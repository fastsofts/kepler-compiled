(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{106:function(t,e,n){"use strict";n.d(e,"a",(function(){return R}));var r=n(957),o=n(197),i=n(2164),a=n(1461),u=n(169),s=n(64);Math.max(6378137,6378137,6356752.314245179);const c=t=>t,l=new r.a;function f(t,e,n=c){return Object(u.f)(t)?(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]):"longitude"in t?(e[0]=n(t.longitude),e[1]=n(t.latitude),e[2]=t.height):(e[0]=n(t.x),e[1]=n(t.y),e[2]=t.z),e}function h(t,e,n=c){return Object(u.f)(e)?(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]):"longitude"in e?(e.longitude=n(t[0]),e.latitude=n(t[1]),e.height=t[2]):(e.x=n(t[0]),e.y=n(t[1]),e.z=t[2]),e}const p=new r.a,d=new r.a,y=new r.a;const g=new r.a,b={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},m={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},v={east:new r.a,north:new r.a,up:new r.a,west:new r.a,south:new r.a,down:new r.a},O=new r.a,w=new r.a,P=new r.a;function M(t,e,n,r,i,a){const s=b[e]&&b[e][n];let c,l,f;Object(o.a)(s&&(!r||r===s));const h=g.copy(i);if(Object(u.d)(h.x,0,1e-14)&&Object(u.d)(h.y,0,1e-14)){const t=Math.sign(h.z);c=O.fromArray(m[e]),"east"!==e&&"west"!==e&&c.scale(t),l=w.fromArray(m[n]),"east"!==n&&"west"!==n&&l.scale(t),f=P.fromArray(m[r]),"east"!==r&&"west"!==r&&f.scale(t)}else{const{up:o,east:i,north:a}=v;i.set(-h.y,h.x,0).normalize(),t.geodeticSurfaceNormal(h,o),a.copy(o).cross(i);const{down:u,west:s,south:p}=v;u.copy(o).scale(-1),s.copy(i).scale(-1),p.copy(a).scale(-1),c=v[e],l=v[n],f=v[r]}return a[0]=c.x,a[1]=c.y,a[2]=c.z,a[3]=0,a[4]=l.x,a[5]=l.y,a[6]=l.z,a[7]=0,a[8]=f.x,a[9]=f.y,a[10]=f.z,a[11]=0,a[12]=h.x,a[13]=h.y,a[14]=h.z,a[15]=1,a}const S=new r.a,x=new r.a,j=new r.a,E=new r.a,_=new r.a,k=new r.a;let C;class R{static get WGS84(){return C=C||new R(6378137,6378137,6356752.314245179),C}constructor(t=0,e=0,n=0){Object(o.a)(t>=0),Object(o.a)(e>=0),Object(o.a)(n>=0),this.radii=new r.a(t,e,n),this.radiiSquared=new r.a(t*t,e*e,n*n),this.radiiToTheFourth=new r.a(t*t*t*t,e*e*e*e,n*n*n*n),this.oneOverRadii=new r.a(0===t?0:1/t,0===e?0:1/e,0===n?0:1/n),this.oneOverRadiiSquared=new r.a(0===t?0:1/(t*t),0===e?0:1/(e*e),0===n?0:1/(n*n)),this.minimumRadius=Math.min(t,e,n),this.maximumRadius=Math.max(t,e,n),this.centerToleranceSquared=i.a.EPSILON1,0!==this.radiiSquared.z&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(t){return this===t||Boolean(t&&this.radii.equals(t.radii))}toString(){return this.radii.toString()}cartographicToCartesian(t,e=[0,0,0]){const n=x,r=j,[,,o]=t;this.geodeticSurfaceNormalCartographic(t,n),r.copy(this.radiiSquared).scale(n);const i=Math.sqrt(n.dot(r));return r.scale(1/i),n.scale(o),r.add(n),r.to(e)}cartesianToCartographic(t,e=[0,0,0]){k.from(t);const n=this.scaleToGeodeticSurface(k,E);if(!n)return;const r=this.geodeticSurfaceNormal(n,x),o=_;o.copy(k).subtract(n);const i=Math.atan2(r.y,r.x),a=Math.asin(r.z),l=Math.sign(s.f(o,k))*s.i(o);return h([i,a,l],e,u.b._cartographicRadians?c:u.g)}eastNorthUpToFixedFrame(t,e=new a.a){return M(this,"east","north","up",t,e)}localFrameToFixedFrame(t,e,n,r,o=new a.a){return M(this,t,e,n,r,o)}geocentricSurfaceNormal(t,e=[0,0,0]){return S.from(t).normalize().to(e)}geodeticSurfaceNormalCartographic(t,e=[0,0,0]){const n=function(t,e=l){return f(t,e,u.b._cartographicRadians?c:u.h)}(t),r=n[0],o=n[1],i=Math.cos(o);return S.set(i*Math.cos(r),i*Math.sin(r),Math.sin(o)).normalize(),S.to(e)}geodeticSurfaceNormal(t,e=[0,0,0]){return S.from(t).scale(this.oneOverRadiiSquared).normalize().to(e)}scaleToGeodeticSurface(t,e){return function(t,e,n=new r.a){const{oneOverRadii:o,oneOverRadiiSquared:a,centerToleranceSquared:u}=e;p.from(t);const s=t.x,c=t.y,l=t.z,f=o.x,h=o.y,g=o.z,b=s*s*f*f,m=c*c*h*h,v=l*l*g*g,O=b+m+v,w=Math.sqrt(1/O);if(!Number.isFinite(w))return;const P=d;if(P.copy(t).scale(w),O<u)return P.to(n);const M=a.x,S=a.y,x=a.z,j=y;j.set(P.x*M*2,P.y*S*2,P.z*x*2);let E,_,k,C,R=(1-w)*t.len()/(.5*j.len()),A=0;do{R-=A,E=1/(1+R*M),_=1/(1+R*S),k=1/(1+R*x);const t=E*E,e=_*_,n=k*k;C=b*t+m*e+v*n-1;A=C/(-2*(b*(t*E)*M+m*(e*_)*S+v*(n*k)*x))}while(Math.abs(C)>i.a.EPSILON12);return p.scale([E,_,k]).to(n)}(t,this,e)}scaleToGeocentricSurface(t,e=[0,0,0]){E.from(t);const n=E.x,r=E.y,o=E.z,i=this.oneOverRadiiSquared,a=1/Math.sqrt(n*n*i.x+r*r*i.y+o*o*i.z);return E.multiplyScalar(a).to(e)}transformPositionToScaledSpace(t,e=[0,0,0]){return E.from(t).scale(this.oneOverRadii).to(e)}transformPositionFromScaledSpace(t,e=[0,0,0]){return E.from(t).scale(this.radii).to(e)}getSurfaceNormalIntersectionWithZAxis(t,e=0,n=[0,0,0]){Object(o.a)(Object(u.d)(this.radii.x,this.radii.y,i.a.EPSILON15)),Object(o.a)(this.radii.z>0),E.from(t);const r=E.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(r)>=this.radii.z-e))return E.set(0,0,r).to(n)}}},1159:function(t,e,n){"use strict";var r=n(1160);function o(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(i,this,e),this.length=this._features.length}function i(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){var e=null,n=t.readVarint()+t.pos;for(;t.pos<n;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null}return e}(n))}t.exports=o,o.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new r(this._pbf,e,this.extent,this._keys,this._values)}},1160:function(t,e,n){"use strict";var r=n(1605);function o(t,e,n,r,o){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=o,t.readFields(i,this,e)}function i(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){var n=t.readVarint()+t.pos;for(;t.pos<n;){var r=e._keys[t.readVarint()],o=e._values[t.readVarint()];e.properties[r]=o}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function a(t){for(var e,n,r=0,o=0,i=t.length,a=i-1;o<i;a=o++)e=t[o],r+=((n=t[a]).x-e.x)*(e.y+n.y);return r}t.exports=o,o.types=["Unknown","Point","LineString","Polygon"],o.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,o=1,i=0,a=0,u=0,s=[];t.pos<n;){if(i<=0){var c=t.readVarint();o=7&c,i=c>>3}if(i--,1===o||2===o)a+=t.readSVarint(),u+=t.readSVarint(),1===o&&(e&&s.push(e),e=[]),e.push(new r(a,u));else{if(7!==o)throw new Error("unknown command "+o);e&&e.push(e[0].clone())}}return e&&s.push(e),s},o.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,r=0,o=0,i=0,a=1/0,u=-1/0,s=1/0,c=-1/0;t.pos<e;){if(r<=0){var l=t.readVarint();n=7&l,r=l>>3}if(r--,1===n||2===n)(o+=t.readSVarint())<a&&(a=o),o>u&&(u=o),(i+=t.readSVarint())<s&&(s=i),i>c&&(c=i);else if(7!==n)throw new Error("unknown command "+n)}return[a,s,u,c]},o.prototype.toGeoJSON=function(t,e,n){var r,i,u=this.extent*Math.pow(2,n),s=this.extent*t,c=this.extent*e,l=this.loadGeometry(),f=o.types[this.type];function h(t){for(var e=0;e<t.length;e++){var n=t[e],r=180-360*(n.y+c)/u;t[e]=[360*(n.x+s)/u-180,360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(r=0;r<l.length;r++)p[r]=l[r][0];h(l=p);break;case 2:for(r=0;r<l.length;r++)h(l[r]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var n,r,o=[],i=0;i<e;i++){var u=a(t[i]);0!==u&&(void 0===r&&(r=u<0),r===u<0?(n&&o.push(n),n=[t[i]]):n.push(t[i]))}n&&o.push(n);return o}(l),r=0;r<l.length;r++)for(i=0;i<l[r].length;i++)h(l[r][i])}1===l.length?l=l[0]:f="Multi"+f;var d={type:"Feature",geometry:{type:f,coordinates:l},properties:this.properties};return"id"in this&&(d.id=this.id),d}},1168:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ScaleMode=void 0;var r=g(n(394)),o=g(n(395)),i=g(n(205)),a=g(n(304)),u=n(30),s=g(n(845)),c=n(88),l=g(n(132)),f=g(n(1615)),h=n(48),p=n(172),d=n(131),y=n(264);function g(t){return t&&t.__esModule?t:{default:t}}function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t){return function(t){if(Array.isArray(t))return v(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function O(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function P(t,e){return!e||"object"!==b(e)&&"function"!=typeof e?M(t):e}function M(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function x(t){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function j(t,e){return(j=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function E(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var _=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&j(t,e)}(b,t);var e,n,l,d,g=(e=b,function(){var t,n=x(e);if(S()){var r=x(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return P(this,t)});function b(){var t;O(this,b);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return E(M(t=g.call.apply(g,[this].concat(n))),"_geometryBeingScaled",void 0),E(M(t),"_selectedEditHandle",void 0),E(M(t),"_cornerGuidePoints",void 0),E(M(t),"_cursor",void 0),E(M(t),"_isScaling",!1),E(M(t),"_isSinglePointGeometrySelected",(function(t){var e=(t||{}).features;return!(!Array.isArray(e)||1!==e.length)&&"Point"===(0,h.getGeom)(e[0]).type})),E(M(t),"_getOppositeScaleHandle",(function(e){var n=e&&e.properties&&Array.isArray(e.properties.positionIndexes)&&e.properties.positionIndexes[0];if("number"!=typeof n)return null;var r=t._cornerGuidePoints.length,o=(n+r/2)%r;return t._cornerGuidePoints.find((function(t){return!!Array.isArray(t.properties.positionIndexes)&&t.properties.positionIndexes[0]===o}))})),E(M(t),"_getUpdatedData",(function(t,e){for(var n=new y.ImmutableFeatureCollection(t.data),r=t.selectedIndexes,o=0;o<r.length;o++){var i=r[o],a=e.features[o];n=n.replaceGeometry(i,a.geometry)}return n.getObject()})),E(M(t),"isEditHandleSelected",(function(){return Boolean(t._selectedEditHandle)})),E(M(t),"getScaleAction",(function(e,n,r,o){if(!t._selectedEditHandle)return null;var i=t._getOppositeScaleHandle(t._selectedEditHandle),a=(0,h.getCoord)(i),u=k(a,e,n),s=(0,f.default)(t._geometryBeingScaled,u,{origin:a});return{updatedData:t._getUpdatedData(o,s),editType:r,editContext:{featureIndexes:o.selectedIndexes}}})),E(M(t),"updateCursor",(function(e){if(t._selectedEditHandle){t._cursor&&e.onUpdateCursor(t._cursor);var n=t.getSelectedFeaturesAsFeatureCollection(e),r=(0,o.default)(n),a=(0,i.default)(r,t._selectedEditHandle),u=a<0?a+180:a;u>=0&&u<=90||u>=180&&u<=270?(t._cursor="nesw-resize",e.onUpdateCursor("nesw-resize")):(t._cursor="nwse-resize",e.onUpdateCursor("nwse-resize"))}else e.onUpdateCursor(null),t._cursor=null})),t}return n=b,(l=[{key:"handlePointerMove",value:function(t,e){if(!this._isScaling){var n=(0,p.getPickedEditHandle)(t.picks);this._selectedEditHandle=n&&"scale"===n.properties.editHandleType?n:null,this.updateCursor(e)}}},{key:"handleStartDragging",value:function(t,e){this._selectedEditHandle&&(this._isScaling=!0,this._geometryBeingScaled=this.getSelectedFeaturesAsFeatureCollection(e))}},{key:"handleDragging",value:function(t,e){if(this._isScaling){e.onUpdateCursor(this._cursor);var n=this.getScaleAction(t.pointerDownMapCoords,t.mapCoords,"scaling",e);n&&e.onEdit(n),t.cancelPan()}}},{key:"handleStopDragging",value:function(t,e){if(this._isScaling){var n=this.getScaleAction(t.pointerDownMapCoords,t.mapCoords,"scaled",e);n&&e.onEdit(n),e.onUpdateCursor(null),this._geometryBeingScaled=null,this._selectedEditHandle=null,this._cursor=null,this._isScaling=!1}}},{key:"getGuides",value:function(t){this._cornerGuidePoints=[];var e=this.getSelectedFeaturesAsFeatureCollection(t);if(this._isSinglePointGeometrySelected(e))return{type:"FeatureCollection",features:[]};var n=(0,a.default)((0,r.default)(e));n.properties.mode="scale";var o=[];return(0,c.coordEach)(n,(function(t,e){if(e<4){var n=(0,u.point)(t,{guideType:"editHandle",editHandleType:"scale",positionIndexes:[e]});o.push(n)}})),this._cornerGuidePoints=o,(0,u.featureCollection)([(0,s.default)(n)].concat(m(this._cornerGuidePoints)))}}])&&w(n.prototype,l),d&&w(n,d),b}(d.GeoJsonEditMode);function k(t,e,n){var r=(0,l.default)(t,e);return(0,l.default)(t,n)/r}e.ScaleMode=_},1169:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RotateMode=void 0;var r=g(n(394)),o=g(n(395)),i=g(n(205)),a=g(n(304)),u=g(n(132)),s=n(88),c=n(48),l=n(30),f=g(n(926)),h=g(n(845)),p=n(172),d=n(131),y=n(264);function g(t){return t&&t.__esModule?t:{default:t}}function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function O(t,e){return!e||"object"!==b(e)&&"function"!=typeof e?w(t):e}function w(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function P(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function M(t){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function S(t,e){return(S=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function x(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var j=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&S(t,e)}(E,t);var e,n,g,b,j=(e=E,function(){var t,n=M(e);if(P()){var r=M(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return O(this,t)});function E(){var t;m(this,E);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return x(w(t=j.call.apply(j,[this].concat(n))),"_selectedEditHandle",void 0),x(w(t),"_geometryBeingRotated",void 0),x(w(t),"_isRotating",!1),x(w(t),"_isSinglePointGeometrySelected",(function(t){var e=(t||{}).features;return!(!Array.isArray(e)||1!==e.length)&&"Point"===(0,c.getGeom)(e[0]).type})),x(w(t),"getIsRotating",(function(){return t._isRotating})),t}return n=E,(g=[{key:"getGuides",value:function(t){var e=this._geometryBeingRotated||this.getSelectedFeaturesAsFeatureCollection(t);if(this._isSinglePointGeometrySelected(e))return{type:"FeatureCollection",features:[]};if(this._isRotating)return(0,l.featureCollection)([(0,o.default)(e)]);var n=(0,a.default)((0,r.default)(e)),i=null,c=null,f=0;(0,s.coordEach)(n,(function(t){if(i){var e=(0,d.getIntermediatePosition)(t,i);(!c||e[1]>c[1])&&(c=e);var n=(0,u.default)(t,i);f=Math.max(f,n)}i=t}));var p=c&&[c[0],c[1]+f/1e3],y=(0,l.lineString)([c,p]),g=(0,l.point)(p,{guideType:"editHandle",editHandleType:"rotate"});return(0,l.featureCollection)([(0,h.default)(n),g,y])}},{key:"handleDragging",value:function(t,e){if(this._isRotating){var n=this.getRotateAction(t.pointerDownMapCoords,t.mapCoords,"rotating",e);n&&e.onEdit(n),t.cancelPan()}}},{key:"handlePointerMove",value:function(t,e){if(!this._isRotating){var n=(0,p.getPickedEditHandle)(t.picks);this._selectedEditHandle=n&&"rotate"===n.properties.editHandleType?n:null}this.updateCursor(e)}},{key:"handleStartDragging",value:function(t,e){this._selectedEditHandle&&(this._isRotating=!0,this._geometryBeingRotated=this.getSelectedFeaturesAsFeatureCollection(e))}},{key:"handleStopDragging",value:function(t,e){if(this._isRotating){var n=this.getRotateAction(t.pointerDownMapCoords,t.mapCoords,"rotated",e);n&&e.onEdit(n),this._geometryBeingRotated=null,this._selectedEditHandle=null,this._isRotating=!1}}},{key:"updateCursor",value:function(t){this._selectedEditHandle?t.onUpdateCursor("crosshair"):t.onUpdateCursor(null)}},{key:"getRotateAction",value:function(t,e,n,r){if(!this._geometryBeingRotated)return null;for(var a=(0,o.default)(this._geometryBeingRotated),u=function(t,e,n){var r=(0,i.default)(t,e);return(0,i.default)(t,n)-r}(a,t,e),s=(0,f.default)(this._geometryBeingRotated,u,{pivot:a}),c=new y.ImmutableFeatureCollection(r.data),l=r.selectedIndexes,h=0;h<l.length;h++){var p=l[h],d=s.features[h];c=c.replaceGeometry(p,d.geometry)}return{updatedData:c.getObject(),editType:n,editContext:{featureIndexes:l}}}}])&&v(n.prototype,g),b&&v(n,b),E}(d.GeoJsonEditMode);e.RotateMode=j},1171:function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||i(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?c(t):e}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.CompositeMode=void 0;var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(d,t);var e,n,r,a,p=(e=d,function(){var t,n=f(e);if(l()){var r=f(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return s(this,t)});function d(t){var e,n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),e=p.call(this),n=c(e),o=void 0,(r="_modes")in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,e._modes=t,e}return n=d,(r=[{key:"_coalesce",value:function(t){for(var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=0;r<this._modes.length&&(e=t(this._modes[r]),!(n?n(e):e));r++);return e}},{key:"handleClick",value:function(t,e){this._coalesce((function(n){return n.handleClick(t,e)}))}},{key:"handlePointerMove",value:function(t,e){return this._coalesce((function(n){return n.handlePointerMove(t,e)}))}},{key:"handleStartDragging",value:function(t,e){return this._coalesce((function(n){return n.handleStartDragging(t,e)}))}},{key:"handleStopDragging",value:function(t,e){return this._coalesce((function(n){return n.handleStopDragging(t,e)}))}},{key:"handleDragging",value:function(t,e){return this._coalesce((function(n){return n.handleDragging(t,e)}))}},{key:"getGuides",value:function(t){var e,n=[],r=function(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=i(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,a=!0,u=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw o}}}}(this._modes);try{for(r.s();!(e=r.n()).done;){var a=e.value;n.push.apply(n,o(a.getGuides(t).features))}}catch(t){r.e(t)}finally{r.f()}return{type:"FeatureCollection",features:n}}}])&&u(n.prototype,r),a&&u(n,a),d}(n(131).GeoJsonEditMode);e.CompositeMode=p},1173:function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function u(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.ThreeClickPolygonMode=void 0;var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(p,t);var e,n,r,f,h=(e=p,function(){var t,n=c(e);if(s()){var r=c(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return u(this,t)});function p(){return o(this,p),h.apply(this,arguments)}return n=p,(r=[{key:"handleClick",value:function(t,e){this.addClickSequence(t);var n=this.getClickSequence(),r=this.getTentativeGuide(e);if(n.length>2&&r&&"Polygon"===r.geometry.type){var o=this.getAddFeatureOrBooleanPolygonAction(r.geometry,e);this.resetClickSequence(),o&&e.onEdit(o)}}},{key:"getGuides",value:function(t){var e=t.lastPointerMoveEvent,n=t.modeConfig,r=this.getClickSequence(),o={type:"FeatureCollection",features:[]};if(0===r.length)return o;var i=e.mapCoords;if(1===r.length)o.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[r[0],i]}});else{var a=this.getThreeClickPolygon(r[0],r[1],i,n);a&&o.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:a.geometry})}return o}},{key:"getThreeClickPolygon",value:function(t,e,n,r){return null}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),a(c(p.prototype),"handlePointerMove",this).call(this,t,e)}},{key:"createTentativeFeature",value:function(t){var e,n=t.lastPointerMoveEvent,r=this.getClickSequence(),o=n?[n.mapCoords]:[];return 2===r.length&&(e=this.getThreeClickPolygon(r[0],r[1],o[0],t.modeConfig)),e}}])&&i(n.prototype,r),f&&i(n,f),p}(n(131).GeoJsonEditMode);e.ThreeClickPolygonMode=f},1174:function(t,e,n){"use strict";function r(t,e){if(t===e)return!0;if(Array.isArray(t)){var n=t.length;if(!e||e.length!==n)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e,n={};return function(o){for(var i in o)if(!r(o[i],n[i])){e=t(o),n=o;break}return e}}},1175:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(49);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){y(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g=["anyclick","pointermove","panstart","panmove","panend","keyup"],b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(s,t);var e,n,r,o,i=(e=s,function(){var t,n=p(e);if(h()){var r=p(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return f(this,t)});function s(){return c(this,s),i.apply(this,arguments)}return n=s,(r=[{key:"onLayerClick",value:function(t){}},{key:"onStartDragging",value:function(t){}},{key:"onStopDragging",value:function(t){}},{key:"onDragging",value:function(t){}},{key:"onPointerMove",value:function(t){}},{key:"onLayerKeyUp",value:function(t){}},{key:"initializeState",value:function(){this.setState({_editableLayerState:{pointerDownPicks:null,pointerDownScreenCoords:null,pointerDownMapCoords:null,eventHandler:this._forwardEventToCurrentLayer.bind(this)}}),this._addEventHandlers()}},{key:"finalizeState",value:function(){this._removeEventHandlers()}},{key:"_addEventHandlers",value:function(){var t,e=this.context.deck.eventManager,n=this.state._editableLayerState.eventHandler,r=u(g);try{for(r.s();!(t=r.n()).done;){var o=t.value;e.on(o,n,{priority:100})}}catch(t){r.e(t)}finally{r.f()}}},{key:"_removeEventHandlers",value:function(){var t,e=this.context.deck.eventManager,n=this.state._editableLayerState.eventHandler,r=u(g);try{for(r.s();!(t=r.n()).done;){var o=t.value;e.off(o,n)}}catch(t){r.e(t)}finally{r.f()}}},{key:"_forwardEventToCurrentLayer",value:function(t){var e=this.getCurrentLayer(),n=e["_on".concat(t.type)].bind(e);n?n(t):console.warn("no handler for mjolnir.js event ".concat(t.type))}},{key:"_onanyclick",value:function(t){var e=t.srcEvent,n=this.getScreenCoords(e),r=this.getMapCoords(n),o=this.getPicks(n);this.onLayerClick({mapCoords:r,screenCoords:n,picks:o,sourceEvent:e})}},{key:"_onkeyup",value:function(t){var e=t.srcEvent;this.onLayerKeyUp(e)}},{key:"_onpanstart",value:function(t){var e=this.getScreenCoords(t.srcEvent),n=this.getMapCoords(e),r=this.getPicks(e);this.setState({_editableLayerState:a({},this.state._editableLayerState,{pointerDownScreenCoords:e,pointerDownMapCoords:n,pointerDownPicks:r})}),this.onStartDragging({picks:r,screenCoords:e,mapCoords:n,pointerDownScreenCoords:e,pointerDownMapCoords:n,cancelPan:t.stopImmediatePropagation,sourceEvent:t.srcEvent})}},{key:"_onpanmove",value:function(t){var e=t.srcEvent,n=this.getScreenCoords(e),r=this.getMapCoords(n),o=this.state._editableLayerState,i=o.pointerDownPicks,a=o.pointerDownScreenCoords,u=o.pointerDownMapCoords,s=this.getPicks(n);this.onDragging({screenCoords:n,mapCoords:r,picks:s,pointerDownPicks:i,pointerDownScreenCoords:a,pointerDownMapCoords:u,sourceEvent:e,cancelPan:t.stopImmediatePropagation})}},{key:"_onpanend",value:function(t){var e=t.srcEvent,n=this.getScreenCoords(e),r=this.getMapCoords(n),o=this.state._editableLayerState,i=o.pointerDownPicks,u=o.pointerDownScreenCoords,s=o.pointerDownMapCoords,c=this.getPicks(n);this.onStopDragging({picks:c,screenCoords:n,mapCoords:r,pointerDownPicks:i,pointerDownScreenCoords:u,pointerDownMapCoords:s,sourceEvent:e}),this.setState({_editableLayerState:a({},this.state._editableLayerState,{pointerDownScreenCoords:null,pointerDownMapCoords:null,pointerDownPicks:null})})}},{key:"_onpointermove",value:function(t){var e=t.srcEvent,n=this.getScreenCoords(e),r=this.getMapCoords(n),o=this.state._editableLayerState,i=o.pointerDownPicks,a=o.pointerDownScreenCoords,u=o.pointerDownMapCoords,s=this.getPicks(n);this.onPointerMove({screenCoords:n,mapCoords:r,picks:s,pointerDownPicks:i,pointerDownScreenCoords:a,pointerDownMapCoords:u,sourceEvent:e})}},{key:"getPicks",value:function(t){return this.context.deck.pickMultipleObjects({x:t[0],y:t[1],layerIds:[this.props.id],radius:this.props.pickingRadius,depth:this.props.pickingDepth})}},{key:"getScreenCoords",value:function(t){return[t.clientX-this.context.gl.canvas.getBoundingClientRect().left,t.clientY-this.context.gl.canvas.getBoundingClientRect().top]}},{key:"getMapCoords",value:function(t){return this.context.viewport.unproject([t[0],t[1]])}}])&&l(n.prototype,r),o&&l(n,o),s}(r.CompositeLayer);e.default=b,y(b,"layerName","EditableLayer")},1177:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toDeckColor=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[255,0,0,255];if(!Array.isArray(t))return e;return[255*t[0],255*t[1],255*t[2],255*t[3]]},e.recursivelyTraverseNestedArrays=function t(e,n,r){if(!Array.isArray(e[0]))return!0;for(var o=0;o<e.length;o++)if(t(e[o],[].concat(function(t){if(Array.isArray(t))return f(t)}(i=n)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(i)||l(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[o]),r)){r(e,n);break}var i;return!1},e.generatePointsParallelToLinePoints=function(t,e,n){var u={type:"LineString",coordinates:[t,e]},s=(0,a.point)(n),c=(0,i.default)(s,u),l=(0,o.default)(t,e),f=(n[0]-t[0])*(e[1]-t[1])-(n[1]-t[1])*(e[0]-t[0])<0?l-90:l-270,h=(0,r.default)(e,c,f),p=(0,r.default)(t,c,f);return[h.geometry.coordinates,p.geometry.coordinates]},e.distance2d=h,e.mix=p,e.nearestPointOnProjectedLine=function(t,e,n){var r=new u.default(n),o=t.geometry.coordinates.map((function(t){var e=c(t,3),n=e[0],o=e[1],i=e[2],a=void 0===i?0:i;return r.project([n,o,a])})),i=c(r.project(e.geometry.coordinates),2),a=i[0],s=i[1],l=1/0,f={};o.forEach((function(t,e){var n=c(t,2),r=n[0],i=n[1];if(0!==e){var u=c(o[e-1],2),h=u[0],p=u[1],d=p-i,y=r-h,g=h*i-r*p,b=d*d+y*y,m=Math.abs(d*a+y*s+g)/Math.sqrt(b);m<l&&(l=m,f={index:e,x0:(y*(y*a-d*s)-d*g)/b,y0:(d*(-y*a+d*s)-y*g)/b})}}));var d=f,y=d.index,g=d.x0,b=d.y0,m=c(o[y-1],3),v=m[0],O=m[1],w=m[2],P=void 0===w?0:w,M=c(o[y],3),S=M[0],x=M[1],j=M[2],E=void 0===j?0:j,_=h(v,O,S,x),k=h(v,O,g,b),C=p(P,E,k/_);return{type:"Feature",geometry:{type:"Point",coordinates:r.unproject([g,b,C])},properties:{dist:l,index:y-1}}},e.insertBefore=function(t,e,n){var r=t.indexOf(e);if(r<0)return t;return t.slice(0,r)+n+t.slice(r)};var r=s(n(252)),o=s(n(205)),i=s(n(1166)),a=n(30),u=s(n(2100));function s(t){return t&&t.__esModule?t:{default:t}}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||l(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function h(t,e,n,r){var o=t-n,i=e-r;return Math.sqrt(o*o+i*i)}function p(t,e,n){return e*n+t*(1-n)}},1179:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(99),o=s(n(125)),i=n(70),a=s(n(1655)),u=n(847);function s(t){return t&&t.__esModule?t:{default:t}}function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=y(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function p(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m(t){var e=t.source,n=t.code,r=void 0===n?"":n;return e.replace(/}[^{}]*$/,r.concat("\n}\n"))}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(b,t);var e,n,r,s,c=(e=b,function(){var t,n=y(e);if(d()){var r=y(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return p(this,t)});function b(){return l(this,b),c.apply(this,arguments)}return n=b,(r=[{key:"getShaders",value:function(){var t=h(y(b.prototype),"getShaders",this).call(this);return Object.assign({},t,{modules:t.modules.concat([a.default]),vs:m({source:t.vs,code:"  outline_setUV(gl_Position);\n  outline_setZLevel(instanceZLevel);\n"}),fs:m({source:t.fs,code:"  gl_FragColor = outline_filterColor(gl_FragColor);\n"})})}},{key:"initializeState",value:function(t){h(y(b.prototype),"initializeState",this).call(this,t),this.setState({outlineFramebuffer:new i.Framebuffer(t.gl),dummyTexture:new i.Texture2D(t.gl)}),this.state.attributeManager.addInstanced({instanceZLevel:{size:1,type:o.default.UNSIGNED_BYTE,accessor:"getZLevel"}})}},{key:"draw",value:function(t){t.moduleParameters,t.parameters;var e=t.uniforms,n=(t.context,this.props),r=n.jointRounded,i=n.capRounded,a=n.billboard,s=n.miterLimit,c=n.widthUnits,l=n.widthScale,f=n.widthMinPixels,h=n.widthMaxPixels;e=Object.assign({},e,{jointType:Number(r),capType:Number(i),billboard:a,widthUnits:u.UNIT[c],widthScale:l,miterLimit:s,widthMinPixels:f,widthMaxPixels:h});var p=this.state,d=p.outlineFramebuffer,y=p.dummyTexture;d.resize(),d.clear({color:!0,depth:!0}),this.state.model.updateModuleSettings({outlineEnabled:!0,outlineRenderShadowmap:!0,outlineShadowmap:y}),this.state.model.draw({uniforms:Object.assign({},e,{jointType:0,widthScale:1.3*this.props.widthScale}),parameters:{depthTest:!1,blendEquation:o.default.MAX},framebuffer:d}),this.state.model.updateModuleSettings({outlineEnabled:!0,outlineRenderShadowmap:!1,outlineShadowmap:d}),this.state.model.draw({uniforms:Object.assign({},e,{jointType:Number(r),capType:Number(i),widthScale:this.props.widthScale}),parameters:{depthTest:!1}})}}])&&f(n.prototype,r),s&&f(n,s),b}(r.PathLayer);e.default=v,b(v,"layerName","PathOutlineLayer"),b(v,"defaultProps",{getZLevel:function(){return 0}})},1234:function(t,e,n){"use strict";var r=n(1235),o=n(1883),i=n(637);function a(t){if(!t||!t.accessToken)throw new Error("Cannot create a client without an access token");r(t.accessToken),this.accessToken=t.accessToken,this.origin=t.origin||i.API_ORIGIN}a.prototype.createRequest=function(t){return new o(this,t)},t.exports=a},1235:function(t,e,n){"use strict";var r=n(1882),o={};function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t){if(o[t])return o[t];var e=t.split("."),n=e[0],a=e[1];if(!a)throw new Error("Invalid token");var u=function(t){try{return JSON.parse(r.decode(t))}catch(t){throw new Error("Invalid token")}}(a),s={usage:n,user:u.u};return i(u,"a")&&(s.authorization=u.a),i(u,"exp")&&(s.expires=1e3*u.exp),i(u,"iat")&&(s.created=1e3*u.iat),i(u,"scopes")&&(s.scopes=u.scopes),i(u,"client")&&(s.client=u.client),i(u,"ll")&&(s.lastLogin=u.ll),i(u,"iu")&&(s.impersonator=u.iu),o[t]=s,s}},131:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getIntermediatePosition=function(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]},e.GeoJsonEditMode=void 0;var r=c(n(1610)),o=c(n(841)),i=c(n(1611)),a=c(n(2101)),u=n(172),s=n(264);function c(t){return t&&t.__esModule?t:{default:t}}function l(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||f(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){if(t){if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var d={type:"FeatureCollection",features:[]},y=[],g=function(){function t(){var e,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r=[],(n="_clickSequence")in(e=this)?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r}var e,n,c;return e=t,(n=[{key:"getGuides",value:function(t){return d}},{key:"getTooltips",value:function(t){return y}},{key:"getSelectedFeature",value:function(t){return 1===t.selectedIndexes.length?t.data.features[t.selectedIndexes[0]]:null}},{key:"getSelectedGeometry",value:function(t){var e=this.getSelectedFeature(t);return e?e.geometry:null}},{key:"getSelectedFeaturesAsFeatureCollection",value:function(t){var e=t.data.features;return{type:"FeatureCollection",features:t.selectedIndexes.map((function(t){return e[t]}))}}},{key:"getClickSequence",value:function(){return this._clickSequence}},{key:"addClickSequence",value:function(t){var e=t.mapCoords;this._clickSequence.push(e)}},{key:"resetClickSequence",value:function(){this._clickSequence=[]}},{key:"getTentativeGuide",value:function(t){return this.getGuides(t).features.find((function(t){return t.properties&&"tentative"===t.properties.guideType}))}},{key:"isSelectionPicked",value:function(t,e){if(!t.length)return!1;var n=(0,u.getNonGuidePicks)(t).map((function(t){return t.index})),r=(0,u.getPickedEditHandles)(t).map((function(t){return t.properties.featureIndex})),o=new Set([].concat(l(n),l(r)));return e.selectedIndexes.some((function(t){return o.has(t)}))}},{key:"rewindPolygon",value:function(t){var e=t.geometry;return"Polygon"===e.type||"MultiPolygon"===e.type?(0,a.default)(t):t}},{key:"getAddFeatureAction",value:function(t,e){var n=t,r="Feature"===n.type?n:{type:"Feature",properties:{},geometry:n},o=this.rewindPolygon(r),i=new s.ImmutableFeatureCollection(e).addFeature(o).getObject();return{updatedData:i,editType:"addFeature",editContext:{featureIndexes:[i.features.length-1]}}}},{key:"getAddManyFeaturesAction",value:function(t,e){var n,r=t.features,o=new s.ImmutableFeatureCollection(e),i=o.getObject().features.length,a=[],u=function(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=f(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}(r);try{for(u.s();!(n=u.n()).done;){var c=n.value,l=c.properties,h=c.geometry;o=o.addFeature({type:"Feature",properties:l,geometry:h}),a.push(i+a.length)}}catch(t){u.e(t)}finally{u.f()}return{updatedData:o.getObject(),editType:"addFeature",editContext:{featureIndexes:a}}}},{key:"getAddFeatureOrBooleanPolygonAction",value:function(t,e){var n=t,a=this.getSelectedFeature(e),u=e.modeConfig;if(u&&u.booleanOperation){if(!a||"Polygon"!==a.geometry.type&&"MultiPolygon"!==a.geometry.type)return console.warn("booleanOperation only supported for single Polygon or MultiPolygon selection"),null;var c,l="Feature"===n.type?n:{type:"Feature",geometry:n};if("union"===u.booleanOperation)c=(0,r.default)(a,l);else if("difference"===u.booleanOperation)c=(0,o.default)(a,l);else{if("intersection"!==u.booleanOperation)return console.warn("Invalid booleanOperation ".concat(u.booleanOperation)),null;c=(0,i.default)(a,l)}if(!c)return console.warn("Canceling edit. Boolean operation erased entire polygon."),null;var f=e.selectedIndexes[0];return{updatedData:new s.ImmutableFeatureCollection(e.data).replaceGeometry(f,c.geometry).getObject(),editType:"unionGeometry",editContext:{featureIndexes:[f]}}}return this.getAddFeatureAction(t,e.data)}},{key:"createTentativeFeature",value:function(t){return null}},{key:"handleClick",value:function(t,e){}},{key:"handlePointerMove",value:function(t,e){var n=this.createTentativeFeature(e);n&&e.onEdit({updatedData:e.data,editType:"updateTentativeFeature",editContext:{feature:n}})}},{key:"handleStartDragging",value:function(t,e){}},{key:"handleStopDragging",value:function(t,e){}},{key:"handleDragging",value:function(t,e){}},{key:"handleKeyUp",value:function(t,e){"Escape"===t.key&&(this.resetClickSequence(),e.onEdit({updatedData:e.data,editType:"cancelFeature",editContext:{}}))}}])&&p(e.prototype,n),c&&p(e,c),t}();e.GeoJsonEditMode=g},1374:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return T})),n.d(e,"WebMercatorViewport",(function(){return T})),n.d(e,"getBounds",(function(){return R})),n.d(e,"fitBounds",(function(){return k})),n.d(e,"normalizeViewportProps",(function(){return I})),n.d(e,"flyToViewport",(function(){return F})),n.d(e,"getFlyToDuration",(function(){return N})),n.d(e,"lngLatToWorld",(function(){return b})),n.d(e,"worldToLngLat",(function(){return m})),n.d(e,"worldToPixels",(function(){return E})),n.d(e,"pixelsToWorld",(function(){return _})),n.d(e,"zoomToScale",(function(){return y})),n.d(e,"scaleToZoom",(function(){return g})),n.d(e,"altitudeToFovy",(function(){return x})),n.d(e,"fovyToAltitude",(function(){return j})),n.d(e,"getMeterZoom",(function(){return v})),n.d(e,"getDistanceScales",(function(){return O})),n.d(e,"addMetersToLngLat",(function(){return w})),n.d(e,"getViewMatrix",(function(){return P})),n.d(e,"getProjectionMatrix",(function(){return S})),n.d(e,"getProjectionParameters",(function(){return M}));var r=n(93);function o(t,e){const n=r.n([],e,t);return r.k(n,n,1/n[3]),n}function i(t,e){const n=t%e;return n<0?e+n:n}const a=Math.log2||function(t){return Math.log(t)*Math.LOG2E};var u=n(46),s=n(58),c=n(64);function l(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const f=Math.PI,h=f/4,p=f/180,d=180/f;function y(t){return Math.pow(2,t)}function g(t){return a(t)}function b([t,e]){l(Number.isFinite(t)),l(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude");const n=e*p;return[512*(t*p+f)/(2*f),512*(f+Math.log(Math.tan(h+.5*n)))/(2*f)]}function m([t,e]){const n=t/512*(2*f)-f,r=2*(Math.atan(Math.exp(e/512*(2*f)-f))-h);return[n*d,r*d]}function v({latitude:t}){l(Number.isFinite(t));return g(4003e4*Math.cos(t*p))-9}function O({latitude:t,longitude:e,highPrecision:n=!1}){l(Number.isFinite(t)&&Number.isFinite(e));const r={},o=Math.cos(t*p),i=512/360/o,a=512/4003e4/o;if(r.unitsPerMeter=[a,a,a],r.metersPerUnit=[1/a,1/a,1/a],r.unitsPerDegree=[512/360,i,a],r.degreesPerUnit=[.703125,1/i,1/a],n){const e=p*Math.tan(t*p)/o,n=512/360*e/2,u=512/4003e4*e,s=u/i*a;r.unitsPerDegree2=[0,n,u],r.unitsPerMeter2=[s,0,s]}return r}function w(t,e){const[n,r,o]=t,[i,a,u]=e,{unitsPerMeter:s,unitsPerMeter2:c}=O({longitude:n,latitude:r,highPrecision:!0}),l=b(t);l[0]+=i*(s[0]+c[0]*a),l[1]+=a*(s[1]+c[1]*a);const f=m(l),h=(o||0)+(u||0);return Number.isFinite(o)||Number.isFinite(u)?[f[0],f[1],h]:f}function P({height:t,pitch:e,bearing:n,altitude:r,scale:o,center:i=null}){const a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return u.p(a,a,[0,0,-r]),u.l(a,a,-e*p),u.n(a,a,n*p),o/=t,u.o(a,a,[o,o,o]),i&&u.p(a,a,c.l([],i)),a}function M({width:t,height:e,fovy:n=x(1.5),altitude:r,pitch:o=0,nearZMultiplier:i=1,farZMultiplier:a=1}){void 0!==r&&(n=x(r));const u=.5*n*p,s=j(n),c=o*p,l=Math.sin(u)*s/Math.sin(Math.min(Math.max(Math.PI/2-c-u,.01),Math.PI-.01));return{fov:2*u,aspect:t/e,focalDistance:s,near:i,far:(Math.sin(c)*l+s)*a}}function S({width:t,height:e,pitch:n,altitude:r,fovy:o,nearZMultiplier:i,farZMultiplier:a}){const{fov:s,aspect:c,near:l,far:f}=M({width:t,height:e,altitude:r,fovy:o,pitch:n,nearZMultiplier:i,farZMultiplier:a});return u.j([],s,c,l,f)}function x(t){return 2*Math.atan(.5/t)*d}function j(t){return.5/Math.tan(.5*t*p)}function E(t,e){const[n,r,i=0]=t;return l(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),o(e,[n,r,i,1])}function _(t,e,n=0){const[r,i,a]=t;if(l(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(a)){return o(e,[r,i,a,1])}const u=o(e,[r,i,0,1]),c=o(e,[r,i,1,1]),f=u[2],h=c[2],p=f===h?0:((n||0)-f)/(h-f);return s.c([],u,c,p)}function k({width:t,height:e,bounds:n,minExtent:r=0,maxZoom:o=24,padding:i=0,offset:u=[0,0]}){const[[s,c],[f,h]]=n;if(Number.isFinite(i)){i={top:i,bottom:i,left:i,right:i}}else l(Number.isFinite(i.top)&&Number.isFinite(i.bottom)&&Number.isFinite(i.left)&&Number.isFinite(i.right));const p=new T({width:t,height:e,longitude:0,latitude:0,zoom:0}),d=p.project([s,h]),y=p.project([f,c]),g=[Math.max(Math.abs(y[0]-d[0]),r),Math.max(Math.abs(y[1]-d[1]),r)],b=[t-i.left-i.right-2*Math.abs(u[0]),e-i.top-i.bottom-2*Math.abs(u[1])];l(b[0]>0&&b[1]>0);const m=b[0]/g[0],v=b[1]/g[1],O=(i.right-i.left)/2/m,w=(i.bottom-i.top)/2/v,P=[(y[0]+d[0])/2+O,(y[1]+d[1])/2+w],M=p.unproject(P),S=Math.min(o,p.zoom+a(Math.abs(Math.min(m,v))));return l(Number.isFinite(S)),{longitude:M[0],latitude:M[1],zoom:S}}const C=Math.PI/180;function R(t,e=0){const{width:n,height:r,unproject:o}=t,i={targetZ:e},a=o([0,r],i),u=o([n,r],i);let s,c;return(t.fovy?.5*t.fovy*C:Math.atan(.5/t.altitude))>(90-t.pitch)*C-.01?(s=A(t,0,e),c=A(t,n,e)):(s=o([0,0],i),c=o([n,0],i)),[a,u,c,s]}function A(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=o(r,[e,0,1,1]),a=o(r,[e,t.height,1,1]),u=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(a[2]-i[2]),c=m(s.c([],i,a,u));return c[2]=n,c}class T{constructor({width:t,height:e,latitude:n=0,longitude:r=0,zoom:o=0,pitch:i=0,bearing:a=0,altitude:u=null,fovy:s=null,position:l=null,nearZMultiplier:f=.02,farZMultiplier:h=1.01}={width:1,height:1}){t=t||1,e=e||1,null===s&&null===u?s=x(u=1.5):null===s?s=x(u):null===u&&(u=j(s));const p=y(o);u=Math.max(.75,u);const d=O({longitude:r,latitude:n}),g=b([r,n]);g[2]=0,l&&c.a(g,g,c.k([],l,d.unitsPerMeter)),this.projectionMatrix=S({width:t,height:e,pitch:i,fovy:s,nearZMultiplier:f,farZMultiplier:h}),this.viewMatrix=P({height:e,scale:p,center:g,pitch:i,bearing:a,altitude:u}),this.width=t,this.height=e,this.scale=p,this.latitude=n,this.longitude=r,this.zoom=o,this.pitch=i,this.bearing=a,this.altitude=u,this.fovy=s,this.center=g,this.meterOffset=l||[0,0,0],this.distanceScales=d,this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}_initMatrices(){const{width:t,height:e,projectionMatrix:n,viewMatrix:r}=this,o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];u.h(o,o,n),u.h(o,o,r),this.viewProjectionMatrix=o;const i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];u.o(i,i,[t/2,-e/2,1]),u.p(i,i,[1,-1,0]),u.h(i,i,o);const a=u.f([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i);if(!a)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=i,this.pixelUnprojectionMatrix=a}equals(t){return t instanceof T&&(t.width===this.width&&t.height===this.height&&u.b(t.projectionMatrix,this.projectionMatrix)&&u.b(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:e=!0}={}){const n=E(this.projectPosition(t),this.pixelProjectionMatrix),[r,o]=n,i=e?o:this.height-o;return 2===t.length?[r,i]:[r,i,n[2]]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[r,o,i]=t,a=e?o:this.height-o,u=n&&n*this.distanceScales.unitsPerMeter[2],s=_([r,a,i],this.pixelUnprojectionMatrix,u),[c,l,f]=this.unprojectPosition(s);return Number.isFinite(i)?[c,l,f]:Number.isFinite(n)?[c,l,n]:[c,l]}projectPosition(t){const[e,n]=b(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=m(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return b(t)}unprojectFlat(t){return m(t)}getMapCenterByLngLatPosition({lngLat:t,pos:e}){const n=_(e,this.pixelUnprojectionMatrix),r=b(t),o=s.a([],r,s.d([],n));return m(s.a([],this.center,o))}getLocationAtPoint({lngLat:t,pos:e}){return this.getMapCenterByLngLatPosition({lngLat:t,pos:e})}fitBounds(t,e={}){const{width:n,height:r}=this,{longitude:o,latitude:i,zoom:a}=k(Object.assign({width:n,height:r,bounds:t},e));return new T({width:n,height:r,longitude:o,latitude:i,zoom:a})}getBounds(t){const e=this.getBoundingRegion(t),n=Math.min(...e.map(t=>t[0])),r=Math.max(...e.map(t=>t[0]));return[[n,Math.min(...e.map(t=>t[1]))],[r,Math.max(...e.map(t=>t[1]))]]}getBoundingRegion(t={}){return R(this,t.z||0)}}function I({width:t,height:e,longitude:n,latitude:r,zoom:o,pitch:u=0,bearing:s=0}){(n<-180||n>180)&&(n=i(n+180,360)-180),(s<-180||s>180)&&(s=i(s+180,360)-180);const c=a(e/512);if(o<=c)o=c,r=0;else{const t=e/2/Math.pow(2,o),n=m([0,t])[1];if(r<n)r=n;else{const e=m([0,512-t])[1];r>e&&(r=e)}}return{width:t,height:e,longitude:n,latitude:r,zoom:o,pitch:u,bearing:s}}const D=["longitude","latitude","zoom"],L={curve:1.414,speed:1.2};function F(t,e,n,r={}){const o={},{startZoom:i,startCenterXY:a,uDelta:u,w0:c,u1:l,S:f,rho:h,rho2:p,r0:d}=q(t,e,r);if(l<.01){for(const r of D){const i=t[r],a=e[r];o[r]=(y=n)*a+(1-y)*i}return o}var y;const b=n*f,v=Math.cosh(d)/Math.cosh(d+h*b),O=c*((Math.cosh(d)*Math.tanh(d+h*b)-Math.sinh(d))/p)/l,w=i+g(1/v),P=s.e([],u,O);s.a(P,P,a);const M=m(P);return o.longitude=M[0],o.latitude=M[1],o.zoom=w,o}function N(t,e,n={}){n=Object.assign({},L,n);const{screenSpeed:r,speed:o,maxDuration:i}=n,{S:a,rho:u}=q(t,e,n),s=1e3*a;let c;return c=Number.isFinite(r)?s/(r/u):s/o,Number.isFinite(i)&&c>i?0:c}function q(t,e,n){const r=(n=Object.assign({},L,n)).curve,o=t.zoom,i=[t.longitude,t.latitude],a=y(o),u=e.zoom,c=[e.longitude,e.latitude],l=y(u-o),f=b(i),h=b(c),p=s.f([],h,f),d=Math.max(t.width,t.height),g=d/l,m=s.b(p)*a,v=Math.max(m,.01),O=r*r,w=(g*g-d*d+O*O*v*v)/(2*d*O*v),P=(g*g-d*d-O*O*v*v)/(2*g*O*v),M=Math.log(Math.sqrt(w*w+1)-w),S=Math.log(Math.sqrt(P*P+1)-P);return{startZoom:o,startCenterXY:f,uDelta:p,w0:d,u1:m,S:(S-M)/r,rho:r,rho2:O,r0:M,r1:S}}},1409:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));const r=1e20;class o{constructor({fontSize:t=24,buffer:e=3,radius:n=8,cutoff:r=.25,fontFamily:o="sans-serif",fontWeight:i="normal",fontStyle:a="normal"}={}){this.buffer=e,this.cutoff=r,this.radius=n;const u=this.size=t+4*e,s=this._createCanvas(u),c=this.ctx=s.getContext("2d",{willReadFrequently:!0});c.font=`${a} ${i} ${t}px ${o}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(u*u),this.gridInner=new Float64Array(u*u),this.f=new Float64Array(u),this.z=new Float64Array(u+1),this.v=new Uint16Array(u)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:o,actualBoundingBoxLeft:a,actualBoundingBoxRight:u}=this.ctx.measureText(t),s=Math.ceil(n),c=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(u-a))),l=Math.min(this.size-this.buffer,s+Math.ceil(o)),f=c+2*this.buffer,h=l+2*this.buffer,p=Math.max(f*h,0),d=new Uint8ClampedArray(p),y={data:d,width:f,height:h,glyphWidth:c,glyphHeight:l,glyphTop:s,glyphLeft:0,glyphAdvance:e};if(0===c||0===l)return y;const{ctx:g,buffer:b,gridInner:m,gridOuter:v}=this;g.clearRect(b,b,c,l),g.fillText(t,b,b+s);const O=g.getImageData(b,b,c,l);v.fill(r,0,p),m.fill(0,0,p);for(let t=0;t<l;t++)for(let e=0;e<c;e++){const n=O.data[4*(t*c+e)+3]/255;if(0===n)continue;const o=(t+b)*f+e+b;if(1===n)v[o]=0,m[o]=r;else{const t=.5-n;v[o]=t>0?t*t:0,m[o]=t<0?t*t:0}}i(v,0,0,f,h,f,this.f,this.v,this.z),i(m,b,b,c,l,f,this.f,this.v,this.z);for(let t=0;t<p;t++){const e=Math.sqrt(v[t])-Math.sqrt(m[t]);d[t]=Math.round(255-255*(e/this.radius+this.cutoff))}return y}}function i(t,e,n,r,o,i,u,s,c){for(let l=e;l<e+r;l++)a(t,n*i+l,i,o,u,s,c);for(let l=n;l<n+o;l++)a(t,l*i+e,1,r,u,s,c)}function a(t,e,n,o,i,a,u){a[0]=0,u[0]=-r,u[1]=r,i[0]=t[e];for(let s=1,c=0,l=0;s<o;s++){i[s]=t[e+s*n];const o=s*s;do{const t=a[c];l=(i[s]-i[t]+o-t*t)/(s-t)/2}while(l<=u[c]&&--c>-1);c++,a[c]=s,u[c]=l,u[c+1]=r}for(let r=0,s=0;r<o;r++){for(;u[s+1]<r;)s++;const o=a[s],c=r-o;t[e+r*n]=i[o]+c*c}}},1410:function(t,e,n){t.exports.VectorTile=n(1604),t.exports.VectorTileFeature=n(1160),t.exports.VectorTileLayer=n(1159)},1420:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"ArrowStyles",{enumerable:!0,get:function(){return r.ArrowStyles}}),Object.defineProperty(e,"DEFAULT_ARROWS",{enumerable:!0,get:function(){return r.DEFAULT_ARROWS}}),Object.defineProperty(e,"MAX_ARROWS",{enumerable:!0,get:function(){return r.MAX_ARROWS}}),Object.defineProperty(e,"EditableGeoJsonLayer",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"EditableH3ClusterLayer",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"SelectionLayer",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"ElevatedEditHandleLayer",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"PathOutlineLayer",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"PathMarkerLayer",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"JunctionScatterplotLayer",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"toDeckColor",{enumerable:!0,get:function(){return f.toDeckColor}});var r=n(1609),o=h(n(840)),i=h(n(1643)),a=h(n(1653)),u=h(n(1654)),s=h(n(1179)),c=h(n(1656)),l=h(n(1660)),f=n(1177);function h(t){return t&&t.__esModule?t:{default:t}}},1461:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n(83),o=n(783),i=n(283),a=n(46),u=n(58),s=n(64),c=n(93);const l=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),f=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),h=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),p={};class d extends o.a{static get IDENTITY(){return p.IDENTITY=p.IDENTITY||Object.freeze(new d(l)),p.IDENTITY}static get ZERO(){return p.ZERO=p.ZERO||Object.freeze(new d(f)),p.ZERO}get INDICES(){return h}get ELEMENTS(){return 16}get RANK(){return 4}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,r,o,i,a,u,s,c,l,f,h,p,d,y){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=o,this[5]=i,this[6]=a,this[7]=u,this[8]=s,this[9]=c,this[10]=l,this[11]=f,this[12]=h,this[13]=p,this[14]=d,this[15]=y,this.check()}setRowMajor(t,e,n,r,o,i,a,u,s,c,l,f,h,p,d,y){return this[0]=t,this[1]=o,this[2]=s,this[3]=h,this[4]=e,this[5]=i,this[6]=c,this[7]=p,this[8]=n,this[9]=a,this[10]=l,this[11]=d,this[12]=r,this[13]=u,this[14]=f,this[15]=y,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(l)}fromQuaternion(t){return a.c(this,t),this.check()}frustum({left:t,right:e,bottom:n,top:r,near:o,far:i}){return i===1/0?d._computeInfinitePerspectiveOffCenter(this,t,e,n,r,o):a.d(this,t,e,n,r,o,i),this.check()}static _computeInfinitePerspectiveOffCenter(t,e,n,r,o,i){const a=2*i/(n-e),u=2*i/(o-r),s=(n+e)/(n-e),c=(o+r)/(o-r),l=-2*i;return t[0]=a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=s,t[9]=c,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0,t}lookAt(t,e,n){return 1===arguments.length&&({eye:t,center:e,up:n}=t),e=e||[0,0,0],n=n||[0,1,0],a.g(this,t,e,n),this.check()}ortho({left:t,right:e,bottom:n,top:r,near:o=.1,far:i=500}){return a.i(this,t,e,n,r,o,i),this.check()}orthographic({fovy:t=45*Math.PI/180,aspect:e=1,focalDistance:n=1,near:r=.1,far:o=500}){if(t>2*Math.PI)throw Error("radians");const i=t/2,a=n*Math.tan(i),u=a*e;return(new d).ortho({left:-u,right:u,bottom:-a,top:a,near:r,far:o})}perspective({fovy:t,fov:e=45*Math.PI/180,aspect:n=1,near:r=.1,far:o=500}={}){if((t=t||e)>2*Math.PI)throw Error("radians");return a.j(this,t,n,r,o),this.check()}determinant(){return a.a(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=null){const n=this.getScale(e||[-0,-0,-0]),r=1/n[0],o=1/n[1],i=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*o,t[2]=this[2]*i,t[3]=0,t[4]=this[4]*r,t[5]=this[5]*o,t[6]=this[6]*i,t[7]=0,t[8]=this[8]*r,t[9]=this[9]*o,t[10]=this[10]*i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t=[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=null){const n=this.getScale(e||[-0,-0,-0]),r=1/n[0],o=1/n[1],i=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*o,t[2]=this[2]*i,t[3]=this[4]*r,t[4]=this[5]*o,t[5]=this[6]*i,t[6]=this[8]*r,t[7]=this[9]*o,t[8]=this[10]*i,t}transpose(){return a.q(this,this),this.check()}invert(){return a.f(this,this),this.check()}multiplyLeft(t){return a.h(this,t,this),this.check()}multiplyRight(t){return a.h(this,this,t),this.check()}rotateX(t){return a.l(this,this,t),this.check()}rotateY(t){return a.m(this,this,t),this.check()}rotateZ(t){return a.n(this,this,t),this.check()}rotateXYZ([t,e,n]){return this.rotateX(t).rotateY(e).rotateZ(n)}rotateAxis(t,e){return a.k(this,this,t,e),this.check()}scale(t){return Array.isArray(t)?a.o(this,this,t):a.o(this,this,[t,t,t]),this.check()}translate(t){return a.p(this,this,t),this.check()}transform(t,e){return 4===t.length?(e=c.n(e||[-0,-0,-0,-0],t,this),Object(r.b)(e,4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;switch(n){case 2:e=u.j(e||[-0,-0],t,this);break;case 3:e=s.t(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(r.b)(e,t.length),e}transformAsVector(t,e){switch(t.length){case 2:e=Object(i.a)(e||[-0,-0],t,this);break;case 3:e=Object(i.c)(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(r.b)(e,t.length),e}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}transformPoint(t,e){return Object(r.c)("Matrix4.transformPoint","3.0"),this.transformAsPoint(t,e)}transformVector(t,e){return Object(r.c)("Matrix4.transformVector","3.0"),this.transformAsPoint(t,e)}transformDirection(t,e){return Object(r.c)("Matrix4.transformDirection","3.0"),this.transformAsVector(t,e)}}},1596:function(t,e,n){var r=function(){var t={},e=Math.PI/180,n=180/Math.PI,r=6378137,o=20037508.342789244;function i(t){return Number(t)===t&&t%1!=0}function a(e){if(e=e||{},this.size=e.size||256,!t[this.size]){var n=this.size,r=t[this.size]={};r.Bc=[],r.Cc=[],r.zc=[],r.Ac=[];for(var o=0;o<30;o++)r.Bc.push(n/360),r.Cc.push(n/(2*Math.PI)),r.zc.push(n/2),r.Ac.push(n),n*=2}this.Bc=t[this.size].Bc,this.Cc=t[this.size].Cc,this.zc=t[this.size].zc,this.Ac=t[this.size].Ac}return a.prototype.px=function(t,n){if(i(n)){var r=this.size*Math.pow(2,n),o=r/2,a=r/360,u=r/(2*Math.PI),s=r,c=Math.min(Math.max(Math.sin(e*t[1]),-.9999),.9999);return(l=o+t[0]*a)>s&&(l=s),(f=o+.5*Math.log((1+c)/(1-c))*-u)>s&&(f=s),[l,f]}o=this.zc[n],c=Math.min(Math.max(Math.sin(e*t[1]),-.9999),.9999);var l=Math.round(o+t[0]*this.Bc[n]),f=Math.round(o+.5*Math.log((1+c)/(1-c))*-this.Cc[n]);return l>this.Ac[n]&&(l=this.Ac[n]),f>this.Ac[n]&&(f=this.Ac[n]),[l,f]},a.prototype.ll=function(t,e){if(i(e)){var r=this.size*Math.pow(2,e),o=r/360,a=r/(2*Math.PI),u=r/2,s=(t[1]-u)/-a;return[(t[0]-u)/o,n*(2*Math.atan(Math.exp(s))-.5*Math.PI)]}s=(t[1]-this.zc[e])/-this.Cc[e];return[(t[0]-this.zc[e])/this.Bc[e],n*(2*Math.atan(Math.exp(s))-.5*Math.PI)]},a.prototype.bbox=function(t,e,n,r,o){r&&(e=Math.pow(2,n)-1-e);var i=[t*this.size,(+e+1)*this.size],a=[(+t+1)*this.size,e*this.size],u=this.ll(i,n).concat(this.ll(a,n));return"900913"===o?this.convert(u,"900913"):u},a.prototype.xyz=function(t,e,n,r){"900913"===r&&(t=this.convert(t,"WGS84"));var o=[t[0],t[1]],i=[t[2],t[3]],a=this.px(o,e),u=this.px(i,e),s=[Math.floor(a[0]/this.size),Math.floor((u[0]-1)/this.size)],c=[Math.floor(u[1]/this.size),Math.floor((a[1]-1)/this.size)],l={minX:Math.min.apply(Math,s)<0?0:Math.min.apply(Math,s),minY:Math.min.apply(Math,c)<0?0:Math.min.apply(Math,c),maxX:Math.max.apply(Math,s),maxY:Math.max.apply(Math,c)};if(n){var f={minY:Math.pow(2,e)-1-l.maxY,maxY:Math.pow(2,e)-1-l.minY};l.minY=f.minY,l.maxY=f.maxY}return l},a.prototype.convert=function(t,e){return"900913"===e?this.forward(t.slice(0,2)).concat(this.forward(t.slice(2,4))):this.inverse(t.slice(0,2)).concat(this.inverse(t.slice(2,4)))},a.prototype.forward=function(t){var n=[r*t[0]*e,r*Math.log(Math.tan(.25*Math.PI+.5*t[1]*e))];return n[0]>o&&(n[0]=o),n[0]<-o&&(n[0]=-o),n[1]>o&&(n[1]=o),n[1]<-o&&(n[1]=-o),n},a.prototype.inverse=function(t){return[t[0]*n/r,(.5*Math.PI-2*Math.atan(Math.exp(-t[1]/r)))*n]},a}();t.exports=r},1604:function(t,e,n){"use strict";var r=n(1159);function o(t,e,n){if(3===t){var o=new r(n,n.readVarint()+n.pos);o.length&&(e[o.name]=o)}}t.exports=function(t,e){this.layers=t.readFields(o,{},e)}},1605:function(t,e,n){"use strict";function r(t,e){this.x=t,this.y=e}t.exports=r,r.prototype={clone:function(){return new r(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=e*this.x-n*this.y,o=n*this.x+e*this.y;return this.x=r,this.y=o,this},_rotateAround:function(t,e){var n=Math.cos(t),r=Math.sin(t),o=e.x+n*(this.x-e.x)-r*(this.y-e.y),i=e.y+r*(this.x-e.x)+n*(this.y-e.y);return this.x=o,this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},r.convert=function(t){return t instanceof r?t:Array.isArray(t)?new r(t[0],t[1]):t}},1609:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MAX_ARROWS=e.DEFAULT_ARROWS=e.ArrowStyles=void 0;e.ArrowStyles={NONE:0,FORWARD:1,BACKWARD:2,BOTH:3};e.DEFAULT_ARROWS=1;e.MAX_ARROWS=3},1612:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ResizeCircleMode=void 0;var r=f(n(1167)),o=n(30),i=f(n(843)),a=f(n(132)),u=f(n(341)),s=n(172),c=n(131),l=n(264);function f(t){return t&&t.__esModule?t:{default:t}}function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function b(t,e){return!e||"object"!==h(e)&&"function"!=typeof e?m(t):e}function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function O(t){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function w(t,e){return(w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function P(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var M=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(d,t);var e,n,c,f,h=(e=d,function(){var t,n=O(e);if(v()){var r=O(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return b(this,t)});function d(){var t;y(this,d);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return P(m(t=h.call.apply(h,[this].concat(n))),"_selectedEditHandle",void 0),P(m(t),"_isResizing",!1),t}return n=d,(c=[{key:"getGuides",value:function(t){var e=this,n=[],r=t.selectedIndexes,i=t.lastPointerMoveEvent,a=i&&i.picks,u=i&&i.mapCoords;if(a&&a.length&&u&&1===r.length&&!this._isResizing){var c=a.find((function(t){return!t.isGuide}));if(c&&c.object.properties.shape&&c.object.properties.shape.includes("Circle")&&t.selectedIndexes.includes(c.index)){var l=null,f=[],h=(0,o.point)(u);if((0,s.recursivelyTraverseNestedArrays)(c.object.geometry.coordinates,[],(function(n,r){var i=(0,o.lineString)(n),a=e.getNearestPoint(i,h,t.modeConfig&&t.modeConfig.viewport);(!l||a.properties.dist<l.properties.dist)&&(l=a,f=r)})),l){var d=l,y=d.geometry.coordinates,g=d.properties.index;n.push({type:"Feature",properties:{guideType:"editHandle",editHandleType:"intermediate",featureIndex:c.index,positionIndexes:[].concat(p(f),[g+1])},geometry:{type:"Point",coordinates:y}})}}}return{type:"FeatureCollection",features:n}}},{key:"getNearestPoint",value:function(t,e,n){if(t.geometry.coordinates.some((function(t){return t.length>2}))){if(n)return(0,s.nearestPointOnProjectedLine)(t,e,n);console.log("Editing 3D point but modeConfig.viewport not provided. Falling back to 2D logic.")}return(0,r.default)(t,e)}},{key:"handleDragging",value:function(t,e){var n=(0,s.getPickedEditHandle)(t.pointerDownPicks);if(n){t.cancelPan();var r=n.properties,o=this.getSelectedFeature(e),c=(0,u.default)(o).geometry.coordinates,f=Object.entries(o.geometry.coordinates[0]).length-1,h=Math.max((0,a.default)(c,t.mapCoords),.001),p={}.steps,d={steps:void 0===p?f:p},y=(0,i.default)(c,h,d).geometry,g=new l.ImmutableFeatureCollection(e.data).replaceGeometry(r.featureIndex,y).getObject();e.onEdit({updatedData:g,editType:"unionGeometry",editContext:{featureIndexes:[r.featureIndex]}})}}},{key:"handlePointerMove",value:function(t,e){if(!this._isResizing){var n=(0,s.getPickedEditHandle)(t.picks);this._selectedEditHandle=n&&"intermediate"===n.properties.editHandleType?n:null}var r=this.getCursor(t);e.onUpdateCursor(r)}},{key:"handleStartDragging",value:function(t,e){this._selectedEditHandle&&(this._isResizing=!0)}},{key:"handleStopDragging",value:function(t,e){this._isResizing&&(this._selectedEditHandle=null,this._isResizing=!1)}},{key:"getCursor",value:function(t){var e=t&&t.picks||[];return(0,s.getPickedEditHandles)(e).length?"cell":null}}])&&g(n.prototype,c),f&&g(n,f),d}(c.GeoJsonEditMode);e.ResizeCircleMode=M},1616:function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function u(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.DuplicateMode=void 0;var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(p,t);var e,n,r,f,h=(e=p,function(){var t,n=c(e);if(s()){var r=c(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return u(this,t)});function p(){return o(this,p),h.apply(this,arguments)}return n=p,(r=[{key:"handleStartDragging",value:function(t,e){a(c(p.prototype),"handleStartDragging",this).call(this,t,e),this._geometryBeforeTranslate&&e.onEdit(this.getAddManyFeaturesAction(this._geometryBeforeTranslate,e.data))}},{key:"updateCursor",value:function(t){this._isTranslatable?t.onUpdateCursor("copy"):t.onUpdateCursor(null)}}])&&i(n.prototype,r),f&&i(n,f),p}(n(844).TranslateMode);e.DuplicateMode=f},1617:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ExtendLineStringMode=void 0;var r=n(131),o=n(264);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(p,t);var e,n,r,i,h=(e=p,function(){var t,n=l(e);if(c()){var r=l(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return s(this,t)});function p(){return a(this,p),h.apply(this,arguments)}return n=p,(r=[{key:"getSingleSelectedLineString",value:function(t){var e=this.getSelectedGeometry(t);return e&&"LineString"===e.type?e:null}},{key:"handleClick",value:function(t,e){var n=e.selectedIndexes,r=this.getSingleSelectedLineString(e);if(r){var i=[r.coordinates.length],a=e.modeConfig;a&&a.drawAtFront&&(i=[0]);var u=n[0],s=new o.ImmutableFeatureCollection(e.data).addPosition(u,i,t.mapCoords).getObject();e.onEdit({updatedData:s,editType:"addPosition",editContext:{featureIndexes:[u],positionIndexes:i,position:t.mapCoords}})}else console.warn("ExtendLineStringMode only supported for single LineString selection")}},{key:"getGuides",value:function(t){var e={type:"FeatureCollection",features:[]},n=this.getSingleSelectedLineString(t);if(!n)return e;var r=t.lastPointerMoveEvent&&t.lastPointerMoveEvent.mapCoords,o=null,i=t.modeConfig;return o=i&&i.drawAtFront?n.coordinates[0]:n.coordinates[n.coordinates.length-1],e.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[o,r]}}),e}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}}])&&u(n.prototype,r),i&&u(n,i),p}(r.GeoJsonEditMode);e.ExtendLineStringMode=h},1618:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SplitPolygonMode=void 0;var r=g(n(1619)),o=g(n(841)),i=g(n(1170)),a=g(n(764)),u=n(30),s=g(n(205)),c=g(n(132)),l=g(n(252)),f=g(n(845)),h=g(n(1167)),p=n(172),d=n(131),y=n(264);function g(t){return t&&t.__esModule?t:{default:t}}function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t){return function(t){if(Array.isArray(t))return w(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||O(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||O(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(t,e){if(t){if("string"==typeof t)return w(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(t,e):void 0}}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function M(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function S(t,e){return!e||"object"!==b(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function x(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function E(t,e){return(E=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&E(t,e)}(O,t);var e,n,d,g,b=(e=O,function(){var t,n=j(e);if(x()){var r=j(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return S(this,t)});function O(){return P(this,O),b.apply(this,arguments)}return n=O,(d=[{key:"calculateMapCoords",value:function(t,e,n){var r=n.modeConfig;if(!r||!r.lock90Degree||!t.length)return e;if(1===t.length){var o=t[0],i=this.getSelectedGeometry(n),a=(0,f.default)(i),d="FeatureCollection"===a.type?a.features:[a],y=Number.MAX_SAFE_INTEGER,g=null;if(d.forEach((function(t){var e=(0,h.default)(t,o),n=(0,c.default)(e,o);y>n&&(y=n,g=e)})),g){var b=(0,s.default)(o,g),m=(0,c.default)(o,e,{units:"meters"});return(0,l.default)(o,m,b,{units:"meters"}).geometry.coordinates}return e}var O=t[t.length-1],w=v((0,p.generatePointsParallelToLinePoints)(t[t.length-2],O,e),1)[0];return(0,h.default)((0,u.lineString)([O,w]),e).geometry.coordinates}},{key:"getGuides",value:function(t){var e=this.getClickSequence(),n={type:"FeatureCollection",features:[]};if(0===e.length||!t.lastPointerMoveEvent)return n;var r=t.lastPointerMoveEvent.mapCoords;return n.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(m(e),[this.calculateMapCoords(e,r,t)])}}),n}},{key:"handleClick",value:function(t,e){var n=this.getTentativeGuide(e),o=this.getSelectedGeometry(e);if(o){var i=this.getClickSequence();n&&"LineString"===n.geometry.type?i.push(n.geometry.coordinates[n.geometry.coordinates.length-1]):this.addClickSequence(t);var u={type:"Point",coordinates:i[i.length-1]},s=(0,r.default)(u,o);if(i.length>1&&n&&!s){if(this.resetClickSequence(),0===(0,a.default)(n,o).features.length)return;var c=this.splitPolygon(n,e);c&&e.onEdit(c)}}else console.warn("A polygon must be selected for splitting")}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}},{key:"splitPolygon",value:function(t,e){var n=this.getSelectedGeometry(e),r=e.selectedIndexes[0],a=e.modeConfig||{},u=a.gap,s=void 0===u?.1:u,c=a.units,l=void 0===c?"centimeters":c;0===s&&(s=.1,l="centimeters");var f=(0,i.default)(t,s,{units:l}),h=(0,o.default)(n,f);if(!h)return console.warn("Canceling edit. Split Polygon erased"),null;var p=h.geometry,d=p.type,g=p.coordinates,b=[];return b="Polygon"===d?g.map((function(t){return[t]})):g.reduce((function(t,e){return e.forEach((function(e){t.push([e])})),t}),[]),{updatedData:new y.ImmutableFeatureCollection(e.data).replaceGeometry(r,{type:"MultiPolygon",coordinates:b}).getObject(),editType:"split",editContext:{featureIndexes:[r]}}}}])&&M(n.prototype,d),g&&M(n,g),O}(d.GeoJsonEditMode);e.SplitPolygonMode=_},1620:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ExtrudeMode=void 0;var r,o=(r=n(205))&&r.__esModule?r:{default:r},i=n(172),a=n(842),u=n(264);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||f(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||f(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){if(t){if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function y(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?g(t):e}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function O(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(f,t);var e,n,r,a,s=(e=f,function(){var t,n=m(e);if(b()){var r=m(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return y(this,t)});function f(){var t;p(this,f);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return O(g(t=s.call.apply(s,[this].concat(n))),"isPointAdded",!1),t}return n=f,(r=[{key:"handleDragging",value:function(t,e){var n=(0,i.getPickedEditHandle)(t.pointerDownPicks);if(n){var r=n.properties.featureIndex,o=n.properties.positionIndexes,a=this.coordinatesSize(o,r,e.data);o=this.isPointAdded?this.nextPositionIndexes(o,a):o;var s=this.getPointForPositionIndexes(this.prevPositionIndexes(o,a),r,e.data),c=this.getPointForPositionIndexes(o,r,e.data);if(s&&c){var f=l((0,i.generatePointsParallelToLinePoints)(s,c,t.mapCoords),2),h=f[0],p=f[1],d=new u.ImmutableFeatureCollection(e.data).replacePosition(r,this.prevPositionIndexes(o,a),p).replacePosition(r,o,h).getObject();e.onEdit({updatedData:d,editType:"extruding",editContext:{featureIndexes:[r],positionIndexes:this.nextPositionIndexes(o,a),position:h}}),t.cancelPan()}}}},{key:"handleStartDragging",value:function(t,e){var n=e.selectedIndexes,r=(0,i.getPickedIntermediateEditHandle)(t.picks);if(n.length&&r){var o=r.properties,a=o.positionIndexes,s=o.featureIndex,c=this.coordinatesSize(a,s,e.data),l=this.getPointForPositionIndexes(this.prevPositionIndexes(a,c),s,e.data),f=this.getPointForPositionIndexes(a,s,e.data);if(l&&f){var h=new u.ImmutableFeatureCollection(e.data);this.isOrthogonal(a,s,c,e.data)||(h=h.addPosition(s,a,f)),this.isOrthogonal(this.prevPositionIndexes(a,c),s,c,e.data)||(h=h.addPosition(s,a,l),this.isPointAdded=!0),e.onEdit({updatedData:h.getObject(),editType:"startExtruding",editContext:{featureIndexes:[s],positionIndexes:a,position:l}})}}}},{key:"handleStopDragging",value:function(t,e){var n=e.selectedIndexes,r=(0,i.getPickedEditHandle)(t.pointerDownPicks);if(n.length&&r){var o=r.properties.featureIndex,a=r.properties.positionIndexes,s=this.coordinatesSize(a,o,e.data);a=this.isPointAdded?this.nextPositionIndexes(a,s):a;var c=this.getPointForPositionIndexes(this.prevPositionIndexes(a,s),o,e.data),f=this.getPointForPositionIndexes(a,o,e.data);if(c&&f){var h=l((0,i.generatePointsParallelToLinePoints)(c,f,t.mapCoords),2),p=h[0],d=h[1],y=new u.ImmutableFeatureCollection(e.data).replacePosition(o,this.prevPositionIndexes(a,s),d).replacePosition(o,a,p).getObject();e.onEdit({updatedData:y,editType:"extruded",editContext:{featureIndexes:[o],positionIndexes:a,position:p}})}}this.isPointAdded=!1}},{key:"coordinatesSize",value:function(t,e,n){var r=n.features,o=0;if(Array.isArray(t)){var i=r[e].geometry.coordinates;if(3===t.length){var a=l(t,2),u=a[0],s=a[1];i.length&&i[u].length&&(o=i[u][s].length)}else{var c=l(t,1)[0];i.length&&i[c].length&&(o=i[c].length)}}return o}},{key:"getBearing",value:function(t,e){var n=(0,o.default)(t,e);return n<0?Math.floor(360+n):Math.floor(n)}},{key:"isOrthogonal",value:function(t,e,n,r){if(!Array.isArray(t))return!1;t[t.length-1]===n-1&&(t[t.length-1]=0);var o=this.getPointForPositionIndexes(this.prevPositionIndexes(t,n),e,r),i=this.getPointForPositionIndexes(this.nextPositionIndexes(t,n),e,r),a=this.getPointForPositionIndexes(t,e,r),u=this.getBearing(a,o),s=this.getBearing(a,i);return[89,90,91,269,270,271].includes(Math.abs(u-s))}},{key:"nextPositionIndexes",value:function(t,e){if(!Array.isArray(t))return[];var n=c(t);return n.length&&(n[n.length-1]=n[n.length-1]===e-1?0:n[n.length-1]+1),n}},{key:"prevPositionIndexes",value:function(t,e){if(!Array.isArray(t))return[];var n=c(t);return n.length&&(n[n.length-1]=0===n[n.length-1]?e-2:n[n.length-1]-1),n}},{key:"getPointForPositionIndexes",value:function(t,e,n){var r,o=n.features;if(Array.isArray(t)){var i=o[e].geometry.coordinates;if(3===t.length){var a=l(t,3),u=a[0],s=a[1],c=a[2];i.length&&i[u].length&&(r=i[u][s][c])}else{var f=l(t,2),h=f[0],p=f[1];i.length&&i[h].length&&(r=i[h][p])}}return r}}])&&d(n.prototype,r),a&&d(n,a),f}(a.ModifyMode);e.ExtrudeMode=w},1621:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ElevationMode=void 0;var r=n(172);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function s(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=t.pointerDownScreenCoords,n=t.screenCoords;return 10*(e[1]-n[1])}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(y,t);var e,n,o,p,d=(e=y,function(){var t,n=l(e);if(c()){var r=l(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return s(this,t)});function y(){return i(this,y),d.apply(this,arguments)}return n=y,p=[{key:"calculateElevationChangeWithViewport",value:function(t,e){var n=e.pointerDownScreenCoords,r=e.screenCoords;return 156543.03392*Math.cos(t.latitude*Math.PI/180)/Math.pow(2,t.zoom)*(n[1]-r[1])/2}}],(o=[{key:"makeElevatedEvent",value:function(t,e,n){var r=n.modeConfig||{},o=r.minElevation,i=void 0===o?0:o,a=r.maxElevation,u=void 0===a?2e4:a,s=r.calculateElevationChange,c=void 0===s?h:s;if(!t.pointerDownScreenCoords)return t;var l=3===e.length?e[2]:0;return l+=c({pointerDownScreenCoords:t.pointerDownScreenCoords,screenCoords:t.screenCoords}),l=Math.min(l,u),l=Math.max(l,i),Object.assign({},t,{mapCoords:[e[0],e[1],l]})}},{key:"handlePointerMove",value:function(t,e){var n=(0,r.getPickedEditHandle)(t.pointerDownPicks),o=n?n.geometry.coordinates:t.mapCoords;u(l(y.prototype),"handlePointerMove",this).call(this,this.makeElevatedEvent(t,o,e),e)}},{key:"handleStopDragging",value:function(t,e){var n=(0,r.getPickedEditHandle)(t.picks),o=n?n.geometry.coordinates:t.mapCoords;u(l(y.prototype),"handleStopDragging",this).call(this,this.makeElevatedEvent(t,o,e),e)}},{key:"getCursor",value:function(t){var e=u(l(y.prototype),"getCursor",this).call(this,t);return"cell"===e&&(e="ns-resize"),e}}])&&a(n.prototype,o),p&&a(n,p),y}(n(842).ModifyMode);e.ElevationMode=p},1622:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TransformMode=void 0;var r=n(30),o=n(844),i=n(1168),a=n(1169);function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function h(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(m,t);var e,n,u,g,b=(e=m,function(){var t,n=d(e);if(p()){var r=d(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return h(this,t)});function m(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,m),b.call(this,[new o.TranslateMode,new i.ScaleMode,new a.RotateMode])}return n=m,(u=[{key:"handlePointerMove",value:function(t,e){var n=null;f(d(m.prototype),"handlePointerMove",this).call(this,t,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},e,{onUpdateCursor:function(t){n=t||n}})),e.onUpdateCursor(n)}},{key:"handleStartDragging",value:function(t,e){var n=null,r=null,a=[];this._modes.forEach((function(t){t instanceof o.TranslateMode?r=t:(t instanceof i.ScaleMode&&(n=t),a.push(t))})),n instanceof i.ScaleMode&&!n.isEditHandleSelected()&&a.push(r),a.filter(Boolean).forEach((function(n){return n.handleStartDragging(t,e)}))}},{key:"getGuides",value:function(t){var e=f(d(m.prototype),"getGuides",this).call(this,t),n=(this._modes||[]).find((function(t){return t instanceof a.RotateMode}));if(n instanceof a.RotateMode){var o=e.features.filter((function(t){var e=t.properties||{},r=e.editHandleType,o=[e.mode];return n.getIsRotating()&&o.push(r),!o.includes("scale")}));e=(0,r.featureCollection)(o)}return e}}])&&l(n.prototype,u),g&&l(n,g),m}(n(1171).CompositeMode);e.TransformMode=g},1623:function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function u(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPointMode=void 0;var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(p,t);var e,n,r,f,h=(e=p,function(){var t,n=c(e);if(s()){var r=c(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return u(this,t)});function p(){return o(this,p),h.apply(this,arguments)}return n=p,(r=[{key:"createTentativeFeature",value:function(t){var e=t.lastPointerMoveEvent;return{type:"Feature",properties:{guideType:"tentative"},geometry:{type:"Point",coordinates:(e?[e.mapCoords]:[])[0]}}}},{key:"handleClick",value:function(t,e){var n={type:"Point",coordinates:t.mapCoords};e.onEdit(this.getAddFeatureAction(n,e.data))}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),a(c(p.prototype),"handlePointerMove",this).call(this,t,e)}}])&&i(n.prototype,r),f&&i(n,f),p}(n(131).GeoJsonEditMode);e.DrawPointMode=f},1624:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawLineStringMode=void 0;var r=n(172);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(d,t);var e,n,o,a,p=(e=d,function(){var t,n=f(e);if(l()){var r=f(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return c(this,t)});function d(){return u(this,d),p.apply(this,arguments)}return n=d,(o=[{key:"handleClick",value:function(t,e){var n=t.picks,o=(0,r.getPickedEditHandle)(n),a=!1;o||(this.addClickSequence(t),a=!0);var u=this.getClickSequence();if(u.length>1&&o&&Array.isArray(o.properties.positionIndexes)&&o.properties.positionIndexes[0]===u.length-1){var s={type:"LineString",coordinates:i(u)};this.resetClickSequence();var c=this.getAddFeatureAction(s,e.data);c&&e.onEdit(c)}else a&&e.onEdit({updatedData:e.data,editType:"addTentativePosition",editContext:{position:t.mapCoords}})}},{key:"handleKeyUp",value:function(t,e){if("Enter"===t.key){var n=this.getClickSequence();if(n.length>1){var r={type:"LineString",coordinates:i(n)};this.resetClickSequence();var o=this.getAddFeatureAction(r,e.data);o&&e.onEdit(o)}}}},{key:"getGuides",value:function(t){var e,n,r=t.lastPointerMoveEvent,o=this.getClickSequence(),a=r?[r.mapCoords]:[],u={type:"FeatureCollection",features:[]};o.length>0&&(n={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(i(o),a)}}),n&&u.features.push(n);var s=o.map((function(t,e){return{type:"Feature",properties:{guideType:"editHandle",editHandleType:"existing",featureIndex:-1,positionIndexes:[e]},geometry:{type:"Point",coordinates:t}}}));return(e=u.features).push.apply(e,i(s)),u}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}}])&&s(n.prototype,o),a&&s(n,a),d}(n(131).GeoJsonEditMode);e.DrawLineStringMode=p},1625:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawRectangleMode=void 0;var r,o=(r=n(304))&&r.__esModule?r:{default:r};function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(p,t);var e,n,r,i,h=(e=p,function(){var t,n=l(e);if(c()){var r=l(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return s(this,t)});function p(){return a(this,p),h.apply(this,arguments)}return n=p,(r=[{key:"getTwoClickPolygon",value:function(t,e,n){var r=(0,o.default)([t[0],t[1],e[0],e[1]]);return r.properties=r.properties||{},r.properties.shape="Rectangle",r}}])&&u(n.prototype,r),i&&u(n,i),p}(n(443).TwoClickPolygonMode);e.DrawRectangleMode=h},1626:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawRectangleFromCenterMode=void 0;var r,o=(r=n(304))&&r.__esModule?r:{default:r};function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(p,t);var e,n,r,i,h=(e=p,function(){var t,n=l(e);if(c()){var r=l(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return s(this,t)});function p(){return a(this,p),h.apply(this,arguments)}return n=p,(r=[{key:"getTwoClickPolygon",value:function(t,e,n){var r=t[0]>e[0]?t[0]+Math.abs(t[0]-e[0]):t[0]-Math.abs(t[0]-e[0]),i=t[1]>e[1]?t[1]+Math.abs(t[1]-e[1]):t[1]-Math.abs(t[1]-e[1]),a=(0,o.default)([r,i,e[0],e[1]]);return a.properties=a.properties||{},a.properties.shape="Rectangle",a}}])&&u(n.prototype,r),i&&u(n,i),p}(n(443).TwoClickPolygonMode);e.DrawRectangleFromCenterMode=h},1627:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawSquareFromCenterMode=void 0;var r=u(n(304)),o=u(n(132)),i=u(n(1628)),a=n(30);function u(t){return t&&t.__esModule?t:{default:t}}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(g,t);var e,n,u,s,y=(e=g,function(){var t,n=p(e);if(h()){var r=p(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return f(this,t)});function g(){return c(this,g),y.apply(this,arguments)}return n=g,(u=[{key:"getTwoClickPolygon",value:function(t,e,n){var u=[e[0],t[1]],s=[t[0],e[1]],c=(0,o.default)((0,a.point)(u),(0,a.point)(t)),l=(0,o.default)((0,a.point)(s),(0,a.point)(t)),f=c<=l?c:l,h=c<=l?u:s,p=(0,a.lineString)([h,e]),d=(0,i.default)(p,f).geometry.coordinates,y=t[0]>d[0]?t[0]+Math.abs(t[0]-d[0]):t[0]-Math.abs(t[0]-d[0]),g=t[1]>d[1]?t[1]+Math.abs(t[1]-d[1]):t[1]-Math.abs(t[1]-d[1]),b=(0,r.default)([y,g,d[0],d[1]]);return b.properties=b.properties||{},b.properties.shape="Square",b}}])&&l(n.prototype,u),s&&l(n,s),g}(n(443).TwoClickPolygonMode);e.DrawSquareFromCenterMode=y},1629:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawCircleByDiameterMode=void 0;var r=a(n(843)),o=a(n(132)),i=n(131);function a(t){return t&&t.__esModule?t:{default:t}}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(y,t);var e,n,a,u,d=(e=y,function(){var t,n=h(e);if(f()){var r=h(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return l(this,t)});function y(){return s(this,y),d.apply(this,arguments)}return n=y,(a=[{key:"getTwoClickPolygon",value:function(t,e,n){var a=(n||{}).steps,u=void 0===a?64:a,s={steps:u};u<4&&(console.warn("Minimum steps to draw a circle is 4 "),s.steps=4);var c=(0,i.getIntermediatePosition)(t,e),l=Math.max((0,o.default)(t,c),.001),f=(0,r.default)(c,l,s);return f.properties=f.properties||{},f.properties.shape="Circle",f}}])&&c(n.prototype,a),u&&c(n,u),y}(n(443).TwoClickPolygonMode);e.DrawCircleByDiameterMode=d},1630:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawCircleFromCenterMode=void 0;var r=i(n(843)),o=i(n(132));function i(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(d,t);var e,n,i,a,p=(e=d,function(){var t,n=f(e);if(l()){var r=f(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return c(this,t)});function d(){return u(this,d),p.apply(this,arguments)}return n=d,(i=[{key:"getTwoClickPolygon",value:function(t,e,n){var i=(n||{}).steps,a=void 0===i?64:i,u={steps:a};a<4&&(console.warn("Minimum steps to draw a circle is 4 "),u.steps=4);var s=Math.max((0,o.default)(t,e),.001),c=(0,r.default)(t,s,u);return c.properties=c.properties||{},c.properties.shape="Circle",c}}])&&s(n.prototype,i),a&&s(n,a),d}(n(443).TwoClickPolygonMode);e.DrawCircleFromCenterMode=p},1631:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawEllipseByBoundingBoxMode=void 0;var r=s(n(304)),o=s(n(132)),i=s(n(1172)),a=n(30),u=n(131);function s(t){return t&&t.__esModule?t:{default:t}}function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(b,t);var e,n,s,c,g=(e=b,function(){var t,n=d(e);if(p()){var r=d(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return h(this,t)});function b(){return l(this,b),g.apply(this,arguments)}return n=b,(s=[{key:"getTwoClickPolygon",value:function(t,e,n){var s=Math.min(t[0],e[0]),c=Math.min(t[1],e[1]),l=Math.max(t[0],e[0]),f=Math.max(t[1],e[1]),h=(0,r.default)([s,c,l,f]).geometry.coordinates[0],p=(0,u.getIntermediatePosition)(t,e),d=Math.max((0,o.default)((0,a.point)(h[0]),(0,a.point)(h[1])),.001),y=Math.max((0,o.default)((0,a.point)(h[0]),(0,a.point)(h[3])),.001);return(0,i.default)(p,d,y)}}])&&f(n.prototype,s),c&&f(n,c),b}(n(443).TwoClickPolygonMode);e.DrawEllipseByBoundingBoxMode=g},1632:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawEllipseUsingThreePointsMode=void 0;var r=s(n(132)),o=s(n(1172)),i=s(n(205)),a=n(30),u=n(131);function s(t){return t&&t.__esModule?t:{default:t}}function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(b,t);var e,n,s,c,g=(e=b,function(){var t,n=d(e);if(p()){var r=d(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return h(this,t)});function b(){return l(this,b),g.apply(this,arguments)}return n=b,(s=[{key:"getThreeClickPolygon",value:function(t,e,n,s){var c=(0,u.getIntermediatePosition)(t,e),l=Math.max((0,r.default)(c,(0,a.point)(n)),.001),f=Math.max((0,r.default)(t,e),.001)/2,h={angle:(0,i.default)(t,e)};return(0,o.default)(c,l,f,h)}}])&&f(n.prototype,s),c&&f(n,c),b}(n(1173).ThreeClickPolygonMode);e.DrawEllipseUsingThreePointsMode=g},1633:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawRectangleUsingThreePointsMode=void 0;var r=n(172);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(d,t);var e,n,o,a,p=(e=d,function(){var t,n=f(e);if(l()){var r=f(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return c(this,t)});function d(){return u(this,d),p.apply(this,arguments)}return n=d,(o=[{key:"getThreeClickPolygon",value:function(t,e,n,o){var a=i((0,r.generatePointsParallelToLinePoints)(t,e,n),2);return{type:"Feature",properties:{shape:"Rectangle"},geometry:{type:"Polygon",coordinates:[[t,e,a[0],a[1],t]]}}}}])&&s(n.prototype,o),a&&s(n,a),d}(n(1173).ThreeClickPolygonMode);e.DrawRectangleUsingThreePointsMode=p},1634:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Draw90DegreePolygonMode=void 0;var r=c(n(252)),o=c(n(205)),i=c(n(764)),a=c(n(132)),u=n(30),s=n(172);function c(t){return t&&t.__esModule?t:{default:t}}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||p(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||p(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){if(t){if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function b(t,e,n){return(b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=O(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function m(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function v(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function O(t){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function w(t,e){return(w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var P=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(d,t);var e,n,c,l,p=(e=d,function(){var t,n=O(e);if(v()){var r=O(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return m(this,t)});function d(){return y(this,d),p.apply(this,arguments)}return n=d,(c=[{key:"createTentativeFeature",value:function(t){var e,n=this.getClickSequence(),r=t.lastPointerMoveEvent.mapCoords;if(1===n.length)e=r;else{var o=n[n.length-2],i=n[n.length-1];e=h((0,s.generatePointsParallelToLinePoints)(o,i,r),1)[0]}return n.length<3?{type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(f(n),[e])}}:{type:"Feature",properties:{guideType:"tentative"},geometry:{type:"Polygon",coordinates:[[].concat(f(n),[e,n[0]])]}}}},{key:"getGuides",value:function(t){var e={type:"FeatureCollection",features:[]};if(0===this.getClickSequence().length||!t.lastPointerMoveEvent)return e;var n=this.createTentativeFeature(t);return e.features.push(n),e.features=e.features.concat((0,s.getEditHandlesForGeometry)(n.geometry,-1)),e.features=e.features.slice(0,-1),e}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),b(O(d.prototype),"handlePointerMove",this).call(this,t,e)}},{key:"handleClick",value:function(t,e){var n=t.picks,r=this.getTentativeGuide(e);this.addClickSequence(t);var o=this.getClickSequence();if(r){if(3===o.length&&"LineString"===r.geometry.type){var i=r.geometry;o[o.length-1]=i.coordinates[i.coordinates.length-1]}else if(o.length>3&&"Polygon"===r.geometry.type){var a=r.geometry;o[o.length-1]=a.coordinates[0][a.coordinates[0].length-2];var u=(0,s.getPickedEditHandle)(n);if(u&&Array.isArray(u.properties.positionIndexes)&&(0===u.properties.positionIndexes[1]||u.properties.positionIndexes[1]===a.coordinates[0].length-3)){var c={type:"Polygon",coordinates:this.finalizedCoordinates(f(a.coordinates[0]))};this.resetClickSequence();var l=this.getAddFeatureOrBooleanPolygonAction(c,e);l&&e.onEdit(l)}}var h={screenCoords:[-1,-1],mapCoords:t.mapCoords,picks:[],pointerDownPicks:null,pointerDownScreenCoords:null,pointerDownMapCoords:null,cancelPan:function(){},sourceEvent:null};this.handlePointerMove(h,e)}}},{key:"finalizedCoordinates",value:function(t){var e=[[].concat(f(t.slice(0,-2)),[t[0]])],n=this.getIntermediatePoint(f(t));if(n)e=[[].concat(f(t.slice(0,-2)),[n,t[0]])];else{var r=f(t);r.splice(-3,1),(n=this.getIntermediatePoint(f(r)))&&(e=[[].concat(f(t.slice(0,-3)),[n,t[0]])])}return e}},{key:"getIntermediatePoint",value:function(t){var e;if(t.length>4){var n=f(t),s=n[0],c=n[1],l=(0,o.default)(s,c),h=t[t.length-3],p=t[t.length-4],d=(0,o.default)(h,p),y={first:[],second:[]};[1,2,3].forEach((function(t){var e=l+90*t;y.first.push(e>180?e-360:e);var n=d+90*t;y.second.push(n>180?n-360:n)}));var g=(0,a.default)((0,u.point)(s),(0,u.point)(h));[0,1,2].forEach((function(t){var n=(0,u.lineString)([s,(0,r.default)(s,g,y.first[t]).geometry.coordinates]);[0,1,2].forEach((function(t){var o=(0,u.lineString)([h,(0,r.default)(h,g,y.second[t]).geometry.coordinates]),a=(0,i.default)(n,o);a&&a.features.length&&(e=a.features[0].geometry.coordinates)}))}))}return e}}])&&g(n.prototype,c),l&&g(n,l),d}(n(131).GeoJsonEditMode);e.Draw90DegreePolygonMode=P},1635:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPolygonByDraggingMode=void 0;var r,o=(r=n(306))&&r.__esModule?r:{default:r},i=n(172);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?h(t):e}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(b,t);var e,n,r,a,s=(e=b,function(){var t,n=d(e);if(p()){var r=d(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return f(this,t)});function b(){var t;c(this,b);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return g(h(t=s.call.apply(s,[this].concat(n))),"handleDraggingThrottled",null),t}return n=b,(r=[{key:"handleClick",value:function(t,e){}},{key:"handleStartDragging",value:function(t,e){t.cancelPan(),e.modeConfig&&e.modeConfig.throttleMs?this.handleDraggingThrottled=(0,o.default)(this.handleDraggingAux,e.modeConfig.throttleMs):this.handleDraggingThrottled=this.handleDraggingAux}},{key:"handleStopDragging",value:function(t,e){this.addClickSequence(t);var n=this.getClickSequence();if(this.handleDraggingThrottled&&this.handleDraggingThrottled.cancel&&this.handleDraggingThrottled.cancel(),n.length>2){var r={type:"Polygon",coordinates:[[].concat(u(n),[n[0]])]};this.resetClickSequence();var o=this.getAddFeatureOrBooleanPolygonAction(r,e);o&&e.onEdit(o)}}},{key:"handleDraggingAux",value:function(t,e){var n=t.picks;(0,i.getPickedEditHandle)(n)||this.addClickSequence(t)}},{key:"handleDragging",value:function(t,e){this.handleDraggingThrottled&&this.handleDraggingThrottled(t,e)}}])&&l(n.prototype,r),a&&l(n,a),b}(n(846).DrawPolygonMode);e.DrawPolygonByDraggingMode=b},1636:function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.ViewMode=void 0;var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(r,t);var e,n=(e=r,function(){var t,n=u(e);if(a()){var r=u(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return i(this,t)});function r(){return o(this,r),n.apply(this,arguments)}return r}(n(131).GeoJsonEditMode);e.ViewMode=c},1637:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeasureDistanceMode=void 0;var r,o=(r=n(132))&&r.__esModule?r:{default:r},i=n(172);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?h(t):e}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(b,t);var e,n,r,a,s=(e=b,function(){var t,n=d(e);if(p()){var r=d(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return f(this,t)});function b(){var t;c(this,b);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return g(h(t=s.call.apply(s,[this].concat(n))),"_isMeasuringSessionFinished",!1),g(h(t),"_currentTooltips",[]),g(h(t),"_currentDistance",0),g(h(t),"_calculateDistanceForTooltip",(function(t){var e=t.positionA,n=t.positionB,r=t.modeConfig||{},i=r.turfOptions,a=r.measurementCallback,u=(0,o.default)(e,n,i);return a&&a(u),u})),t}return n=b,(r=[{key:"_formatTooltip",value:function(t,e){var n=e||{},r=n.formatTooltip,o=n.turfOptions,i=o&&o.units||"kilometers";return r?r(t):"".concat(parseFloat(t).toFixed(2)," ").concat(i)}},{key:"handleClick",value:function(t,e){var n=e.modeConfig,r=e.data,o=e.onEdit;this._isMeasuringSessionFinished&&(this._isMeasuringSessionFinished=!1,this.resetClickSequence(),this._currentTooltips=[],this._currentDistance=0);var a=t.picks,u=(0,i.getPickedEditHandle)(a),s=!1;u||(this.addClickSequence(t),s=!0);var c=this.getClickSequence();c.length>1&&u&&Array.isArray(u.properties.positionIndexes)&&u.properties.positionIndexes[0]===c.length-1?this._isMeasuringSessionFinished=!0:s&&(c.length>1&&(this._currentDistance+=this._calculateDistanceForTooltip({positionA:c[c.length-2],positionB:c[c.length-1],modeConfig:n}),this._currentTooltips.push({position:t.mapCoords,text:this._formatTooltip(this._currentDistance,n)})),o({updatedData:r,editType:"addTentativePosition",editContext:{position:t.mapCoords}}))}},{key:"handleKeyUp",value:function(t,e){if(!this._isMeasuringSessionFinished){t.stopPropagation();var n=t.key,r=this.getClickSequence().length;switch(n){case"Escape":this._isMeasuringSessionFinished=!0,1===r&&(this.resetClickSequence(),this._currentTooltips=[]),e.onUpdateCursor("cell");break;case"Enter":this.handleClick(e.lastPointerMoveEvent,e),this._isMeasuringSessionFinished=!0}}}},{key:"getGuides",value:function(t){var e,n=t.lastPointerMoveEvent,r=this.getClickSequence(),o=n&&!this._isMeasuringSessionFinished?[n.mapCoords]:[],i={type:"FeatureCollection",features:[]};r.length>0&&i.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(u(r),o)}});var a=r.map((function(t,e){return{type:"Feature",properties:{guideType:"editHandle",editHandleType:"existing",featureIndex:-1,positionIndexes:[e]},geometry:{type:"Point",coordinates:t}}}));return(e=i.features).push.apply(e,u(a)),i}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}},{key:"getTooltips",value:function(t){var e=t.lastPointerMoveEvent,n=t.modeConfig,r=this.getClickSequence();if(r.length>0&&e&&!this._isMeasuringSessionFinished){var o=this._calculateDistanceForTooltip({positionA:r[r.length-1],positionB:e.mapCoords,modeConfig:t.modeConfig});return[].concat(u(this._currentTooltips),[{position:e.mapCoords,text:this._formatTooltip(this._currentDistance+o,n)}])}return this._currentTooltips}}])&&l(n.prototype,r),a&&l(n,a),b}(n(131).GeoJsonEditMode);e.MeasureDistanceMode=b},1638:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeasureAreaMode=void 0;var r=a(n(1639)),o=a(n(395)),i=n(846);function a(t){return t&&t.__esModule?t:{default:t}}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=y(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function p(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var b=[],m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(m,t);var e,n,i,a,u=(e=m,function(){var t,n=y(e);if(d()){var r=y(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return p(this,t)});function m(){return l(this,m),u.apply(this,arguments)}return n=m,(i=[{key:"handleClick",value:function(t,e){var n=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},e,{onEdit:function(){}});h(y(m.prototype),"handleClick",this).call(this,t,n)}},{key:"getTooltips",value:function(t){var e=this.getTentativeGuide(t);if(e&&"Polygon"===e.geometry.type){var n,i=t.modeConfig||{},a=i.formatTooltip,u=i.measurementCallback,s=(0,o.default)(e),c=(0,r.default)(e);return n=a?a(c):"".concat(parseFloat(c).toFixed(2)," ").concat("sq. m"),u&&u(c),[{position:s.geometry.coordinates,text:n}]}return b}}])&&f(n.prototype,i),a&&f(n,a),m}(i.DrawPolygonMode);e.MeasureAreaMode=m},1640:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeasureAngleMode=void 0;var r=u(n(205)),o=u(n(341)),i=u(n(1174)),a=n(131);function u(t){return t&&t.__esModule?t:{default:t}}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?d(t):e}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function b(t,e){return(b=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var v=[],O=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}(l,t);var e,n,a,u,s=(e=l,function(){var t,n=g(e);if(y()){var r=g(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return p(this,t)});function l(){var t;f(this,l);for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return m(d(t=s.call.apply(s,[this].concat(n))),"_getTooltips",(0,i.default)((function(t){var e=t.modeConfig,n=t.vertex,i=t.point1,a=t.point2,u=v;if(n&&i&&a){var s,c=e||{},l=c.formatTooltip,f=c.measurementCallback,h=(0,r.default)(n,i),p=(0,r.default)(n,a),d=Math.abs(h-p);d>180&&(d=360-d),s=l?l(d):"".concat(parseFloat(d).toFixed(2)," ").concat("deg"),f&&f(d),u=[{position:(0,o.default)({type:"FeatureCollection",features:[i,a].map((function(t){return{type:"Feature",geometry:{type:"Point",coordinates:t}}}))}).geometry.coordinates,text:s}]}return u}))),t}return n=l,(a=[{key:"handleClick",value:function(t,e){this.getClickSequence().length>=3&&this.resetClickSequence(),this.addClickSequence(t)}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}},{key:"getPoints",value:function(t){var e=this.getClickSequence(),n=c(e);return e.length<3&&t.lastPointerMoveEvent&&n.push(t.lastPointerMoveEvent.mapCoords),n}},{key:"getGuides",value:function(t){var e={type:"FeatureCollection",features:[]},n=e.features,r=this.getPoints(t);return r.length>2?n.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[r[1],r[0],r[2]]}}):r.length>1&&n.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[r[1],r[0]]}}),e}},{key:"getTooltips",value:function(t){var e=this.getPoints(t);return this._getTooltips({modeConfig:t.modeConfig,vertex:e[0],point1:e[1],point2:e[2]})}}])&&h(n.prototype,a),u&&h(n,u),l}(a.GeoJsonEditMode);e.MeasureAngleMode=O},1641:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SnappableMode=void 0;var r=n(172);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||a(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?f(t):e}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(b,t);var e,n,o,u,g=(e=b,function(){var t,n=p(e);if(h()){var r=p(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return l(this,t)});function b(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b),y(f(e=g.call(this)),"_handler",void 0),e._handler=t,e}return n=b,(o=[{key:"_getSnappedMouseEvent",value:function(t,e,n){return Object.assign(t,{mapCoords:n.geometry.coordinates,pointerDownMapCoords:e&&e.geometry.coordinates})}},{key:"_getPickedSnapTarget",value:function(t){return(0,r.getPickedEditHandles)(t).find((function(t){return"snap-target"===t.properties.editHandleType}))}},{key:"_getPickedSnapSource",value:function(t){return(0,r.getPickedSnapSourceEditHandle)(t)}},{key:"_getUpdatedSnapSourceHandle",value:function(t,e){var n=t.properties,r=n.featureIndex,o=n.positionIndexes;if(!Array.isArray(o))return t;var i=e.features[r];return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){y(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t,{geometry:{type:"Point",coordinates:o.reduce((function(t,e){return t[e]}),i.geometry.coordinates)}})}},{key:"_getSnapTargets",value:function(t){var e=(t.modeConfig||{}).additionalSnapTargets;return e=e||[],[].concat(i(t.data.features),i(e))}},{key:"_getSnapTargetHandles",value:function(t){for(var e=[],n=this._getSnapTargets(t),o=0;o<n.length;o++)if(!t.selectedIndexes.includes(o)){var a=n[o].geometry;e.push.apply(e,i((0,r.getEditHandlesForGeometry)(a,o,"snap-target")))}return e}},{key:"getGuides",value:function(t){var e=t.modeConfig,n=t.lastPointerMoveEvent,o=(e||{}).enableSnapping,u={type:"FeatureCollection",features:i(this._handler.getGuides(t).features)};if(!o)return u;var s,c=n&&this._getPickedSnapSource(n.pointerDownPicks);if(c)return(s=u.features).push.apply(s,i(this._getSnapTargetHandles(t)).concat([this._getUpdatedSnapSourceHandle(c,t.data)])),u;var l,f=t.data.features,h=function(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=a(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,u=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){u=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw o}}}}(t.selectedIndexes);try{for(h.s();!(l=h.n()).done;){var p=l.value;if(p<f.length){var d,y=f[p].geometry;(d=u.features).push.apply(d,i((0,r.getEditHandlesForGeometry)(y,p,"snap-source")))}}}catch(t){h.e(t)}finally{h.f()}return u}},{key:"_getSnapAwareEvent",value:function(t,e){var n=this._getPickedSnapSource(e.lastPointerMoveEvent.pointerDownPicks),r=this._getPickedSnapTarget(t.picks);return n&&r?this._getSnappedMouseEvent(t,n,r):t}},{key:"handleStartDragging",value:function(t,e){this._handler.handleStartDragging(t,e)}},{key:"handleStopDragging",value:function(t,e){this._handler.handleStopDragging(this._getSnapAwareEvent(t,e),e)}},{key:"handleDragging",value:function(t,e){this._handler.handleDragging(this._getSnapAwareEvent(t,e),e)}},{key:"handlePointerMove",value:function(t,e){this._handler.handlePointerMove(this._getSnapAwareEvent(t,e),e)}}])&&c(n.prototype,o),u&&c(n,u),b}(n(131).GeoJsonEditMode);e.SnappableMode=g},1642:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(99),o=n(1177);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function c(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){y(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g=d({},r.PathLayer.defaultProps,{pickingLineWidthExtraPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER}}),b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(y,t);var e,n,r,i,p=(e=y,function(){var t,n=f(e);if(l()){var r=f(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return c(this,t)});function y(){return a(this,y),p.apply(this,arguments)}return n=y,(r=[{key:"getShaders",value:function(){var t,e=s(f(y.prototype),"getShaders",this).call(this);return e.vs=(0,o.insertBefore)(e.vs,"vec3 width;","\n       if(picking_uActive){\n        widthPixels.xy += pickingLineWidthExtraPixels;\n       }\n      "),d({},e,{inject:d({},e.inject||{},{"vs:#decl":((null===(t=e.inject)||void 0===t?void 0:t["vs:#decl"])||"").concat("uniform float pickingLineWidthExtraPixels;")})})}},{key:"draw",value:function(t){s(f(y.prototype),"draw",this).call(this,d({},t,{uniforms:d({},t.uniforms,{pickingLineWidthExtraPixels:this.props.pickingLineWidthExtraPixels})}))}}])&&u(n.prototype,r),i&&u(n,i),y}(r.PathLayer);e.default=b,b.defaultProps=g,b.layerName="EditablePathLayer"},1643:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(557),o=n(277),i=n(227),a=n(847),u=c(n(840)),s=c(n(1175));function c(t){return t&&t.__esModule?t:{default:t}}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function y(t,e,n){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=m(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function g(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach((function(e){P(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function P(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var M=o.ViewMode,S={type:"FeatureCollection",features:[]},x=w({mode:M},u.default.defaultProps,{data:[],selectedIndexes:[],filled:!1,stroked:!0,lineWidthScale:a.PROJECTED_PIXEL_SIZE_MULTIPLIER,lineWidthMinPixels:1,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineWidthUnits:"pixels",getHexagons:function(t){return t.hexIds},getEditedCluster:function(t,e){return e?w({},e,{hexIds:t}):{hexIds:t}},resolution:9}),j=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(c,t);var e,n,o,a,s=(e=c,function(){var t,n=m(e);if(b()){var r=m(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return g(this,t)});function c(){return p(this,c),s.apply(this,arguments)}return n=c,(o=[{key:"initializeState",value:function(){y(m(c.prototype),"initializeState",this).call(this),this.setState({tentativeHexagonIDs:[]})}},{key:"getDerivedHexagonIDs",value:function(t){return(0,i.polyfill)(t,this.props.resolution,!0)}},{key:"getDerivedHexagonID",value:function(t){return(0,i.geoToH3)(t[1],t[0],this.props.resolution)}},{key:"renderLayers",value:function(){var t=this;return[new u.default(this.getSubLayerProps({id:"editable-geojson",mode:this.props.mode,data:S,selectedFeatureIndexes:[],onEdit:function(e){var n=e.editType,r=e.editContext;switch(n){case"updateTentativeFeature":if("Polygon"===r.feature.geometry.type){var o=r.feature.geometry.coordinates,i=t.getDerivedHexagonIDs(o);t.setState({tentativeHexagonIDs:i})}else if("Point"===r.feature.geometry.type){var a=r.feature.geometry.coordinates,u=t.getDerivedHexagonID(a);t.setState({tentativeHexagonIDs:[u]})}break;case"addFeature":var s=f(t.props.data),c=t.props.modeConfig;if(c&&c.booleanOperation)if(1!==t.props.selectedIndexes.length)console.warn("booleanOperation only supported for single cluster selection");else{var l,h=new Set(t.getSelectedHexIDs()),p=new Set(t.state.tentativeHexagonIDs);switch(c.booleanOperation){case"union":default:l=f(new Set([].concat(f(h),f(p))));break;case"intersection":l=f(h).filter((function(t){return p.has(t)}));break;case"difference":l=f(h).filter((function(t){return!p.has(t)}))}var d=t.props.selectedIndexes[0],y=t.props.data[d];s[d]=t.props.getEditedCluster(l,y)}else s.push(t.props.getEditedCluster(t.state.tentativeHexagonIDs,null));t.setState({tentativeHexagonIDs:[]}),t.props.onEdit({updatedData:s})}}})),new r.H3ClusterLayer(this.getSubLayerProps({id:"hexagons",data:this.props.data,getHexagons:this.props.getHexagons})),new r.H3ClusterLayer(this.getSubLayerProps({id:"tentative-hexagons",data:[{hexIds:this.state.tentativeHexagonIDs}],getHexagons:function(t){return t.hexIds}}))]}},{key:"getSelectedHexIDs",value:function(){var t=this,e=[];return this.props.selectedIndexes.forEach((function(n){var r=t.props.data[n],o=t.props.getHexagons(r);e=e.concat(o)})),e}},{key:"getCursor",value:function(t){var e=t.isDragging,n=(this.state||{}).cursor;return n||(n=e?"grabbing":"grab"),n}}])&&d(n.prototype,o),a&&d(n,a),c}(s.default);e.default=j,P(j,"layerName","EditableH3ClusterLayer"),P(j,"defaultProps",x)},1653:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.SELECTION_TYPE=void 0;var r,o=n(49),i=n(99),a=n(30),u=f(n(1170)),s=f(n(841)),c=n(277),l=f(n(840));function f(t){return t&&t.__esModule?t:{default:t}}function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){x(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function y(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||b(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||b(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(t,e){if(t){if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function w(t,e){return!e||"object"!==h(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function P(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function M(t){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function S(t,e){return(S=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function x(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var j={NONE:null,RECTANGLE:"rectangle",POLYGON:"polygon"};e.SELECTION_TYPE=j;var E=(x(r={},j.RECTANGLE,c.DrawRectangleMode),x(r,j.POLYGON,c.DrawPolygonMode),r),_=x({},j.RECTANGLE,{dragToDraw:!0}),k={selectionType:j.RECTANGLE,layerIds:[],onSelect:function(){}},C={type:"FeatureCollection",features:[]},R=["lineWidthScale","lineWidthMinPixels","lineWidthMaxPixels","lineWidthUnits","lineJointRounded","lineCapRounded","lineMiterLimit","pointRadiusScale","pointRadiusMinPixels","pointRadiusMaxPixels","lineDashJustified","getLineColor","getFillColor","getRadius","getLineWidth","getLineDashArray","getTentativeLineDashArray","getTentativeLineColor","getTentativeFillColor","getTentativeLineWidth"],A=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&S(t,e)}(h,t);var e,n,r,o,f=(e=h,function(){var t,n=M(e);if(P()){var r=M(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return w(this,t)});function h(){return v(this,h),f.apply(this,arguments)}return n=h,(r=[{key:"_selectRectangleObjects",value:function(t){var e=this.props,n=e.layerIds,r=e.onSelect,o=g(this.context.viewport.project(t[0][0]),2),i=o[0],a=o[1],u=g(this.context.viewport.project(t[0][2]),2),s=u[0],c=u[1];r({pickingInfos:this.context.deck.pickObjects({x:Math.min(i,s),y:Math.min(a,c),width:Math.abs(s-i),height:Math.abs(c-a),layerIds:n})})}},{key:"_selectPolygonObjects",value:function(t){var e,n=this,r=this.props,o=r.layerIds,i=r.onSelect,c=t[0].map((function(t){return n.context.viewport.project(t)})),l=c.map((function(t){return t[0]})),f=c.map((function(t){return t[1]})),h=Math.min.apply(Math,y(l)),p=Math.min.apply(Math,y(f)),d=Math.max.apply(Math,y(l)),g=Math.max.apply(Math,y(f)),b=(0,a.polygon)(t),m=(0,u.default)(b,50);try{e=(0,s.default)(m,b)}catch(t){return void console.log("turfDifference() error",t)}this.setState({pendingPolygonSelection:{bigPolygon:e}});var v="".concat(this.props.id,"-").concat("selection-blocker");setTimeout((function(){var t=n.context.deck.pickObjects({x:h,y:p,width:d-h,height:g-p,layerIds:[v].concat(y(o))});i({pickingInfos:t.filter((function(t){return t.layer.id!==n.props.id}))})}),250)}},{key:"renderLayers",value:function(){var t=this,e=this.state.pendingPolygonSelection,n=E[this.props.selectionType]||c.ViewMode,r=_[this.props.selectionType],o={};R.forEach((function(e){void 0!==t.props[e]&&(o[e]=t.props[e])}));var a=[new l.default(this.getSubLayerProps(d({id:"selection-geojson",pickable:!0,mode:n,modeConfig:r,selectedFeatureIndexes:[],data:C,onEdit:function(e){var n=e.updatedData;if("addFeature"===e.editType){var r=n.features[0].geometry.coordinates;t.props.selectionType===j.RECTANGLE?t._selectRectangleObjects(r):t.props.selectionType===j.POLYGON&&t._selectPolygonObjects(r)}}},o)))];if(e){var u=e.bigPolygon;a.push(new i.PolygonLayer(this.getSubLayerProps({id:"selection-blocker",pickable:!0,stroked:!1,opacity:1,data:[u],getLineColor:function(t){return[0,0,0,1]},getFillColor:function(t){return[0,0,0,1]},getPolygon:function(t){return t.geometry.coordinates}})))}return a}},{key:"shouldUpdateState",value:function(t){var e=t.changeFlags,n=e.stateChanged,r=e.propsOrDataChanged;return n||r}}])&&O(n.prototype,r),o&&O(n,o),h}(o.CompositeLayer);e.default=A,x(A,"layerName","SelectionLayer"),x(A,"defaultProps",k)},1654:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(49),o=n(99);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(p,t);var e,n,r,i,h=(e=p,function(){var t,n=l(e);if(c()){var r=l(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return s(this,t)});function p(){return a(this,p),h.apply(this,arguments)}return n=p,(r=[{key:"renderLayers",value:function(){return[new o.ScatterplotLayer(Object.assign({},this.props,{id:"".concat(this.props.id,"-ScatterplotLayer"),data:this.props.data})),new o.LineLayer(Object.assign({},this.props,{id:"".concat(this.props.id,"-LineLayer"),data:this.props.data,pickable:!1,getSourcePosition:function(t){var e=t.position;return[e[0],e[1],0]},getTargetPosition:function(t){var e=t.position;return[e[0],e[1],e[2]||0]},getColor:[150,150,150,200],getStrokeWidth:3}))]}}])&&u(n.prototype,r),i&&u(n,i),p}(r.CompositeLayer);e.default=p,h(p,"layerName","ElevatedEditHandleLayer"),h(p,"defaultProps",{})},1655:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r={outlineEnabled:!1,outlineRenderShadowmap:!1,outlineShadowmap:null};var o={name:"outline",vs:"attribute float instanceZLevel;\nvarying float outline_vzLevel;\nvarying vec4 outline_vPosition;\n\n// Set the z level for the outline shadowmap rendering\nvoid outline_setZLevel(float zLevel) {\n  outline_vzLevel = zLevel;\n}\n\n// Store an adjusted position for texture2DProj\nvoid outline_setUV(vec4 position) {\n  // mat4(\n  //   0.5, 0.0, 0.0, 0.0,\n  //   0.0, 0.5, 0.0, 0.0,\n  //   0.0, 0.0, 0.5, 0.0,\n  //   0.5, 0.5, 0.5, 1.0\n  // ) * position;\n  outline_vPosition = vec4(position.xyz * 0.5 + position.w * 0.5, position.w);\n}\n",fs:"uniform bool outline_uEnabled;\nuniform bool outline_uRenderOutlines;\nuniform sampler2D outline_uShadowmap;\n\nvarying float outline_vzLevel;\n// varying vec2 outline_vUV;\nvarying vec4 outline_vPosition;\n\nconst float OUTLINE_Z_LEVEL_ERROR = 0.01;\n\n// Return a darker color in shadowmap\nvec4 outline_filterShadowColor(vec4 color) {\n  return vec4(outline_vzLevel / 255., outline_vzLevel / 255., outline_vzLevel / 255., 1.);\n}\n\n// Return a darker color if in shadowmap\nvec4 outline_filterDarkenColor(vec4 color) {\n  if (outline_uEnabled) {\n    float maxZLevel;\n    if (outline_vPosition.q > 0.0) {\n      maxZLevel = texture2DProj(outline_uShadowmap, outline_vPosition).r * 255.;\n    } else {\n      discard;\n    }\n    if (maxZLevel < outline_vzLevel + OUTLINE_Z_LEVEL_ERROR) {\n      vec4(color.rgb * 0.5, color.a);\n    } else {\n      discard;\n    }\n  }\n  return color;\n}\n\n// if enabled and rendering outlines - Render depth to shadowmap\n// if enabled and rendering colors - Return a darker color if in shadowmap\n// if disabled, just return color\nvec4 outline_filterColor(vec4 color) {\n  if (outline_uEnabled) {\n    return outline_uRenderOutlines ?\n      outline_filterShadowColor(color) :\n      outline_filterDarkenColor(color);\n  }\n  return color;\n}\n",getUniforms:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,e=t.outlineEnabled,n=t.outlineRenderShadowmap,o=t.outlineShadowmap,i={};return void 0!==e&&(i.outline_uEnabled=e),void 0!==n&&(i.outline_uRenderOutlines=n),void 0!==o&&(i.outline_uShadowmap=o),i}};e.default=o},1656:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(49),o=n(99),i=n(548),a=l(n(1179)),u=l(n(1657)),s=l(n(1658)),c=n(1659);function l(t){return t&&t.__esModule?t:{default:t}}function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function g(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function O(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var w=i.SimpleMeshLayer,P={mesh:new u.default({headSize:.2,tailWidth:.05})},M=Object.assign({},a.default.defaultProps,{MarkerLayer:w,markerLayerProps:P,sizeScale:100,fp64:!1,highlightIndex:-1,highlightPoint:null,getPath:function(t){return t.path},getColor:function(t){return t.color},getMarkerColor:function(t){return[0,0,0,255]},getDirection:function(t){return t.direction},getMarkerPercentages:function(t,e){return e.lineLength>.1?[.25,.5,.75]:[.5]}}),S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(p,t);var e,n,i,l,f=(e=p,function(){var t,n=m(e);if(b()){var r=m(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return g(this,t)});function p(){return d(this,p),f.apply(this,arguments)}return n=p,(i=[{key:"initializeState",value:function(){this.state={markers:[],mesh:new u.default({headSize:.2,tailWidth:.05}),closestPoint:null}}},{key:"projectFlat",value:function(t,e,n,o){if(n===r.COORDINATE_SYSTEM.METER_OFFSETS){var i=h(e.metersToLngLatDelta(t),2),a=i[0],u=i[1],s=h(o,2),c=s[0],l=s[1];return e.projectFlat([c+a,u+l])}if(n===r.COORDINATE_SYSTEM.LNGLAT_OFFSETS){var f=h(t,2),p=f[0],d=f[1],y=h(o,2),g=y[0],b=y[1];return e.projectFlat([g+p,d+b])}return e.projectFlat(t)}},{key:"updateState",value:function(t){var e=this,n=t.props,r=t.oldProps,o=t.changeFlags;if(o.dataChanged||o.updateTriggersChanged){var i=this.props,a=i.data,u=i.getPath,c=i.getDirection,l=i.getMarkerColor,f=i.getMarkerPercentages,h=i.coordinateSystem,p=i.coordinateOrigin,d=this.context.viewport;this.state.markers=(0,s.default)({data:a,getPath:u,getDirection:c,getColor:l,getMarkerPercentages:f,projectFlat:function(t){return e.projectFlat(t,d,h,p)}}),this._recalculateClosestPoint()}o.propsChanged&&n.point!==r.point&&this._recalculateClosestPoint()}},{key:"_recalculateClosestPoint",value:function(){var t=this.props,e=t.highlightPoint,n=t.highlightIndex;if(e&&n>=0){var r=this.props.data[n],o=this.props.getPath(r),i=(0,c.getClosestPointOnPolyline)({points:o,p:e}).point;this.state.closestPoints=[{position:i}]}else this.state.closestPoints=[]}},{key:"getPickingInfo",value:function(t){var e=t.info;return Object.assign(e,{object:e.object&&e.object.path||e.object})}},{key:"renderLayers",value:function(){return[new a.default(this.props,this.getSubLayerProps({id:"paths",data:this.props.data})),new this.props.MarkerLayer(this.getSubLayerProps(Object.assign({},this.props.markerLayerProps,{id:"markers",data:this.state.markers,getOrientation:function(t){return[0,-t.angle,0]},getColor:function(t){return t.color},sizeScale:this.props.sizeScale,fp64:this.props.fp64,pickable:!1,parameters:{blend:!1,depthTest:!1}}))),this.state.closestPoints&&new o.ScatterplotLayer({id:"".concat(this.props.id,"-highlight"),data:this.state.closestPoints,fp64:this.props.fp64})]}}])&&y(n.prototype,i),l&&y(n,l),p}(r.CompositeLayer);e.default=S,O(S,"layerName","PathMarkerLayer"),O(S,"defaultProps",M)},1657:function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(r,t);var e,n=(e=r,function(){var t,n=u(e);if(a()){var r=u(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return i(this,t)});function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o(this,r),n.call(this,Object.assign({},t,{attributes:l(t)}))}return r}(n(70).Geometry);function l(t){for(var e=t.length,n=void 0===e?1:e,r=t.headSize,o=void 0===r?.2:r,i=t.tailWidth,a=void 0===i?.05:i,u=t.tailStart,s=void 0===u?.05:u,c=[.5,1,0,.5-o/2,1-o,0,.5+o/2,1-o,0,.5-a/2,s,0,.5+a/2,1-o,0,.5+a/2,s,0,.5-a/2,s,0,.5-a/2,1-o,0,.5+a/2,1-o,0],l=new Array(c.length),f=0;f<c.length/3;f++){var h=3*f;l[h+0]=(c[h+0]-.5)*n,l[h+1]=(c[h+1]-.5)*n,l[h+2]=0}return{positions:new Float32Array(l),normals:new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]),texCoords:new Float32Array(c)}}e.default=c},1658:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e,n=t.data,i=t.getPath,l=void 0===i?function(t){return t.path}:i,f=t.getDirection,h=void 0===f?function(t){return t.direction}:f,p=t.getColor,d=void 0===p?function(t){return u}:p,y=t.getMarkerPercentages,g=void 0===y?function(t,e){return[.5]}:y,b=t.projectFlat,m=[],v=o(n);try{for(v.s();!(e=v.n()).done;){var O,w=e.value,P=l(w),M=h(w)||s,S=d(w),x=P.map((function(t){return new r.Vector2(t)})),j=x.slice(0).reverse(),E=a(x),_=o(g(w,{lineLength:E}));try{for(_.s();!(O=_.n()).done;){var k=O.value;if(M.forward){var C=c({path:x,percentage:k,lineLength:E,color:S,object:w,projectFlat:b});m.push(C)}if(M.backward){var R=c({path:j,percentage:k,lineLength:E,color:S,object:w,projectFlat:b});m.push(R)}}}catch(t){_.e(t)}finally{_.f()}}}catch(t){v.e(t)}finally{v.f()}return m};var r=n(1373);function o(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,a=!0,u=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw o}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t){for(var e=0,n=0;n<t.length-1;n++)e+=t[n].distance(t[n+1]);return e}var u=[0,0,0,255],s={forward:!0,backward:!1};function c(t){for(var e=t.path,n=t.percentage,o=t.lineLength,i=t.color,a=t.object,u=t.projectFlat,s=o*n,c=0,l=0,f=0;f<e.length-1&&!((c+=e[f].distance(e[f+1]))>s);f++)l=c;var h=e[e.length-1],p=e[e.length-2],d=s-l,y=h.clone().subtract(p).normalize().clone().multiply(new r.Vector2(d,d)).add(p),g=180*new r.Vector2(u(h)).subtract(u(p)).verticalAngle()/Math.PI;return{position:[y.x,y.y,0],angle:g,color:i,object:a}}},1659:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getClosestPointOnLine=o,e.getClosestPointOnPolyline=function(t){var e=t.p,n=t.points;e=new r.Vector3(e);for(var i=null,a=1/0,u=-1,s=0;s<n.length-1;++s){var c=n[s],l=n[s+1],f=o({p:e,p1:c,p2:l}),h=e.distanceSquared(f);h<a&&(a=h,i=f,u=s)}return{point:i,index:u,p1:n[u],p2:n[u+1],distanceSquared:a,distance:Math.sqrt(a)}};var r=n(1373);function o(t){var e=t.p,n=t.p1,o=t.p2,i=t.clampToLine,a=void 0===i||i,u=new r.Vector3(o).subtract(n),s=new r.Vector3(e).subtract(n),c=u.dot(s);return a&&(c=(0,r.clamp)(c,0,1)),u.lerp(c)}},1660:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(49),o=n(99);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){d(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(d,t);var e,n,r,i,a=(e=d,function(){var t,n=h(e);if(f()){var r=h(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return l(this,t)});function d(){return s(this,d),a.apply(this,arguments)}return n=d,(r=[{key:"renderLayers",value:function(){var t=this.props,e=t.id,n=t.getFillColor,r=t.getStrokeColor,i=t.getInnerRadius,a=t.updateTriggers;return[new o.ScatterplotLayer(u({},this.props,{id:"".concat(e,"-full"),data:this.props.data,getLineColor:r,updateTriggers:u({},a,{getStrokeColor:a.getStrokeColor})})),new o.ScatterplotLayer(u({},this.props,{id:"".concat(e,"-inner"),data:this.props.data,getFillColor:n,getRadius:i,pickable:!1,updateTriggers:u({},a,{getFillColor:a.getFillColor,getRadius:a.getInnerRadius})}))]}}])&&c(n.prototype,r),i&&c(n,i),d}(r.CompositeLayer);e.default=y,d(y,"layerName","JunctionScatterplotLayer"),d(y,"defaultProps",u({},o.ScatterplotLayer.defaultProps,{getFillColor:function(t){return[0,0,0,255]},getStrokeColor:function(t){return[255,255,255,255]},getInnerRadius:function(t){return 1}}))},169:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"e",(function(){return a})),n.d(e,"f",(function(){return u})),n.d(e,"h",(function(){return c})),n.d(e,"g",(function(){return l})),n.d(e,"c",(function(){return f})),n.d(e,"a",(function(){return h})),n.d(e,"d",(function(){return p}));n(197);const r=1/Math.PI*180,o=1/180*Math.PI,i={};function a(t,{precision:e=i.precision||4}={}){return t=function(t){return Math.round(t/i.EPSILON)*i.EPSILON}(t),"".concat(parseFloat(t.toPrecision(e)))}function u(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function s(t,e,n){if(u(t)){n=n||((r=t).clone?r.clone():new Array(r.length));for(let r=0;r<n.length&&r<t.length;++r)n[r]=e(t[r],r,n);return n}var r;return e(t)}function c(t){return function(t,e){return s(t,t=>t*o,e)}(t)}function l(t){return f(t)}function f(t,e){return s(t,t=>t*r,e)}function h(t,e,n){return s(t,t=>Math.max(e,Math.min(n,t)))}function p(t,e,n){const r=i.EPSILON;n&&(i.EPSILON=n);try{if(t===e)return!0;if(u(t)&&u(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!p(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):!(!Number.isFinite(t)||!Number.isFinite(e))&&Math.abs(t-e)<=i.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{i.EPSILON=r}}i.EPSILON=1e-12,i.debug=!1,i.precision=4,i.printTypes=!1,i.printDegrees=!1,i.printRowMajor=!0},172:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toDeckColor=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[255,0,0,255];if(!Array.isArray(t))return e;return[255*t[0],255*t[1],255*t[2],255*t[3]]},e.recursivelyTraverseNestedArrays=function t(e,n,r){if(!Array.isArray(e[0]))return!0;for(var o=0;o<e.length;o++)if(t(e[o],[].concat(h(n),[o]),r)){r(e,n);break}return!1},e.generatePointsParallelToLinePoints=function(t,e,n){var a={type:"LineString",coordinates:[t,e]},s=(0,u.point)(n),c=(0,i.default)(s,a),l=(0,o.default)(t,e),f=(n[0]-t[0])*(e[1]-t[1])-(n[1]-t[1])*(e[0]-t[0])<0?l-90:l-270,h=(0,r.default)(e,c,f),p=(0,r.default)(t,c,f);return[h.geometry.coordinates,p.geometry.coordinates]},e.distance2d=y,e.mix=g,e.nearestPointOnProjectedLine=function(t,e,n){var r=new c.default(n),o=t.geometry.coordinates.map((function(t){var e=f(t,3),n=e[0],o=e[1],i=e[2],a=void 0===i?0:i;return r.project([n,o,a])})),i=f(r.project(e.geometry.coordinates),2),a=i[0],u=i[1],s=1/0,l={};o.forEach((function(t,e){var n=f(t,2),r=n[0],i=n[1];if(0!==e){var c=f(o[e-1],2),h=c[0],p=c[1],d=p-i,y=r-h,g=h*i-r*p,b=d*d+y*y,m=Math.abs(d*a+y*u+g)/Math.sqrt(b);m<s&&(s=m,l={index:e,x0:(y*(y*a-d*u)-d*g)/b,y0:(d*(-y*a+d*u)-y*g)/b})}}));var h=l,p=h.index,d=h.x0,b=h.y0,m=f(o[p-1],3),v=m[0],O=m[1],w=m[2],P=void 0===w?0:w,M=f(o[p],3),S=M[0],x=M[1],j=M[2],E=void 0===j?0:j,_=y(v,O,S,x),k=y(v,O,d,b),C=g(P,E,k/_);return{type:"Feature",geometry:{type:"Point",coordinates:r.unproject([d,b,C])},properties:{dist:s,index:p-1}}},e.nearestPointOnLine=function(t,e,n){var r,o,i;n&&(i=new c.default(n));var l=(0,u.point)([1/0,1/0],{dist:1/0});if(!(null===(r=t.geometry)||void 0===r?void 0:r.coordinates.length)||(null===(o=t.geometry)||void 0===o?void 0:o.coordinates.length)<2)return l;return(0,a.flattenEach)(t,(function(t){var n,r,o,a,c,f,h,p=(0,s.getCoords)(t),d=(0,s.getCoords)(e);if(p.length>1&&d.length){var y,g;i?(y=p.map((function(t){return i.project(t)})),g=i.project(d)):(y=p,g=d);for(var b=1;b<y.length;b++){if(y[b][0]!==y[b-1][0]){var m=(y[b][1]-y[b-1][1])/(y[b][0]-y[b-1][0]),v=y[b][1]-m*y[b][0];h=Math.abs(m*g[0]+v-g[1])/Math.sqrt(m*m+1)}else h=Math.abs(g[0]-y[b][0]);var O=Math.pow(y[b][1]-y[b-1][1],2)+Math.pow(y[b][0]-y[b-1][0],2),w=Math.pow(y[b][1]-g[1],2)+Math.pow(y[b][0]-g[0],2),P=Math.pow(y[b-1][1]-g[1],2)+Math.pow(y[b-1][0]-g[0],2),M=Math.pow(h,2),S=w-M+P-M;S>O&&(h=Math.sqrt(Math.min(w,P))),(null==n||n>h)&&(S>O?P<w?(r=0,o=1):(o=0,r=1):(r=Math.sqrt(P-M)/Math.sqrt(O),o=Math.sqrt(w-M)/Math.sqrt(O)),n=h,f=b)}var x=y[f-1][0]-y[f][0],j=y[f-1][1]-y[f][1];a=y[f-1][0]-x*r,c=y[f-1][1]-j*r}var E={x:a,y:c,idx:f-1,to:r,from:o};if(i){var _=i.unproject([E.x,E.y]);E={x:_[0],y:_[1],idx:f-1,to:r,from:o}}l=(0,u.point)([E.x,E.y],{dist:Math.abs(E.from-E.to),index:E.idx})})),l},e.getPickedEditHandle=function(t){var e=b(t);return e.length?e[0]:null},e.getPickedSnapSourceEditHandle=function(t){return b(t).find((function(t){return"snap-source"===t.properties.editHandleType}))},e.getNonGuidePicks=function(t){return t&&t.filter((function(t){return!t.isGuide}))},e.getPickedExistingEditHandle=function(t){return b(t).find((function(t){var e=t.properties;return e.featureIndex>=0&&"existing"===e.editHandleType}))},e.getPickedIntermediateEditHandle=function(t){return b(t).find((function(t){var e=t.properties;return e.featureIndex>=0&&"intermediate"===e.editHandleType}))},e.getPickedEditHandles=b,e.getEditHandlesForGeometry=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"existing",r=[];switch(t.type){case"Point":r=[{type:"Feature",properties:{guideType:"editHandle",editHandleType:n,positionIndexes:[],featureIndex:e},geometry:{type:"Point",coordinates:t.coordinates}}];break;case"MultiPoint":case"LineString":r=r.concat(m(t.coordinates,[],e,n));break;case"Polygon":case"MultiLineString":for(var o=0;o<t.coordinates.length;o++)r=r.concat(m(t.coordinates[o],[o],e,n)),"Polygon"===t.type&&(r=r.slice(0,-1));break;case"MultiPolygon":for(var i=0;i<t.coordinates.length;i++)for(var a=0;a<t.coordinates[i].length;a++)r=(r=r.concat(m(t.coordinates[i][a],[i,a],e,n))).slice(0,-1);break;default:throw Error("Unhandled geometry type: ".concat(t.type))}return r},e.updateRectanglePosition=function(t,e,n){var r=t.geometry.coordinates;if(!r)return null;var o=r[0].slice(0,4);o[e%4]=n;var i=o[(e+2)%4],a=o[e%4];return o[(e+1)%4]=[a[0],i[1]],o[(e+3)%4]=[i[0],a[1]],[[].concat(h(o),[o[0]])]},e.mapCoords=function t(e,n){if("number"==typeof e[0])return!isNaN(e[0])&&isFinite(e[0])?n(e):e;return e.map((function(e){return t(e,n)})).filter(Boolean)};var r=l(n(252)),o=l(n(205)),i=l(n(1166)),a=n(88),u=n(30),s=n(48),c=l(n(1374));function l(t){return t&&t.__esModule?t:{default:t}}function f(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||p(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||p(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){if(t){if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function y(t,e,n,r){var o=t-n,i=e-r;return Math.sqrt(o*o+i*i)}function g(t,e,n){return e*n+t*(1-n)}function b(t){return t&&t.filter((function(t){return t.isGuide&&"editHandle"===t.object.properties.guideType})).map((function(t){return t.object}))||[]}function m(t,e,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"existing",o=[],i=0;i<t.length;i++){var a=t[i];o.push({type:"Feature",properties:{guideType:"editHandle",positionIndexes:[].concat(h(e),[i]),featureIndex:n,editHandleType:r},geometry:{type:"Point",coordinates:a}})}return o}},1875:function(t,e,n){"use strict";(function(e){var r=n(387),o=n(1876);t.exports=r(o,{file:function(t){if("undefined"!=typeof window){if(t instanceof e.Blob||t instanceof e.ArrayBuffer)return;return"Blob or ArrayBuffer"}if("string"!=typeof t&&void 0===t.pipe)return"Filename or Readable stream"},date:function(t){if("boolean"==typeof t)return"date";try{var e=new Date(t);if(e.getTime&&isNaN(e.getTime()))return"date"}catch(t){return"date"}},coordinates:function(t){return o.tuple(o.number,o.number)(t)},assertShape:function(t,e){return o.assert(o.strictShape(t),e)}})}).call(this,n(80))},1876:function(t,e,n){"use strict";var r=n(1877),o=n(387),i={};function a(t){var e=Array.isArray(t);return function(n){var r,o=u(i.plainArray,n);if(o)return o;if(e&&n.length!==t.length)return"an array with "+t.length+" items";for(var a=0;a<n.length;a++)if(o=u((r=a,e?t[r]:t),n[a]))return[a].concat(o)}}function u(t,e){if(null!=e||t.hasOwnProperty("__required")){var n=t(e);return n?Array.isArray(n)?n:[n]:void 0}}function s(t,e){var n=t.length,r=t[n-1],i=t.slice(0,n-1);return 0===i.length&&(i=["value"]),e=o(e,{path:i}),"function"==typeof r?r(e):l(e,function(t){return"must be "+function(t){if(/^an? /.test(t))return t;if(/^[aeiou]/i.test(t))return"an "+t;if(/^[a-z]/i.test(t))return"a "+t;return t}(t)+"."}(r))}function c(t){return t.length<2?t[0]:2===t.length?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t.slice(-1)}function l(t,e){return(f(t.path)?"Item at position ":"")+(t.path.join(".")+" "+e)}function f(t){return"number"==typeof t[t.length-1]||"number"==typeof t[0]}i.assert=function(t,e){return e=e||{},function(n){var r=u(t,n);if(r){var o=s(r,e);throw e.apiName&&(o=e.apiName+": "+o),new Error(o)}}},i.shape=function(t){var e,n=(e=t,Object.keys(e||{}).map((function(t){return{key:t,value:e[t]}})));return function(t){var e,r=u(i.plainObject,t);if(r)return r;for(var o=[],a=0;a<n.length;a++)e=n[a].key,(r=u(n[a].value,t[e]))&&o.push([e].concat(r));return o.length<2?o[0]:function(t){o=o.map((function(e){return"- "+e[0]+": "+s(e,t).split("\n").join("\n  ")}));var e=t.path.join(".");return"The following properties"+("value"===e?"":" of "+e)+" have invalid values:\n  "+o.join("\n  ")}}},i.strictShape=function(t){var e=i.shape(t);return function(n){var r=e(n);if(r)return r;var o=Object.keys(n).reduce((function(e,n){return void 0===t[n]&&e.push(n),e}),[]);return 0!==o.length?function(){return"The following keys are invalid: "+o.join(", ")}:void 0}},i.arrayOf=function(t){return a(t)},i.tuple=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return a(t)},i.required=function(t){function e(e){return null==e?function(t){return l(t,f(t.path)?"cannot be undefined/null.":"is required.")}:t.apply(this,arguments)}return e.__required=!0,e},i.oneOfType=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(e){var n=t.map((function(t){return u(t,e)})).filter(Boolean);if(n.length===t.length)return n.every((function(t){return 1===t.length&&"string"==typeof t[0]}))?c(n.map((function(t){return t[0]}))):n.reduce((function(t,e){return e.length>t.length?e:t}))}},i.equal=function(t){return function(e){if(e!==t)return JSON.stringify(t)}},i.oneOf=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments),e=t.map((function(t){return i.equal(t)}));return i.oneOfType.apply(this,e)},i.range=function(t){var e=t[0],n=t[1];return function(t){if(u(i.number,t)||t<e||t>n)return"number between "+e+" & "+n+" (inclusive)"}},i.any=function(){},i.boolean=function(t){if("boolean"!=typeof t)return"boolean"},i.number=function(t){if("number"!=typeof t)return"number"},i.plainArray=function(t){if(!Array.isArray(t))return"array"},i.plainObject=function(t){if(!r(t))return"object"},i.string=function(t){if("string"!=typeof t)return"string"},i.func=function(t){if("function"!=typeof t)return"function"},i.validate=u,i.processMessage=s,t.exports=i},1878:function(t,e,n){"use strict";t.exports=function(t,e){var n=function(t,n){return-1!==e.indexOf(t)&&void 0!==n};return"function"==typeof e&&(n=e),Object.keys(t).filter((function(e){return n(e,t[e])})).reduce((function(e,n){return e[n]=t[n],e}),{})}},1879:function(t,e,n){"use strict";var r=n(1880);t.exports=function(t){return r(t,(function(t,e){return"boolean"==typeof e?JSON.stringify(e):e}))}},1880:function(t,e,n){"use strict";t.exports=function(t,e){return Object.keys(t).reduce((function(n,r){return n[r]=e(r,t[r]),n}),{})}},1881:function(t,e,n){"use strict";var r=n(1234),o=n(1886);t.exports=function(t){return function(e){var n;n=r.prototype.isPrototypeOf(e)?e:o(e);var i=Object.create(t);return i.client=n,i}}},1883:function(t,e,n){"use strict";var r=n(1235),o=n(387),i=n(1884),a=n(1885),u=n(637),s=1;function c(t,e){if(!t)throw new Error("MapiRequest requires a client");if(!e||!e.path||!e.method)throw new Error("MapiRequest requires an options object with path and method properties");var n={};e.body&&(n["content-type"]="application/json");var r=o(n,e.headers),a=Object.keys(r).reduce((function(t,e){return t[e.toLowerCase()]=r[e],t}),{});this.id=s++,this._options=e,this.emitter=new i,this.client=t,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=e.path,this.method=e.method,this.origin=e.origin||t.origin,this.query=e.query||{},this.params=e.params||{},this.body=e.body||null,this.file=e.file||null,this.encoding=e.encoding||"utf8",this.sendFileAs=e.sendFileAs||null,this.headers=a}c.prototype.url=function(t){var e=a.prependOrigin(this.path,this.origin);e=a.appendQueryObject(e,this.query);var n=this.params,i=null==t?this.client.accessToken:t;if(i){e=a.appendQueryParam(e,"access_token",i);var u=r(i).user;n=o({ownerId:u},n)}return e=a.interpolateRouteParams(e,n),e},c.prototype.send=function(){var t=this;if(t.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return t.sent=!0,t.client.sendRequest(t).then((function(e){return t.response=e,t.emitter.emit(u.EVENT_RESPONSE,e),e}),(function(e){throw t.error=e,t.emitter.emit(u.EVENT_ERROR,e),e}))},c.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),this.response||this.error||this.aborted||(this.aborted=!0,this.client.abortRequest(this))},c.prototype.eachPage=function(t){var e=this;function n(n){t(null,n,(function(){delete e._nextPageRequest;var t=n.nextPage();t&&(e._nextPageRequest=t,o(t))}))}function r(e){t(e,null,(function(){}))}function o(t){t.send().then(n,r)}o(this)},c.prototype.clone=function(){return this._extend()},c.prototype._extend=function(t){var e=o(this._options,t);return new c(this.client,e)},t.exports=c},1885:function(t,e,n){"use strict";function r(t){return Array.isArray(t)?t.map(encodeURIComponent).join(","):encodeURIComponent(String(t))}function o(t,e,n){if(!1===n||null===n)return t;var o=/\?/.test(t)?"&":"?",i=encodeURIComponent(e);return void 0!==n&&""!==n&&!0!==n&&(i+="="+r(n)),""+t+o+i}t.exports={appendQueryObject:function(t,e){if(!e)return t;var n=t;return Object.keys(e).forEach((function(t){var r=e[t];void 0!==r&&(Array.isArray(r)&&(r=r.filter((function(t){return null!=t})).join(",")),n=o(n,t,r))})),n},appendQueryParam:o,prependOrigin:function(t,e){if(!e)return t;if("http"===t.slice(0,4))return t;var n="/"===t[0]?"":"/";return""+e.replace(/\/$/,"")+n+t},interpolateRouteParams:function(t,e){return e?t.replace(/\/:([a-zA-Z0-9]+)/g,(function(t,n){var o=e[n];if(void 0===o)throw new Error("Unspecified route parameter "+n);return"/"+r(o)})):t}}},1886:function(t,e,n){"use strict";var r=n(1887),o=n(1234);function i(t){o.call(this,t)}i.prototype=Object.create(o.prototype),i.prototype.constructor=i,i.prototype.sendRequest=r.browserSend,i.prototype.abortRequest=r.browserAbort,t.exports=function(t){return new i(t)}},1887:function(t,e,n){"use strict";var r=n(1888),o=n(1890),i=n(637),a=n(1891),u={};function s(t){var e=t.total,n=t.loaded;return{total:e,transferred:n,percent:100*n/e}}function c(t,e){return new Promise((function(n,r){e.onprogress=function(e){t.emitter.emit(i.EVENT_PROGRESS_DOWNLOAD,s(e))};var a=t.file;a&&(e.upload.onprogress=function(e){t.emitter.emit(i.EVENT_PROGRESS_UPLOAD,s(e))}),e.onerror=function(t){r(t)},e.onabort=function(){var e=new o({request:t,type:i.ERROR_REQUEST_ABORTED});r(e)},e.onload=function(){if(delete u[t.id],e.status<200||e.status>=400){var i=new o({request:t,body:e.response,statusCode:e.status});r(i)}else n(e)};var c=t.body;"string"==typeof c?e.send(c):c?e.send(JSON.stringify(c)):a?e.send(a):e.send(),u[t.id]=e})).then((function(e){return function(t,e){return new r(t,{body:e.response,headers:a(e.getAllResponseHeaders()),statusCode:e.status})}(t,e)}))}function l(t,e){var n=t.url(e),r=new window.XMLHttpRequest;return r.open(t.method,n),Object.keys(t.headers).forEach((function(e){r.setRequestHeader(e,t.headers[e])})),r}t.exports={browserAbort:function(t){var e=u[t.id];e&&(e.abort(),delete u[t.id])},sendRequestXhr:c,browserSend:function(t){return Promise.resolve().then((function(){var e=l(t,t.client.accessToken);return c(t,e)}))},createRequestXhr:l}},1888:function(t,e,n){"use strict";var r=n(1889);function o(t,e){this.request=t,this.headers=e.headers,this.rawBody=e.body,this.statusCode=e.statusCode;try{this.body=JSON.parse(e.body||"{}")}catch(t){this.body=e.body}this.links=r(this.headers.link)}o.prototype.hasNextPage=function(){return!!this.links.next},o.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null},t.exports=o},1889:function(t,e,n){"use strict";t.exports=function(t){return t?t.split(/,\s*</).reduce((function(t,e){var n=function(t){var e=t.match(/<?([^>]*)>(.*)/);if(!e)return null;var n=e[1],r=e[2].split(";"),o=null,i=r.reduce((function(t,e){var n=function(t){var e=t.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return e?{key:e[1],value:e[2]}:null}(e);return n?"rel"===n.key?(o||(o=n.value),t):(t[n.key]=n.value,t):t}),{});return o?{url:n,rel:o,params:i}:null}(e);return n?(n.rel.split(/\s+/).forEach((function(e){t[e]||(t[e]={url:n.url,params:n.params})})),t):t}),{}):{}}},1890:function(t,e,n){"use strict";var r=n(637);t.exports=function(t){var e,n=t.type||r.ERROR_HTTP;if(t.body)try{e=JSON.parse(t.body)}catch(n){e=t.body}else e=null;var o=t.message||null;o||("string"==typeof e?o=e:e&&"string"==typeof e.message?o=e.message:n===r.ERROR_REQUEST_ABORTED&&(o="Request aborted")),this.message=o,this.type=n,this.statusCode=t.statusCode||null,this.request=t.request,this.body=e}},1891:function(t,e,n){"use strict";t.exports=function(t){var e={};return t?(t.trim().split(/[\r|\n]+/).forEach((function(t){var n=function(t){var e=t.indexOf(":");return{name:t.substring(0,e).trim().toLowerCase(),value:t.substring(e+1).trim()}}(t);e[n.name]=n.value})),e):e}},197:function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}n.d(e,"a",(function(){return r}))},2100:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return T})),n.d(e,"WebMercatorViewport",(function(){return T})),n.d(e,"getBounds",(function(){return R})),n.d(e,"fitBounds",(function(){return k})),n.d(e,"normalizeViewportProps",(function(){return I})),n.d(e,"flyToViewport",(function(){return F})),n.d(e,"getFlyToDuration",(function(){return N})),n.d(e,"lngLatToWorld",(function(){return b})),n.d(e,"worldToLngLat",(function(){return m})),n.d(e,"worldToPixels",(function(){return E})),n.d(e,"pixelsToWorld",(function(){return _})),n.d(e,"zoomToScale",(function(){return y})),n.d(e,"scaleToZoom",(function(){return g})),n.d(e,"altitudeToFovy",(function(){return x})),n.d(e,"fovyToAltitude",(function(){return j})),n.d(e,"getMeterZoom",(function(){return v})),n.d(e,"getDistanceScales",(function(){return O})),n.d(e,"addMetersToLngLat",(function(){return w})),n.d(e,"getViewMatrix",(function(){return P})),n.d(e,"getProjectionMatrix",(function(){return S})),n.d(e,"getProjectionParameters",(function(){return M}));var r=n(93);function o(t,e){const n=r.n([],e,t);return r.k(n,n,1/n[3]),n}function i(t,e){const n=t%e;return n<0?e+n:n}const a=Math.log2||function(t){return Math.log(t)*Math.LOG2E};var u=n(46),s=n(58),c=n(64);function l(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const f=Math.PI,h=f/4,p=f/180,d=180/f;function y(t){return Math.pow(2,t)}function g(t){return a(t)}function b([t,e]){l(Number.isFinite(t)),l(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude");const n=e*p;return[512*(t*p+f)/(2*f),512*(f+Math.log(Math.tan(h+.5*n)))/(2*f)]}function m([t,e]){const n=t/512*(2*f)-f,r=2*(Math.atan(Math.exp(e/512*(2*f)-f))-h);return[n*d,r*d]}function v({latitude:t}){l(Number.isFinite(t));return g(4003e4*Math.cos(t*p))-9}function O({latitude:t,longitude:e,highPrecision:n=!1}){l(Number.isFinite(t)&&Number.isFinite(e));const r={},o=Math.cos(t*p),i=512/360/o,a=512/4003e4/o;if(r.unitsPerMeter=[a,a,a],r.metersPerUnit=[1/a,1/a,1/a],r.unitsPerDegree=[512/360,i,a],r.degreesPerUnit=[.703125,1/i,1/a],n){const e=p*Math.tan(t*p)/o,n=512/360*e/2,u=512/4003e4*e,s=u/i*a;r.unitsPerDegree2=[0,n,u],r.unitsPerMeter2=[s,0,s]}return r}function w(t,e){const[n,r,o]=t,[i,a,u]=e,{unitsPerMeter:s,unitsPerMeter2:c}=O({longitude:n,latitude:r,highPrecision:!0}),l=b(t);l[0]+=i*(s[0]+c[0]*a),l[1]+=a*(s[1]+c[1]*a);const f=m(l),h=(o||0)+(u||0);return Number.isFinite(o)||Number.isFinite(u)?[f[0],f[1],h]:f}function P({height:t,pitch:e,bearing:n,altitude:r,scale:o,center:i=null}){const a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return u.p(a,a,[0,0,-r]),u.l(a,a,-e*p),u.n(a,a,n*p),o/=t,u.o(a,a,[o,o,o]),i&&u.p(a,a,c.l([],i)),a}function M({width:t,height:e,fovy:n=x(1.5),altitude:r,pitch:o=0,nearZMultiplier:i=1,farZMultiplier:a=1}){void 0!==r&&(n=x(r));const u=.5*n*p,s=j(n),c=o*p,l=Math.sin(u)*s/Math.sin(Math.min(Math.max(Math.PI/2-c-u,.01),Math.PI-.01));return{fov:2*u,aspect:t/e,focalDistance:s,near:i,far:(Math.sin(c)*l+s)*a}}function S({width:t,height:e,pitch:n,altitude:r,fovy:o,nearZMultiplier:i,farZMultiplier:a}){const{fov:s,aspect:c,near:l,far:f}=M({width:t,height:e,altitude:r,fovy:o,pitch:n,nearZMultiplier:i,farZMultiplier:a});return u.j([],s,c,l,f)}function x(t){return 2*Math.atan(.5/t)*d}function j(t){return.5/Math.tan(.5*t*p)}function E(t,e){const[n,r,i=0]=t;return l(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),o(e,[n,r,i,1])}function _(t,e,n=0){const[r,i,a]=t;if(l(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(a)){return o(e,[r,i,a,1])}const u=o(e,[r,i,0,1]),c=o(e,[r,i,1,1]),f=u[2],h=c[2],p=f===h?0:((n||0)-f)/(h-f);return s.c([],u,c,p)}function k({width:t,height:e,bounds:n,minExtent:r=0,maxZoom:o=24,padding:i=0,offset:u=[0,0]}){const[[s,c],[f,h]]=n;if(Number.isFinite(i)){i={top:i,bottom:i,left:i,right:i}}else l(Number.isFinite(i.top)&&Number.isFinite(i.bottom)&&Number.isFinite(i.left)&&Number.isFinite(i.right));const p=new T({width:t,height:e,longitude:0,latitude:0,zoom:0}),d=p.project([s,h]),y=p.project([f,c]),g=[Math.max(Math.abs(y[0]-d[0]),r),Math.max(Math.abs(y[1]-d[1]),r)],b=[t-i.left-i.right-2*Math.abs(u[0]),e-i.top-i.bottom-2*Math.abs(u[1])];l(b[0]>0&&b[1]>0);const m=b[0]/g[0],v=b[1]/g[1],O=(i.right-i.left)/2/m,w=(i.bottom-i.top)/2/v,P=[(y[0]+d[0])/2+O,(y[1]+d[1])/2+w],M=p.unproject(P),S=Math.min(o,p.zoom+a(Math.abs(Math.min(m,v))));return l(Number.isFinite(S)),{longitude:M[0],latitude:M[1],zoom:S}}const C=Math.PI/180;function R(t,e=0){const{width:n,height:r,unproject:o}=t,i={targetZ:e},a=o([0,r],i),u=o([n,r],i);let s,c;return(t.fovy?.5*t.fovy*C:Math.atan(.5/t.altitude))>(90-t.pitch)*C-.01?(s=A(t,0,e),c=A(t,n,e)):(s=o([0,0],i),c=o([n,0],i)),[a,u,c,s]}function A(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=o(r,[e,0,1,1]),a=o(r,[e,t.height,1,1]),u=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(a[2]-i[2]),c=m(s.c([],i,a,u));return c[2]=n,c}class T{constructor({width:t,height:e,latitude:n=0,longitude:r=0,zoom:o=0,pitch:i=0,bearing:a=0,altitude:u=null,fovy:s=null,position:l=null,nearZMultiplier:f=.02,farZMultiplier:h=1.01}={width:1,height:1}){t=t||1,e=e||1,null===s&&null===u?s=x(u=1.5):null===s?s=x(u):null===u&&(u=j(s));const p=y(o);u=Math.max(.75,u);const d=O({longitude:r,latitude:n}),g=b([r,n]);g[2]=0,l&&c.a(g,g,c.k([],l,d.unitsPerMeter)),this.projectionMatrix=S({width:t,height:e,pitch:i,fovy:s,nearZMultiplier:f,farZMultiplier:h}),this.viewMatrix=P({height:e,scale:p,center:g,pitch:i,bearing:a,altitude:u}),this.width=t,this.height=e,this.scale=p,this.latitude=n,this.longitude=r,this.zoom=o,this.pitch=i,this.bearing=a,this.altitude=u,this.fovy=s,this.center=g,this.meterOffset=l||[0,0,0],this.distanceScales=d,this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}_initMatrices(){const{width:t,height:e,projectionMatrix:n,viewMatrix:r}=this,o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];u.h(o,o,n),u.h(o,o,r),this.viewProjectionMatrix=o;const i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];u.o(i,i,[t/2,-e/2,1]),u.p(i,i,[1,-1,0]),u.h(i,i,o);const a=u.f([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i);if(!a)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=i,this.pixelUnprojectionMatrix=a}equals(t){return t instanceof T&&(t.width===this.width&&t.height===this.height&&u.b(t.projectionMatrix,this.projectionMatrix)&&u.b(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:e=!0}={}){const n=E(this.projectPosition(t),this.pixelProjectionMatrix),[r,o]=n,i=e?o:this.height-o;return 2===t.length?[r,i]:[r,i,n[2]]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[r,o,i]=t,a=e?o:this.height-o,u=n&&n*this.distanceScales.unitsPerMeter[2],s=_([r,a,i],this.pixelUnprojectionMatrix,u),[c,l,f]=this.unprojectPosition(s);return Number.isFinite(i)?[c,l,f]:Number.isFinite(n)?[c,l,n]:[c,l]}projectPosition(t){const[e,n]=b(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=m(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return b(t)}unprojectFlat(t){return m(t)}getMapCenterByLngLatPosition({lngLat:t,pos:e}){const n=_(e,this.pixelUnprojectionMatrix),r=b(t),o=s.a([],r,s.d([],n));return m(s.a([],this.center,o))}getLocationAtPoint({lngLat:t,pos:e}){return this.getMapCenterByLngLatPosition({lngLat:t,pos:e})}fitBounds(t,e={}){const{width:n,height:r}=this,{longitude:o,latitude:i,zoom:a}=k(Object.assign({width:n,height:r,bounds:t},e));return new T({width:n,height:r,longitude:o,latitude:i,zoom:a})}getBounds(t){const e=this.getBoundingRegion(t),n=Math.min(...e.map(t=>t[0])),r=Math.max(...e.map(t=>t[0]));return[[n,Math.min(...e.map(t=>t[1]))],[r,Math.max(...e.map(t=>t[1]))]]}getBoundingRegion(t={}){return R(this,t.z||0)}}function I({width:t,height:e,longitude:n,latitude:r,zoom:o,pitch:u=0,bearing:s=0}){(n<-180||n>180)&&(n=i(n+180,360)-180),(s<-180||s>180)&&(s=i(s+180,360)-180);const c=a(e/512);if(o<=c)o=c,r=0;else{const t=e/2/Math.pow(2,o),n=m([0,t])[1];if(r<n)r=n;else{const e=m([0,512-t])[1];r>e&&(r=e)}}return{width:t,height:e,longitude:n,latitude:r,zoom:o,pitch:u,bearing:s}}const D=["longitude","latitude","zoom"],L={curve:1.414,speed:1.2};function F(t,e,n,r={}){const o={},{startZoom:i,startCenterXY:a,uDelta:u,w0:c,u1:l,S:f,rho:h,rho2:p,r0:d}=q(t,e,r);if(l<.01){for(const r of D){const i=t[r],a=e[r];o[r]=(y=n)*a+(1-y)*i}return o}var y;const b=n*f,v=Math.cosh(d)/Math.cosh(d+h*b),O=c*((Math.cosh(d)*Math.tanh(d+h*b)-Math.sinh(d))/p)/l,w=i+g(1/v),P=s.e([],u,O);s.a(P,P,a);const M=m(P);return o.longitude=M[0],o.latitude=M[1],o.zoom=w,o}function N(t,e,n={}){n=Object.assign({},L,n);const{screenSpeed:r,speed:o,maxDuration:i}=n,{S:a,rho:u}=q(t,e,n),s=1e3*a;let c;return c=Number.isFinite(r)?s/(r/u):s/o,Number.isFinite(i)&&c>i?0:c}function q(t,e,n){const r=(n=Object.assign({},L,n)).curve,o=t.zoom,i=[t.longitude,t.latitude],a=y(o),u=e.zoom,c=[e.longitude,e.latitude],l=y(u-o),f=b(i),h=b(c),p=s.f([],h,f),d=Math.max(t.width,t.height),g=d/l,m=s.b(p)*a,v=Math.max(m,.01),O=r*r,w=(g*g-d*d+O*O*v*v)/(2*d*O*v),P=(g*g-d*d-O*O*v*v)/(2*g*O*v),M=Math.log(Math.sqrt(w*w+1)-w),S=Math.log(Math.sqrt(P*P+1)-P);return{startZoom:o,startCenterXY:f,uDelta:p,w0:d,u1:m,S:(S-M)/r,rho:r,rho2:O,r0:M,r1:S}}},2162:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(499),o=n(83),i=n(197),a=n(150),u=n(93);const s=[0,0,0,1];class c extends r.a{constructor(t=0,e=0,n=0,r=1){super(-0,-0,-0,-0),Array.isArray(t)&&1===arguments.length?this.copy(t):this.set(t,e,n,r)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}fromMatrix3(t){return a.e(this,t),this.check()}identity(){return a.f(this),this.check()}fromAxisRotation(t,e){return a.p(this,t,e),this.check()}setAxisAngle(t,e){return this.fromAxisRotation(t,e)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=Object(o.a)(t)}get y(){return this[1]}set y(t){this[1]=Object(o.a)(t)}get z(){return this[2]}set z(t){this[2]=Object(o.a)(t)}get w(){return this[3]}set w(t){this[3]=Object(o.a)(t)}len(){return a.h(this)}lengthSquared(){return a.r(this)}dot(t,e){if(void 0!==e)throw new Error("Quaternion.dot only takes one argument");return a.d(this,t)}rotationTo(t,e){return a.n(this,t,e),this.check()}add(t,e){if(void 0!==e)throw new Error("Quaternion.add only takes one argument");return a.a(this,this,t),this.check()}calculateW(){return a.b(this,this),this.check()}conjugate(){return a.c(this,this),this.check()}invert(){return a.g(this,this),this.check()}lerp(t,e,n){return a.i(this,t,e,n),this.check()}multiplyRight(t,e){return Object(i.a)(!e),a.j(this,this,t),this.check()}multiplyLeft(t,e){return Object(i.a)(!e),a.j(this,t,this),this.check()}normalize(){const t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}rotateX(t){return a.k(this,this,t),this.check()}rotateY(t){return a.l(this,this,t),this.check()}rotateZ(t){return a.m(this,this,t),this.check()}scale(t){return a.o(this,this,t),this.check()}slerp(t,e,n){switch(arguments.length){case 1:({start:t=s,target:e,ratio:n}=arguments[0]);break;case 2:[e,n]=arguments,t=this}return a.q(this,t,e,n),this.check()}transformVector4(t,e=t){return u.o(e,t,this),Object(o.b)(e,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,e){return this.setAxisAngle(t,e)}premultiply(t,e){return this.multiplyLeft(t,e)}multiply(t,e){return this.multiplyRight(t,e)}}},2164:function(t,e,n){"use strict";e.a={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:2*Math.PI}},2165:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r=n(783),o=n(83),i=n(283),a=n(229),u=n(58),s=n(64);const c=Object.freeze([1,0,0,0,1,0,0,0,1]),l=Object.freeze([0,0,0,0,0,0,0,0,0]),f=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),h={};class p extends r.a{static get IDENTITY(){return h.IDENTITY=h.IDENTITY||Object.freeze(new p(c)),h.IDENTITY}static get ZERO(){return h.ZERO=h.ZERO||Object.freeze(new p(l)),h.ZERO}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return f}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}set(t,e,n,r,o,i,a,u,s){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=o,this[5]=i,this[6]=a,this[7]=u,this[8]=s,this.check()}setRowMajor(t,e,n,r,o,i,a,u,s){return this[0]=t,this[1]=r,this[2]=a,this[3]=e,this[4]=o,this[5]=u,this[6]=n,this[7]=i,this[8]=s,this.check()}determinant(){return a.b(this)}identity(){return this.copy(c)}fromQuaternion(t){return a.c(this,t),this.check()}transpose(){return a.i(this,this),this.check()}invert(){return a.d(this,this),this.check()}multiplyLeft(t){return a.e(this,t,this),this.check()}multiplyRight(t){return a.e(this,this,t),this.check()}rotate(t){return a.f(this,this,t),this.check()}scale(t){return Array.isArray(t)?a.g(this,this,t):a.g(this,this,[t,t,t]),this.check()}translate(t){return a.h(this,this,t),this.check()}transform(t,e){switch(t.length){case 2:e=u.i(e||[-0,-0],t,this);break;case 3:e=s.s(e||[-0,-0,-0],t,this);break;case 4:e=Object(i.d)(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(o.b)(e,t.length),e}transformVector(t,e){return Object(o.c)("Matrix3.transformVector"),this.transform(t,e)}transformVector2(t,e){return Object(o.c)("Matrix3.transformVector"),this.transform(t,e)}transformVector3(t,e){return Object(o.c)("Matrix3.transformVector"),this.transform(t,e)}}},2166:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(782),o=n(169),i=n(83),a=n(58),u=n(283);class s extends r.a{constructor(t=0,e=0){super(2),Object(o.f)(t)&&1===arguments.length?this.copy(t):(o.b.debug&&(Object(i.a)(t),Object(i.a)(e)),this[0]=t,this[1]=e)}set(t,e){return this[0]=t,this[1]=e,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this.check()}fromObject(t){return o.b.debug&&(Object(i.a)(t.x),Object(i.a)(t.y)),this[0]=t.x,this[1]=t.y,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return a.j(this,this,t),this.check()}transformAsVector(t){return Object(u.a)(this,this,t),this.check()}transformByMatrix3(t){return a.i(this,this,t),this.check()}transformByMatrix2x3(t){return a.h(this,this,t),this.check()}transformByMatrix2(t){return a.g(this,this,t),this.check()}}},264:function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),e.ImmutableFeatureCollection=void 0;var c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,"featureCollection",void 0),this.featureCollection=e}var e,n,o;return e=t,(n=[{key:"getObject",value:function(){return this.featureCollection}},{key:"replacePosition",value:function(t,e,n){var r=this.featureCollection.features[t].geometry,o="Polygon"===r.type||"MultiPolygon"===r.type,i=a({},r,{coordinates:f(r.coordinates,e,n,o)});return this.replaceGeometry(t,i)}},{key:"removePosition",value:function(t,e){var n=this.featureCollection.features[t].geometry;if("Point"===n.type)throw Error("Can't remove a position from a Point or there'd be nothing left");if("MultiPoint"===n.type&&n.coordinates.length<2)throw Error("Can't remove the last point of a MultiPoint or there'd be nothing left");if("LineString"===n.type&&n.coordinates.length<3)throw Error("Can't remove position. LineString must have at least two positions");if("Polygon"===n.type&&n.coordinates[0].length<5&&Array.isArray(e)&&0===e[0])throw Error("Can't remove position. Polygon's outer ring must have at least four positions");if("MultiLineString"===n.type&&1===n.coordinates.length&&n.coordinates[0].length<3)throw Error("Can't remove position. MultiLineString must have at least two positions");if("MultiPolygon"===n.type&&1===n.coordinates.length&&n.coordinates[0][0].length<5&&Array.isArray(e)&&0===e[0]&&0===e[1])throw Error("Can't remove position. MultiPolygon's outer ring must have at least four positions");var r="Polygon"===n.type||"MultiPolygon"===n.type,o=a({},n,{coordinates:h(n.coordinates,e,r)});return function(t){switch(t.type){case"Polygon":!function(t){for(var e=t.coordinates,n=1;n<e.length;n++)d(e,n)&&n--}(t);break;case"MultiLineString":!function(t){for(var e=0;e<t.coordinates.length;e++)1===t.coordinates[e].length&&(t.coordinates.splice(e,1),e--)}(t);break;case"MultiPolygon":!function(t){for(var e=0;e<t.coordinates.length;e++){var n=t.coordinates[e];n[0].length<=3&&(t.coordinates.splice(e,1),e--);for(var r=1;r<n.length;r++)d(n,r)&&r--}}(t)}}(o),this.replaceGeometry(t,o)}},{key:"addPosition",value:function(t,e,n){var r=this.featureCollection.features[t].geometry;if("Point"===r.type)throw new Error("Unable to add a position to a Point feature");var o="Polygon"===r.type||"MultiPolygon"===r.type,i=a({},r,{coordinates:p(r.coordinates,e,n,o)});return this.replaceGeometry(t,i)}},{key:"replaceGeometry",value:function(e,n){var o=a({},this.featureCollection.features[e],{geometry:n});return new t(a({},this.featureCollection,{features:[].concat(r(this.featureCollection.features.slice(0,e)),[o],r(this.featureCollection.features.slice(e+1)))}))}},{key:"addFeature",value:function(t){return this.addFeatures([t])}},{key:"addFeatures",value:function(e){return new t(a({},this.featureCollection,{features:[].concat(r(this.featureCollection.features),r(e))}))}},{key:"deleteFeature",value:function(t){return this.deleteFeatures([t])}},{key:"deleteFeatures",value:function(e){var n=r(this.featureCollection.features);e.sort();for(var o=e.length-1;o>=0;o--){var i=e[o];i>=0&&i<n.length&&n.splice(i,1)}return new t(a({},this.featureCollection,{features:n}))}}])&&u(e.prototype,n),o&&u(e,o),t}();function l(t,e){if(2===t.length&&3===e.length){var n=e[2];return[t[0],t[1],n]}return t}function f(t,e,n,o){if(!e)return t;if(0===e.length)return l(n,t);if(1===e.length){var i=[].concat(r(t.slice(0,e[0])),[l(n,t[e[0]])],r(t.slice(e[0]+1)));return!o||0!==e[0]&&e[0]!==t.length-1||(i[0]=l(n,t[0]),i[t.length-1]=l(n,t[0])),i}return[].concat(r(t.slice(0,e[0])),[f(t[e[0]],e.slice(1,e.length),n,o)],r(t.slice(e[0]+1)))}function h(t,e,n){if(!e)return t;if(0===e.length)throw Error("Must specify the index of the position to remove");if(1===e.length){var o=[].concat(r(t.slice(0,e[0])),r(t.slice(e[0]+1)));return!n||0!==e[0]&&e[0]!==t.length-1||(0===e[0]?o[o.length-1]=o[0]:e[0]===t.length-1&&(o[0]=o[o.length-1])),o}return[].concat(r(t.slice(0,e[0])),[h(t[e[0]],e.slice(1,e.length),n)],r(t.slice(e[0]+1)))}function p(t,e,n,o){if(!e)return t;if(0===e.length)throw Error("Must specify the index of the position to remove");return 1===e.length?[].concat(r(t.slice(0,e[0])),[n],r(t.slice(e[0]))):[].concat(r(t.slice(0,e[0])),[p(t[e[0]],e.slice(1,e.length),n,o)],r(t.slice(e[0]+1)))}function d(t,e){return t[e].length<=3&&(t.splice(e,1),!0)}e.ImmutableFeatureCollection=c},277:function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"GeoJsonEditMode",{enumerable:!0,get:function(){return i.GeoJsonEditMode}}),Object.defineProperty(e,"ModifyMode",{enumerable:!0,get:function(){return a.ModifyMode}}),Object.defineProperty(e,"ResizeCircleMode",{enumerable:!0,get:function(){return u.ResizeCircleMode}}),Object.defineProperty(e,"TranslateMode",{enumerable:!0,get:function(){return s.TranslateMode}}),Object.defineProperty(e,"ScaleMode",{enumerable:!0,get:function(){return c.ScaleMode}}),Object.defineProperty(e,"RotateMode",{enumerable:!0,get:function(){return l.RotateMode}}),Object.defineProperty(e,"DuplicateMode",{enumerable:!0,get:function(){return f.DuplicateMode}}),Object.defineProperty(e,"ExtendLineStringMode",{enumerable:!0,get:function(){return h.ExtendLineStringMode}}),Object.defineProperty(e,"SplitPolygonMode",{enumerable:!0,get:function(){return p.SplitPolygonMode}}),Object.defineProperty(e,"ExtrudeMode",{enumerable:!0,get:function(){return d.ExtrudeMode}}),Object.defineProperty(e,"ElevationMode",{enumerable:!0,get:function(){return y.ElevationMode}}),Object.defineProperty(e,"TransformMode",{enumerable:!0,get:function(){return g.TransformMode}}),Object.defineProperty(e,"DrawPointMode",{enumerable:!0,get:function(){return b.DrawPointMode}}),Object.defineProperty(e,"DrawLineStringMode",{enumerable:!0,get:function(){return m.DrawLineStringMode}}),Object.defineProperty(e,"DrawPolygonMode",{enumerable:!0,get:function(){return v.DrawPolygonMode}}),Object.defineProperty(e,"DrawRectangleMode",{enumerable:!0,get:function(){return O.DrawRectangleMode}}),Object.defineProperty(e,"DrawRectangleFromCenterMode",{enumerable:!0,get:function(){return w.DrawRectangleFromCenterMode}}),Object.defineProperty(e,"DrawSquareFromCenterMode",{enumerable:!0,get:function(){return P.DrawSquareFromCenterMode}}),Object.defineProperty(e,"DrawCircleByDiameterMode",{enumerable:!0,get:function(){return M.DrawCircleByDiameterMode}}),Object.defineProperty(e,"DrawCircleFromCenterMode",{enumerable:!0,get:function(){return S.DrawCircleFromCenterMode}}),Object.defineProperty(e,"DrawEllipseByBoundingBoxMode",{enumerable:!0,get:function(){return x.DrawEllipseByBoundingBoxMode}}),Object.defineProperty(e,"DrawEllipseUsingThreePointsMode",{enumerable:!0,get:function(){return j.DrawEllipseUsingThreePointsMode}}),Object.defineProperty(e,"DrawRectangleUsingThreePointsMode",{enumerable:!0,get:function(){return E.DrawRectangleUsingThreePointsMode}}),Object.defineProperty(e,"Draw90DegreePolygonMode",{enumerable:!0,get:function(){return _.Draw90DegreePolygonMode}}),Object.defineProperty(e,"DrawPolygonByDraggingMode",{enumerable:!0,get:function(){return k.DrawPolygonByDraggingMode}}),Object.defineProperty(e,"ImmutableFeatureCollection",{enumerable:!0,get:function(){return C.ImmutableFeatureCollection}}),Object.defineProperty(e,"ViewMode",{enumerable:!0,get:function(){return R.ViewMode}}),Object.defineProperty(e,"MeasureDistanceMode",{enumerable:!0,get:function(){return A.MeasureDistanceMode}}),Object.defineProperty(e,"MeasureAreaMode",{enumerable:!0,get:function(){return T.MeasureAreaMode}}),Object.defineProperty(e,"MeasureAngleMode",{enumerable:!0,get:function(){return I.MeasureAngleMode}}),Object.defineProperty(e,"CompositeMode",{enumerable:!0,get:function(){return D.CompositeMode}}),Object.defineProperty(e,"SnappableMode",{enumerable:!0,get:function(){return L.SnappableMode}}),Object.defineProperty(e,"_memoize",{enumerable:!0,get:function(){return F.default}}),e.utils=void 0;var o,i=n(131),a=n(842),u=n(1612),s=n(844),c=n(1168),l=n(1169),f=n(1616),h=n(1617),p=n(1618),d=n(1620),y=n(1621),g=n(1622),b=n(1623),m=n(1624),v=n(846),O=n(1625),w=n(1626),P=n(1627),M=n(1629),S=n(1630),x=n(1631),j=n(1632),E=n(1633),_=n(1634),k=n(1635),C=n(264),R=n(1636),A=n(1637),T=n(1638),I=n(1640),D=n(1171),L=n(1641),F=(o=n(1174))&&o.__esModule?o:{default:o},N=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var e=q();if(e&&e.has(t))return e.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var a=o?Object.getOwnPropertyDescriptor(t,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=t[i]}n.default=t,e&&e.set(t,n);return n}(n(172));function q(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return q=function(){return t},t}e.utils=N},283:function(t,e,n){"use strict";function r(t,e,n){const r=e[0],o=e[1],i=n[3]*r+n[7]*o||1;return t[0]=(n[0]*r+n[4]*o)/i,t[1]=(n[1]*r+n[5]*o)/i,t}function o(t,e,n){const r=e[0],o=e[1],i=e[2],a=n[3]*r+n[7]*o+n[11]*i||1;return t[0]=(n[0]*r+n[4]*o+n[8]*i)/a,t[1]=(n[1]*r+n[5]*o+n[9]*i)/a,t[2]=(n[2]*r+n[6]*o+n[10]*i)/a,t}function i(t,e,n){const r=e[0],o=e[1];return t[0]=n[0]*r+n[2]*o,t[1]=n[1]*r+n[3]*o,t[2]=e[2],t}function a(t,e,n){const r=e[0],o=e[1],i=e[2];return t[0]=n[0]*r+n[3]*o+n[6]*i,t[1]=n[1]*r+n[4]*o+n[7]*i,t[2]=n[2]*r+n[5]*o+n[8]*i,t[3]=e[3],t}n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return i})),n.d(e,"d",(function(){return a}))},429:function(t,e,n){"use strict";n.d(e,"a",(function(){return I})),n.d(e,"b",(function(){return Ut})),n.d(e,"c",(function(){return qt})),n.d(e,"d",(function(){return le}));const r=-1,o=0,i=1;var a=n(3);function u(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}Math.PI,Math.PI;const s={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function c(t,{precision:e=s.precision}={}){return t=function(t){return Math.round(t/s.EPSILON)*s.EPSILON}(t),"".concat(parseFloat(t.toPrecision(e)))}function l(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function f(t,e,n){const r=s.EPSILON;n&&(s.EPSILON=n);try{if(t===e)return!0;if(l(t)&&l(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!f(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):"number"==typeof t&&"number"==typeof e&&Math.abs(t-e)<=s.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{s.EPSILON=r}}class h extends(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array)){clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}toArray(t=[],e=0){for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:l(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(s)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+c(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!f(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){if(void 0===n)return this.lerp(this,t,e);for(let r=0;r<this.ELEMENTS;++r){const o=t[r];this[r]=o+n*(e[r]-o)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=e[t];return this.check()}subtract(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=e[t];return this.check()}scale(t){if("number"==typeof t)for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;else for(let e=0;e<this.ELEMENTS&&e<t.length;++e)this[e]*=t[e];return this.check()}multiplyByScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}check(){if(s.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}get elements(){return this}}function p(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function d(t,e,n=""){if(s.debug&&!function(t,e){if(t.length!==e)return!1;for(let e=0;e<t.length;++e)if(!Number.isFinite(t[e]))return!1;return!0}(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class y extends h{get x(){return this[0]}set x(t){this[0]=p(t)}get y(){return this[1]}set y(t){this[1]=p(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const r=this[n]-t[n];e+=r*r}return p(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return p(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e[t];return this.check()}divide(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return u(t>=0&&t<this.ELEMENTS,"index is out of range"),p(this[t])}setComponent(t,e){return u(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}var g=1e-6,b="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function m(){var t=new b(3);return b!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function v(t,e,n){var r=new b(3);return r[0]=t,r[1]=e,r[2]=n,r}function O(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function w(t,e,n){var r=e[0],o=e[1],i=e[2],a=n[0],u=n[1],s=n[2];return t[0]=o*s-i*u,t[1]=i*a-r*s,t[2]=r*u-o*a,t}function P(t,e,n){var r=e[0],o=e[1],i=e[2],a=n[3]*r+n[7]*o+n[11]*i+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*o+n[8]*i+n[12])/a,t[1]=(n[1]*r+n[5]*o+n[9]*i+n[13])/a,t[2]=(n[2]*r+n[6]*o+n[10]*i+n[14])/a,t}function M(t,e,n){var r=e[0],o=e[1],i=e[2];return t[0]=r*n[0]+o*n[3]+i*n[6],t[1]=r*n[1]+o*n[4]+i*n[7],t[2]=r*n[2]+o*n[5]+i*n[8],t}function S(t,e,n){var r=n[0],o=n[1],i=n[2],a=n[3],u=e[0],s=e[1],c=e[2],l=o*c-i*s,f=i*u-r*c,h=r*s-o*u,p=o*h-i*f,d=i*l-r*h,y=r*f-o*l,g=2*a;return l*=g,f*=g,h*=g,p*=2,d*=2,y*=2,t[0]=u+l+p,t[1]=s+f+d,t[2]=c+h+y,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var x,j=function(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)};x=m();function E(t,e,n){const r=e[0],o=e[1],i=e[2],a=n[3]*r+n[7]*o+n[11]*i||1;return t[0]=(n[0]*r+n[4]*o+n[8]*i)/a,t[1]=(n[1]*r+n[5]*o+n[9]*i)/a,t[2]=(n[2]*r+n[6]*o+n[10]*i)/a,t}function _(t,e,n){const r=e[0],o=e[1],i=e[2];return t[0]=n[0]*r+n[3]*o+n[6]*i,t[1]=n[1]*r+n[4]*o+n[7]*i,t[2]=n[2]*r+n[5]*o+n[8]*i,t[3]=e[3],t}const k=[0,0,0];let C;class R extends y{static get ZERO(){return C||(C=new R(0,0,0),Object.freeze(C)),C}constructor(t=0,e=0,n=0){super(-0,-0,-0),1===arguments.length&&l(t)?this.copy(t):(s.debug&&(p(t),p(e),p(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return s.debug&&(p(t.x),p(t.y),p(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=p(t)}angle(t){return n=t,r=(e=this)[0],o=e[1],i=e[2],a=n[0],u=n[1],s=n[2],c=Math.sqrt(r*r+o*o+i*i)*Math.sqrt(a*a+u*u+s*s),l=c&&O(e,n)/c,Math.acos(Math.min(Math.max(l,-1),1));var e,n,r,o,i,a,u,s,c,l}cross(t){return w(this,this,t),this.check()}rotateX({radians:t,origin:e=k}){var n,r,o,i,a,u;return n=this,o=e,i=t,u=[],(a=[])[0]=(r=this)[0]-o[0],a[1]=r[1]-o[1],a[2]=r[2]-o[2],u[0]=a[0],u[1]=a[1]*Math.cos(i)-a[2]*Math.sin(i),u[2]=a[1]*Math.sin(i)+a[2]*Math.cos(i),n[0]=u[0]+o[0],n[1]=u[1]+o[1],n[2]=u[2]+o[2],this.check()}rotateY({radians:t,origin:e=k}){var n,r,o,i,a,u;return n=this,o=e,i=t,u=[],(a=[])[0]=(r=this)[0]-o[0],a[1]=r[1]-o[1],a[2]=r[2]-o[2],u[0]=a[2]*Math.sin(i)+a[0]*Math.cos(i),u[1]=a[1],u[2]=a[2]*Math.cos(i)-a[0]*Math.sin(i),n[0]=u[0]+o[0],n[1]=u[1]+o[1],n[2]=u[2]+o[2],this.check()}rotateZ({radians:t,origin:e=k}){var n,r,o,i,a,u;return n=this,o=e,i=t,u=[],(a=[])[0]=(r=this)[0]-o[0],a[1]=r[1]-o[1],a[2]=r[2]-o[2],u[0]=a[0]*Math.cos(i)-a[1]*Math.sin(i),u[1]=a[0]*Math.sin(i)+a[1]*Math.cos(i),u[2]=a[2],n[0]=u[0]+o[0],n[1]=u[1]+o[1],n[2]=u[2]+o[2],this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return P(this,this,t),this.check()}transformAsVector(t){return E(this,this,t),this.check()}transformByMatrix3(t){return M(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,n){const r=e[0],o=e[1];t[0]=n[0]*r+n[2]*o,t[1]=n[1]*r+n[3]*o,t[2]=e[2]}(this,this,t),this.check()}transformByQuaternion(t){return S(this,this,t),this.check()}}const A=new R,T=new R;class I{constructor(t=[0,0,0],e=[0,0,0],n){Object(a.a)(this,"center",void 0),Object(a.a)(this,"halfDiagonal",void 0),Object(a.a)(this,"minimum",void 0),Object(a.a)(this,"maximum",void 0),n=n||A.copy(t).add(e).scale(.5),this.center=new R(n),this.halfDiagonal=new R(e).subtract(this.center),this.minimum=new R(t),this.maximum=new R(e)}clone(){return new I(this.minimum,this.maximum,this.center)}equals(t){return this===t||Boolean(t)&&this.minimum.equals(t.minimum)&&this.maximum.equals(t.maximum)}transform(t){return this.center.transformAsPoint(t),this.halfDiagonal.transform(t),this.minimum.transform(t),this.maximum.transform(t),this}intersectPlane(t){const{halfDiagonal:e}=this,n=T.from(t.normal),a=e.x*Math.abs(n.x)+e.y*Math.abs(n.y)+e.z*Math.abs(n.z),u=this.center.dot(n)+t.distance;return u-a>0?i:u+a<0?r:o}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){const e=A.from(t).subtract(this.center),{halfDiagonal:n}=this;let r,o=0;return r=Math.abs(e.x)-n.x,r>0&&(o+=r*r),r=Math.abs(e.y)-n.y,r>0&&(o+=r*r),r=Math.abs(e.z)-n.z,r>0&&(o+=r*r),o}}function D(t,e){var n=e[0],r=e[1],o=e[2],i=e[4],a=e[5],u=e[6],s=e[8],c=e[9],l=e[10];return t[0]=Math.hypot(n,r,o),t[1]=Math.hypot(i,a,u),t[2]=Math.hypot(s,c,l),t}const L=new R,F=new R;class N{constructor(t=[0,0,0],e=0){Object(a.a)(this,"center",void 0),Object(a.a)(this,"radius",void 0),this.radius=-0,this.center=new R,this.fromCenterRadius(t,e)}fromCenterRadius(t,e){return this.center.from(t),this.radius=e,this}fromCornerPoints(t,e){return e=L.from(e),this.center=(new R).from(t).add(e).scale(.5),this.radius=this.center.distance(e),this}equals(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.radius===t.radius}clone(){return new N(this.center,this.radius)}union(t){const e=this.center,n=this.radius,r=t.center,o=t.radius,i=L.copy(r).subtract(e),a=i.magnitude();if(n>=a+o)return this.clone();if(o>=a+n)return t.clone();const u=.5*(n+a+o);return F.copy(i).scale((-n+u)/a).add(e),this.center.copy(F),this.radius=u,this}expand(t){const e=L.from(t).subtract(this.center).magnitude();return e>this.radius&&(this.radius=e),this}transform(t){this.center.transform(t);const e=D(L,t);return this.radius=Math.max(e[0],Math.max(e[1],e[2]))*this.radius,this}distanceSquaredTo(t){const e=this.distanceTo(t);return e*e}distanceTo(t){const e=L.from(t).subtract(this.center);return Math.max(0,e.len()-this.radius)}intersectPlane(t){const e=this.center,n=this.radius,a=t.normal.dot(e)+t.distance;return a<-n?r:a<n?o:i}}class q extends h{toString(){let t="[";if(s.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=p(n),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)e[t]=this[n+t];return e}setColumn(t,e){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)this[n+t]=e[t];return this}}function z(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],c=e[6],l=e[7],f=e[8],h=n[0],p=n[1],d=n[2],y=n[3],g=n[4],b=n[5],m=n[6],v=n[7],O=n[8];return t[0]=h*r+p*a+d*c,t[1]=h*o+p*u+d*l,t[2]=h*i+p*s+d*f,t[3]=y*r+g*a+b*c,t[4]=y*o+g*u+b*l,t[5]=y*i+g*s+b*f,t[6]=m*r+v*a+O*c,t[7]=m*o+v*u+O*l,t[8]=m*i+v*s+O*f,t}function H(t,e,n){var r=n[0],o=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=o*e[3],t[4]=o*e[4],t[5]=o*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function W(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[3]*o+n[6],t[1]=n[1]*r+n[4]*o+n[7],t}var U;!function(){var t,e=(t=new b(2),b!=Float32Array&&(t[0]=0,t[1]=0),t)}();!function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"}(U||(U={}));const B=Object.freeze([1,0,0,0,1,0,0,0,1]);class G extends q{static get IDENTITY(){return function(){V||(V=new G,Object.freeze(V));return V}()}static get ZERO(){return function(){Z||(Z=new G([0,0,0,0,0,0,0,0,0]),Object.freeze(Z));return Z}()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return U}constructor(t,...e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):e.length>0?this.copy([t,...e]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(B)}fromObject(t){return this.check()}fromQuaternion(t){return function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n+n,u=r+r,s=o+o,c=n*a,l=r*a,f=r*u,h=o*a,p=o*u,d=o*s,y=i*a,g=i*u,b=i*s;t[0]=1-f-d,t[3]=l-b,t[6]=h+g,t[1]=l+b,t[4]=1-c-d,t[7]=p-y,t[2]=h-g,t[5]=p+y,t[8]=1-c-f}(this,t),this.check()}set(t,e,n,r,o,i,a,u,s){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=o,this[5]=i,this[6]=a,this[7]=u,this[8]=s,this.check()}setRowMajor(t,e,n,r,o,i,a,u,s){return this[0]=t,this[1]=r,this[2]=a,this[3]=e,this[4]=o,this[5]=u,this[6]=n,this[7]=i,this[8]=s,this.check()}determinant(){return e=(t=this)[0],n=t[1],r=t[2],o=t[3],i=t[4],a=t[5],u=t[6],s=t[7],c=t[8],e*(c*i-a*s)+n*(-c*o+a*u)+r*(s*o-i*u);var t,e,n,r,o,i,a,u,s,c}transpose(){return function(t,e){if(t===e){var n=e[1],r=e[2],o=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=o}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8]}(this,this),this.check()}invert(){var t,e,n,r,o,i,a,u,s,c,l,f,h,p,d;return t=this,n=(e=this)[0],r=e[1],o=e[2],i=e[3],a=e[4],u=e[5],s=e[6],c=e[7],l=e[8],(d=n*(f=l*a-u*c)+r*(h=-l*i+u*s)+o*(p=c*i-a*s))&&(d=1/d,t[0]=f*d,t[1]=(-l*r+o*c)*d,t[2]=(u*r-o*a)*d,t[3]=h*d,t[4]=(l*n-o*s)*d,t[5]=(-u*n+o*i)*d,t[6]=p*d,t[7]=(-c*n+r*s)*d,t[8]=(a*n-r*i)*d),this.check()}multiplyLeft(t){return z(this,t,this),this.check()}multiplyRight(t){return z(this,this,t),this.check()}rotate(t){var e,n,r,o,i,a,u,s,c,l,f,h,p,d;return e=this,r=t,o=(n=this)[0],i=n[1],a=n[2],u=n[3],s=n[4],c=n[5],l=n[6],f=n[7],h=n[8],p=Math.sin(r),d=Math.cos(r),e[0]=d*o+p*u,e[1]=d*i+p*s,e[2]=d*a+p*c,e[3]=d*u-p*o,e[4]=d*s-p*i,e[5]=d*c-p*a,e[6]=l,e[7]=f,e[8]=h,this.check()}scale(t){return Array.isArray(t)?H(this,this,t):H(this,this,[t,t]),this.check()}translate(t){var e,n,r,o,i,a,u,s,c,l,f,h,p,d;return e=this,r=t,o=(n=this)[0],i=n[1],a=n[2],u=n[3],s=n[4],c=n[5],l=n[6],f=n[7],h=n[8],p=r[0],d=r[1],e[0]=o,e[1]=i,e[2]=a,e[3]=u,e[4]=s,e[5]=c,e[6]=p*o+d*u+l,e[7]=p*i+d*s+f,e[8]=p*a+d*c+h,this.check()}transform(t,e){let n;switch(t.length){case 2:n=W(e||[-0,-0],t,this);break;case 3:n=M(e||[-0,-0,-0],t,this);break;case 4:n=_(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return d(n,t.length),n}transformVector(t,e){return this.transform(t,e)}transformVector2(t,e){return this.transform(t,e)}transformVector3(t,e){return this.transform(t,e)}}let Z,V,J;class X extends y{static get ZERO(){return J||(J=new X(0,0,0,0),Object.freeze(J)),J}constructor(t=0,e=0,n=0,r=0){super(-0,-0,-0,-0),l(t)&&1===arguments.length?this.copy(t):(s.debug&&(p(t),p(e),p(n),p(r)),this[0]=t,this[1]=e,this[2]=n,this[3]=r)}set(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return s.debug&&(p(t.x),p(t.y),p(t.z),p(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=p(t)}get w(){return this[3]}set w(t){this[3]=p(t)}transform(t){return P(this,this,t),this.check()}transformByMatrix3(t){return _(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,n){const r=e[0],o=e[1];t[0]=n[0]*r+n[2]*o,t[1]=n[1]*r+n[3]*o,t[2]=e[2],t[3]=e[3]}(this,this,t),this.check()}transformByQuaternion(t){return S(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}}function Y(t){var e=t[0],n=t[1],r=t[2],o=t[3];return Math.hypot(e,n,r,o)}function K(t){var e=t[0],n=t[1],r=t[2],o=t[3];return e*e+n*n+r*r+o*o}!function(){var t,e=(t=new b(4),b!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t)}();function $(){var t=new b(4);return b!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Q(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function tt(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=n[0],s=n[1],c=n[2],l=n[3];return t[0]=r*l+a*u+o*c-i*s,t[1]=o*l+a*s+i*u-r*c,t[2]=i*l+a*c+r*s-o*u,t[3]=a*l-r*u-o*s-i*c,t}function et(t,e,n,r){var o,i,a,u,s,c=e[0],l=e[1],f=e[2],h=e[3],p=n[0],d=n[1],y=n[2],b=n[3];return(i=c*p+l*d+f*y+h*b)<0&&(i=-i,p=-p,d=-d,y=-y,b=-b),1-i>g?(o=Math.acos(i),a=Math.sin(o),u=Math.sin((1-r)*o)/a,s=Math.sin(r*o)/a):(u=1-r,s=r),t[0]=u*c+s*p,t[1]=u*l+s*d,t[2]=u*f+s*y,t[3]=u*h+s*b,t}function nt(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var o=0;e[4]>e[0]&&(o=1),e[8]>e[3*o+o]&&(o=2);var i=(o+1)%3,a=(o+2)%3;n=Math.sqrt(e[3*o+o]-e[3*i+i]-e[3*a+a]+1),t[o]=.5*n,n=.5/n,t[3]=(e[3*i+a]-e[3*a+i])*n,t[i]=(e[3*i+o]+e[3*o+i])*n,t[a]=(e[3*a+o]+e[3*o+a])*n}return t}var rt,ot,it,at,ut,st,ct,lt=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},ft=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},ht=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},pt=function(t,e,n,r){var o=e[0],i=e[1],a=e[2],u=e[3];return t[0]=o+r*(n[0]-o),t[1]=i+r*(n[1]-i),t[2]=a+r*(n[2]-a),t[3]=u+r*(n[3]-u),t},dt=Y,yt=K,gt=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n*n+r*r+o*o+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=n*a,t[1]=r*a,t[2]=o*a,t[3]=i*a,t},bt=(rt=m(),ot=v(1,0,0),it=v(0,1,0),function(t,e,n){var r=O(e,n);return r<-.999999?(w(rt,ot,e),j(rt)<1e-6&&w(rt,it,e),function(t,e){var n=e[0],r=e[1],o=e[2],i=n*n+r*r+o*o;i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i}(rt,rt),Q(t,rt,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(w(rt,e,n),t[0]=rt[0],t[1]=rt[1],t[2]=rt[2],t[3]=1+r,gt(t,t))});at=$(),ut=$(),st=new b(9),b!=Float32Array&&(st[1]=0,st[2]=0,st[3]=0,st[5]=0,st[6]=0,st[7]=0),st[0]=1,st[4]=1,st[8]=1,ct=st;const mt=[0,0,0,1];class vt extends h{constructor(t=0,e=0,n=0,r=1){super(-0,-0,-0,-0),Array.isArray(t)&&1===arguments.length?this.copy(t):this.set(t,e,n,r)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return nt(this,t),this.check()}fromAxisRotation(t,e){return Q(this,t,e),this.check()}identity(){return function(t){t[0]=0,t[1]=0,t[2]=0,t[3]=1}(this),this.check()}setAxisAngle(t,e){return this.fromAxisRotation(t,e)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=p(t)}get y(){return this[1]}set y(t){this[1]=p(t)}get z(){return this[2]}set z(t){this[2]=p(t)}get w(){return this[3]}set w(t){this[3]=p(t)}len(){return dt(this)}lengthSquared(){return yt(this)}dot(t){return ht(this,t)}rotationTo(t,e){return bt(this,t,e),this.check()}add(t){return lt(this,this,t),this.check()}calculateW(){return function(t,e){var n=e[0],r=e[1],o=e[2];t[0]=n,t[1]=r,t[2]=o,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-o*o))}(this,this),this.check()}conjugate(){return function(t,e){t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3]}(this,this),this.check()}invert(){return function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n*n+r*r+o*o+i*i,u=a?1/a:0;t[0]=-n*u,t[1]=-r*u,t[2]=-o*u,t[3]=i*u}(this,this),this.check()}lerp(t,e,n){return void 0===n?this.lerp(this,t,e):(pt(this,t,e,n),this.check())}multiplyRight(t){return tt(this,this,t),this.check()}multiplyLeft(t){return tt(this,t,this),this.check()}normalize(){const t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}rotateX(t){return function(t,e,n){n*=.5;var r=e[0],o=e[1],i=e[2],a=e[3],u=Math.sin(n),s=Math.cos(n);t[0]=r*s+a*u,t[1]=o*s+i*u,t[2]=i*s-o*u,t[3]=a*s-r*u}(this,this,t),this.check()}rotateY(t){return function(t,e,n){n*=.5;var r=e[0],o=e[1],i=e[2],a=e[3],u=Math.sin(n),s=Math.cos(n);t[0]=r*s-i*u,t[1]=o*s+a*u,t[2]=i*s+r*u,t[3]=a*s-o*u}(this,this,t),this.check()}rotateZ(t){return function(t,e,n){n*=.5;var r=e[0],o=e[1],i=e[2],a=e[3],u=Math.sin(n),s=Math.cos(n);t[0]=r*s+o*u,t[1]=o*s-r*u,t[2]=i*s+a*u,t[3]=a*s-i*u}(this,this,t),this.check()}scale(t){return ft(this,this,t),this.check()}slerp(t,e,n){let r,o,i;switch(arguments.length){case 1:({start:r=mt,target:o,ratio:i}=t);break;case 2:r=this,o=t,i=e;break;default:r=t,o=e,i=n}return et(this,r,o,i),this.check()}transformVector4(t,e=new X){return function(t,e,n){var r=e[0],o=e[1],i=e[2],a=n[0],u=n[1],s=n[2],c=n[3],l=c*r+u*i-s*o,f=c*o+s*r-a*i,h=c*i+a*o-u*r,p=-a*r-u*o-s*i;t[0]=l*c+p*-a+f*-s-h*-u,t[1]=f*c+p*-u+h*-a-l*-s,t[2]=h*c+p*-s+l*-u-f*-a,t[3]=e[3]}(e,t,this),d(e,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,e){return this.setAxisAngle(t,e)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}}const Ot=new R,wt=new R,Pt=new R,Mt=new R,St=new R,xt=new R,jt=new R,Et=0,_t=1,kt=2,Ct=3,Rt=4,At=5,Tt=6,It=7,Dt=8;class Lt{constructor(t=[0,0,0],e=[0,0,0,0,0,0,0,0,0]){Object(a.a)(this,"center",void 0),Object(a.a)(this,"halfAxes",void 0),this.center=(new R).from(t),this.halfAxes=new G(e)}get halfSize(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new R(t).len(),new R(e).len(),new R(n).len()]}get quaternion(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),r=new R(t).normalize(),o=new R(e).normalize(),i=new R(n).normalize();return(new vt).fromMatrix3(new G([...r,...o,...i]))}fromCenterHalfSizeQuaternion(t,e,n){const r=new vt(n),o=(new G).fromQuaternion(r);return o[0]=o[0]*e[0],o[1]=o[1]*e[0],o[2]=o[2]*e[0],o[3]=o[3]*e[1],o[4]=o[4]*e[1],o[5]=o[5]*e[1],o[6]=o[6]*e[2],o[7]=o[7]*e[2],o[8]=o[8]*e[2],this.center=(new R).from(t),this.halfAxes=o,this}clone(){return new Lt(this.center,this.halfAxes)}equals(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}getBoundingSphere(t=new N){const e=this.halfAxes,n=e.getColumn(0,Pt),r=e.getColumn(1,Mt),o=e.getColumn(2,St),i=Ot.copy(n).add(r).add(o);return t.center.copy(this.center),t.radius=i.magnitude(),t}intersectPlane(t){const e=this.center,n=t.normal,a=this.halfAxes,u=n.x,s=n.y,c=n.z,l=Math.abs(u*a[Et]+s*a[_t]+c*a[kt])+Math.abs(u*a[Ct]+s*a[Rt]+c*a[At])+Math.abs(u*a[Tt]+s*a[It]+c*a[Dt]),f=n.dot(e)+t.distance;return f<=-l?r:f>=l?i:o}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){const e=wt.from(t).subtract(this.center),n=this.halfAxes,r=n.getColumn(0,Pt),o=n.getColumn(1,Mt),i=n.getColumn(2,St),a=r.magnitude(),u=o.magnitude(),s=i.magnitude();r.normalize(),o.normalize(),i.normalize();let c,l=0;return c=Math.abs(e.dot(r))-a,c>0&&(l+=c*c),c=Math.abs(e.dot(o))-u,c>0&&(l+=c*c),c=Math.abs(e.dot(i))-s,c>0&&(l+=c*c),l}computePlaneDistances(t,e,n=[-0,-0]){let r=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;const i=this.center,a=this.halfAxes,u=a.getColumn(0,Pt),s=a.getColumn(1,Mt),c=a.getColumn(2,St),l=xt.copy(u).add(s).add(c).add(i),f=jt.copy(l).subtract(t);let h=e.dot(f);return r=Math.min(h,r),o=Math.max(h,o),l.copy(i).add(u).add(s).subtract(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),o=Math.max(h,o),l.copy(i).add(u).subtract(s).add(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),o=Math.max(h,o),l.copy(i).add(u).subtract(s).subtract(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),o=Math.max(h,o),i.copy(l).subtract(u).add(s).add(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),o=Math.max(h,o),i.copy(l).subtract(u).add(s).subtract(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),o=Math.max(h,o),i.copy(l).subtract(u).subtract(s).add(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),o=Math.max(h,o),i.copy(l).subtract(u).subtract(s).subtract(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),o=Math.max(h,o),n[0]=r,n[1]=o,n}transform(t){this.center.transformAsPoint(t);const e=this.halfAxes.getColumn(0,Pt);e.transformAsPoint(t);const n=this.halfAxes.getColumn(1,Mt);n.transformAsPoint(t);const r=this.halfAxes.getColumn(2,St);return r.transformAsPoint(t),this.halfAxes=new G([...e,...n,...r]),this}getTransform(){throw new Error("not implemented")}}const Ft=new R,Nt=new R;class qt{constructor(t=[0,0,1],e=0){Object(a.a)(this,"normal",void 0),Object(a.a)(this,"distance",void 0),this.normal=new R,this.distance=-0,this.fromNormalDistance(t,e)}fromNormalDistance(t,e){return u(Number.isFinite(e)),this.normal.from(t).normalize(),this.distance=e,this}fromPointNormal(t,e){t=Ft.from(t),this.normal.from(e).normalize();const n=-this.normal.dot(t);return this.distance=n,this}fromCoefficients(t,e,n,r){return this.normal.set(t,e,n),u(f(this.normal.len(),1)),this.distance=r,this}clone(){return new qt(this.normal,this.distance)}equals(t){return f(this.distance,t.distance)&&f(this.normal,t.normal)}getPointDistance(t){return this.normal.dot(t)+this.distance}transform(t){const e=Nt.copy(this.normal).transformAsVector(t).normalize(),n=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(n,e)}projectPointOntoPlane(t,e=[0,0,0]){t=Ft.from(t);const n=this.getPointDistance(t),r=Nt.copy(this.normal).scale(n);return t.subtract(r).to(e)}}const zt=[new R([1,0,0]),new R([0,1,0]),new R([0,0,1])],Ht=new R,Wt=new R;new qt(new R(1,0,0),0);class Ut{constructor(t=[]){Object(a.a)(this,"planes",void 0),this.planes=t}fromBoundingSphere(t){this.planes.length=2*zt.length;const e=t.center,n=t.radius;let r=0;for(const t of zt){let o=this.planes[r],i=this.planes[r+1];o||(o=this.planes[r]=new qt),i||(i=this.planes[r+1]=new qt);const a=Ht.copy(t).scale(-n).add(e);t.dot(a);o.fromPointNormal(a,t);const u=Ht.copy(t).scale(n).add(e),s=Wt.copy(t).negate();s.dot(u);i.fromPointNormal(u,s),r+=2}return this}computeVisibility(t){let e=i;for(const n of this.planes){switch(t.intersectPlane(n)){case r:return r;case o:e=o}}return e}computeVisibilityWithPlaneMask(t,e){if(u(Number.isFinite(e),"parentPlaneMask is required."),e===Ut.MASK_OUTSIDE||e===Ut.MASK_INSIDE)return e;let n=Ut.MASK_INSIDE;const i=this.planes;for(let a=0;a<this.planes.length;++a){const u=a<31?1<<a:0;if(a<31&&0==(e&u))continue;const s=i[a],c=t.intersectPlane(s);if(c===r)return Ut.MASK_OUTSIDE;c===o&&(n|=u)}return n}}var Bt;Object(a.a)(Ut,"MASK_OUTSIDE",4294967295),Object(a.a)(Ut,"MASK_INSIDE",0),Object(a.a)(Ut,"MASK_INDETERMINATE",2147483647),function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"}(Bt||(Bt={}));Math.PI,Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);new R,new R,new R,new R,new R;new R,new R,new R,new R,new R,new R,new R,new R,new R,new R,new R,new R,Math.PI;var Gt=1e-15,Zt=1e-20;Math.PI,Math.PI,Math.PI,Math.PI;const Vt=new G,Jt=new G,Xt=new G,Yt=new G,Kt=new G;function $t(t,e={}){const n=Zt;let r=0,o=0;const i=Jt,a=Xt;i.identity(),a.copy(t);const u=n*function(t){let e=0;for(let n=0;n<9;++n){const r=t[n];e+=r*r}return Math.sqrt(e)}(a);for(;o<10&&ee(a)>u;)ne(a,Yt),Kt.copy(Yt).transpose(),a.multiplyRight(Yt),a.multiplyLeft(Kt),i.multiplyRight(Yt),++r>2&&(++o,r=0);return e.unitary=i.toTarget(e.unitary),e.diagonal=a.toTarget(e.diagonal),e}const Qt=[1,0,0],te=[2,2,1];function ee(t){let e=0;for(let n=0;n<3;++n){const r=t[Vt.getElementIndex(te[n],Qt[n])];e+=2*r*r}return Math.sqrt(e)}function ne(t,e){const n=Gt;let r=0,o=1;for(let e=0;e<3;++e){const n=Math.abs(t[Vt.getElementIndex(te[e],Qt[e])]);n>r&&(o=e,r=n)}const i=Qt[o],a=te[o];let u=1,s=0;if(Math.abs(t[Vt.getElementIndex(a,i)])>n){const e=(t[Vt.getElementIndex(a,a)]-t[Vt.getElementIndex(i,i)])/2/t[Vt.getElementIndex(a,i)];let n;n=e<0?-1/(-e+Math.sqrt(1+e*e)):1/(e+Math.sqrt(1+e*e)),u=1/Math.sqrt(1+n*n),s=n*u}return G.IDENTITY.to(e),e[Vt.getElementIndex(i,i)]=e[Vt.getElementIndex(a,a)]=u,e[Vt.getElementIndex(a,i)]=s,e[Vt.getElementIndex(i,a)]=-s,e}const re=new R,oe=new R,ie=new R,ae=new R,ue=new R,se=new G,ce={diagonal:new G,unitary:new G};function le(t,e=new Lt){if(!t||0===t.length)return e.halfAxes=new G([0,0,0,0,0,0,0,0,0]),e.center=new R,e;const n=t.length,r=new R(0,0,0);for(const e of t)r.add(e);const o=1/n;r.multiplyByScalar(o);let i=0,a=0,u=0,s=0,c=0,l=0;for(const e of t){const t=re.copy(e).subtract(r);i+=t.x*t.x,a+=t.x*t.y,u+=t.x*t.z,s+=t.y*t.y,c+=t.y*t.z,l+=t.z*t.z}i*=o,a*=o,u*=o,s*=o,c*=o,l*=o;const f=se;f[0]=i,f[1]=a,f[2]=u,f[3]=a,f[4]=s,f[5]=c,f[6]=u,f[7]=c,f[8]=l;const{unitary:h}=$t(f,ce),p=e.halfAxes.copy(h);let d=p.getColumn(0,ie),y=p.getColumn(1,ae),g=p.getColumn(2,ue),b=-Number.MAX_VALUE,m=-Number.MAX_VALUE,v=-Number.MAX_VALUE,O=Number.MAX_VALUE,w=Number.MAX_VALUE,P=Number.MAX_VALUE;for(const e of t)re.copy(e),b=Math.max(re.dot(d),b),m=Math.max(re.dot(y),m),v=Math.max(re.dot(g),v),O=Math.min(re.dot(d),O),w=Math.min(re.dot(y),w),P=Math.min(re.dot(g),P);d=d.multiplyByScalar(.5*(O+b)),y=y.multiplyByScalar(.5*(w+m)),g=g.multiplyByScalar(.5*(P+v)),e.center.copy(d).add(y).add(g);const M=oe.set(b-O,m-w,v-P).multiplyByScalar(.5),S=new G([M[0],0,0,0,M[1],0,0,0,M[2]]);return e.halfAxes.multiplyRight(S),e}},443:function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function u(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.TwoClickPolygonMode=void 0;var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(p,t);var e,n,r,f,h=(e=p,function(){var t,n=c(e);if(s()){var r=c(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return u(this,t)});function p(){return o(this,p),h.apply(this,arguments)}return n=p,(r=[{key:"handleClick",value:function(t,e){e.modeConfig&&e.modeConfig.dragToDraw||(this.addClickSequence(t),this.checkAndFinishPolygon(e))}},{key:"handleStartDragging",value:function(t,e){e.modeConfig&&e.modeConfig.dragToDraw&&(this.addClickSequence(t),t.cancelPan())}},{key:"handleStopDragging",value:function(t,e){e.modeConfig&&e.modeConfig.dragToDraw&&(this.addClickSequence(t),this.checkAndFinishPolygon(e))}},{key:"checkAndFinishPolygon",value:function(t){var e=this.getClickSequence(),n=this.getTentativeGuide(t);if(e.length>1&&n&&"Polygon"===n.geometry.type){var r={type:"Feature",properties:{shape:n.properties.shape},geometry:{type:"Polygon",coordinates:n.geometry.coordinates}},o=this.getAddFeatureOrBooleanPolygonAction(r,t);this.resetClickSequence(),o&&t.onEdit(o)}}},{key:"getGuides",value:function(t){var e=t.lastPointerMoveEvent,n=t.modeConfig,r=this.getClickSequence(),o={type:"FeatureCollection",features:[]};if(0===r.length)return o;var i=r[0],a=e.mapCoords,u=this.getTwoClickPolygon(i,a,n);return u&&o.features.push({type:"Feature",properties:{shape:u.properties&&u.properties.shape,guideType:"tentative"},geometry:u.geometry}),o}},{key:"getTwoClickPolygon",value:function(t,e,n){return null}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),a(c(p.prototype),"handlePointerMove",this).call(this,t,e)}},{key:"createTentativeFeature",value:function(t){var e,n=t.lastPointerMoveEvent,r=this.getClickSequence(),o=n?[n.mapCoords]:[];return 1===r.length&&(e=this.getTwoClickPolygon(r[0],o[0],t.modeConfig)),e}}])&&i(n.prototype,r),f&&i(n,f),p}(n(131).GeoJsonEditMode);e.TwoClickPolygonMode=f},494:function(t,e,n){var r=n(1596),o={};function i(t){return o[t=t||256]||(o[t]=new r({size:t})),o[t]}t.exports.viewport=function(t,e,n,r,o,a){n=void 0===n?0:n,r=void 0===r?20:r;var u=i(o),s=r,c=u.px([t[0],t[1]],s),l=u.px([t[2],t[3]],s),f=l[0]-c[0],h=c[1]-l[1],p=c[0]+f/2,d=l[1]+h/2,y=[f/e[0],h/e[1]],g=function(t,e,n){var r=Math.min(t-Math.log(e[0])/Math.log(2),t-Math.log(e[1])/Math.log(2));return n?r:Math.floor(r)}(s,y,a),b=u.ll([p,d],s),m=Math.max(n,Math.min(r,g));return{center:b,zoom:m}},t.exports.bounds=function(t,e,n,r){void 0!==t.lon&&(t=[t.lon,t.lat]);var o=i(r),a=o.px(t,e),u=o.ll([a[0]-n[0]/2,a[1]-n[1]/2],e),s=o.ll([a[0]+n[0]/2,a[1]+n[1]/2],e);return[u[0],s[1],s[0],u[1]]}},499:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(169),o=n(197);class i extends(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array)){get ELEMENTS(){return Object(o.a)(!1),0}clone(){return(new this.constructor).copy(this)}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}fromArray(t,e=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}to(t){return t===this?this:Object(r.f)(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toArray(t=[],e=0){for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(r.b)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+Object(r.e)(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!Object(r.d)(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){void 0===n&&(n=e,e=t,t=this);for(let r=0;r<this.ELEMENTS;++r){const o=t[r];this[r]=o+n*(e[r]-o)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=e[t];return this.check()}subtract(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=e[t];return this.check()}scale(t){if(Array.isArray(t))return this.multiply(t);for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.scale(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}multiplyByScalar(t){return this.scale(t)}get elements(){return this}check(){if(r.b.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}}},588:function(t,e){t.exports=function(t){if(!t||!t.type)return null;var e=n[t.type];if(!e)return null;if("geometry"===e)return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]};if("feature"===e)return{type:"FeatureCollection",features:[t]};if("featurecollection"===e)return t};var n={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"}},602:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}));n(169);function r(t,e={}){const{start:n=0,end:r=t.length}=e,o=e.size||2;let i=0;for(let e=n,a=r-o;e<r;e+=o)i+=(t[e]-t[a])*(t[e+1]+t[a+1]),a=e;return i/2}function o(t,e,n,r){n=n||2;const o=e&&e.length,s=o?e[0]*n:t.length;let c=i(t,0,s,n,!0,r&&r[0]);const l=[];if(!c||c.next===c.prev)return l;let f,d,y,b,m,v,O;if(o&&(c=function(t,e,n,r,o){const u=[];let s,c,l,f,d;for(s=0,c=e.length;s<c;s++)l=e[s]*r,f=s<c-1?e[s+1]*r:t.length,d=i(t,l,f,r,!1,o&&o[s+1]),d===d.next&&(d.steiner=!0),u.push(g(d));for(u.sort(h),s=0;s<u.length;s++)p(u[s],n),n=a(n,n.next);return n}(t,e,c,n,r)),t.length>80*n){b=d=t[0],m=y=t[1];for(let e=n;e<s;e+=n)v=t[e],O=t[e+1],v<b&&(b=v),O<m&&(m=O),v>d&&(d=v),O>y&&(y=O);f=Math.max(d-b,y-m),f=0!==f?1/f:0}return u(c,l,n,b,m,f),l}function i(t,e,n,o,i,a){let u,s;if(void 0===a&&(a=r(t,{start:e,end:n,size:o})),i===a<0)for(u=e;u<n;u+=o)s=j(u,t[u],t[u+1],s);else for(u=n-o;u>=e;u-=o)s=j(u,t[u],t[u+1],s);return s&&O(s,s.next)&&(E(s),s=s.next),s}function a(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!O(r,r.next)&&0!==v(r.prev,r,r.next))r=r.next;else{if(E(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function u(t,e,n,r,o,i,h){if(!t)return;!h&&i&&function(t,e,n,r){let o=t;do{null===o.z&&(o.z=y(o.x,o.y,e,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){let e,n,r,o,i,a,u,s,c=1;do{for(o=t,t=null,s=null,r=0;o;){for(r++,a=o,i=0,n=0;n<c&&(i++,a=a.nextZ,a);n++);for(u=c;i>0||u>0&&a;)0!==i&&(0===u||!a||o.z<=a.z)?(e=o,o=o.nextZ,i--):(e=a,a=a.nextZ,u--),s?s.nextZ=e:t=e,e.prevZ=s,s=e;o=a}s.nextZ=null,c*=2}while(r>1)}(o)}(t,r,o,i);let p,d,g=t;for(;t.prev!==t.next;)if(p=t.prev,d=t.next,i?c(t,r,o,i):s(t))e.push(p.i/n),e.push(t.i/n),e.push(d.i/n),E(t),t=d.next,g=d.next;else if((t=d)===g){h?1===h?u(t=l(a(t),e,n),e,n,r,o,i,2):2===h&&f(t,e,n,r,o,i):u(a(t),e,n,r,o,i,1);break}}function s(t){const e=t.prev,n=t,r=t.next;if(v(e,n,r)>=0)return!1;let o=t.next.next;for(;o!==t.prev;){if(b(e.x,e.y,n.x,n.y,r.x,r.y,o.x,o.y)&&v(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function c(t,e,n,r){const o=t.prev,i=t,a=t.next;if(v(o,i,a)>=0)return!1;const u=o.x<i.x?o.x<a.x?o.x:a.x:i.x<a.x?i.x:a.x,s=o.y<i.y?o.y<a.y?o.y:a.y:i.y<a.y?i.y:a.y,c=o.x>i.x?o.x>a.x?o.x:a.x:i.x>a.x?i.x:a.x,l=o.y>i.y?o.y>a.y?o.y:a.y:i.y>a.y?i.y:a.y,f=y(u,s,e,n,r),h=y(c,l,e,n,r);let p=t.prevZ,d=t.nextZ;for(;p&&p.z>=f&&d&&d.z<=h;){if(p!==t.prev&&p!==t.next&&b(o.x,o.y,i.x,i.y,a.x,a.y,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,d!==t.prev&&d!==t.next&&b(o.x,o.y,i.x,i.y,a.x,a.y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;p&&p.z>=f;){if(p!==t.prev&&p!==t.next&&b(o.x,o.y,i.x,i.y,a.x,a.y,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;d&&d.z<=h;){if(d!==t.prev&&d!==t.next&&b(o.x,o.y,i.x,i.y,a.x,a.y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function l(t,e,n){let r=t;do{const o=r.prev,i=r.next.next;!O(o,i)&&w(o,r,r.next,i)&&S(o,i)&&S(i,o)&&(e.push(o.i/n),e.push(r.i/n),e.push(i.i/n),E(r),E(r.next),r=t=i),r=r.next}while(r!==t);return a(r)}function f(t,e,n,r,o,i){let s=t;do{let t=s.next.next;for(;t!==s.prev;){if(s.i!==t.i&&m(s,t)){let c=x(s,t);return s=a(s,s.next),c=a(c,c.next),u(s,e,n,r,o,i),void u(c,e,n,r,o,i)}t=t.next}s=s.next}while(s!==t)}function h(t,e){return t.x-e.x}function p(t,e){if(e=function(t,e){let n=e;const r=t.x,o=t.y;let i,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){const t=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>a){if(a=t,t===r){if(o===n.y)return n;if(o===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(r===a)return i;const u=i,s=i.x,c=i.y;let l,f=1/0;n=i;do{r>=n.x&&n.x>=s&&r!==n.x&&b(o<c?r:a,o,s,c,o<c?a:r,o,n.x,n.y)&&(l=Math.abs(o-n.y)/(r-n.x),S(n,t)&&(l<f||l===f&&(n.x>i.x||n.x===i.x&&d(i,n)))&&(i=n,f=l)),n=n.next}while(n!==u);return i}(t,e)){const n=x(e,t);a(e,e.next),a(n,n.next)}}function d(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function y(t,e,n,r,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*o)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*o)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function g(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function b(t,e,n,r,o,i,a,u){return(o-a)*(e-u)-(t-a)*(i-u)>=0&&(t-a)*(r-u)-(n-a)*(e-u)>=0&&(n-a)*(i-u)-(o-a)*(r-u)>=0}function m(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&w(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(S(t,e)&&S(e,t)&&function(t,e){let n=t,r=!1;const o=(t.x+e.x)/2,i=(t.y+e.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&o<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||O(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function O(t,e){return t.x===e.x&&t.y===e.y}function w(t,e,n,r){const o=M(v(t,e,n)),i=M(v(t,e,r)),a=M(v(n,r,t)),u=M(v(n,r,e));return o!==i&&a!==u||(!(0!==o||!P(t,n,e))||(!(0!==i||!P(t,r,e))||(!(0!==a||!P(n,t,r))||!(0!==u||!P(n,e,r)))))}function P(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function M(t){return t>0?1:t<0?-1:0}function S(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function x(t,e){const n=new _(t.i,t.x,t.y),r=new _(e.i,e.x,e.y),o=t.next,i=e.prev;return t.next=e,e.prev=t,n.next=o,o.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function j(t,e,n,r){const o=new _(t,e,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function E(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function _(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}},61:function(t,e,n){"use strict";n.d(e,"f",(function(){return N})),n.d(e,"c",(function(){return L})),n.d(e,"m",(function(){return z})),n.d(e,"d",(function(){return U})),n.d(e,"h",(function(){return B})),n.d(e,"l",(function(){return S})),n.d(e,"p",(function(){return x})),n.d(e,"q",(function(){return I})),n.d(e,"n",(function(){return D})),n.d(e,"b",(function(){return A})),n.d(e,"e",(function(){return T})),n.d(e,"i",(function(){return j})),n.d(e,"o",(function(){return E})),n.d(e,"g",(function(){return _})),n.d(e,"a",(function(){return k})),n.d(e,"k",(function(){return C})),n.d(e,"j",(function(){return R}));n(3);var r="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var o,i;o=new r(4),r!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0,o[3]=0),i=o;function a(t,e){const n=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3];return t[0]=n[0]*r+n[4]*o+n[8]*i+n[12]*a,t[1]=n[1]*r+n[5]*o+n[9]*i+n[13]*a,t[2]=n[2]*r+n[6]*o+n[10]*i+n[14]*a,t[3]=n[3]*r+n[7]*o+n[11]*i+n[15]*a,t}([],e,t);return function(t,e,n){t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n}(n,n,1/n[3]),n}function u(t,e){const n=t%e;return n<0?e+n:n}function s(t,e,n){return t<e?e:t>n?n:t}const c=Math.log2||function(t){return Math.log(t)*Math.LOG2E};function l(t,e,n){var r,o,i,a,u,s,c,l,f,h,p,d,y=n[0],g=n[1],b=n[2];return e===t?(t[12]=e[0]*y+e[4]*g+e[8]*b+e[12],t[13]=e[1]*y+e[5]*g+e[9]*b+e[13],t[14]=e[2]*y+e[6]*g+e[10]*b+e[14],t[15]=e[3]*y+e[7]*g+e[11]*b+e[15]):(r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],c=e[6],l=e[7],f=e[8],h=e[9],p=e[10],d=e[11],t[0]=r,t[1]=o,t[2]=i,t[3]=a,t[4]=u,t[5]=s,t[6]=c,t[7]=l,t[8]=f,t[9]=h,t[10]=p,t[11]=d,t[12]=r*y+u*g+f*b+e[12],t[13]=o*y+s*g+h*b+e[13],t[14]=i*y+c*g+p*b+e[14],t[15]=a*y+l*g+d*b+e[15]),t}function f(t,e,n){var r=n[0],o=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*o,t[5]=e[5]*o,t[6]=e[6]*o,t[7]=e[7]*o,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function h(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function p(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function d(t,e,n,r){var o=e[0],i=e[1];return t[0]=o+r*(n[0]-o),t[1]=i+r*(n[1]-i),t}var y=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t};!function(){var t=function(){var t=new r(2);return r!=Float32Array&&(t[0]=0,t[1]=0),t}()}();!function(){var t=function(){var t=new r(3);return r!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}()}();function g(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const b=Math.PI,m=b/4,v=b/180,O=180/b,w=1.5;function P(t){return Math.pow(2,t)}function M(t){return c(t)}function S(t){const[e,n]=t;g(Number.isFinite(e)),g(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=n*v;return[512*(e*v+b)/(2*b),512*(b+Math.log(Math.tan(m+.5*r)))/(2*b)]}function x(t){const[e,n]=t,r=e/512*(2*b)-b,o=2*(Math.atan(Math.exp(n/512*(2*b)-b))-m);return[r*O,o*O]}function j(t){const{latitude:e}=t;g(Number.isFinite(e));return M(4003e4*Math.cos(e*v))-9}function E(t){return 512/4003e4/Math.cos(t*v)}function _(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;g(Number.isFinite(e)&&Number.isFinite(n));const o=Math.cos(e*v),i=512/360/o,a=512/4003e4/o,u={unitsPerMeter:[a,a,a],metersPerUnit:[1/a,1/a,1/a],unitsPerDegree:[512/360,i,a],degreesPerUnit:[.703125,1/i,1/a]};if(r){const t=v*Math.tan(e*v)/o,n=512/360*t/2,r=512/4003e4*t,s=r/i*a;u.unitsPerDegree2=[0,n,r],u.unitsPerMeter2=[s,0,s]}return u}function k(t,e){const[n,r,o]=t,[i,a,u]=e,{unitsPerMeter:s,unitsPerMeter2:c}=_({longitude:n,latitude:r,highPrecision:!0}),l=S(t);l[0]+=i*(s[0]+c[0]*a),l[1]+=a*(s[1]+c[1]*a);const f=x(l),h=(o||0)+(u||0);return Number.isFinite(o)||Number.isFinite(u)?[f[0],f[1],h]:f}function C(t){const{height:e,pitch:n,bearing:r,altitude:o,scale:i,center:a}=t,u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];l(u,u,[0,0,-o]),function(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[4],a=e[5],u=e[6],s=e[7],c=e[8],l=e[9],f=e[10],h=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*o+c*r,t[5]=a*o+l*r,t[6]=u*o+f*r,t[7]=s*o+h*r,t[8]=c*o-i*r,t[9]=l*o-a*r,t[10]=f*o-u*r,t[11]=h*o-s*r}(u,u,-n*v),function(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[0],a=e[1],u=e[2],s=e[3],c=e[4],l=e[5],f=e[6],h=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*o+c*r,t[1]=a*o+l*r,t[2]=u*o+f*r,t[3]=s*o+h*r,t[4]=c*o-i*r,t[5]=l*o-a*r,t[6]=f*o-u*r,t[7]=h*o-s*r}(u,u,r*v);const s=i/e;return f(u,u,[s,s,s]),a&&l(u,u,function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}([],a)),u}function R(t){const{width:e,height:n,altitude:r,pitch:o=0,offset:i,center:a,scale:u,nearZMultiplier:c=1,farZMultiplier:l=1}=t;let{fovy:f=A(w)}=t;void 0!==r&&(f=A(r));const h=f*v,p=o*v,d=T(f);let y=d;a&&(y+=a[2]*u/Math.cos(p)/n);const g=h*(.5+(i?i[1]:0)/n),b=Math.sin(g)*y/Math.sin(s(Math.PI/2-p-g,.01,Math.PI-.01)),m=Math.sin(p)*b+y,O=10*y;return{fov:h,aspect:e/n,focalDistance:d,near:c,far:Math.min(m*l,O)}}function A(t){return 2*Math.atan(.5/t)*O}function T(t){return.5/Math.tan(.5*t*v)}function I(t,e){const[n,r,o=0]=t;return g(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(o)),a(e,[n,r,o,1])}function D(t,e,n=0){const[r,o,i]=t;if(g(Number.isFinite(r)&&Number.isFinite(o),"invalid pixel coordinate"),Number.isFinite(i)){return a(e,[r,o,i,1])}const u=a(e,[r,o,0,1]),s=a(e,[r,o,1,1]),c=u[2],l=s[2];return d([],u,s,c===l?0:((n||0)-c)/(l-c))}function L(t){const{width:e,height:n,bounds:r,minExtent:o=0,maxZoom:i=24,offset:a=[0,0]}=t,[[u,l],[f,h]]=r,p=function(t=0){if("number"==typeof t)return{top:t,bottom:t,left:t,right:t};return g(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t}(t.padding),d=S([u,s(h,-85.051129,85.051129)]),y=S([f,s(l,-85.051129,85.051129)]),b=[Math.max(Math.abs(y[0]-d[0]),o),Math.max(Math.abs(y[1]-d[1]),o)],m=[e-p.left-p.right-2*Math.abs(a[0]),n-p.top-p.bottom-2*Math.abs(a[1])];g(m[0]>0&&m[1]>0);const v=m[0]/b[0],O=m[1]/b[1],w=(p.right-p.left)/2/v,P=(p.top-p.bottom)/2/O,M=x([(y[0]+d[0])/2+w,(y[1]+d[1])/2+P]),j=Math.min(i,c(Math.abs(Math.min(v,O))));return g(Number.isFinite(j)),{longitude:M[0],latitude:M[1],zoom:j}}const F=Math.PI/180;function N(t,e=0){const{width:n,height:r,unproject:o}=t,i={targetZ:e},a=o([0,r],i),u=o([n,r],i);let s,c;return(t.fovy?.5*t.fovy*F:Math.atan(.5/t.altitude))>(90-t.pitch)*F-.01?(s=q(t,0,e),c=q(t,n,e)):(s=o([0,0],i),c=o([n,0],i)),[a,u,c,s]}function q(t,e,n){const{pixelUnprojectionMatrix:r}=t,o=a(r,[e,0,1,1]),i=a(r,[e,t.height,1,1]),u=x(d([],o,i,(n*t.distanceScales.unitsPerMeter[2]-o[2])/(i[2]-o[2])));return u.push(n),u}function z(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:o,latitude:i,zoom:a,bearing:s=0}=t;(o<-180||o>180)&&(o=u(o+180,360)-180),(s<-180||s>180)&&(s=u(s+180,360)-180);const l=c(n/512);if(a<=l)a=l,i=0;else{const t=n/2/Math.pow(2,a),e=x([0,t])[1];if(i<e)i=e;else{const e=x([0,512-t])[1];i>e&&(i=e)}}return{width:e,height:n,longitude:o,latitude:i,zoom:a,pitch:r,bearing:s}}const H=["longitude","latitude","zoom"],W={curve:1.414,speed:1.2};function U(t,e,n,r){const{startZoom:o,startCenterXY:i,uDelta:a,w0:u,u1:s,S:c,rho:l,rho2:f,r0:p}=G(t,e,r);if(s<.01){const r={};for(const o of H){const i=t[o],a=e[o];r[o]=(d=n)*a+(1-d)*i}return r}var d;const y=n*c,g=Math.cosh(p)/Math.cosh(p+l*y),b=u*((Math.cosh(p)*Math.tanh(p+l*y)-Math.sinh(p))/f)/s,m=o+M(1/g),v=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}([],a,b);h(v,v,i);const O=x(v);return{longitude:O[0],latitude:O[1],zoom:m}}function B(t,e,n){const r={...W,...n},{screenSpeed:o,speed:i,maxDuration:a}=r,{S:u,rho:s}=G(t,e,r),c=1e3*u;let l;return l=Number.isFinite(o)?c/(o/s):c/i,Number.isFinite(a)&&l>a?0:l}function G(t,e,n){const r=(n=Object.assign({},W,n)).curve,o=t.zoom,i=[t.longitude,t.latitude],a=P(o),u=e.zoom,s=[e.longitude,e.latitude],c=P(u-o),l=S(i),f=S(s),h=y([],f,l),d=Math.max(t.width,t.height),g=d/c,b=p(h)*a,m=Math.max(b,.01),v=r*r,O=(g*g-d*d+v*v*m*m)/(2*d*v*m),w=(g*g-d*d-v*v*m*m)/(2*g*v*m),M=Math.log(Math.sqrt(O*O+1)-O),x=Math.log(Math.sqrt(w*w+1)-w);return{startZoom:o,startCenterXY:l,uDelta:h,w0:d,u1:b,S:(x-M)/r,rho:r,rho2:v,r0:M,r1:x}}},637:function(t,e,n){"use strict";t.exports={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"}},782:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(499),o=n(83),i=n(197);class a extends r.a{get ELEMENTS(){return Object(i.a)(!1),0}copy(t){return Object(i.a)(!1),this}get x(){return this[0]}set x(t){this[0]=Object(o.a)(t)}get y(){return this[1]}set y(t){this[1]=Object(o.a)(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const r=this[n]-t[n];e+=r*r}return Object(o.a)(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return Object(o.a)(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e[t];return this.check()}divide(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return Object(i.a)(t>=0&&t<this.ELEMENTS,"index is out of range"),Object(o.a)(this[t])}setComponent(t,e){return Object(i.a)(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}},783:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(499),o=n(83),i=n(169),a=n(197);class u extends r.a{get ELEMENTS(){return Object(a.a)(!1),0}get RANK(){return Object(a.a)(!1),0}toString(){let t="[";if(i.b.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=Object(o.a)(n),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)e[t]=this[n+t];return e}setColumn(t,e){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)this[n+t]=e[t];return this}}},83:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return u}));var r=n(169);function o(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function i(t,e,n=""){if(r.b.debug&&!function(t,e){if(t.length!==e)return!1;for(let e=0;e<t.length;++e)if(!Number.isFinite(t[e]))return!1;return!0}(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}const a={};function u(t,e){a[t]||(a[t]=!0,console.warn("".concat(t," has been removed in version ").concat(e,", see upgrade guide for more information")))}},840:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(99),o=n(277),i=n(847),a=s(n(1175)),u=s(n(1642));function s(t){return t&&t.__esModule?t:{default:t}}function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function f(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function y(t,e,n){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=m(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function g(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function O(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var w=[0,0,0,153],P=[0,0,0,144],M=[0,0,0,255],S=[0,0,144,144],x=[144,144,144,255],j=[144,144,144,144],E=[192,0,0,255],_=[0,0,0,128],k=[124,0,192,255],C=[255,255,255,255],R=32*i.PROJECTED_PIXEL_SIZE_MULTIPLIER,A=o.DrawPolygonMode;function T(t){return t&&"function"==typeof t?function(e){return t(function(t){if(t.__source)return t.__source.object;if(t.sourceFeature)return t.sourceFeature.feature;return t}(e))}:t}function I(t){switch(t.properties.editHandleType){case"existing":return E;case"snap-source":return k;case"intermediate":default:return _}}var D={mode:A,onEdit:function(){},pickable:!0,pickingRadius:10,pickingDepth:5,fp64:!1,filled:!0,stroked:!0,lineWidthScale:i.PROJECTED_PIXEL_SIZE_MULTIPLIER,lineWidthMinPixels:1,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,pickingLineWidthExtraPixels:0,lineWidthUnits:"pixels",lineJointRounded:!1,lineCapRounded:!1,lineMiterLimit:4,pointRadiusScale:1,pointRadiusMinPixels:2,pointRadiusMaxPixels:Number.MAX_SAFE_INTEGER,getLineColor:function(t,e,n){return e?M:w},getFillColor:function(t,e,n){return e?S:P},getRadius:function(t){return t&&t.properties&&t.properties.radius||t&&t.properties&&t.properties.size||1},getLineWidth:function(t){return t&&t.properties&&t.properties.lineWidth||3},getTentativeLineColor:function(t){return x},getTentativeFillColor:function(t){return j},getTentativeLineWidth:function(t){return t&&t.properties&&t.properties.lineWidth||3},editHandleType:"point",editHandlePointRadiusScale:1,editHandlePointOutline:!0,editHandlePointStrokeWidth:2,editHandlePointRadiusUnits:"pixels",editHandlePointRadiusMinPixels:4,editHandlePointRadiusMaxPixels:8,getEditHandlePointColor:I,getEditHandlePointOutlineColor:function(t){return C},getEditHandlePointRadius:function(t){switch(t.properties.editHandleType){case"existing":return 5;case"snap":return 7;case"intermediate":default:return 3}},editHandleIconAtlas:null,editHandleIconMapping:null,editHandleIconSizeScale:1,editHandleIconSizeUnits:"pixels",getEditHandleIcon:function(t){return t.properties.editHandleType},getEditHandleIconSize:10,getEditHandleIconColor:I,getEditHandleIconAngle:0,billboard:!0},L={view:o.ViewMode,modify:o.ModifyMode,translate:new o.SnappableMode(new o.TranslateMode),transform:new o.SnappableMode(new o.TransformMode),scale:o.ScaleMode,rotate:o.RotateMode,duplicate:o.DuplicateMode,split:o.SplitPolygonMode,extrude:o.ExtrudeMode,elevation:o.ElevationMode,drawPoint:o.DrawPointMode,drawLineString:o.DrawLineStringMode,drawPolygon:o.DrawPolygonMode,drawRectangle:o.DrawRectangleMode,drawRectangleFromCenter:o.DrawRectangleFromCenterMode,drawSquareFromCenter:o.DrawSquareFromCenterMode,drawCircleFromCenter:o.DrawCircleFromCenterMode,drawCircleByBoundingBox:o.DrawCircleByDiameterMode,drawEllipseByBoundingBox:o.DrawEllipseByBoundingBoxMode,drawRectangleUsing3Points:o.DrawRectangleUsingThreePointsMode,drawEllipseUsing3Points:o.DrawEllipseUsingThreePointsMode,draw90DegreePolygon:o.Draw90DegreePolygonMode,drawPolygonByDragging:o.DrawPolygonByDraggingMode},F=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(s,t);var e,n,o,i,a=(e=s,function(){var t,n=m(e);if(b()){var r=m(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return g(this,t)});function s(){return p(this,s),a.apply(this,arguments)}return n=s,(o=[{key:"renderLayers",value:function(){var t=this.getSubLayerProps({id:"geojson",data:this.props.data,fp64:this.props.fp64,filled:this.props.filled,stroked:this.props.stroked,lineWidthScale:this.props.lineWidthScale,lineWidthMinPixels:this.props.lineWidthMinPixels,lineWidthMaxPixels:this.props.lineWidthMaxPixels,lineWidthUnits:this.props.lineWidthUnits,lineJointRounded:this.props.lineJointRounded,lineCapRounded:this.props.lineCapRounded,lineMiterLimit:this.props.lineMiterLimit,pointRadiusScale:this.props.pointRadiusScale,pointRadiusMinPixels:this.props.pointRadiusMinPixels,pointRadiusMaxPixels:this.props.pointRadiusMaxPixels,getLineColor:this.selectionAwareAccessor(this.props.getLineColor),getFillColor:this.selectionAwareAccessor(this.props.getFillColor),getPointRadius:this.selectionAwareAccessor(this.props.getRadius),getLineWidth:this.selectionAwareAccessor(this.props.getLineWidth),_subLayerProps:{linestrings:{billboard:this.props.billboard,updateTriggers:{all:[this.props.selectedFeatureIndexes,this.props.mode]}},"polygons-stroke":{billboard:this.props.billboard,pickingLineWidthExtraPixels:this.props.pickingLineWidthExtraPixels,type:u.default,updateTriggers:{all:[this.props.selectedFeatureIndexes,this.props.mode]}}},updateTriggers:{getLineColor:[this.props.selectedFeatureIndexes,this.props.mode],getFillColor:[this.props.selectedFeatureIndexes,this.props.mode],getPointRadius:[this.props.selectedFeatureIndexes,this.props.mode],getLineWidth:[this.props.selectedFeatureIndexes,this.props.mode]}}),e=[new r.GeoJsonLayer(t)];return e=e.concat(this.createGuidesLayers(),this.createTooltipsLayers())}},{key:"initializeState",value:function(){y(m(s.prototype),"initializeState",this).call(this),this.setState({selectedFeatures:[],editHandles:[]})}},{key:"shouldUpdateState",value:function(t){return y(m(s.prototype),"shouldUpdateState",this).call(this,t)||t.changeFlags.stateChanged}},{key:"updateState",value:function(t){var e,n=t.props,r=t.oldProps,o=t.changeFlags,i=t.context;(y(m(s.prototype),"updateState",this).call(this,{oldProps:r,props:n,changeFlags:o,context:i}),!o.propsOrDataChanged||0!==Object.keys(r).length&&n.mode===r.mode)||("function"==typeof n.mode?e=new(0,n.mode):"string"==typeof n.mode?(e=L[n.mode],console.warn("Deprecated use of passing `mode` as a string. Pass the mode's class constructor instead.")):e=n.mode,e||(console.warn("No mode configured for ".concat(String(n.mode))),e=new A),e!==this.state.mode&&this.setState({mode:e,cursor:null}));var a=[];Array.isArray(n.selectedFeatureIndexes)&&(a=n.selectedFeatureIndexes.map((function(t){return n.data.features[t]}))),this.setState({selectedFeatures:a})}},{key:"getModeProps",value:function(t){var e=this;return{modeConfig:t.modeConfig,data:t.data,selectedIndexes:t.selectedFeatureIndexes,lastPointerMoveEvent:this.state.lastPointerMoveEvent,cursor:this.state.cursor,onEdit:function(n){e.setNeedsUpdate(),t.onEdit(n)},onUpdateCursor:function(t){e.setState({cursor:t})}}}},{key:"selectionAwareAccessor",value:function(t){var e=this;return"function"!=typeof t?t:function(n){return t(n,e.isFeatureSelected(n),e.props.mode)}}},{key:"isFeatureSelected",value:function(t){if(!this.props.data||!this.props.selectedFeatureIndexes)return!1;if(!this.props.selectedFeatureIndexes.length)return!1;var e=this.props.data.features.indexOf(t);return this.props.selectedFeatureIndexes.includes(e)}},{key:"getPickingInfo",value:function(t){var e=t.info;return t.sourceLayer.id.endsWith("guides")&&(e.isGuide=!0),e}},{key:"_updateAutoHighlight",value:function(t){if(null==t?void 0:t.sourceLayer)if(t.isGuide){var e,n=f(t.sourceLayer.getSubLayers());try{for(n.s();!(e=n.n()).done;)e.value.updateAutoHighlight(t)}catch(t){n.e(t)}finally{n.f()}}else t.sourceLayer.updateAutoHighlight(t)}},{key:"createGuidesLayers",value:function(){var t=this.getActiveMode().getGuides(this.getModeProps(this.props));if(!t||!t.features.length)return[];var e={linestrings:{billboard:this.props.billboard,autoHighlight:!1},"polygons-fill":{autoHighlight:!1},"polygons-stroke":{billboard:this.props.billboard}};return"icon"===this.props.editHandleType?e["points-icon"]={type:r.IconLayer,iconAtlas:this.props.editHandleIconAtlas,iconMapping:this.props.editHandleIconMapping,sizeUnits:this.props.editHandleIconSizeUnits,sizeScale:this.props.editHandleIconSizeScale,getIcon:T(this.props.getEditHandleIcon),getSize:T(this.props.getEditHandleIconSize),getColor:T(this.props.getEditHandleIconColor),getAngle:T(this.props.getEditHandleIconAngle)}:e["points-circle"]={type:r.ScatterplotLayer,radiusScale:this.props.editHandlePointRadiusScale,stroked:this.props.editHandlePointOutline,getLineWidth:this.props.editHandlePointStrokeWidth,radiusUnits:this.props.editHandlePointRadiusUnits,radiusMinPixels:this.props.editHandlePointRadiusMinPixels,radiusMaxPixels:this.props.editHandlePointRadiusMaxPixels,getRadius:T(this.props.getEditHandlePointRadius),getFillColor:T(this.props.getEditHandlePointColor),getLineColor:T(this.props.getEditHandlePointOutlineColor)},[new r.GeoJsonLayer(this.getSubLayerProps({id:"guides",data:t,fp64:this.props.fp64,_subLayerProps:e,lineWidthScale:this.props.lineWidthScale,lineWidthMinPixels:this.props.lineWidthMinPixels,lineWidthMaxPixels:this.props.lineWidthMaxPixels,lineWidthUnits:this.props.lineWidthUnits,lineJointRounded:this.props.lineJointRounded,lineCapRounded:this.props.lineCapRounded,lineMiterLimit:this.props.lineMiterLimit,getLineColor:T(this.props.getTentativeLineColor),getLineWidth:T(this.props.getTentativeLineWidth),getFillColor:T(this.props.getTentativeFillColor),pointType:"icon"===this.props.editHandleType?"icon":"circle",iconAtlas:this.props.editHandleIconAtlas}))]}},{key:"createTooltipsLayers",value:function(){var t=this.getActiveMode().getTooltips(this.getModeProps(this.props));return[new r.TextLayer(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){O(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({getSize:R},this.getSubLayerProps({id:"tooltips",data:t})))]}},{key:"onLayerClick",value:function(t){this.getActiveMode().handleClick(t,this.getModeProps(this.props))}},{key:"onLayerKeyUp",value:function(t){this.getActiveMode().handleKeyUp(t,this.getModeProps(this.props))}},{key:"onStartDragging",value:function(t){this.getActiveMode().handleStartDragging(t,this.getModeProps(this.props))}},{key:"onDragging",value:function(t){this.getActiveMode().handleDragging(t,this.getModeProps(this.props))}},{key:"onStopDragging",value:function(t){this.getActiveMode().handleStopDragging(t,this.getModeProps(this.props))}},{key:"onPointerMove",value:function(t){this.setState({lastPointerMoveEvent:t}),this.getActiveMode().handlePointerMove(t,this.getModeProps(this.props))}},{key:"getCursor",value:function(t){var e=t.isDragging;if(null===this.state)return null;var n=this.state.cursor;return n||(n=e?"grabbing":"grab"),n}},{key:"getActiveMode",value:function(){return this.state.mode}}])&&d(n.prototype,o),i&&d(n,i),s}(a.default);e.default=F,O(F,"layerName","EditableGeoJsonLayer"),O(F,"defaultProps",D)},842:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ModifyMode=void 0;var r=n(30),o=n(172),i=n(131),a=n(264);function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(b,t);var e,n,i,u,l=(e=b,function(){var t,n=y(e);if(d()){var r=y(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return p(this,t)});function b(){return f(this,b),l.apply(this,arguments)}return n=b,(i=[{key:"getGuides",value:function(t){var e,n=this,i=[],a=t.data,u=t.lastPointerMoveEvent,l=a.features,f=u&&u.picks,h=u&&u.mapCoords,p=function(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=c(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}(t.selectedIndexes);try{for(p.s();!(e=p.n()).done;){var d=e.value;if(d<l.length){var y=l[d].geometry;i.push.apply(i,s((0,o.getEditHandlesForGeometry)(y,d)))}else console.warn("selectedFeatureIndexes out of range ".concat(d))}}catch(t){p.e(t)}finally{p.f()}if(f&&f.length&&h){var g,b=!(0,o.getPickedExistingEditHandle)(f)&&f.find((function(t){return!t.isGuide}));if(b&&!b.object.geometry.type.includes("Point")&&(!(null===(g=t.modeConfig)||void 0===g?void 0:g.lockRectangles)||"Rectangle"!==b.object.properties.shape)&&t.selectedIndexes.includes(b.index)){var m=null,v=[],O=(0,r.point)(h);if((0,o.recursivelyTraverseNestedArrays)(b.object.geometry.coordinates,[],(function(e,o){var i=(0,r.lineString)(e),a=n.getNearestPoint(i,O,t.modeConfig&&t.modeConfig.viewport);(!m||a.properties.dist<m.properties.dist)&&(m=a,v=o)})),m){var w=m,P=w.geometry.coordinates,M=w.properties.index;i.push({type:"Feature",properties:{guideType:"editHandle",editHandleType:"intermediate",featureIndex:b.index,positionIndexes:[].concat(s(v),[M+1])},geometry:{type:"Point",coordinates:P}})}}}return{type:"FeatureCollection",features:i}}},{key:"getNearestPoint",value:function(t,e,n){if(t.geometry.coordinates.some((function(t){return t.length>2}))){if(n)return(0,o.nearestPointOnProjectedLine)(t,e,n);console.log("Editing 3D point but modeConfig.viewport not provided. Falling back to 2D logic.")}return(0,o.nearestPointOnLine)(t,e,n)}},{key:"handleClick",value:function(t,e){var n=(0,o.getPickedExistingEditHandle)(t.picks),r=(0,o.getPickedIntermediateEditHandle)(t.picks);if(n){var i,u=n.properties,s=u.featureIndex,c=u.positionIndexes;try{i=new a.ImmutableFeatureCollection(e.data).removePosition(s,c).getObject()}catch(t){}i&&e.onEdit({updatedData:i,editType:"removePosition",editContext:{featureIndexes:[s],positionIndexes:c,position:n.geometry.coordinates}})}else if(r){var l,f=r.properties,h=f.featureIndex,p=f.positionIndexes,d=e.data.features[h];if(!(null===(l=e.modeConfig)||void 0===l?void 0:l.lockRectangles)||"Rectangle"!==(null==d?void 0:d.properties.shape)){var y=new a.ImmutableFeatureCollection(e.data).addPosition(h,p,r.geometry.coordinates).getObject();y&&e.onEdit({updatedData:y,editType:"addPosition",editContext:{featureIndexes:[h],positionIndexes:p,position:r.geometry.coordinates}})}}}},{key:"handleDragging",value:function(t,e){var n=(0,o.getPickedEditHandle)(t.pointerDownPicks);n&&(t.cancelPan(),this._dragEditHandle("movePosition",e,n,t))}},{key:"_dragEditHandle",value:function(t,e,n,r){var i,u,s=n.properties,c=e.data.features[s.featureIndex];if((null===(i=e.modeConfig)||void 0===i?void 0:i.lockRectangles)&&"Rectangle"===c.properties.shape){var l=(0,o.updateRectanglePosition)(c,s.positionIndexes[1],r.mapCoords);u=new a.ImmutableFeatureCollection(e.data).replaceGeometry(s.featureIndex,{coordinates:l,type:"Polygon"}).getObject()}else u=new a.ImmutableFeatureCollection(e.data).replacePosition(s.featureIndex,s.positionIndexes,r.mapCoords).getObject();e.onEdit({updatedData:u,editType:t,editContext:{featureIndexes:[s.featureIndex],positionIndexes:s.positionIndexes,position:r.mapCoords}})}},{key:"handlePointerMove",value:function(t,e){var n=this.getCursor(t);e.onUpdateCursor(n)}},{key:"handleStartDragging",value:function(t,e){var n=e.selectedIndexes,r=(0,o.getPickedIntermediateEditHandle)(t.picks);if(n.length&&r){var i=r.properties,u=new a.ImmutableFeatureCollection(e.data).addPosition(i.featureIndex,i.positionIndexes,t.mapCoords).getObject();e.onEdit({updatedData:u,editType:"addPosition",editContext:{featureIndexes:[i.featureIndex],positionIndexes:i.positionIndexes,position:t.mapCoords}})}}},{key:"handleStopDragging",value:function(t,e){var n=e.selectedIndexes,r=(0,o.getPickedEditHandle)(t.picks);n.length&&r&&this._dragEditHandle("finishMovePosition",e,r,t)}},{key:"getCursor",value:function(t){var e=t&&t.picks||[];return(0,o.getPickedEditHandles)(e).length?"cell":null}}])&&h(n.prototype,i),u&&h(n,u),b}(i.GeoJsonEditMode);e.ModifyMode=b},844:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TranslateMode=void 0;var r=f(n(205)),o=f(n(132)),i=f(n(1614)),a=n(30),u=f(n(1374)),s=n(172),c=n(131),l=n(264);function f(t){return t&&t.__esModule?t:{default:t}}function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function y(t,e){return!e||"object"!==h(e)&&"function"!=typeof e?g(t):e}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function O(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(w,t);var e,n,c,f,h=(e=w,function(){var t,n=m(e);if(b()){var r=m(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return y(this,t)});function w(){var t;p(this,w);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return O(g(t=h.call.apply(h,[this].concat(n))),"_geometryBeforeTranslate",void 0),O(g(t),"_isTranslatable",void 0),t}return n=w,(c=[{key:"handleDragging",value:function(t,e){if(this._isTranslatable){if(this._geometryBeforeTranslate){var n=this.getTranslateAction(t.pointerDownMapCoords,t.mapCoords,"translating",e);n&&e.onEdit(n)}t.cancelPan()}}},{key:"handlePointerMove",value:function(t,e){this._isTranslatable=this.isSelectionPicked(t.pointerDownPicks||t.picks,e),this.updateCursor(e)}},{key:"handleStartDragging",value:function(t,e){this._isTranslatable&&(this._geometryBeforeTranslate=this.getSelectedFeaturesAsFeatureCollection(e))}},{key:"handleStopDragging",value:function(t,e){if(this._geometryBeforeTranslate){var n=this.getTranslateAction(t.pointerDownMapCoords,t.mapCoords,"translated",e);n&&e.onEdit(n),this._geometryBeforeTranslate=null}}},{key:"updateCursor",value:function(t){this._isTranslatable?t.onUpdateCursor("move"):t.onUpdateCursor(null)}},{key:"getTranslateAction",value:function(t,e,n,c){var f=this;if(!this._geometryBeforeTranslate)return null;var h=new l.ImmutableFeatureCollection(c.data),p=c.selectedIndexes,d=c.modeConfig||{},y=d.viewport,g=d.screenSpace;if(y&&g)!function(){for(var n=y.project?y:new u.default(y),r=n.project(t),o=n.project(e),i=o[0]-r[0],a=o[1]-r[1],c=0;c<p.length;c++){var l=p[c],d=f._geometryBeforeTranslate.features[c],g=d.geometry.coordinates;g&&(g=(0,s.mapCoords)(g,(function(t){var e=n.project(t);return e?(e[0]+=i,e[1]+=a,n.unproject(e)):null})),h=h.replaceGeometry(l,{type:d.geometry.type,coordinates:g}))}}();else for(var b=(0,a.point)(t),m=(0,a.point)(e),v=(0,o.default)(b,m),O=(0,r.default)(b,m),w=(0,i.default)(this._geometryBeforeTranslate,v,O),P=0;P<p.length;P++){var M=p[P],S=w.features[P];h=h.replaceGeometry(M,S.geometry)}return{updatedData:h.getObject(),editType:n,editContext:{featureIndexes:p}}}}])&&d(n.prototype,c),f&&d(n,f),w}(c.GeoJsonEditMode);e.TranslateMode=w},846:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPolygonMode=void 0;var r=n(172);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function l(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(y,t);var e,n,o,a,d=(e=y,function(){var t,n=h(e);if(f()){var r=h(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return l(this,t)});function y(){return u(this,y),d.apply(this,arguments)}return n=y,(o=[{key:"createTentativeFeature",value:function(t){var e,n=t.lastPointerMoveEvent,r=this.getClickSequence(),o=n?[n.mapCoords]:[];return 1===r.length||2===r.length?e={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(i(r),o)}}:r.length>2&&(e={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"Polygon",coordinates:[[].concat(i(r),o,[r[0]])]}}),e}},{key:"getGuides",value:function(t){var e,n=this.getClickSequence(),r={type:"FeatureCollection",features:[]},o=this.createTentativeFeature(t);o&&r.features.push(o);var a=n.map((function(t,e){return{type:"Feature",properties:{guideType:"editHandle",editHandleType:"existing",featureIndex:-1,positionIndexes:[e]},geometry:{type:"Point",coordinates:t}}}));return(e=r.features).push.apply(e,i(a)),r}},{key:"handleClick",value:function(t,e){var n=t.picks,o=(0,r.getPickedEditHandle)(n),a=!1;o||(this.addClickSequence(t),a=!0);var u=this.getClickSequence();if(u.length>2&&o&&Array.isArray(o.properties.positionIndexes)&&(0===o.properties.positionIndexes[0]||o.properties.positionIndexes[0]===u.length-1)){var s={type:"Polygon",coordinates:[[].concat(i(u),[u[0]])]};this.resetClickSequence();var c=this.getAddFeatureOrBooleanPolygonAction(s,e);c&&e.onEdit(c)}else a&&e.onEdit({updatedData:e.data,editType:"addTentativePosition",editContext:{position:t.mapCoords}})}},{key:"handleKeyUp",value:function(t,e){if("Enter"===t.key){var n=this.getClickSequence();if(n.length>2){var r={type:"Polygon",coordinates:[[].concat(i(n),[n[0]])]};this.resetClickSequence();var o=this.getAddFeatureOrBooleanPolygonAction(r,e);o&&e.onEdit(o)}}}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),c(h(y.prototype),"handlePointerMove",this).call(this,t,e)}}])&&s(n.prototype,o),a&&s(n,a),y}(n(131).GeoJsonEditMode);e.DrawPolygonMode=d},847:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UNIT=e.PROJECTED_PIXEL_SIZE_MULTIPLIER=void 0;e.PROJECTED_PIXEL_SIZE_MULTIPLIER=2/3;e.UNIT={common:0,meters:1,pixels:2}},931:function(t,e,n){"use strict";var r=n(387),o=n(1875),i=n(1878),a=n(1879),u=n(1881),s={},c=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];s.forwardGeocode=function(t){o.assertShape({query:o.required(o.string),mode:o.oneOf("mapbox.places","mapbox.places-permanent"),countries:o.arrayOf(o.string),proximity:o.oneOf(o.coordinates,"ip"),types:o.arrayOf(o.oneOf(c)),autocomplete:o.boolean,bbox:o.arrayOf(o.number),limit:o.number,language:o.arrayOf(o.string),routing:o.boolean,fuzzyMatch:o.boolean,worldview:o.string})(t),t.mode=t.mode||"mapbox.places";var e=a(r({country:t.countries},i(t,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:i(t,["mode","query"]),query:e})},s.reverseGeocode=function(t){o.assertShape({query:o.required(o.coordinates),mode:o.oneOf("mapbox.places","mapbox.places-permanent"),countries:o.arrayOf(o.string),types:o.arrayOf(o.oneOf(c)),bbox:o.arrayOf(o.number),limit:o.number,language:o.arrayOf(o.string),reverseMode:o.oneOf("distance","score"),routing:o.boolean,worldview:o.string})(t),t.mode=t.mode||"mapbox.places";var e=a(r({country:t.countries},i(t,["country","types","bbox","limit","language","reverseMode","routing","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:i(t,["mode","query"]),query:e})},t.exports=u(s)},954:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));const r=Math.PI/180,o=23.4397*r;function i(t,e,n){const o=r*-n,i=r*e,a=function(t){return function(t){return("number"==typeof t?t:t.getTime())/864e5-.5+2440588}(t)-2451545}(t),f=function(t){const e=function(t){const e=t,n=r*(1.9148*Math.sin(e)+.02*Math.sin(2*e)+3e-4*Math.sin(3*e));return e+n+102.9372*r+Math.PI}((n=t,r*(357.5291+.98560028*n)));var n;return{declination:s(e,0),rightAscension:u(e,0)}}(a),h=function(t,e){return r*(280.147+360.9856235*t)-e}(a,o)-f.rightAscension;return{azimuth:c(h,i,f.declination),altitude:l(h,i,f.declination)}}function a(t,e,n){const{azimuth:r,altitude:o}=i(t,e,n);return[Math.sin(r)*Math.cos(o),Math.cos(r)*Math.cos(o),-Math.sin(o)]}function u(t,e){const n=t;return Math.atan2(Math.sin(n)*Math.cos(o)-Math.tan(e)*Math.sin(o),Math.cos(n))}function s(t,e){const n=t;return Math.asin(Math.sin(e)*Math.cos(o)+Math.cos(e)*Math.sin(o)*Math.sin(n))}function c(t,e,n){const r=t,o=e,i=n;return Math.atan2(Math.sin(r),Math.cos(r)*Math.sin(o)-Math.tan(i)*Math.cos(o))}function l(t,e,n){const r=t,o=e,i=n;return Math.asin(Math.sin(o)*Math.sin(i)+Math.cos(o)*Math.cos(i)*Math.cos(r))}},957:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(782),o=n(169),i=n(83),a=n(64),u=n(283);const s=[0,0,0],c={};class l extends r.a{static get ZERO(){return c.ZERO=c.ZERO||Object.freeze(new l(0,0,0,0))}constructor(t=0,e=0,n=0){super(-0,-0,-0),1===arguments.length&&Object(o.f)(t)?this.copy(t):(o.b.debug&&(Object(i.a)(t),Object(i.a)(e),Object(i.a)(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return o.b.debug&&(Object(i.a)(t.x),Object(i.a)(t.y),Object(i.a)(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=Object(i.a)(t)}angle(t){return a.b(this,t)}cross(t){return a.d(this,this,t),this.check()}rotateX({radians:t,origin:e=s}){return a.n(this,this,e,t),this.check()}rotateY({radians:t,origin:e=s}){return a.o(this,this,e,t),this.check()}rotateZ({radians:t,origin:e=s}){return a.p(this,this,e,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return a.t(this,this,t),this.check()}transformAsVector(t){return Object(u.c)(this,this,t),this.check()}transformByMatrix3(t){return a.s(this,this,t),this.check()}transformByMatrix2(t){return Object(u.b)(this,this,t),this.check()}transformByQuaternion(t){return a.u(this,this,t),this.check()}}}}]);
//# sourceMappingURL=8.bundle.js.map