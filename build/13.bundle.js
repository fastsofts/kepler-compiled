(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{1:function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.default=t.exports,t.exports.__esModule=!0},10:function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.default=t.exports,t.exports.__esModule=!0},1e3:function(t,e){t.exports=function(t){if(Array.isArray(t))return t},t.exports.default=t.exports,t.exports.__esModule=!0},1001:function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0},11:function(t,e,n){var i=n(1597);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)},t.exports.default=t.exports,t.exports.__esModule=!0},113:function(t,e,n){"use strict";n.r(e),n.d(e,"AutoScrollActivator",(function(){return wt})),n.d(e,"DndContext",(function(){return Qt})),n.d(e,"DragOverlay",(function(){return ge})),n.d(e,"KeyboardCode",(function(){return st})),n.d(e,"KeyboardSensor",(function(){return dt})),n.d(e,"MeasuringFrequency",(function(){return jt})),n.d(e,"MeasuringStrategy",(function(){return Ct})),n.d(e,"MouseSensor",(function(){return yt})),n.d(e,"PointerSensor",(function(){return mt})),n.d(e,"TouchSensor",(function(){return _t})),n.d(e,"TraversalOrder",(function(){return Ot})),n.d(e,"applyModifiers",(function(){return Xt})),n.d(e,"closestCenter",(function(){return M})),n.d(e,"closestCorners",(function(){return E})),n.d(e,"defaultAnnouncements",(function(){return f})),n.d(e,"defaultCoordinates",(function(){return x})),n.d(e,"defaultDropAnimation",(function(){return he})),n.d(e,"defaultDropAnimationSideEffects",(function(){return de})),n.d(e,"defaultScreenReaderInstructions",(function(){return p})),n.d(e,"getClientRect",(function(){return N})),n.d(e,"getFirstCollision",(function(){return C})),n.d(e,"getScrollableAncestors",(function(){return U})),n.d(e,"pointerWithin",(function(){return A})),n.d(e,"rectIntersection",(function(){return T})),n.d(e,"useDndContext",(function(){return ne})),n.d(e,"useDndMonitor",(function(){return h})),n.d(e,"useDraggable",(function(){return ee})),n.d(e,"useDroppable",(function(){return re})),n.d(e,"useSensor",(function(){return b})),n.d(e,"useSensors",(function(){return y}));var i=n(0),r=n.n(i),o=n(60),s=n(35);const a={display:"none"};function c(t){let{id:e,value:n}=t;return r.a.createElement("div",{id:e,style:a},n)}const l={position:"fixed",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};function u(t){let{id:e,announcement:n}=t;return r.a.createElement("div",{id:e,style:l,role:"status","aria-live":"assertive","aria-atomic":!0},n)}const d=Object(i.createContext)(null);function h(t){const e=Object(i.useContext)(d);Object(i.useEffect)(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}const p={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},f={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was moved over droppable area "+n.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was dropped over droppable area "+n.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function g(t){let{announcements:e=f,container:n,hiddenTextDescribedById:a,screenReaderInstructions:l=p}=t;const{announce:d,announcement:g}=function(){const[t,e]=Object(i.useState)("");return{announce:Object(i.useCallback)(t=>{null!=t&&e(t)},[]),announcement:t}}(),m=Object(s.useUniqueId)("DndLiveRegion"),[v,b]=Object(i.useState)(!1);if(Object(i.useEffect)(()=>{b(!0)},[]),h(Object(i.useMemo)(()=>({onDragStart(t){let{active:n}=t;d(e.onDragStart({active:n}))},onDragMove(t){let{active:n,over:i}=t;e.onDragMove&&d(e.onDragMove({active:n,over:i}))},onDragOver(t){let{active:n,over:i}=t;d(e.onDragOver({active:n,over:i}))},onDragEnd(t){let{active:n,over:i}=t;d(e.onDragEnd({active:n,over:i}))},onDragCancel(t){let{active:n,over:i}=t;d(e.onDragCancel({active:n,over:i}))}}),[d,e])),!v)return null;const y=r.a.createElement(r.a.Fragment,null,r.a.createElement(c,{id:a,value:l.draggable}),r.a.createElement(u,{id:m,announcement:g}));return n?Object(o.createPortal)(y,n):y}var m;function v(){}function b(t,e){return Object(i.useMemo)(()=>({sensor:t,options:null!=e?e:{}}),[t,e])}function y(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Object(i.useMemo)(()=>[...e].filter(t=>null!=t),[...e])}!function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"}(m||(m={}));const x=Object.freeze({x:0,y:0});function _(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function w(t,e){const n=Object(s.getEventCoordinates)(t);if(!n)return"0 0";return(n.x-e.left)/e.width*100+"% "+(n.y-e.top)/e.height*100+"%"}function O(t,e){let{data:{value:n}}=t,{data:{value:i}}=e;return n-i}function P(t,e){let{data:{value:n}}=t,{data:{value:i}}=e;return i-n}function S(t){let{left:e,top:n,height:i,width:r}=t;return[{x:e,y:n},{x:e+r,y:n},{x:e,y:n+i},{x:e+r,y:n+i}]}function C(t,e){if(!t||0===t.length)return null;const[n]=t;return e?n[e]:n}function j(t,e,n){return void 0===e&&(e=t.left),void 0===n&&(n=t.top),{x:e+.5*t.width,y:n+.5*t.height}}const M=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:i}=t;const r=j(e,e.left,e.top),o=[];for(const t of i){const{id:e}=t,i=n.get(e);if(i){const n=_(j(i),r);o.push({id:e,data:{droppableContainer:t,value:n}})}}return o.sort(O)},E=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:i}=t;const r=S(e),o=[];for(const t of i){const{id:e}=t,i=n.get(e);if(i){const n=S(i),s=r.reduce((t,e,i)=>t+_(n[i],e),0),a=Number((s/4).toFixed(4));o.push({id:e,data:{droppableContainer:t,value:a}})}}return o.sort(O)};function L(t,e){const n=Math.max(e.top,t.top),i=Math.max(e.left,t.left),r=Math.min(e.left+e.width,t.left+t.width),o=Math.min(e.top+e.height,t.top+t.height),s=r-i,a=o-n;if(i<r&&n<o){const n=e.width*e.height,i=t.width*t.height,r=s*a;return Number((r/(n+i-r)).toFixed(4))}return 0}const T=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:i}=t;const r=[];for(const t of i){const{id:i}=t,o=n.get(i);if(o){const n=L(o,e);n>0&&r.push({id:i,data:{droppableContainer:t,value:n}})}}return r.sort(P)};function R(t,e){const{top:n,left:i,bottom:r,right:o}=e;return n<=t.y&&t.y<=r&&i<=t.x&&t.x<=o}const A=t=>{let{droppableContainers:e,droppableRects:n,pointerCoordinates:i}=t;if(!i)return[];const r=[];for(const t of e){const{id:e}=t,o=n.get(e);if(o&&R(i,o)){const n=S(o).reduce((t,e)=>t+_(i,e),0),s=Number((n/4).toFixed(4));r.push({id:e,data:{droppableContainer:t,value:s}})}}return r.sort(O)};function I(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:x}function k(t){return function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i.reduce((e,n)=>({...e,top:e.top+t*n.y,bottom:e.bottom+t*n.y,left:e.left+t*n.x,right:e.right+t*n.x}),{...e})}}const z=k(1);function D(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}const F={ignoreTransform:!1};function N(t,e){void 0===e&&(e=F);let n=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:e,transformOrigin:i}=Object(s.getWindow)(t).getComputedStyle(t);e&&(n=function(t,e,n){const i=D(e);if(!i)return t;const{scaleX:r,scaleY:o,x:s,y:a}=i,c=t.left-s-(1-r)*parseFloat(n),l=t.top-a-(1-o)*parseFloat(n.slice(n.indexOf(" ")+1)),u=r?t.width/r:t.width,d=o?t.height/o:t.height;return{width:u,height:d,top:l,right:c+u,bottom:l+d,left:c}}(n,e,i))}const{top:i,left:r,width:o,height:a,bottom:c,right:l}=n;return{top:i,left:r,width:o,height:a,bottom:c,right:l}}function V(t){return N(t,{ignoreTransform:!0})}function U(t,e){const n=[];return t?function i(r){if(null!=e&&n.length>=e)return n;if(!r)return n;if(Object(s.isDocument)(r)&&null!=r.scrollingElement&&!n.includes(r.scrollingElement))return n.push(r.scrollingElement),n;if(!Object(s.isHTMLElement)(r)||Object(s.isSVGElement)(r))return n;if(n.includes(r))return n;const o=Object(s.getWindow)(t).getComputedStyle(r);return r!==t&&function(t,e){void 0===e&&(e=Object(s.getWindow)(t).getComputedStyle(t));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(t=>{const i=e[t];return"string"==typeof i&&n.test(i)})}(r,o)&&n.push(r),function(t,e){return void 0===e&&(e=Object(s.getWindow)(t).getComputedStyle(t)),"fixed"===e.position}(r,o)?n:i(r.parentNode)}(t):n}function B(t){const[e]=U(t,1);return null!=e?e:null}function W(t){return s.canUseDOM&&t?Object(s.isWindow)(t)?t:Object(s.isNode)(t)?Object(s.isDocument)(t)||t===Object(s.getOwnerDocument)(t).scrollingElement?window:Object(s.isHTMLElement)(t)?t:null:null:null}function G(t){return Object(s.isWindow)(t)?t.scrollX:t.scrollLeft}function H(t){return Object(s.isWindow)(t)?t.scrollY:t.scrollTop}function Z(t){return{x:G(t),y:H(t)}}var q;function K(t){return!(!s.canUseDOM||!t)&&t===document.scrollingElement}function X(t){const e={x:0,y:0},n=K(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},i={x:t.scrollWidth-n.width,y:t.scrollHeight-n.height};return{isTop:t.scrollTop<=e.y,isLeft:t.scrollLeft<=e.x,isBottom:t.scrollTop>=i.y,isRight:t.scrollLeft>=i.x,maxScroll:i,minScroll:e}}!function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"}(q||(q={}));const Y={x:.2,y:.2};function J(t,e,n,i,r){let{top:o,left:s,right:a,bottom:c}=n;void 0===i&&(i=10),void 0===r&&(r=Y);const{isTop:l,isBottom:u,isLeft:d,isRight:h}=X(t),p={x:0,y:0},f={x:0,y:0},g=e.height*r.y,m=e.width*r.x;return!l&&o<=e.top+g?(p.y=q.Backward,f.y=i*Math.abs((e.top+g-o)/g)):!u&&c>=e.bottom-g&&(p.y=q.Forward,f.y=i*Math.abs((e.bottom-g-c)/g)),!h&&a>=e.right-m?(p.x=q.Forward,f.x=i*Math.abs((e.right-m-a)/m)):!d&&s<=e.left+m&&(p.x=q.Backward,f.x=i*Math.abs((e.left+m-s)/m)),{direction:p,speed:f}}function Q(t){if(t===document.scrollingElement){const{innerWidth:t,innerHeight:e}=window;return{top:0,left:0,right:t,bottom:e,width:t,height:e}}const{top:e,left:n,right:i,bottom:r}=t.getBoundingClientRect();return{top:e,left:n,right:i,bottom:r,width:t.clientWidth,height:t.clientHeight}}function $(t){return t.reduce((t,e)=>Object(s.add)(t,Z(e)),x)}function tt(t,e){if(void 0===e&&(e=N),!t)return;const{top:n,left:i,bottom:r,right:o}=e(t);B(t)&&(r<=0||o<=0||n>=window.innerHeight||i>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const et=[["x",["left","right"],function(t){return t.reduce((t,e)=>t+G(e),0)}],["y",["top","bottom"],function(t){return t.reduce((t,e)=>t+H(e),0)}]];class nt{constructor(t,e){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=U(e),i=$(n);this.rect={...t},this.width=t.width,this.height=t.height;for(const[t,e,r]of et)for(const o of e)Object.defineProperty(this,o,{get:()=>{const e=r(n),s=i[t]-e;return this.rect[o]+s},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class it{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(t=>{var e;return null==(e=this.target)?void 0:e.removeEventListener(...t)})},this.target=t}add(t,e,n){var i;null==(i=this.target)||i.addEventListener(t,e,n),this.listeners.push([t,e,n])}}function rt(t,e){const n=Math.abs(t.x),i=Math.abs(t.y);return"number"==typeof e?Math.sqrt(n**2+i**2)>e:"x"in e&&"y"in e?n>e.x&&i>e.y:"x"in e?n>e.x:"y"in e&&i>e.y}var ot,st;function at(t){t.preventDefault()}function ct(t){t.stopPropagation()}!function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"}(ot||(ot={})),function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter"}(st||(st={}));const lt={start:[st.Space,st.Enter],cancel:[st.Esc],end:[st.Space,st.Enter]},ut=(t,e)=>{let{currentCoordinates:n}=e;switch(t.code){case st.Right:return{...n,x:n.x+25};case st.Left:return{...n,x:n.x-25};case st.Down:return{...n,y:n.y+25};case st.Up:return{...n,y:n.y-25}}};class dt{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:e}}=t;this.props=t,this.listeners=new it(Object(s.getOwnerDocument)(e)),this.windowListeners=new it(Object(s.getWindow)(e)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ot.Resize,this.handleCancel),this.windowListeners.add(ot.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ot.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:e}=this.props,n=t.node.current;n&&tt(n),e(x)}handleKeyDown(t){if(Object(s.isKeyboardEvent)(t)){const{active:e,context:n,options:i}=this.props,{keyboardCodes:r=lt,coordinateGetter:o=ut,scrollBehavior:a="smooth"}=i,{code:c}=t;if(r.end.includes(c))return void this.handleEnd(t);if(r.cancel.includes(c))return void this.handleCancel(t);const{collisionRect:l}=n.current,u=l?{x:l.left,y:l.top}:x;this.referenceCoordinates||(this.referenceCoordinates=u);const d=o(t,{active:e,context:n.current,currentCoordinates:u});if(d){const e=Object(s.subtract)(d,u),i={x:0,y:0},{scrollableAncestors:r}=n.current;for(const n of r){const r=t.code,{isTop:o,isRight:s,isLeft:c,isBottom:l,maxScroll:u,minScroll:h}=X(n),p=Q(n),f={x:Math.min(r===st.Right?p.right-p.width/2:p.right,Math.max(r===st.Right?p.left:p.left+p.width/2,d.x)),y:Math.min(r===st.Down?p.bottom-p.height/2:p.bottom,Math.max(r===st.Down?p.top:p.top+p.height/2,d.y))},g=r===st.Right&&!s||r===st.Left&&!c,m=r===st.Down&&!l||r===st.Up&&!o;if(g&&f.x!==d.x){const t=n.scrollLeft+e.x,o=r===st.Right&&t<=u.x||r===st.Left&&t>=h.x;if(o&&!e.y)return void n.scrollTo({left:t,behavior:a});i.x=o?n.scrollLeft-t:r===st.Right?n.scrollLeft-u.x:n.scrollLeft-h.x,i.x&&n.scrollBy({left:-i.x,behavior:a});break}if(m&&f.y!==d.y){const t=n.scrollTop+e.y,o=r===st.Down&&t<=u.y||r===st.Up&&t>=h.y;if(o&&!e.x)return void n.scrollTo({top:t,behavior:a});i.y=o?n.scrollTop-t:r===st.Down?n.scrollTop-u.y:n.scrollTop-h.y,i.y&&n.scrollBy({top:-i.y,behavior:a});break}}this.handleMove(t,Object(s.add)(Object(s.subtract)(d,this.referenceCoordinates),i))}}}handleMove(t,e){const{onMove:n}=this.props;t.preventDefault(),n(e)}handleEnd(t){const{onEnd:e}=this.props;t.preventDefault(),this.detach(),e()}handleCancel(t){const{onCancel:e}=this.props;t.preventDefault(),this.detach(),e()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function ht(t){return Boolean(t&&"distance"in t)}function pt(t){return Boolean(t&&"delay"in t)}dt.activators=[{eventName:"onKeyDown",handler:(t,e,n)=>{let{keyboardCodes:i=lt,onActivation:r}=e,{active:o}=n;const{code:s}=t.nativeEvent;if(i.start.includes(s)){const e=o.activatorNode.current;return(!e||t.target===e)&&(t.preventDefault(),null==r||r({event:t.nativeEvent}),!0)}return!1}}];class ft{constructor(t,e,n){var i;void 0===n&&(n=function(t){const{EventTarget:e}=Object(s.getWindow)(t);return t instanceof e?t:Object(s.getOwnerDocument)(t)}(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=e;const{event:r}=t,{target:o}=r;this.props=t,this.events=e,this.document=Object(s.getOwnerDocument)(o),this.documentListeners=new it(this.document),this.listeners=new it(n),this.windowListeners=new it(Object(s.getWindow)(o)),this.initialCoordinates=null!=(i=Object(s.getEventCoordinates)(r))?i:x,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:e}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),this.windowListeners.add(ot.Resize,this.handleCancel),this.windowListeners.add(ot.DragStart,at),this.windowListeners.add(ot.VisibilityChange,this.handleCancel),this.windowListeners.add(ot.ContextMenu,at),this.documentListeners.add(ot.Keydown,this.handleKeydown),e){if(ht(e))return;if(pt(e))return void(this.timeoutId=setTimeout(this.handleStart,e.delay))}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handleStart(){const{initialCoordinates:t}=this,{onStart:e}=this.props;t&&(this.activated=!0,this.documentListeners.add(ot.Click,ct,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ot.SelectionChange,this.removeTextSelection),e(t))}handleMove(t){var e;const{activated:n,initialCoordinates:i,props:r}=this,{onMove:o,options:{activationConstraint:a}}=r;if(!i)return;const c=null!=(e=Object(s.getEventCoordinates)(t))?e:x,l=Object(s.subtract)(i,c);if(!n&&a){if(pt(a))return rt(l,a.tolerance)?this.handleCancel():void 0;if(ht(a))return null!=a.tolerance&&rt(l,a.tolerance)?this.handleCancel():rt(l,a.distance)?this.handleStart():void 0}t.cancelable&&t.preventDefault(),o(c)}handleEnd(){const{onEnd:t}=this.props;this.detach(),t()}handleCancel(){const{onCancel:t}=this.props;this.detach(),t()}handleKeydown(t){t.code===st.Esc&&this.handleCancel()}removeTextSelection(){var t;null==(t=this.document.getSelection())||t.removeAllRanges()}}const gt={move:{name:"pointermove"},end:{name:"pointerup"}};class mt extends ft{constructor(t){const{event:e}=t,n=Object(s.getOwnerDocument)(e.target);super(t,gt,n)}}mt.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:i}=e;return!(!n.isPrimary||0!==n.button)&&(null==i||i({event:n}),!0)}}];const vt={move:{name:"mousemove"},end:{name:"mouseup"}};var bt;!function(t){t[t.RightClick=2]="RightClick"}(bt||(bt={}));class yt extends ft{constructor(t){super(t,vt,Object(s.getOwnerDocument)(t.event.target))}}yt.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:i}=e;return n.button!==bt.RightClick&&(null==i||i({event:n}),!0)}}];const xt={move:{name:"touchmove"},end:{name:"touchend"}};class _t extends ft{constructor(t){super(t,xt)}static setup(){return window.addEventListener(xt.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(xt.move.name,t)};function t(){}}}var wt,Ot;function Pt(t){let{acceleration:e,activator:n=wt.Pointer,canScroll:r,draggingRect:o,enabled:a,interval:c=5,order:l=Ot.TreeOrder,pointerCoordinates:u,scrollableAncestors:d,scrollableAncestorRects:h,delta:p,threshold:f}=t;const g=function(t){let{delta:e,disabled:n}=t;const i=Object(s.usePrevious)(e);return Object(s.useLazyMemo)(t=>{if(n||!i||!t)return St;const r=Math.sign(e.x-i.x),o=Math.sign(e.y-i.y);return{x:{[q.Backward]:t.x[q.Backward]||-1===r,[q.Forward]:t.x[q.Forward]||1===r},y:{[q.Backward]:t.y[q.Backward]||-1===o,[q.Forward]:t.y[q.Forward]||1===o}}},[n,e,i])}({delta:p,disabled:!a}),[m,v]=Object(s.useInterval)(),b=Object(i.useRef)({x:0,y:0}),y=Object(i.useRef)({x:0,y:0}),x=Object(i.useMemo)(()=>{switch(n){case wt.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case wt.DraggableRect:return o}},[n,o,u]),_=Object(i.useRef)(null),w=Object(i.useCallback)(()=>{const t=_.current;if(!t)return;const e=b.current.x*y.current.x,n=b.current.y*y.current.y;t.scrollBy(e,n)},[]),O=Object(i.useMemo)(()=>l===Ot.TreeOrder?[...d].reverse():d,[l,d]);Object(i.useEffect)(()=>{if(a&&d.length&&x){for(const t of O){if(!1===(null==r?void 0:r(t)))continue;const n=d.indexOf(t),i=h[n];if(!i)continue;const{direction:o,speed:s}=J(t,i,x,e,f);for(const t of["x","y"])g[t][o[t]]||(s[t]=0,o[t]=0);if(s.x>0||s.y>0)return v(),_.current=t,m(w,c),b.current=s,void(y.current=o)}b.current={x:0,y:0},y.current={x:0,y:0},v()}else v()},[e,w,r,v,a,c,JSON.stringify(x),JSON.stringify(g),m,d,O,h,JSON.stringify(f)])}_t.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:i}=e;const{touches:r}=n;return!(r.length>1)&&(null==i||i({event:n}),!0)}}],function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"}(wt||(wt={})),function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"}(Ot||(Ot={}));const St={x:{[q.Backward]:!1,[q.Forward]:!1},y:{[q.Backward]:!1,[q.Forward]:!1}};var Ct,jt;!function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"}(Ct||(Ct={})),function(t){t.Optimized="optimized"}(jt||(jt={}));const Mt=new Map;function Et(t,e){return Object(s.useLazyMemo)(n=>t?n||("function"==typeof e?e(t):t):null,[e,t])}function Lt(t){let{callback:e,disabled:n}=t;const r=Object(s.useEvent)(e),o=Object(i.useMemo)(()=>{if(n||"undefined"==typeof window||void 0===window.ResizeObserver)return;const{ResizeObserver:t}=window;return new t(r)},[n]);return Object(i.useEffect)(()=>()=>null==o?void 0:o.disconnect(),[o]),o}function Tt(t){return new nt(N(t),t)}function Rt(t,e,n){void 0===e&&(e=Tt);const[r,o]=Object(i.useReducer)((function(i){if(!t)return null;var r;if(!1===t.isConnected)return null!=(r=null!=i?i:n)?r:null;const o=e(t);if(JSON.stringify(i)===JSON.stringify(o))return i;return o}),null),a=function(t){let{callback:e,disabled:n}=t;const r=Object(s.useEvent)(e),o=Object(i.useMemo)(()=>{if(n||"undefined"==typeof window||void 0===window.MutationObserver)return;const{MutationObserver:t}=window;return new t(r)},[r,n]);return Object(i.useEffect)(()=>()=>null==o?void 0:o.disconnect(),[o]),o}({callback(e){if(t)for(const n of e){const{type:e,target:i}=n;if("childList"===e&&i instanceof HTMLElement&&i.contains(t)){o();break}}}}),c=Lt({callback:o});return Object(s.useIsomorphicLayoutEffect)(()=>{o(),t?(null==c||c.observe(t),null==a||a.observe(document.body,{childList:!0,subtree:!0})):(null==c||c.disconnect(),null==a||a.disconnect())},[t]),r}const At=[];function It(t,e){void 0===e&&(e=[]);const n=Object(i.useRef)(null);return Object(i.useEffect)(()=>{n.current=null},e),Object(i.useEffect)(()=>{const e=t!==x;e&&!n.current&&(n.current=t),!e&&n.current&&(n.current=null)},[t]),n.current?Object(s.subtract)(t,n.current):x}function kt(t){return Object(i.useMemo)(()=>t?function(t){const e=t.innerWidth,n=t.innerHeight;return{top:0,left:0,right:e,bottom:n,width:e,height:n}}(t):null,[t])}const zt=[];function Dt(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return Object(s.isHTMLElement)(e)?e:t}const Ft=[{sensor:mt,options:{}},{sensor:dt,options:{}}],Nt={current:{}},Vt={draggable:{measure:V},droppable:{measure:V,strategy:Ct.WhileDragging,frequency:jt.Optimized},dragOverlay:{measure:N}};class Ut extends Map{get(t){var e;return null!=t&&null!=(e=super.get(t))?e:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:e}=t;return!e})}getNodeFor(t){var e,n;return null!=(e=null==(n=this.get(t))?void 0:n.node.current)?e:void 0}}const Bt={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Ut,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:v},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Vt,measureDroppableContainers:v,windowRect:null,measuringScheduled:!1},Wt={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:v,draggableNodes:new Map,over:null,measureDroppableContainers:v},Gt=Object(i.createContext)(Wt),Ht=Object(i.createContext)(Bt);function Zt(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Ut}}}function qt(t,e){switch(e.type){case m.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case m.DragMove:return t.draggable.active?{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}}:t;case m.DragEnd:case m.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case m.RegisterDroppable:{const{element:n}=e,{id:i}=n,r=new Ut(t.droppable.containers);return r.set(i,n),{...t,droppable:{...t.droppable,containers:r}}}case m.SetDroppableDisabled:{const{id:n,key:i,disabled:r}=e,o=t.droppable.containers.get(n);if(!o||i!==o.key)return t;const s=new Ut(t.droppable.containers);return s.set(n,{...o,disabled:r}),{...t,droppable:{...t.droppable,containers:s}}}case m.UnregisterDroppable:{const{id:n,key:i}=e,r=t.droppable.containers.get(n);if(!r||i!==r.key)return t;const o=new Ut(t.droppable.containers);return o.delete(n),{...t,droppable:{...t.droppable,containers:o}}}default:return t}}function Kt(t){let{disabled:e}=t;const{active:n,activatorEvent:r,draggableNodes:o}=Object(i.useContext)(Gt),a=Object(s.usePrevious)(r),c=Object(s.usePrevious)(null==n?void 0:n.id);return Object(i.useEffect)(()=>{if(!e&&!r&&a&&null!=c){if(!Object(s.isKeyboardEvent)(a))return;if(document.activeElement===a.target)return;const t=o.get(c);if(!t)return;const{activatorNode:e,node:n}=t;if(!e.current&&!n.current)return;requestAnimationFrame(()=>{for(const t of[e.current,n.current]){if(!t)continue;const e=Object(s.findFirstFocusableNode)(t);if(e){e.focus();break}}})}},[r,e,o,c,a]),null}function Xt(t,e){let{transform:n,...i}=e;return null!=t&&t.length?t.reduce((t,e)=>e({transform:t,...i}),n):n}const Yt=Object(i.createContext)({...x,scaleX:1,scaleY:1});var Jt;!function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"}(Jt||(Jt={}));const Qt=Object(i.memo)((function(t){var e,n,a,c;let{id:l,accessibility:u,autoScroll:h=!0,children:p,sensors:f=Ft,collisionDetection:v=T,measuring:b,modifiers:y,..._}=t;const w=Object(i.useReducer)(qt,void 0,Zt),[O,P]=w,[S,j]=function(){const[t]=Object(i.useState)(()=>new Set),e=Object(i.useCallback)(e=>(t.add(e),()=>t.delete(e)),[t]);return[Object(i.useCallback)(e=>{let{type:n,event:i}=e;t.forEach(t=>{var e;return null==(e=t[n])?void 0:e.call(t,i)})},[t]),e]}(),[M,E]=Object(i.useState)(Jt.Uninitialized),L=M===Jt.Initialized,{draggable:{active:R,nodes:A,translate:k},droppable:{containers:D}}=O,F=R?A.get(R):null,V=Object(i.useRef)({initial:null,translated:null}),G=Object(i.useMemo)(()=>{var t;return null!=R?{id:R,data:null!=(t=null==F?void 0:F.data)?t:Nt,rect:V}:null},[R,F]),H=Object(i.useRef)(null),[q,X]=Object(i.useState)(null),[Y,J]=Object(i.useState)(null),Q=Object(s.useLatestValue)(_,Object.values(_)),tt=Object(s.useUniqueId)("DndDescribedBy",l),et=Object(i.useMemo)(()=>D.getEnabled(),[D]),it=(rt=b,Object(i.useMemo)(()=>({draggable:{...Vt.draggable,...null==rt?void 0:rt.draggable},droppable:{...Vt.droppable,...null==rt?void 0:rt.droppable},dragOverlay:{...Vt.dragOverlay,...null==rt?void 0:rt.dragOverlay}}),[null==rt?void 0:rt.draggable,null==rt?void 0:rt.droppable,null==rt?void 0:rt.dragOverlay]));var rt;const{droppableRects:ot,measureDroppableContainers:st,measuringScheduled:at}=function(t,e){let{dragging:n,dependencies:r,config:o}=e;const[a,c]=Object(i.useState)(null),{frequency:l,measure:u,strategy:d}=o,h=Object(i.useRef)(t),p=function(){switch(d){case Ct.Always:return!1;case Ct.BeforeDragging:return n;default:return!n}}(),f=Object(s.useLatestValue)(p),g=Object(i.useCallback)((function(t){void 0===t&&(t=[]),f.current||c(e=>null===e?t:e.concat(t.filter(t=>!e.includes(t))))}),[f]),m=Object(i.useRef)(null),v=Object(s.useLazyMemo)(e=>{if(p&&!n)return Mt;if(!e||e===Mt||h.current!==t||null!=a){const e=new Map;for(let n of t){if(!n)continue;if(a&&a.length>0&&!a.includes(n.id)&&n.rect.current){e.set(n.id,n.rect.current);continue}const t=n.node.current,i=t?new nt(u(t),t):null;n.rect.current=i,i&&e.set(n.id,i)}return e}return e},[t,a,n,p,u]);return Object(i.useEffect)(()=>{h.current=t},[t]),Object(i.useEffect)(()=>{p||g()},[n,p]),Object(i.useEffect)(()=>{a&&a.length>0&&c(null)},[JSON.stringify(a)]),Object(i.useEffect)(()=>{p||"number"!=typeof l||null!==m.current||(m.current=setTimeout(()=>{g(),m.current=null},l))},[l,p,g,...r]),{droppableRects:v,measureDroppableContainers:g,measuringScheduled:null!=a}}(et,{dragging:L,dependencies:[k.x,k.y],config:it.droppable}),ct=function(t,e){const n=null!==e?t.get(e):void 0,i=n?n.node.current:null;return Object(s.useLazyMemo)(t=>{var n;return null===e?null:null!=(n=null!=i?i:t)?n:null},[i,e])}(A,R),lt=Object(i.useMemo)(()=>Y?Object(s.getEventCoordinates)(Y):null,[Y]),ut=function(){const t=!1===(null==q?void 0:q.autoScrollEnabled),e="object"==typeof h?!1===h.enabled:!1===h,n=L&&!t&&!e;if("object"==typeof h)return{...h,enabled:n};return{enabled:n}}(),dt=function(t,e){return Et(t,e)}(ct,it.draggable.measure);!function(t){let{activeNode:e,measure:n,initialRect:r,config:o=!0}=t;const a=Object(i.useRef)(!1),{x:c,y:l}="boolean"==typeof o?{x:o,y:o}:o;Object(s.useIsomorphicLayoutEffect)(()=>{if(!c&&!l||!e)return void(a.current=!1);if(a.current||!r)return;const t=null==e?void 0:e.node.current;if(!t||!1===t.isConnected)return;const i=I(n(t),r);if(c||(i.x=0),l||(i.y=0),a.current=!0,Math.abs(i.x)>0||Math.abs(i.y)>0){const e=B(t);e&&e.scrollBy({top:i.y,left:i.x})}},[e,c,l,r,n])}({activeNode:R?A.get(R):null,config:ut.layoutShiftCompensation,initialRect:dt,measure:it.draggable.measure});const ht=Rt(ct,it.draggable.measure,dt),pt=Rt(ct?ct.parentElement:null),ft=Object(i.useRef)({activatorEvent:null,active:null,activeNode:ct,collisionRect:null,collisions:null,droppableRects:ot,draggableNodes:A,draggingNode:null,draggingNodeRect:null,droppableContainers:D,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),gt=D.getNodeFor(null==(e=ft.current.over)?void 0:e.id),mt=function(t){let{measure:e}=t;const[n,r]=Object(i.useState)(null),o=Lt({callback:Object(i.useCallback)(t=>{for(const{target:n}of t)if(Object(s.isHTMLElement)(n)){r(t=>{const i=e(n);return t?{...t,width:i.width,height:i.height}:i});break}},[e])}),a=Object(i.useCallback)(t=>{const n=Dt(t);null==o||o.disconnect(),n&&(null==o||o.observe(n)),r(n?e(n):null)},[e,o]),[c,l]=Object(s.useNodeRef)(a);return Object(i.useMemo)(()=>({nodeRef:c,rect:n,setRef:l}),[n,c,l])}({measure:it.dragOverlay.measure}),vt=null!=(n=mt.nodeRef.current)?n:ct,bt=L?null!=(a=mt.rect)?a:ht:null,yt=Boolean(mt.nodeRef.current&&mt.rect),xt=I(_t=yt?null:ht,Et(_t));var _t;const wt=kt(vt?Object(s.getWindow)(vt):null),Ot=function(t){const e=Object(i.useRef)(t),n=Object(s.useLazyMemo)(n=>t?n&&n!==At&&t&&e.current&&t.parentNode===e.current.parentNode?n:U(t):At,[t]);return Object(i.useEffect)(()=>{e.current=t},[t]),n}(L?null!=gt?gt:ct:null),St=function(t,e){void 0===e&&(e=N);const[n]=t,r=kt(n?Object(s.getWindow)(n):null),[o,a]=Object(i.useReducer)((function(){if(!t.length)return zt;return t.map(t=>K(t)?r:new nt(e(t),t))}),zt),c=Lt({callback:a});return t.length>0&&o===zt&&a(),Object(s.useIsomorphicLayoutEffect)(()=>{t.length?t.forEach(t=>null==c?void 0:c.observe(t)):(null==c||c.disconnect(),a())},[t]),o}(Ot),jt=Xt(y,{transform:{x:k.x-xt.x,y:k.y-xt.y,scaleX:1,scaleY:1},activatorEvent:Y,active:G,activeNodeRect:ht,containerNodeRect:pt,draggingNodeRect:bt,over:ft.current.over,overlayNodeRect:mt.rect,scrollableAncestors:Ot,scrollableAncestorRects:St,windowRect:wt}),Tt=lt?Object(s.add)(lt,k):null,Ut=function(t){const[e,n]=Object(i.useState)(null),r=Object(i.useRef)(t),o=Object(i.useCallback)(t=>{const e=W(t.target);e&&n(t=>t?(t.set(e,Z(e)),new Map(t)):null)},[]);return Object(i.useEffect)(()=>{const e=r.current;if(t!==e){i(e);const s=t.map(t=>{const e=W(t);return e?(e.addEventListener("scroll",o,{passive:!0}),[e,Z(e)]):null}).filter(t=>null!=t);n(s.length?new Map(s):null),r.current=t}return()=>{i(t),i(e)};function i(t){t.forEach(t=>{const e=W(t);null==e||e.removeEventListener("scroll",o)})}},[o,t]),Object(i.useMemo)(()=>t.length?e?Array.from(e.values()).reduce((t,e)=>Object(s.add)(t,e),x):$(t):x,[t,e])}(Ot),Bt=It(Ut),Wt=It(Ut,[ht]),Qt=Object(s.add)(jt,Bt),$t=bt?z(bt,jt):null,te=G&&$t?v({active:G,collisionRect:$t,droppableRects:ot,droppableContainers:et,pointerCoordinates:Tt}):null,ee=C(te,"id"),[ne,ie]=Object(i.useState)(null),re=function(t,e,n){return{...t,scaleX:e&&n?e.width/n.width:1,scaleY:e&&n?e.height/n.height:1}}(yt?jt:Object(s.add)(jt,Wt),null!=(c=null==ne?void 0:ne.rect)?c:null,ht),oe=Object(i.useCallback)((t,e)=>{let{sensor:n,options:i}=e;if(null==H.current)return;const r=A.get(H.current);if(!r)return;const s=t.nativeEvent,a=new n({active:H.current,activeNode:r,event:s,options:i,context:ft,onStart(t){const e=H.current;if(null==e)return;const n=A.get(e);if(!n)return;const{onDragStart:i}=Q.current,r={active:{id:e,data:n.data,rect:V}};Object(o.unstable_batchedUpdates)(()=>{null==i||i(r),E(Jt.Initializing),P({type:m.DragStart,initialCoordinates:t,active:e}),S({type:"onDragStart",event:r})})},onMove(t){P({type:m.DragMove,coordinates:t})},onEnd:c(m.DragEnd),onCancel:c(m.DragCancel)});function c(t){return async function(){const{active:e,collisions:n,over:i,scrollAdjustedTranslate:r}=ft.current;let a=null;if(e&&r){const{cancelDrop:o}=Q.current;if(a={activatorEvent:s,active:e,collisions:n,delta:r,over:i},t===m.DragEnd&&"function"==typeof o){await Promise.resolve(o(a))&&(t=m.DragCancel)}}H.current=null,Object(o.unstable_batchedUpdates)(()=>{P({type:t}),E(Jt.Uninitialized),ie(null),X(null),J(null);const e=t===m.DragEnd?"onDragEnd":"onDragCancel";if(a){const t=Q.current[e];null==t||t(a),S({type:e,event:a})}})}}Object(o.unstable_batchedUpdates)(()=>{X(a),J(t.nativeEvent)})},[A]),se=function(t,e){return Object(i.useMemo)(()=>t.reduce((t,n)=>{const{sensor:i}=n;return[...t,...i.activators.map(t=>({eventName:t.eventName,handler:e(t.handler,n)}))]},[]),[t,e])}(f,Object(i.useCallback)((t,e)=>(n,i)=>{const r=n.nativeEvent,o=A.get(i);if(null!==H.current||!o||r.dndKit||r.defaultPrevented)return;const s={active:o};!0===t(n,e.options,s)&&(r.dndKit={capturedBy:e.sensor},H.current=i,oe(n,e))},[A,oe]));!function(t){Object(i.useEffect)(()=>{if(!s.canUseDOM)return;const e=t.map(t=>{let{sensor:e}=t;return null==e.setup?void 0:e.setup()});return()=>{for(const t of e)null==t||t()}},t.map(t=>{let{sensor:e}=t;return e}))}(f),Object(s.useIsomorphicLayoutEffect)(()=>{ht&&M===Jt.Initializing&&E(Jt.Initialized)},[ht,M]),Object(i.useEffect)(()=>{const{onDragMove:t}=Q.current,{active:e,activatorEvent:n,collisions:i,over:r}=ft.current;if(!e||!n)return;const s={active:e,activatorEvent:n,collisions:i,delta:{x:Qt.x,y:Qt.y},over:r};Object(o.unstable_batchedUpdates)(()=>{null==t||t(s),S({type:"onDragMove",event:s})})},[Qt.x,Qt.y]),Object(i.useEffect)(()=>{const{active:t,activatorEvent:e,collisions:n,droppableContainers:i,scrollAdjustedTranslate:r}=ft.current;if(!t||null==H.current||!e||!r)return;const{onDragOver:s}=Q.current,a=i.get(ee),c=a&&a.rect.current?{id:a.id,rect:a.rect.current,data:a.data,disabled:a.disabled}:null,l={active:t,activatorEvent:e,collisions:n,delta:{x:r.x,y:r.y},over:c};Object(o.unstable_batchedUpdates)(()=>{ie(c),null==s||s(l),S({type:"onDragOver",event:l})})},[ee]),Object(s.useIsomorphicLayoutEffect)(()=>{ft.current={activatorEvent:Y,active:G,activeNode:ct,collisionRect:$t,collisions:te,droppableRects:ot,draggableNodes:A,draggingNode:vt,draggingNodeRect:bt,droppableContainers:D,over:ne,scrollableAncestors:Ot,scrollAdjustedTranslate:Qt},V.current={initial:bt,translated:$t}},[G,ct,te,$t,A,vt,bt,ot,D,ne,Ot,Qt]),Pt({...ut,delta:k,draggingRect:$t,pointerCoordinates:Tt,scrollableAncestors:Ot,scrollableAncestorRects:St});const ae=Object(i.useMemo)(()=>({active:G,activeNode:ct,activeNodeRect:ht,activatorEvent:Y,collisions:te,containerNodeRect:pt,dragOverlay:mt,draggableNodes:A,droppableContainers:D,droppableRects:ot,over:ne,measureDroppableContainers:st,scrollableAncestors:Ot,scrollableAncestorRects:St,measuringConfiguration:it,measuringScheduled:at,windowRect:wt}),[G,ct,ht,Y,te,pt,mt,A,D,ot,ne,st,Ot,St,it,at,wt]),ce=Object(i.useMemo)(()=>({activatorEvent:Y,activators:se,active:G,activeNodeRect:ht,ariaDescribedById:{draggable:tt},dispatch:P,draggableNodes:A,over:ne,measureDroppableContainers:st}),[Y,se,G,ht,P,tt,A,ne,st]);return r.a.createElement(d.Provider,{value:j},r.a.createElement(Gt.Provider,{value:ce},r.a.createElement(Ht.Provider,{value:ae},r.a.createElement(Yt.Provider,{value:re},p)),r.a.createElement(Kt,{disabled:!1===(null==u?void 0:u.restoreFocus)})),r.a.createElement(g,{...u,hiddenTextDescribedById:tt}))})),$t=Object(i.createContext)(null),te="button";function ee(t){let{id:e,data:n,disabled:r=!1,attributes:o}=t;const a=Object(s.useUniqueId)("Droppable"),{activators:c,activatorEvent:l,active:u,activeNodeRect:d,ariaDescribedById:h,draggableNodes:p,over:f}=Object(i.useContext)(Gt),{role:g=te,roleDescription:m="draggable",tabIndex:v=0}=null!=o?o:{},b=(null==u?void 0:u.id)===e,y=Object(i.useContext)(b?Yt:$t),[x,_]=Object(s.useNodeRef)(),[w,O]=Object(s.useNodeRef)(),P=function(t,e){return Object(i.useMemo)(()=>t.reduce((t,n)=>{let{eventName:i,handler:r}=n;return t[i]=t=>{r(t,e)},t},{}),[t,e])}(c,e),S=Object(s.useLatestValue)(n);Object(s.useIsomorphicLayoutEffect)(()=>(p.set(e,{id:e,key:a,node:x,activatorNode:w,data:S}),()=>{const t=p.get(e);t&&t.key===a&&p.delete(e)}),[p,e]);return{active:u,activatorEvent:l,activeNodeRect:d,attributes:Object(i.useMemo)(()=>({role:g,tabIndex:v,"aria-disabled":r,"aria-pressed":!(!b||g!==te)||void 0,"aria-roledescription":m,"aria-describedby":h.draggable}),[r,g,v,b,m,h.draggable]),isDragging:b,listeners:r?void 0:P,node:x,over:f,setNodeRef:_,setActivatorNodeRef:O,transform:y}}function ne(){return Object(i.useContext)(Ht)}const ie={timeout:25};function re(t){let{data:e,disabled:n=!1,id:r,resizeObserverConfig:o}=t;const a=Object(s.useUniqueId)("Droppable"),{active:c,dispatch:l,over:u,measureDroppableContainers:d}=Object(i.useContext)(Gt),h=Object(i.useRef)({disabled:n}),p=Object(i.useRef)(!1),f=Object(i.useRef)(null),g=Object(i.useRef)(null),{disabled:v,updateMeasurementsFor:b,timeout:y}={...ie,...o},x=Object(s.useLatestValue)(null!=b?b:r),_=Lt({callback:Object(i.useCallback)(()=>{p.current?(null!=g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{d(Array.isArray(x.current)?x.current:[x.current]),g.current=null},y)):p.current=!0},[y]),disabled:v||!c}),w=Object(i.useCallback)((t,e)=>{_&&(e&&(_.unobserve(e),p.current=!1),t&&_.observe(t))},[_]),[O,P]=Object(s.useNodeRef)(w),S=Object(s.useLatestValue)(e);return Object(i.useEffect)(()=>{_&&O.current&&(_.disconnect(),p.current=!1,_.observe(O.current))},[O,_]),Object(s.useIsomorphicLayoutEffect)(()=>(l({type:m.RegisterDroppable,element:{id:r,key:a,disabled:n,node:O,rect:f,data:S}}),()=>l({type:m.UnregisterDroppable,key:a,id:r})),[r]),Object(i.useEffect)(()=>{n!==h.current.disabled&&(l({type:m.SetDroppableDisabled,id:r,key:a,disabled:n}),h.current.disabled=n)},[r,a,n,l]),{active:c,rect:f,isOver:(null==u?void 0:u.id)===r,node:O,over:u,setNodeRef:P}}function oe(t){let{animation:e,children:n}=t;const[o,a]=Object(i.useState)(null),[c,l]=Object(i.useState)(null),u=Object(s.usePrevious)(n);return n||o||!u||a(u),Object(s.useIsomorphicLayoutEffect)(()=>{if(!c)return;const t=null==o?void 0:o.key,n=null==o?void 0:o.props.id;null!=t&&null!=n?Promise.resolve(e(n,c)).then(()=>{a(null)}):a(null)},[e,o,c]),r.a.createElement(r.a.Fragment,null,n,o?Object(i.cloneElement)(o,{ref:l}):null)}const se={x:0,y:0,scaleX:1,scaleY:1};function ae(t){let{children:e}=t;return r.a.createElement(Gt.Provider,{value:Wt},r.a.createElement(Yt.Provider,{value:se},e))}const ce={position:"fixed",touchAction:"none"},le=t=>Object(s.isKeyboardEvent)(t)?"transform 250ms ease":void 0,ue=Object(i.forwardRef)((t,e)=>{let{as:n,activatorEvent:i,adjustScale:o,children:a,className:c,rect:l,style:u,transform:d,transition:h=le}=t;if(!l)return null;const p=o?d:{...d,scaleX:1,scaleY:1},f={...ce,width:l.width,height:l.height,top:l.top,left:l.left,transform:s.CSS.Transform.toString(p),transformOrigin:o&&i?w(i,l):void 0,transition:"function"==typeof h?h(i):h,...u};return r.a.createElement(n,{className:c,style:f,ref:e},a)}),de=t=>e=>{let{active:n,dragOverlay:i}=e;const r={},{styles:o,className:s}=t;if(null!=o&&o.active)for(const[t,e]of Object.entries(o.active))void 0!==e&&(r[t]=n.node.style.getPropertyValue(t),n.node.style.setProperty(t,e));if(null!=o&&o.dragOverlay)for(const[t,e]of Object.entries(o.dragOverlay))void 0!==e&&i.node.style.setProperty(t,e);return null!=s&&s.active&&n.node.classList.add(s.active),null!=s&&s.dragOverlay&&i.node.classList.add(s.dragOverlay),function(){for(const[t,e]of Object.entries(r))n.node.style.setProperty(t,e);null!=s&&s.active&&n.node.classList.remove(s.active)}},he={duration:250,easing:"ease",keyframes:t=>{let{transform:{initial:e,final:n}}=t;return[{transform:s.CSS.Transform.toString(e)},{transform:s.CSS.Transform.toString(n)}]},sideEffects:de({styles:{active:{opacity:"0"}}})};function pe(t){let{config:e,draggableNodes:n,droppableContainers:i,measuringConfiguration:r}=t;return Object(s.useEvent)((t,o)=>{if(null===e)return;const a=n.get(t);if(!a)return;const c=a.node.current;if(!c)return;const l=Dt(o);if(!l)return;const{transform:u}=Object(s.getWindow)(o).getComputedStyle(o),d=D(u);if(!d)return;const h="function"==typeof e?e:function(t){const{duration:e,easing:n,sideEffects:i,keyframes:r}={...he,...t};return t=>{let{active:o,dragOverlay:s,transform:a,...c}=t;if(!e)return;const l=s.rect.left-o.rect.left,u=s.rect.top-o.rect.top,d={scaleX:1!==a.scaleX?o.rect.width*a.scaleX/s.rect.width:1,scaleY:1!==a.scaleY?o.rect.height*a.scaleY/s.rect.height:1},h={x:a.x-l,y:a.y-u,...d},p=r({...c,active:o,dragOverlay:s,transform:{initial:a,final:h}}),[f]=p,g=p[p.length-1];if(JSON.stringify(f)===JSON.stringify(g))return;const m=null==i?void 0:i({active:o,dragOverlay:s,...c}),v=s.node.animate(p,{duration:e,easing:n,fill:"forwards"});return new Promise(t=>{v.onfinish=()=>{null==m||m(),t()}})}}(e);return tt(c,r.draggable.measure),h({active:{id:t,data:a.data,node:c,rect:r.draggable.measure(c)},draggableNodes:n,dragOverlay:{node:o,rect:r.dragOverlay.measure(l)},droppableContainers:i,measuringConfiguration:r,transform:d})})}let fe=0;const ge=r.a.memo(t=>{let{adjustScale:e=!1,children:n,dropAnimation:o,style:s,transition:a,modifiers:c,wrapperElement:l="div",className:u,zIndex:d=999}=t;const{activatorEvent:h,active:p,activeNodeRect:f,containerNodeRect:g,draggableNodes:m,droppableContainers:v,dragOverlay:b,over:y,measuringConfiguration:x,scrollableAncestors:_,scrollableAncestorRects:w,windowRect:O}=ne(),P=Object(i.useContext)(Yt),S=(C=null==p?void 0:p.id,Object(i.useMemo)(()=>{if(null!=C)return fe++,fe},[C]));var C;const j=Xt(c,{activatorEvent:h,active:p,activeNodeRect:f,containerNodeRect:g,draggingNodeRect:b.rect,over:y,overlayNodeRect:b.rect,scrollableAncestors:_,scrollableAncestorRects:w,transform:P,windowRect:O}),M=Et(f),E=pe({config:o,draggableNodes:m,droppableContainers:v,measuringConfiguration:x}),L=M?b.setRef:void 0;return r.a.createElement(ae,null,r.a.createElement(oe,{animation:E},p&&S?r.a.createElement(ue,{key:S,id:p.id,ref:L,as:l,activatorEvent:h,adjustScale:e,className:u,transition:a,rect:M,style:{zIndex:d,...s},transform:j},n):null))})},1149:function(t,e){t.exports=function(t){this.wrapped=t},t.exports.default=t.exports,t.exports.__esModule=!0},1154:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(3),r=n(402),o=n(954);class s extends r.a{constructor(t){super(t),Object(i.a)(this,"timestamp",void 0),this.timestamp=t.timestamp}getProjectedLight({layer:t}){const{viewport:e}=t.context;if(e.resolution&&e.resolution>0){const[t,e,n]=Object(o.a)(this.timestamp,0,0);this.direction=[t,-n,e]}else{const{latitude:t,longitude:n}=e;this.direction=Object(o.a)(this.timestamp,t,n)}return this}}},1156:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n(3),r=n(178);class o{static get componentName(){return Object.prototype.hasOwnProperty.call(this,"extensionName")?this.extensionName:""}constructor(t){Object(i.a)(this,"opts",void 0),t&&(this.opts=t)}equals(t){return this===t||this.constructor===t.constructor&&Object(r.a)(this.opts,t.opts,1)}getShaders(t){return null}getSubLayerProps(t){const{defaultProps:e}=t.constructor,n={updateTriggers:{}};for(const t in e)if(t in this.props){const i=e[t],r=this.props[t];n[t]=r,i&&"accessor"===i.type&&(n.updateTriggers[t]=this.props.updateTriggers[t],"function"==typeof r&&(n[t]=this.getSubLayerAccessor(r)))}return n}initializeState(t,e){}updateState(t,e){}onNeedsRedraw(t){}getNeedsPickingBuffer(t){return!1}draw(t,e){}finalizeState(t,e){}}Object(i.a)(o,"defaultProps",{}),Object(i.a)(o,"extensionName","LayerExtension")},1157:function(t,e,n){"use strict";var i=n(408);e.a={name:"project32",dependencies:[i.a],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"}},1158:function(t,e,n){"use strict";var i=n(2102);e.a={inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:#decl":"\nuniform bool picking_uAttribute;\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},...i.a}},116:function(t,e,n){"use strict";function i(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}n.d(e,"a",(function(){return i}))},1161:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(3),r=n(196),o=n(256),s=n(116),a=n(134);class c{constructor(t){Object(i.a)(this,"opts",void 0),Object(i.a)(this,"typedArrayManager",void 0),Object(i.a)(this,"indexStarts",[0]),Object(i.a)(this,"vertexStarts",[0]),Object(i.a)(this,"vertexCount",0),Object(i.a)(this,"instanceCount",0),Object(i.a)(this,"attributes",void 0),Object(i.a)(this,"_attributeDefs",void 0),Object(i.a)(this,"data",void 0),Object(i.a)(this,"getGeometry",void 0),Object(i.a)(this,"geometryBuffer",void 0),Object(i.a)(this,"buffers",void 0),Object(i.a)(this,"positionSize",void 0),Object(i.a)(this,"normalize",void 0);const{attributes:e={}}=t;this.typedArrayManager=o.a,this.attributes={},this._attributeDefs=e,this.opts=t,this.updateGeometry(t)}updateGeometry(t){Object.assign(this.opts,t);const{data:e,buffers:n={},getGeometry:i,geometryBuffer:r,positionFormat:o,dataChanged:a,normalize:c=!0}=this.opts;if(this.data=e,this.getGeometry=i,this.positionSize=r&&r.size||("XY"===o?2:3),this.buffers=n,this.normalize=c,r&&(Object(s.a)(e.startIndices),this.getGeometry=this.getGeometryFromBuffer(r),c||(n.positions=r)),this.geometryBuffer=n.positions,Array.isArray(a))for(const t of a)this._rebuildGeometry(t);else this._rebuildGeometry()}updatePartialGeometry({startRow:t,endRow:e}){this._rebuildGeometry({startRow:t,endRow:e})}getGeometryFromBuffer(t){const e=t.value||t;return ArrayBuffer.isView(e)?Object(r.b)(e,{size:this.positionSize,offset:t.offset,stride:t.stride,startIndices:this.data.startIndices}):null}_allocate(t,e){const{attributes:n,buffers:i,_attributeDefs:r,typedArrayManager:o}=this;for(const s in r)if(s in i)o.release(n[s]),n[s]=null;else{const i=r[s];i.copy=e,n[s]=o.allocate(n[s],t,i)}}_forEachGeometry(t,e,n){const{data:i,getGeometry:o}=this,{iterable:s,objectInfo:a}=Object(r.a)(i,e,n);for(const e of s){a.index++;t(o?o(e,a):null,a.index)}}_rebuildGeometry(t){if(!this.data)return;let{indexStarts:e,vertexStarts:n,instanceCount:i}=this;const{data:r,geometryBuffer:o}=this,{startRow:s=0,endRow:c=1/0}=t||{},l={};if(t||(e=[0],n=[0]),this.normalize||!o)this._forEachGeometry((t,e)=>{const i=t&&this.normalizeGeometry(t);l[e]=i,n[e+1]=n[e]+(i?this.getGeometrySize(i):0)},s,c),i=n[n.length-1];else if(n=r.startIndices,i=n[r.length]||0,ArrayBuffer.isView(o))i=i||o.length/this.positionSize;else if(o instanceof a.a){const t=o.accessor.stride||4*this.positionSize;i=i||o.byteLength/t}else if(o.buffer){const t=o.stride||4*this.positionSize;i=i||o.buffer.byteLength/t}else if(o.value){const t=o.value,e=o.stride/t.BYTES_PER_ELEMENT||this.positionSize;i=i||t.length/e}this._allocate(i,Boolean(t)),this.indexStarts=e,this.vertexStarts=n,this.instanceCount=i;const u={};this._forEachGeometry((t,r)=>{const o=l[r]||t;u.vertexStart=n[r],u.indexStart=e[r];const s=r<n.length-1?n[r+1]:i;u.geometrySize=s-n[r],u.geometryIndex=r,this.updateGeometryAttributes(o,u)},s,c),this.vertexCount=e[e.length-1]}}},1162:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(3),r=n(2103),o=n(52),s=n(586);class a extends s.a{getGeometry(t){return new r.a}draw({uniforms:t}){const{elevationScale:e,extruded:n,offset:i,coverage:r,cellSize:s,angle:a,radiusUnits:c}=this.props;this.state.model.setUniforms(t).setUniforms({radius:s/2,radiusUnits:o.e[c],angle:a,offset:i,extruded:n,coverage:r,elevationScale:e,edgeDistance:1,isWireframe:!1}).draw()}}Object(i.a)(a,"layerName","GridCellLayer"),Object(i.a)(a,"defaultProps",{cellSize:{type:"number",min:0,value:1e3},offset:{type:"array",value:[1,1]}})},1165:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n(3),r=n(407);class o extends r.a{getShaders(){const t=super.getShaders();return t.inject={"vs:#decl":"uniform float trailLength;\nattribute float instanceTimestamps;\nattribute float instanceNextTimestamps;\nvarying float vTime;\n","vs:#main-end":"vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;\n","fs:#decl":"uniform bool fadeTrail;\nuniform float trailLength;\nuniform float currentTime;\nvarying float vTime;\n","fs:#main-start":"if(vTime > currentTime || (fadeTrail && (vTime < currentTime - trailLength))) {\n  discard;\n}\n","fs:DECKGL_FILTER_COLOR":"if(fadeTrail) {\n  color.a *= 1.0 - (currentTime - vTime) / trailLength;\n}\n"},t}initializeState(){super.initializeState();this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}draw(t){const{fadeTrail:e,trailLength:n,currentTime:i}=this.props;t.uniforms={...t.uniforms,fadeTrail:e,trailLength:n,currentTime:i},super.draw(t)}}Object(i.a)(o,"layerName","TripsLayer"),Object(i.a)(o,"defaultProps",{fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:t=>t.timestamps}})},1176:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n(3),r=n(461),o=n(69),s=n(61);const a={bearing:0,pitch:0,position:[0,0,0]},c={speed:1.2,curve:1.414};class l extends r.a{constructor(t={}){super({compare:["longitude","latitude","zoom","bearing","pitch","position"],extract:["width","height","longitude","latitude","zoom","bearing","pitch","position"],required:["width","height","latitude","longitude","zoom"]}),Object(i.a)(this,"opts",void 0),this.opts={...c,...t}}interpolateProps(t,e,n){const i=Object(s.d)(t,e,n,this.opts);for(const r in a)i[r]=Object(o.g)(t[r]||a[r],e[r]||a[r],n);return i}getDuration(t,e){let{transitionDuration:n}=e;return"auto"===n&&(n=Object(s.h)(t,e,this.opts)),n}}},12:function(t,e,n){var i=n(18).default,r=n(10);t.exports=function(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?r(t):e},t.exports.default=t.exports,t.exports.__esModule=!0},128:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"f",(function(){return s})),n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return c})),n.d(e,"b",(function(){return d})),n.d(e,"g",(function(){return p})),n.d(e,"e",(function(){return f}));var i=n(256),r=n(327);function o(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function s(t,e){const n=t%e;return n<0?e+n:n}function a(t){return[t[12],t[13],t[14]]}function c(t){return{left:u(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:u(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:u(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:u(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:u(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:u(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const l=new r.a;function u(t,e,n,i){l.set(t,e,n);const o=l.len();return{distance:i/o,normal:new r.a(-t/o,-e/o,-n/o)}}function d(t){return t-Math.fround(t)}let h;function p(t,e){const{size:n=1,startIndex:r=0}=e,o=void 0!==e.endIndex?e.endIndex:t.length,s=(o-r)/n;h=i.a.allocate(h,s,{type:Float32Array,size:2*n});let a=r,c=0;for(;a<o;){for(let e=0;e<n;e++){const i=t[a++];h[c+e]=i,h[c+e+n]=d(i)}c+=2*n}return h.subarray(0,s*n*2)}function f(t){let e=null,n=!1;for(const i of t)i&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],i[0][0]),e[0][1]=Math.min(e[0][1],i[0][1]),e[1][0]=Math.max(e[1][0],i[1][0]),e[1][1]=Math.max(e[1][1],i[1][1])):e=i);return e}},129:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return s}));var i=n(68);let r={};function o(t){r=t}function s(t,e,n,o){i.a.level>0&&r[t]&&r[t].call(null,e,n,o)}},1300:function(t,e,n){"use strict";n.r(e);var i=n(568);n.d(e,"DeckGL",(function(){return i.a})),n.d(e,"default",(function(){return i.a}))},1343:function(t,e,n){t.exports=n(2009)},1375:function(t,e,n){"use strict";n.d(e,"a",(function(){return N}));var i=n(3),r=n(753),o=n(178),s=n(68),a=n(232);class c{constructor(t){Object(i.a)(this,"width",void 0),Object(i.a)(this,"height",void 0),Object(i.a)(this,"views",void 0),Object(i.a)(this,"viewState",void 0),Object(i.a)(this,"controllers",void 0),Object(i.a)(this,"timeline",void 0),Object(i.a)(this,"_viewports",void 0),Object(i.a)(this,"_viewportMap",void 0),Object(i.a)(this,"_isUpdating",void 0),Object(i.a)(this,"_needsRedraw",void 0),Object(i.a)(this,"_needsUpdate",void 0),Object(i.a)(this,"_eventManager",void 0),Object(i.a)(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(const t in this.controllers){const e=this.controllers[t];e&&e.finalize()}this.controllers={}}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const e=this.controllers[t];e&&e.updateTransition()}}getViewports(t){return t?this._viewports.filter(e=>e.containsPixel(t)):this._viewports}getViews(){const t={};return this.views.forEach(e=>{t[e.id]=e}),t}getView(t){return this.views.find(e=>e.id===t)}getViewState(t){const e="string"==typeof t?this.getView(t):t,n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}getViewport(t){return this._viewportMap[t]}unproject(t,e){const n=this.getViewports(),i={x:t[0],y:t[1]};for(let r=n.length-1;r>=0;--r){const o=n[r];if(o.containsPixel(i)){const n=t.slice();return n[0]-=o.x,n[1]-=o.y,o.unproject(n,e)}}return null}setProps(t){t.views&&this._setViews(t.views),t.viewState&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,e){t===this.width&&e===this.height||(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}_setViews(t){t=Object(a.b)(t,Boolean);this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){if(t){!Object(o.a)(t,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=t}else s.a.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(t,e){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...e,viewId:t})}_createController(t,e){return new(0,e.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,e.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:e=>{var n;return null===(n=this.getView(t.id))||void 0===n?void 0:n.makeViewport({viewState:e,width:this.width,height:this.height})}})}_updateController(t,e,n,i){const r=t.controller;if(r&&n){const o={...e,...r,id:t.id,x:n.x,y:n.y,width:n.width,height:n.height};return i&&i.constructor===r.type||(i=this._createController(t,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:t}=this,e=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let i=t.length;i--;){const r=t[i],o=this.getViewState(r),s=r.makeViewport({viewState:o,width:this.width,height:this.height});let a=e[r.id];const c=Boolean(r.controller);c&&!a&&(n=!0),!n&&c||!a||(a.finalize(),a=null),this.controllers[r.id]=this._updateController(r,o,s,a),s&&this._viewports.unshift(s)}for(const t in e){const n=e[t];n&&!this.controllers[t]&&n.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)})}_diffViews(t,e){return t.length!==e.length||t.some((n,i)=>!t[i].equals(e[i]))}}var l=n(576),u=n(587);const d=new u.a;class h{constructor(){Object(i.a)(this,"effects",void 0),Object(i.a)(this,"_resolvedEffects",[]),Object(i.a)(this,"_defaultEffects",[]),Object(i.a)(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(t){const e=this._defaultEffects;if(!e.find(e=>e.id===t.id)){const n=e.findIndex(e=>{return n=t,(null!==(i=e.order)&&void 0!==i?i:1/0)-(null!==(r=n.order)&&void 0!==r?r:1/0)>0;var n,i,r});n<0?e.push(t):e.splice(n,0,t),this._setEffects(this.effects)}}setProps(t){"effects"in t&&(Object(o.a)(t.effects,this.effects,1)||this._setEffects(t.effects))}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}getEffects(){return this._resolvedEffects}_setEffects(t){const e={};for(const t of this.effects)e[t.id]=t;const n=[];for(const i of t){const t=e[i.id];t&&t!==i?t.setProps?(t.setProps(i.props),n.push(t)):(t.cleanup(),n.push(i)):n.push(i),delete e[i.id]}for(const t in e)e[t].cleanup();this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),t.some(t=>t instanceof u.a)||this._resolvedEffects.push(d),this._needsRedraw="effects changed"}finalize(){for(const t of this._resolvedEffects)t.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}var p=n(762),f=n(275),g=n(425),m=n(29),v=n(955),b=n(459);const y={pickedColor:null,pickedObjectIndex:-1};function x({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:i,deviceRadius:r,deviceRect:o}){const{x:a,y:c,width:l,height:u}=o;let d=r*r,h=-1,p=0;for(let e=0;e<u;e++){const r=e+c-i,o=r*r;if(o>d)p+=4*l;else for(let e=0;e<l;e++){if(t[p+3]-1>=0){const t=e+a-n,i=t*t+o;i<=d&&(d=i,h=p)}p+=4}}if(h>=0){const n=t.slice(h,h+4),i=e(n);if(i){const t=Math.floor(h/4/l),e=h/4-t*l;return{...i,pickedColor:n,pickedX:a+e,pickedY:c+t}}s.a.error("Picked non-existent layer. Is picking buffer corrupt?")()}return y}function _({pickInfo:t,viewports:e,pixelRatio:n,x:i,y:r,z:o}){let s,a=e[0];if(e.length>1&&(a=function(t,e){for(let n=t.length-1;n>=0;n--){const i=t[n];if(i.containsPixel(e))return i}return t[0]}((null==t?void 0:t.pickedViewports)||e,{x:i,y:r})),a){const t=[i-a.x,r-a.y];void 0!==o&&(t[2]=o),s=a.unproject(t)}return{color:null,layer:null,viewport:a,index:-1,picked:!1,x:i,y:r,pixel:[i,r],coordinate:s,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function w(t){const{pickInfo:e,lastPickedInfo:n,mode:i,layers:r}=t,{pickedColor:o,pickedLayer:s,pickedObjectIndex:a}=e,c=s?[s]:[];if("hover"===i){const t=n.index,e=n.layerId,i=s?s.props.id:null;if(i!==e||a!==t){if(i!==e){const t=r.find(t=>t.props.id===e);t&&c.unshift(t)}n.layerId=i,n.index=a,n.info=null}}const l=_(t),u=new Map;return u.set(null,l),c.forEach(t=>{let e={...l};t===s&&(e.color=o,e.index=a,e.picked=!0),e=O({layer:t,info:e,mode:i});const r=e.layer;t===s&&"hover"===i&&(n.info=e),u.set(r.id,e),"hover"===i&&r.updateAutoHighlight(e)}),u}function O({layer:t,info:e,mode:n}){for(;t&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:i}),t=t.parent}return e}class P{constructor(t){Object(i.a)(this,"gl",void 0),Object(i.a)(this,"pickingFBO",void 0),Object(i.a)(this,"depthFBO",void 0),Object(i.a)(this,"pickLayersPass",void 0),Object(i.a)(this,"layerFilter",void 0),Object(i.a)(this,"lastPickedInfo",void 0),Object(i.a)(this,"_pickable",!0),this.gl=t,this.pickLayersPass=new b.a(t),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject({x:t,y:e,layers:n,viewports:i},r=this.lastPickedInfo.info){const o=r&&r.layer&&r.layer.id,s=r&&r.viewport&&r.viewport.id,a=o?n.find(t=>t.id===o):null,c=s&&i.find(t=>t.id===s)||i[0],l=c&&c.unproject([t-c.x,e-c.y]),u={x:t,y:e,viewport:c,coordinate:l,layer:a};return{...r,...u}}_resizeBuffer(){var t,e;const{gl:n}=this;if(!this.pickingFBO&&(this.pickingFBO=new f.a(n),f.a.isSupported(n,{colorBufferFloat:!0}))){const t=new f.a(n);t.attach({36064:new g.a(n,{format:Object(m.j)(n)?34836:6408,type:5126})}),this.depthFBO=t}null===(t=this.pickingFBO)||void 0===t||t.resize({width:n.canvas.width,height:n.canvas.height}),null===(e=this.depthFBO)||void 0===e||e.resize({width:n.canvas.width,height:n.canvas.height})}_getPickable(t){if(!1===this._pickable)return null;const e=t.filter(t=>this.pickLayersPass.shouldDrawLayer(t)&&!t.isComposite);return e.length?e:null}_pickClosestObject({layers:t,views:e,viewports:n,x:i,y:r,radius:o=0,depth:s=1,mode:a="query",unproject3D:c,onViewportActive:l,effects:u}){const d=this._getPickable(t),h=Object(m.e)(this.gl);if(!d)return{result:[],emptyInfo:_({viewports:n,x:i,y:r,pixelRatio:h})};this._resizeBuffer();const p=Object(m.d)(this.gl,[i,r],!0),f=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],g=Math.round(o*h),{width:v,height:b}=this.pickingFBO,y=this._getPickingRect({deviceX:f[0],deviceY:f[1],deviceRadius:g,deviceWidth:v,deviceHeight:b}),O={x:i-o,y:r-o,width:2*o+1,height:2*o+1};let P;const S=[],C=new Set;for(let t=0;t<s;t++){let o,p;if(y){o=x({...this._drawAndSample({layers:d,views:e,viewports:n,onViewportActive:l,deviceRect:y,cullRect:O,effects:u,pass:"picking:".concat(a)}),deviceX:f[0],deviceY:f[1],deviceRadius:g,deviceRect:y})}else o={pickedColor:null,pickedObjectIndex:-1};if(o.pickedLayer&&c&&this.depthFBO){const{pickedColors:t}=this._drawAndSample({layers:[o.pickedLayer],views:e,viewports:n,onViewportActive:l,deviceRect:{x:o.pickedX,y:o.pickedY,width:1,height:1},cullRect:O,effects:u,pass:"picking:".concat(a,":z")},!0);t[3]&&(p=t[0])}o.pickedLayer&&t+1<s&&(C.add(o.pickedLayer),o.pickedLayer.disablePickingIndex(o.pickedObjectIndex)),P=w({pickInfo:o,lastPickedInfo:this.lastPickedInfo,mode:a,layers:d,viewports:n,x:i,y:r,z:p,pixelRatio:h});for(const t of P.values())t.layer&&S.push(t);if(!o.pickedColor)break}for(const t of C)t.restorePickingColors();return{result:S,emptyInfo:P.get(null)}}_pickVisibleObjects({layers:t,views:e,viewports:n,x:i,y:r,width:o=1,height:a=1,mode:c="query",maxObjects:l=null,onViewportActive:u,effects:d}){const h=this._getPickable(t);if(!h)return[];this._resizeBuffer();const p=Object(m.e)(this.gl),f=Object(m.d)(this.gl,[i,r],!0),g=f.x,v=f.y+f.height,b=Object(m.d)(this.gl,[i+o,r+a],!0),y=b.x+b.width,x=b.y,_={x:g,y:x,width:y-g,height:v-x},w=function({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t)for(let i=0;i<t.length;i+=4){if(t[i+3]-1>=0){const r=t.slice(i,i+4),o=r.join(",");if(!n.has(o)){const t=e(r);t?n.set(o,{...t,color:r}):s.a.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}(this._drawAndSample({layers:h,views:e,viewports:n,onViewportActive:u,deviceRect:_,cullRect:{x:i,y:r,width:o,height:a},effects:d,pass:"picking:".concat(c)})),P=new Map,S=Number.isFinite(l);for(let t=0;t<w.length&&!(S&&l&&P.size>=l);t++){const e=w[t];let n={color:e.pickedColor,layer:null,index:e.pickedObjectIndex,picked:!0,x:i,y:r,pixelRatio:p};n=O({layer:e.pickedLayer,info:n,mode:c}),P.has(n.object)||P.set(n.object,n)}return Array.from(P.values())}_drawAndSample({layers:t,views:e,viewports:n,onViewportActive:i,deviceRect:r,cullRect:o,effects:s,pass:a},c=!1){const l=c?this.depthFBO:this.pickingFBO,u={layers:t,layerFilter:this.layerFilter,views:e,viewports:n,onViewportActive:i,pickingFBO:l,deviceRect:r,cullRect:o,effects:s,pass:a,pickZ:c,preRenderStats:{}};for(const t of s)t.useInPicking&&(u.preRenderStats[t.id]=t.preRender(this.gl,u));const{decodePickingColor:d}=this.pickLayersPass.render(u),{x:h,y:p,width:f,height:g}=r,m=new(c?Float32Array:Uint8Array)(f*g*4);return Object(v.c)(l,{sourceX:h,sourceY:p,sourceWidth:f,sourceHeight:g,target:m}),{pickedColors:m,decodePickingColor:d}}_getPickingRect({deviceX:t,deviceY:e,deviceRadius:n,deviceWidth:i,deviceHeight:r}){const o=Math.max(0,t-n),s=Math.max(0,e-n),a=Math.min(i,t+n+1)-o,c=Math.min(r,e+n+1)-s;return a<=0||c<=0?null:{x:o,y:s,width:a,height:c}}}const S={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class C{constructor(t){Object(i.a)(this,"el",null),Object(i.a)(this,"isVisible",!1);const e=t.parentElement;e&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,S),e.appendChild(this.el))}setTooltip(t,e,n){const i=this.el;if(i){if("string"==typeof t)i.innerText=t;else{if(!t)return this.isVisible=!1,void(i.style.display="none");t.text&&(i.innerText=t.text),t.html&&(i.innerHTML=t.html),t.className&&(i.className=t.className)}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(e,"px, ").concat(n,"px)"),t&&"object"==typeof t&&"style"in t&&Object.assign(i.style,t.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var j=n(256),M=n(761),E=n(2158),L=n(2209),T=n(2163),R=n(607),A=n(514),I=n(1445),k=n(116),z=n(52);function D(){}const F={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:D,onResize:D,onViewStateChange:D,onInteractionStateChange:D,onBeforeRender:D,onAfterRender:D,onLoad:D,onError:t=>s.a.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:({isDragging:t})=>t?"grabbing":"grab",getTooltip:null,debug:!1,drawPickingColors:!1};class N{constructor(t){Object(i.a)(this,"props",void 0),Object(i.a)(this,"width",0),Object(i.a)(this,"height",0),Object(i.a)(this,"userData",{}),Object(i.a)(this,"canvas",null),Object(i.a)(this,"viewManager",null),Object(i.a)(this,"layerManager",null),Object(i.a)(this,"effectManager",null),Object(i.a)(this,"deckRenderer",null),Object(i.a)(this,"deckPicker",null),Object(i.a)(this,"eventManager",null),Object(i.a)(this,"tooltip",null),Object(i.a)(this,"metrics",void 0),Object(i.a)(this,"animationLoop",void 0),Object(i.a)(this,"stats",void 0),Object(i.a)(this,"viewState",void 0),Object(i.a)(this,"cursorState",void 0),Object(i.a)(this,"_needsRedraw",void 0),Object(i.a)(this,"_pickRequest",void 0),Object(i.a)(this,"_lastPointerDownInfo",null),Object(i.a)(this,"_metricsCounter",void 0),Object(i.a)(this,"_onPointerMove",t=>{const{_pickRequest:e}=this;if("pointerleave"===t.type)e.x=-1,e.y=-1,e.radius=0;else{if(t.leftButton||t.rightButton)return;{const n=t.offsetCenter;if(!n)return;e.x=n.x,e.y=n.y,e.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:e.x,y:e.y}),e.event=t}),Object(i.a)(this,"_onEvent",t=>{const e=z.b[t.type],n=t.offsetCenter;if(!e||!n||!this.layerManager)return;const i=this.layerManager.getLayers(),r=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:i,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:o}=r,s=o&&(o[e.handler]||o.props[e.handler]),a=this.props[e.handler];let c=!1;s&&(c=s.call(o,r,t)),!c&&a&&a(r,t)}),Object(i.a)(this,"_onPointerDown",t=>{const e=t.offsetCenter,n=this._pick("pickObject","pickObject Time",{x:e.x,y:e.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=n.result[0]||n.emptyInfo}),this.props={...F,...t},t=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},t.viewState&&t.initialViewState&&s.a.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===Object(E.a)()&&s.a.warn("IE 11 is not supported")(),this.viewState=t.initialViewState,t.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(t)),this.animationLoop=this._createAnimationLoop(t),this.stats=new A.a({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(t),t._typedArrayManagerProps&&j.a.setOptions(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){var t,e,n,i,r,o,s,a,c;(null===(t=this.animationLoop)||void 0===t||t.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,null===(e=this.layerManager)||void 0===e||e.finalize(),this.layerManager=null,null===(n=this.viewManager)||void 0===n||n.finalize(),this.viewManager=null,null===(i=this.effectManager)||void 0===i||i.finalize(),this.effectManager=null,null===(r=this.deckRenderer)||void 0===r||r.finalize(),this.deckRenderer=null,null===(o=this.deckPicker)||void 0===o||o.finalize(),this.deckPicker=null,null===(s=this.eventManager)||void 0===s||s.destroy(),this.eventManager=null,null===(a=this.tooltip)||void 0===a||a.remove(),this.tooltip=null,this.props.canvas||this.props.gl||!this.canvas)||(null===(c=this.canvas.parentElement)||void 0===c||c.removeChild(this.canvas),this.canvas=null)}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&s.a.removed("onLayerHover","onHover")(),"onLayerClick"in t&&s.a.removed("onLayerClick","onClick")(),t.initialViewState&&!Object(o.a)(this.props.initialViewState,t.initialViewState,3)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);const e=Object.create(this.props);Object.assign(e,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(e),this.layerManager&&(this.viewManager.setProps(e),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(e),this.effectManager.setProps(e),this.deckRenderer.setProps(e),this.deckPicker.setProps(e)),this.stats.get("setProps Time").timeEnd()}needsRedraw(t={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(t),i=this.layerManager.needsRedraw(t),r=this.effectManager.needsRedraw(t),o=this.deckRenderer.needsRedraw(t);return e=e||n||i||r||o,e}redraw(t){if(!this.layerManager)return;let e=this.needsRedraw({clearRedrawFlags:!0});e=t||e,e&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(e):this._drawLayers(e))}get isInitialized(){return null!==this.viewManager}getViews(){return Object(k.a)(this.viewManager),this.viewManager.views}getViewports(t){return Object(k.a)(this.viewManager),this.viewManager.getViewports(t)}getCanvas(){return this.canvas}pickObject(t){const e=this._pick("pickObject","pickObject Time",t).result;return e.length?e[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t,e=!1){for(const n in t)this.layerManager.resourceManager.add({resourceId:n,data:t[n],forceUpdate:e})}_removeResources(t){for(const e of t)this.layerManager.resourceManager.remove(e)}_addDefaultEffect(t){this.effectManager.addDefaultEffect(t)}_pick(t,e,n){Object(k.a)(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(e).timeStart();const r=this.deckPicker[t]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return i.get(e).timeEnd(),r}_createCanvas(t){let e=t.canvas;if("string"==typeof e&&(e=document.getElementById(e),Object(k.a)(e)),!e){e=document.createElement("canvas"),e.id=t.id||"deckgl-overlay";(t.parent||document.body).appendChild(e)}return Object.assign(e.style,t.style),e}_setCanvasSize(t){if(!this.canvas)return;const{width:e,height:n}=t;if(e||0===e){const t=Number.isFinite(e)?"".concat(e,"px"):e;this.canvas.style.width=t}if(n||0===n){var i;const e=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.position=(null===(i=t.style)||void 0===i?void 0:i.position)||"absolute",this.canvas.style.height=e}}_updateCanvasSize(){var t,e;const{canvas:n}=this;if(!n)return;const i=null!==(t=n.clientWidth)&&void 0!==t?t:n.width,r=null!==(e=n.clientHeight)&&void 0!==e?e:n.height;var o,s;i===this.width&&r===this.height||(this.width=i,this.height=r,null===(o=this.viewManager)||void 0===o||o.setProps({width:i,height:r}),null===(s=this.layerManager)||void 0===s||s.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:r}))}_createAnimationLoop(t){const{width:e,height:n,gl:i,glOptions:r,debug:o,onError:s,onBeforeRender:a,onAfterRender:c,useDevicePixels:l}=t;return new L.a({width:e,height:n,useDevicePixels:l,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:t=>Object(m.c)({...r,...t,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:t=>this._setGLContext(t.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:a,onAfterRender:c,onError:s})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let t=this.props.views||[new l.a({id:"default-view"})];return t=Array.isArray(t)?t:[t],t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:t}=this;if(t.event){const{result:n,emptyInfo:i}=this._pick("pickObject","pickObject Time",t);this.cursorState.isHovering=n.length>0;let r=i,o=!1;for(const i of n){var e;r=i,o=(null===(e=i.layer)||void 0===e?void 0:e.onHover(i,t.event))||o}if(!o&&this.props.onHover&&this.props.onHover(r,t.event),this.props.getTooltip&&this.tooltip){const t=this.props.getTooltip(r);this.tooltip.setTooltip(t,r.x,r.y)}t.event=null}}_updateCursor(){const t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(t){if(this.layerManager)return;this.canvas||(this.canvas=t.canvas,Object(m.h)(t,{enable:!0,copyState:!0})),this.tooltip=new C(this.canvas),Object(m.n)(t,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(t);const e=new T.a;e.play(),this.animationLoop.attachTimeline(e),this.eventManager=new I.a(this.props.parent||t.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const t in z.b)this.eventManager.on(t,this._onEvent);this.viewManager=new c({timeline:e,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new r.a(t,{deck:this,stats:this.stats,viewport:n,timeline:e}),this.effectManager=new h,this.deckRenderer=new p.a(t),this.deckPicker=new P(t),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,e){const{gl:n}=this.layerManager.context;Object(m.n)(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...e}),this.props.onAfterRender({gl:n})}_onRenderFrame(t){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),s.a.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){const e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:e},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.cursorState.isDragging=t.isDragging||!1,this.props.onInteractionStateChange(t)}_getFrameStats(){const{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();const e=this.animationLoop.stats;t.get("GPU Time").addTime(e.get("GPU Time").lastTiming),t.get("CPU Time").addTime(e.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:t,stats:e}=this;t.fps=e.get("frameRate").getHz(),t.setPropsTime=e.get("setProps Time").time,t.updateAttributesTime=e.get("Update Attributes").time,t.framesRedrawn=e.get("Redraw Count").count,t.pickTime=e.get("pickObject Time").time+e.get("pickMultipleObjects Time").time+e.get("pickObjects Time").time,t.pickCount=e.get("Pick Count").count,t.gpuTime=e.get("GPU Time").time,t.cpuTime=e.get("CPU Time").time,t.gpuTimePerFrame=e.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=e.get("CPU Time").getAverageTime();const n=R.a.get("Memory Usage");t.bufferMemory=n.get("Buffer Memory").count,t.textureMemory=n.get("Texture Memory").count,t.renderbufferMemory=n.get("Renderbuffer Memory").count,t.gpuMemory=n.get("GPU Memory").count}}Object(i.a)(N,"defaultProps",F),Object(i.a)(N,"VERSION",M.a)},1377:function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var i=n(3),r=n(747),o=n(1157),s=n(1158),a=n(68),c=n(29),l=n(2211),u=n(597),d=n(2201),h=n(2180);async function p(t){const e=[];return t.scenes.forEach(t=>{t.traverse(t=>{Object.values(t.model.getUniforms()).forEach(t=>{!1===t.loaded&&e.push(t)})})}),await async function(t){for(;t();)await new Promise(t=>requestAnimationFrame(t))}(()=>e.some(t=>!t.loaded))}var f=n(535);const g=[255,255,255,255],m={scenegraph:{type:"object",value:null,async:!0},getScene:t=>t&&t.scenes?"object"==typeof t.scene?t.scene:t.scenes[t.scene||0]:t,getAnimator:t=>t&&t.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:g},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[h.a]};class v extends r.a{constructor(...t){super(...t),Object(i.a)(this,"state",void 0)}getShaders(){const t=[o.a,s.a];return"pbr"===this.props._lighting&&t.push(l.a),super.getShaders({vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  vec3 normal = vec3(0.0, 0.0, 1.0);\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      normal = instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz;\n    #endif\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    geometry.normal = project_normal(normal);\n    geometry.worldPosition += pos;\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n    geometry.normal = project_normal(normal);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n    #ifdef HAS_NORMALS\n      pbr_vNormal = geometry.normal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:t})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:g,transition:!0},instanceModelMatrix:f.a})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;e.scenegraph!==n.scenegraph?this._updateScenegraph():e._animations!==n._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,e._animations)}finalizeState(t){super.finalizeState(t),this._deleteScenegraph()}_updateScenegraph(){const t=this.props,{gl:e}=this.context;let n=null;if(t.scenegraph instanceof u.a)n={scenes:[t.scenegraph]};else if(t.scenegraph&&!t.scenegraph.gltf){const i=t.scenegraph,r=Object(d.a)(e,i,this._getModelOptions());n={gltf:i,...r},p(r).then(()=>this.setNeedsRedraw())}else t.scenegraph&&(a.a.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),n=t.scenegraph);const i={layer:this,gl:e},r=t.getScene(n,i),o=t.getAnimator(n,i);r instanceof u.a?(this._deleteScenegraph(),this._applyAllAttributes(r),this._applyAnimationsProp(r,o,t._animations),this.setState({scenegraph:r,animator:o})):null!==r&&a.a.warn("invalid scenegraph:",r)()}_applyAllAttributes(t){if(this.state.attributesAvailable){const e=this.getAttributeManager().getAttributes();t.traverse(t=>{this._setModelAttributes(t.model,e)})}}_applyAnimationsProp(t,e,n){if(!t||!e||!n)return;const i=e.getAnimations();Object.keys(n).sort().forEach(t=>{const e=n[t];if("*"===t)i.forEach(t=>{Object.assign(t,e)});else if(Number.isFinite(Number(t))){const n=Number(t);n>=0&&n<i.length?Object.assign(i[n],e):a.a.warn("animation ".concat(t," not found"))()}else{const n=i.find(({name:e})=>e===t);n?Object.assign(n,e):a.a.warn("animation ".concat(t," not found"))()}})}_deleteScenegraph(){const{scenegraph:t}=this.state;t instanceof u.a&&t.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:t}=this.props;let e=null;return t&&(e="function"==typeof t?t({gl:this.context.gl,layer:this}):t),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:e,modelOptions:{isInstanced:!0,transpileToGLSL100:!Object(c.j)(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(t){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(e=>{this._setModelAttributes(e.model,t)})}draw({moduleParameters:t=null,parameters:e={},context:n}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(n.timeline.getTime()),this.setNeedsRedraw());const{viewport:i}=this.context,{sizeScale:r,sizeMinPixels:o,sizeMaxPixels:s,opacity:a,coordinateSystem:c}=this.props,l=this.getNumInstances();this.state.scenegraph.traverse((n,{worldMatrix:u})=>{n.model.setInstanceCount(l),n.updateModuleSettings(t),n.draw({parameters:e,uniforms:{sizeScale:r,opacity:a,sizeMinPixels:o,sizeMaxPixels:s,composeModelMatrix:Object(f.b)(i,c),sceneModelMatrix:u,u_Camera:n.model.getUniforms().project_uCameraPosition}})})}}Object(i.a)(v,"defaultProps",m),Object(i.a)(v,"layerName","ScenegraphLayer")},1378:function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var i=n(3),r=n(52),o=n(747),s=n(1157),a=n(1158),c=n(798),l=n(237),u=n(61),d=n(2218);const h=new Uint16Array([0,2,1,0,3,2]),p=new Float32Array([0,1,0,0,1,0,1,1]);function f(t,e){if(!e)return function(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[3*n+0]=t[n][0],e[3*n+1]=t[n][1],e[3*n+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:h,texCoords:p}}(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),i=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),r=Math.ceil(n/e)+1,o=Math.ceil(i/e)+1,s=(r-1)*(o-1)*6,a=new Uint32Array(s),c=new Float32Array(r*o*2),l=new Float64Array(r*o*3);let u=0,d=0;for(let e=0;e<r;e++){const n=e/(r-1);for(let i=0;i<o;i++){const r=i/(o-1),s=g(t,n,r);l[3*u+0]=s[0],l[3*u+1]=s[1],l[3*u+2]=s[2]||0,c[2*u+0]=n,c[2*u+1]=1-r,e>0&&i>0&&(a[d++]=u-o,a[d++]=u-o-1,a[d++]=u-1,a[d++]=u-o,a[d++]=u-1,a[d++]=u),u++}}return{vertexCount:s,positions:l,indices:a,texCoords:c}}function g(t,e,n){return Object(d.c)(Object(d.c)(t[0],t[1],n),Object(d.c)(t[3],t[2],n),e)}var m="\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float desaturate;\nuniform vec4 transparentColor;\nuniform vec3 tintColor;\nuniform float opacity;\n\nuniform float coordinateConversion;\nuniform vec4 bounds;\n\n/* projection utils */\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / PI / 2.0;\n\n// from degrees to Web Mercator\nvec2 lnglat_to_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// from Web Mercator to degrees\nvec2 mercator_to_lnglat(vec2 xy) {\n  xy /= WORLD_SCALE;\n  return degrees(vec2(\n    xy.x - PI,\n    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5\n  ));\n}\n/* End projection utils */\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  if (transparentColor.a == 0.0) {\n    return vec4(color, alpha);\n  }\n  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);\n  float highLightRatio = alpha / blendedAlpha;\n  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);\n  return vec4(blendedRGB, blendedAlpha);\n}\n\nvec2 getUV(vec2 pos) {\n  return vec2(\n    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),\n    (pos.y - bounds[3]) / (bounds[1] - bounds[3])\n  );\n}\n\n".concat("\nvec3 packUVsIntoRGB(vec2 uv) {\n  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction\n  vec2 uv8bit = floor(uv * 256.);\n\n  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits\n  // Scale and clamp to 0-1 range\n  vec2 uvFraction = fract(uv * 256.);\n  vec2 uvFraction4bit = floor(uvFraction * 16.);\n\n  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates\n  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;\n\n  return vec3(uv8bit, fractions) / 255.;\n}\n","\n\nvoid main(void) {\n  vec2 uv = vTexCoord;\n  if (coordinateConversion < -0.5) {\n    vec2 lnglat = mercator_to_lnglat(vTexPos);\n    uv = getUV(lnglat);\n  } else if (coordinateConversion > 0.5) {\n    vec2 commonPos = lnglat_to_mercator(vTexPos);\n    uv = getUV(commonPos);\n  }\n  vec4 bitmapColor = texture2D(bitmapTexture, uv);\n\n  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);\n\n  geometry.uv = uv;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n\n  if (picking_uActive && !picking_uAttribute) {\n    // Since instance information is not used, we can use picking color for pixel index\n    gl_FragColor.rgb = packUVsIntoRGB(uv);\n  }\n}\n");const v={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:r.a.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0}};class b extends o.a{constructor(...t){super(...t),Object(i.a)(this,"state",void 0)}getShaders(){return super.getShaders({vs:"\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nattribute vec2 texCoords;\nattribute vec3 positions;\nattribute vec3 positions64Low;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float coordinateConversion;\n\nconst vec3 pickingColor = vec3(1.0, 0.0, 0.0);\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = pickingColor;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  if (coordinateConversion < -0.5) {\n    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;\n  } else if (coordinateConversion > 0.5) {\n    vTexPos = geometry.worldPosition.xy;\n  }\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n",fs:m,modules:[s.a,a.a]})}initializeState(){const t=this.getAttributeManager();t.remove(["instancePickingColors"]);t.add({indices:{size:1,isIndexed:!0,update:t=>t.value=this.state.mesh.indices,noAlloc:!0},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:t=>t.value=this.state.mesh.positions,noAlloc:!0},texCoords:{size:2,update:t=>t.value=this.state.mesh.texCoords,noAlloc:!0}})}updateState({props:t,oldProps:e,changeFlags:n}){const i=this.getAttributeManager();if(n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),i.invalidateAll()}if(t.bounds!==e.bounds){const t=this.state.mesh,e=this._createMesh();this.state.model.setVertexCount(e.vertexCount);for(const n in e)t&&t[n]!==e[n]&&i.invalidate(n);this.setState({mesh:e,...this._getCoordinateUniforms()})}else t._imageCoordinateSystem!==e._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(t){const{image:e}=this.props,n=t.info;if(!n.color||!e)return n.bitmap=null,n;const{width:i,height:r}=e;n.index=0;const o=function(t){const[e,n,i]=t;return[(e+(15&i)/16)/256,(n+(240&i)/256)/256]}(n.color),s=[Math.floor(o[0]*i),Math.floor(o[1]*r)];return n.bitmap={size:{width:i,height:r},uv:o,pixel:s},n}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(t){super._updateAutoHighlight({...t,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:t}=this.props;let e=t;return y(t)&&(e=[[t[0],t[1]],[t[0],t[3]],[t[2],t[3]],[t[2],t[1]]]),f(e,this.context.viewport.resolution)}_getModel(t){return t?new c.a(t,{...this.getShaders(),id:this.props.id,geometry:new l.a({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(t){const{uniforms:e,moduleParameters:n}=t,{model:i,coordinateConversion:r,bounds:o,disablePicking:s}=this.state,{image:a,desaturate:c,transparentColor:l,tintColor:u}=this.props;n.pickingActive&&s||a&&i&&i.setUniforms(e).setUniforms({bitmapTexture:a,desaturate:c,transparentColor:l.map(t=>t/255),tintColor:u.slice(0,3).map(t=>t/255),coordinateConversion:r,bounds:o}).draw()}_getCoordinateUniforms(){const{LNGLAT:t,CARTESIAN:e,DEFAULT:n}=r.a;let{_imageCoordinateSystem:i}=this.props;if(i!==n){const{bounds:n}=this.props;if(!y(n))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const r=this.context.viewport.resolution?t:e;if(i=i===t?t:e,i===t&&r===e)return{coordinateConversion:-1,bounds:n};if(i===e&&r===t){const t=Object(u.l)([n[0],n[1]]),e=Object(u.l)([n[2],n[3]]);return{coordinateConversion:1,bounds:[t[0],t[1],e[0],e[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}function y(t){return Number.isFinite(t[0])}Object(i.a)(b,"layerName","BitmapLayer"),Object(i.a)(b,"defaultProps",v)},1379:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i=n(3),r=n(747),o=n(1157),s=n(1158),a=n(52),c=n(798),l=n(237);const u=[0,0,0,255],d={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getSourceColor:{type:"accessor",value:u},getTargetColor:{type:"accessor",value:u},getWidth:{type:"accessor",value:1},getHeight:{type:"accessor",value:1},getTilt:{type:"accessor",value:0},greatCircle:!1,numSegments:{type:"number",value:50,min:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class h extends r.a{constructor(...t){super(...t),Object(i.a)(this,"state",void 0)}getBounds(){var t;return null===(t=this.getAttributeManager())||void 0===t?void 0:t.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:"#define SHADER_NAME arc-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec4 instanceSourceColors;\nattribute vec4 instanceTargetColors;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\nattribute float instanceHeights;\nattribute float instanceTilts;\n\nuniform bool greatCircle;\nuniform bool useShortestPath;\nuniform float numSegments;\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform int widthUnits;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nfloat paraboloid(float distance, float sourceZ, float targetZ, float ratio) {\n\n  float deltaZ = targetZ - sourceZ;\n  float dh = distance * instanceHeights;\n  if (dh == 0.0) {\n    return sourceZ + deltaZ * ratio;\n  }\n  float unitZ = deltaZ / dh;\n  float p2 = unitZ * unitZ + 1.0;\n  float dir = step(deltaZ, 0.0);\n  float z0 = mix(sourceZ, targetZ, dir);\n  float r = mix(ratio, 1.0 - ratio, dir);\n  return sqrt(r * (p2 - r)) * dh + z0;\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n}\n\nvec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {\n  float distance = length(source.xy - target.xy);\n  float z = paraboloid(distance, source.z, target.z, segmentRatio);\n\n  float tiltAngle = radians(instanceTilts);\n  vec2 tiltDirection = normalize(target.xy - source.xy);\n  vec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);\n\n  return vec3(\n    mix(source.xy, target.xy, segmentRatio) + tilt,\n    z * cos(tiltAngle)\n  );\n}\nfloat getAngularDist (vec2 source, vec2 target) {\n  vec2 sourceRadians = radians(source);\n  vec2 targetRadians = radians(target);\n  vec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);\n  vec2 shd_sq = sin_half_delta * sin_half_delta;\n\n  float a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;\n  return 2.0 * asin(sqrt(a));\n}\n\nvec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {\n  vec2 lngLat;\n  if(abs(angularDist - PI) < 0.001) {\n    lngLat = (1.0 - t) * source.xy + t * target.xy;\n  } else {\n    float a = sin((1.0 - t) * angularDist);\n    float b = sin(t * angularDist);\n    vec3 p = source3D.yxz * a + target3D.yxz * b;\n    lngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));\n  }\n\n  float z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);\n\n  return vec3(lngLat, z);\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  float segmentIndex = positions.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));\n  float nextSegmentRatio = getSegmentRatio(min(numSegments - 1.0, segmentIndex + 1.0));\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  isValid = 1.0;\n\n  uv = vec2(segmentRatio, positions.y);\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n\n  vec4 curr;\n  vec4 next;\n  vec3 source;\n  vec3 target;\n\n  if ((greatCircle || project_uProjectionMode == PROJECTION_MODE_GLOBE) && project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n    source = project_globe_(vec3(instanceSourcePositions.xy, 0.0));\n    target = project_globe_(vec3(instanceTargetPositions.xy, 0.0));\n    float angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);\n\n    vec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);\n    vec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);\n    vec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);\n\n    if (abs(currPos.x - prevPos.x) > 180.0) {\n      indexDir = -1.0;\n      isValid = 0.0;\n    } else if (abs(currPos.x - nextPos.x) > 180.0) {\n      indexDir = 1.0;\n      isValid = 0.0;\n    }\n    nextPos = indexDir < 0.0 ? prevPos : nextPos;\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n\n    if (isValid == 0.0) {\n      nextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;\n      float t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);\n      currPos = mix(currPos, nextPos, t);\n      segmentRatio = mix(segmentRatio, nextSegmentRatio, t);\n    }\n\n    vec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);\n    vec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);\n  \n    curr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);\n    next = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));\n  \n  } else {\n    vec3 source_world = instanceSourcePositions;\n    vec3 target_world = instanceTargetPositions;\n    if (useShortestPath) {\n      source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n      target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n\n      float deltaLng = target_world.x - source_world.x;\n      if (deltaLng > 180.) target_world.x -= 360.;\n      if (deltaLng < -180.) source_world.x -= 360.;\n    }\n    source = project_position(source_world, instanceSourcePositions64Low);\n    target = project_position(target_world, instanceTargetPositions64Low);\n    float antiMeridianX = 0.0;\n\n    if (useShortestPath) {\n      if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n        antiMeridianX = -(project_uCoordinateOrigin.x + 180.) / 360. * TILE_SIZE;\n      }\n      float thresholdRatio = (antiMeridianX - source.x) / (target.x - source.x);\n\n      if (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {\n        isValid = 0.0;\n        indexDir = sign(segmentRatio - thresholdRatio);\n        segmentRatio = thresholdRatio;\n      }\n    }\n\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n    vec3 currPos = interpolateFlat(source, target, segmentRatio);\n    vec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);\n\n    if (useShortestPath) {\n      if (nextPos.x < antiMeridianX) {\n        currPos.x += TILE_SIZE;\n        nextPos.x += TILE_SIZE;\n      }\n    }\n\n    curr = project_common_position_to_clipspace(vec4(currPos, 1.0));\n    next = project_common_position_to_clipspace(vec4(nextPos, 1.0));\n    geometry.position = vec4(currPos, 1.0);\n  }\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels\n  );\n  vec3 offset = vec3(\n    getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  DECKGL_FILTER_GL_POSITION(curr, geometry);\n  gl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n\n  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);\n  vColor = vec4(color.rgb, color.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME arc-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nvoid main(void) {\n  if (isValid == 0.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  geometry.uv = uv;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[o.a,s.a]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceSourceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getSourceColor",defaultValue:u},instanceTargetColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getTargetColor",defaultValue:u},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:"getHeight",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:"getTilt",defaultValue:0}})}updateState(t){super.updateState(t);const{props:e,oldProps:n,changeFlags:i}=t;if(i.extensionsChanged||i.propsChanged&&e.numSegments!==n.numSegments){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{widthUnits:e,widthScale:n,widthMinPixels:i,widthMaxPixels:r,greatCircle:o,wrapLongitude:s}=this.props;this.state.model.setUniforms(t).setUniforms({greatCircle:o,widthUnits:a.e[e],widthScale:n,widthMinPixels:i,widthMaxPixels:r,useShortestPath:s}).draw()}_getModel(t){const{id:e,numSegments:n}=this.props;let i=[];for(let t=0;t<n;t++)i=i.concat([t,1,0,t,-1,0]);const r=new c.a(t,{...this.getShaders(),id:e,geometry:new l.a({drawMode:5,attributes:{positions:new Float32Array(i)}}),isInstanced:!0});return r.setUniforms({numSegments:n}),r}}Object(i.a)(h,"layerName","ArcLayer"),Object(i.a)(h,"defaultProps",d)},1380:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var i=n(3),r=n(747),o=n(1157),s=n(1158),a=n(52),c=n(798),l=n(237);const u={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getColor:{type:"accessor",value:[0,0,0,255]},getWidth:{type:"accessor",value:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class d extends r.a{getBounds(){var t;return null===(t=this.getAttributeManager())||void 0===t?void 0:t.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:"#define SHADER_NAME line-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float useShortestPath;\nuniform int widthUnits;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nvec3 splitLine(vec3 a, vec3 b, float x) {\n  float t = (x - a.x) / (b.x - a.x);\n  return vec3(x, mix(a.yz, b.yz, t));\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  vec3 source_world = instanceSourcePositions;\n  vec3 target_world = instanceTargetPositions;\n  vec3 source_world_64low = instanceSourcePositions64Low;\n  vec3 target_world_64low = instanceTargetPositions64Low;\n\n  if (useShortestPath > 0.5 || useShortestPath < -0.5) {\n    source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n    target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n    float deltaLng = target_world.x - source_world.x;\n\n    if (deltaLng * useShortestPath > 180.) {\n      source_world.x += 360. * useShortestPath;\n      source_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      source_world_64low = vec3(0.0);\n    } else if (deltaLng * useShortestPath < -180.) {\n      target_world.x += 360. * useShortestPath;\n      target_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      target_world_64low = vec3(0.0);\n    } else if (useShortestPath < 0.) {\n      gl_Position = vec4(0.);\n      return;\n    }\n  }\n  vec4 source_commonspace;\n  vec4 target_commonspace;\n  vec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);\n  vec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);\n  float segmentIndex = positions.x;\n  vec4 p = mix(source, target, segmentIndex);\n  geometry.position = mix(source_commonspace, target_commonspace, segmentIndex);\n  uv = positions.xy;\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels\n  );\n  vec3 offset = vec3(\n    getExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  DECKGL_FILTER_GL_POSITION(p, geometry);\n  gl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME line-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[o.a,s.a]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1}})}updateState(t){if(super.updateState(t),t.changeFlags.extensionsChanged){var e;const{gl:t}=this.context;null===(e=this.state.model)||void 0===e||e.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{widthUnits:e,widthScale:n,widthMinPixels:i,widthMaxPixels:r,wrapLongitude:o}=this.props;this.state.model.setUniforms(t).setUniforms({widthUnits:a.e[e],widthScale:n,widthMinPixels:i,widthMaxPixels:r,useShortestPath:o?1:0}).draw(),o&&this.state.model.setUniforms({useShortestPath:-1}).draw()}_getModel(t){return new c.a(t,{...this.getShaders(),id:this.props.id,geometry:new l.a({drawMode:5,attributes:{positions:new Float32Array([0,-1,0,0,1,0,1,-1,0,1,1,0])}}),isInstanced:!0})}}Object(i.a)(d,"layerName","LineLayer"),Object(i.a)(d,"defaultProps",u)},1381:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var i=n(3),r=n(273),o=n(309),s=n.n(o);const a=180/Math.PI;function c(t,e,n){const i=1<<e;return[(t[0]+n[0])/i,(t[1]+n[1])/i]}function l(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}function u(t){return[l(t[0]),l(t[1])]}function d(t,[e,n]){switch(t){case 0:return[1,e,n];case 1:return[-e,1,n];case 2:return[-e,-n,1];case 3:return[-1,-n,-e];case 4:return[n,-1,-e];case 5:return[n,e,-1];default:throw new Error("Invalid face")}}function h([t,e,n]){const i=Math.atan2(n,Math.sqrt(t*t+e*e));return[Math.atan2(e,t)*a,i*a]}function p(t,e,n,i){if(0===i){1===n&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const i=e[0];e[0]=e[1],e[1]=i}}function f(t){if("string"==typeof t){if(t.indexOf("/")>0)return t;t=function(t){const e=t.padEnd(16,"0");return s.a.fromString(e,16)}(t)}return function(t){let e=s.a.fromString(t,!0,10).toString(2);for(;e.length<64;)e="0"+e;const n=e.lastIndexOf("1"),i=e.substring(0,3),r=e.substring(3,n),o=r.length/2,a=s.a.fromString(i,!0,2).toString(10);let c=s.a.fromString(r,!0,2).toString(4);for(;c.length<o;)c="0"+c;return"".concat(a,"/").concat(c)}(t.toString())}function g(t){return function({face:t,ij:e,level:n}){const i=[[0,0],[0,1],[1,1],[1,0],[0,0]],r=Math.max(1,Math.ceil(100*Math.pow(2,-n))),o=new Float64Array(4*r*2+2);let s=0,a=0;for(let l=0;l<4;l++){const p=i[l].slice(0),f=i[l+1],g=(f[0]-p[0])/r,m=(f[1]-p[1])/r;for(let i=0;i<r;i++){p[0]+=g,p[1]+=m;const i=h(d(t,u(c(e,n,p))));Math.abs(i[1])>89.999&&(i[0]=a);const r=i[0]-a;i[0]+=r>180?-360:r<-180?360:0,o[s++]=i[0],o[s++]=i[1],a=i[0]}}return o[s++]=o[0],o[s++]=o[1],o}(function(t){const e=t.split("/"),n=parseInt(e[0],10),i=e[1],r=i.length,o=[0,0];let s;for(let t=r-1;t>=0;t--){s=r-t;const e=i[t];let n=0,a=0;"1"===e?a=1:"2"===e?(n=1,a=1):"3"===e&&(n=1);const c=Math.pow(2,s-1);p(c,o,n,a),o[0]+=c*n,o[1]+=c*a}if(n%2==1){const t=o[0];o[0]=o[1],o[1]=t}return{face:n,ij:o,level:s}}(f(t)))}class m extends r.a{indexToBounds(){const{data:t,getS2Token:e}=this.props;return{data:t,_normalize:!1,positionFormat:"XY",getPolygon:(t,n)=>g(e(t,n))}}}Object(i.a)(m,"layerName","S2Layer"),Object(i.a)(m,"defaultProps",{getS2Token:{type:"accessor",value:t=>t.token}})},1382:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var i=n(3),r=n(747),o=n(1157),s=n(1386),a=n(1158),c=n(52),l=n(798),u=n(237);const d=[0,0,0,255],h=[0,0,1],p={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:t=>t.position},getNormal:{type:"accessor",value:h},getColor:{type:"accessor",value:d},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};class f extends r.a{getShaders(){return super.getShaders({vs:"#define SHADER_NAME point-cloud-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceNormals;\nattribute vec4 instanceColors;\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusPixels;\nuniform int sizeUnits;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.normal = project_normal(instanceNormals);\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n  vec3 offset = vec3(positions.xy * project_size_to_pixel(radiusPixels, sizeUnits), 0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n  vColor = vec4(lightColor, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME point-cloud-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition);\n\n  if (distToCenter > 1.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[o.a,s.a,a.a]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:h},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:d}})}updateState(t){const{changeFlags:e,props:n}=t;if(super.updateState(t),e.extensionsChanged){var i;const{gl:t}=this.context;null===(i=this.state.model)||void 0===i||i.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}e.dataChanged&&function(t){const{header:e,attributes:n}=t;e&&n&&(t.length=e.vertexCount,n.POSITION&&(n.instancePositions=n.POSITION),n.NORMAL&&(n.instanceNormals=n.NORMAL),n.COLOR_0&&(n.instanceColors=n.COLOR_0))}(n.data)}draw({uniforms:t}){const{pointSize:e,sizeUnits:n}=this.props;this.state.model.setUniforms(t).setUniforms({sizeUnits:c.e[n],radiusPixels:e}).draw()}_getModel(t){const e=[];for(let t=0;t<3;t++){const n=t/3*Math.PI*2;e.push(2*Math.cos(n),2*Math.sin(n),0)}return new l.a(t,{...this.getShaders(),id:this.props.id,geometry:new u.a({drawMode:4,attributes:{positions:new Float32Array(e)}}),isInstanced:!0})}}Object(i.a)(f,"layerName","PointCloudLayer"),Object(i.a)(f,"defaultProps",p)},1383:function(t,e,n){"use strict";n.d(e,"a",(function(){return x}));var i=n(3),r=n(68),o=n(747),s=n(1157),a=n(1386),c=n(1158),l=n(237),u=n(29),d=n(425),h=n(798),p=n(1456),f=n(810),g=n(535),m=n(849);function v(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),r.a.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function b(t,e){if(t.attributes)return v(t.attributes,e),t instanceof l.a?t:new l.a(t);if(t.positions||t.POSITION)return v(t,e),new l.a({attributes:t});throw Error("Invalid mesh")}const y={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}};class x extends o.a{constructor(...t){super(...t),Object(i.a)(this,"state",void 0)}getShaders(){const t=!Object(u.j)(this.context.gl),e={};return Object(p.b)(this.context.gl,f.a.GLSL_DERIVATIVES)&&(e.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    normals_commonspace = project_normal(instanceModelMatrix * normals);\n    geometry.worldPosition += pos;\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n    geometry.position = position_commonspace;\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n    geometry.position = position_commonspace;\n    normals_commonspace = project_normal(instanceModelMatrix * normals);\n  }\n\n  geometry.normal = normals_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  DECKGL_FILTER_COLOR(color, geometry);\n\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n}\n",modules:[s.a,a.b,c.a],transpileToGLSL100:t,defines:e})}getBounds(){var t;if(this.props._instanced)return super.getBounds();let e=this.state.positionBounds;if(e)return e;const{mesh:n}=this.props;if(!n)return null;if(e=null===(t=n.header)||void 0===t?void 0:t.boundingBox,!e){const{attributes:t}=b(n,this.props._useMeshColors);t.POSITION=t.POSITION||t.positions,e=Object(m.a)(t)}return this.state.positionBounds=e,e}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:g.a}),this.setState({emptyTexture:new d.a(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(t){super.updateState(t);const{props:e,oldProps:n,changeFlags:i}=t;if(e.mesh!==n.mesh||i.extensionsChanged){var r;if(this.state.positionBounds=null,null===(r=this.state.model)||void 0===r||r.delete(),e.mesh){this.state.model=this.getModel(e.mesh);const t=e.mesh.attributes||e.mesh;this.setState({hasNormals:Boolean(t.NORMAL||t.normals)})}this.getAttributeManager().invalidateAll()}e.texture!==n.texture&&this.setTexture(e.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(t){super.finalizeState(t),this.state.emptyTexture.delete()}draw({uniforms:t}){if(!this.state.model)return;const{viewport:e}=this.context,{sizeScale:n,coordinateSystem:i,_instanced:r}=this.props;this.state.model.setUniforms(t).setUniforms({sizeScale:n,composeModelMatrix:!r||Object(g.b)(e,i),flatShading:!this.state.hasNormals}).draw()}getModel(t){const e=new h.a(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:b(t,this.props._useMeshColors),isInstanced:!0}),{texture:n}=this.props,{emptyTexture:i}=this.state;return e.setUniforms({sampler:n||i,hasTexture:Boolean(n)}),e}setTexture(t){const{emptyTexture:e,model:n}=this.state;n&&n.setUniforms({sampler:t||e,hasTexture:Boolean(t)})}}Object(i.a)(x,"defaultProps",y),Object(i.a)(x,"layerName","SimpleMeshLayer")},1385:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var i=n(3),r=n(2157),o=n(29),s=n(809),a=n(777);class c extends a.a{constructor(t,e){super(t,e),Object(i.a)(this,"model",void 0);const{module:n,fs:o,id:s}=e;this.model=new r.a(t,{id:s,fs:o,modules:[n]})}render(t){const e=this.gl;Object(o.n)(e,{viewport:[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}),Object(o.o)(e,{framebuffer:t.outputBuffer,clearColor:[0,0,0,0]},()=>this._renderPass(e,t))}delete(){this.model.delete(),this.model=null}_renderPass(t,e){const{inputBuffer:n}=e;Object(s.a)(t,{color:!0}),this.model.draw({moduleSettings:e.moduleSettings,uniforms:{texture:n,texSize:[n.width,n.height]},parameters:{depthWrite:!1,depthTest:!1}})}}var l=n(956);class u{constructor(t,e={}){Object(i.a)(this,"id",void 0),Object(i.a)(this,"props",void 0),Object(i.a)(this,"module",void 0),Object(i.a)(this,"passes",void 0),this.id="".concat(t.name,"-pass"),this.props=e,Object(l.b)(t),this.module=t}setProps(t){this.props=t}preRender(){}postRender(t,e){const n=this.passes||function(t,e,n){if(!e.passes){const i=d(e);return[new c(t,{id:n,module:e,fs:i})]}return e.passes.map((i,r)=>{const o=d(e,i),s="".concat(n,"-").concat(r);return new c(t,{id:s,module:e,fs:o})})}(t,this.module,this.id);this.passes=n;const{target:i}=e;let r=e.inputBuffer,o=e.swapBuffer;for(let t=0;t<this.passes.length;t++){i&&t===this.passes.length-1&&(o=i),this.passes[t].render({inputBuffer:r,outputBuffer:o,moduleSettings:this.props});const e=o;o=r,r=e}return r}cleanup(){if(this.passes){for(const t of this.passes)t.delete();this.passes=void 0}}}function d(t,e=t){if(e.filter){return(t=>"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = texture2D(texture, texCoord);\n  gl_FragColor = ".concat(t,"(gl_FragColor, texSize, texCoord);\n}\n"))("string"==typeof e.filter?e.filter:"".concat(t.name,"_filterColor"))}if(e.sampler){return(t=>"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = ".concat(t,"(texture, texSize, texCoord);\n}\n"))("string"==typeof e.sampler?e.sampler:"".concat(t.name,"_sampleColor"))}return null}},14:function(t,e){function n(){return t.exports=n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},t.exports.default=t.exports,t.exports.__esModule=!0,n.apply(this,arguments)}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},1411:function(t,e,n){"use strict";function i(t,e,n){n=n||2;var i,o,a,c,l,u,p,f=e&&e.length,m=f?e[0]*n:t.length,v=r(t,0,m,n,!0),b=[];if(!v||v.next===v.prev)return b;if(f&&(v=function(t,e,n,i){var o,s,a,c,l,u=[];for(o=0,s=e.length;o<s;o++)a=e[o]*i,c=o<s-1?e[o+1]*i:t.length,(l=r(t,a,c,i,!1))===l.next&&(l.steiner=!0),u.push(g(l));for(u.sort(d),o=0;o<u.length;o++)n=h(u[o],n);return n}(t,e,v,n)),t.length>80*n){i=a=t[0],o=c=t[1];for(var y=n;y<m;y+=n)(l=t[y])<i&&(i=l),(u=t[y+1])<o&&(o=u),l>a&&(a=l),u>c&&(c=u);p=0!==(p=Math.max(a-i,c-o))?32767/p:0}return s(v,b,n,i,o,p,0),b}function r(t,e,n,i,r){var o,s;if(r===M(t,e,n,i)>0)for(o=e;o<n;o+=i)s=S(o,t[o],t[o+1],s);else for(o=n-i;o>=e;o-=i)s=S(o,t[o],t[o+1],s);return s&&y(s,s.next)&&(C(s),s=s.next),s}function o(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!y(i,i.next)&&0!==b(i.prev,i,i.next))i=i.next;else{if(C(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function s(t,e,n,i,r,d,h){if(t){!h&&d&&function(t,e,n,i){var r=t;do{0===r.z&&(r.z=f(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,s,a,c,l=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,i=n,a=0,e=0;e<l&&(a++,i=i.nextZ);e++);for(c=l;a>0||c>0&&i;)0!==a&&(0===c||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,c--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,l*=2}while(s>1)}(r)}(t,i,r,d);for(var p,g,m=t;t.prev!==t.next;)if(p=t.prev,g=t.next,d?c(t,i,r,d):a(t))e.push(p.i/n|0),e.push(t.i/n|0),e.push(g.i/n|0),C(t),t=g.next,m=g.next;else if((t=g)===m){h?1===h?s(t=l(o(t),e,n),e,n,i,r,d,2):2===h&&u(t,e,n,i,r,d):s(o(t),e,n,i,r,d,1);break}}}function a(t){var e=t.prev,n=t,i=t.next;if(b(e,n,i)>=0)return!1;for(var r=e.x,o=n.x,s=i.x,a=e.y,c=n.y,l=i.y,u=r<o?r<s?r:s:o<s?o:s,d=a<c?a<l?a:l:c<l?c:l,h=r>o?r>s?r:s:o>s?o:s,p=a>c?a>l?a:l:c>l?c:l,f=i.next;f!==e;){if(f.x>=u&&f.x<=h&&f.y>=d&&f.y<=p&&m(r,a,o,c,s,l,f.x,f.y)&&b(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function c(t,e,n,i){var r=t.prev,o=t,s=t.next;if(b(r,o,s)>=0)return!1;for(var a=r.x,c=o.x,l=s.x,u=r.y,d=o.y,h=s.y,p=a<c?a<l?a:l:c<l?c:l,g=u<d?u<h?u:h:d<h?d:h,v=a>c?a>l?a:l:c>l?c:l,y=u>d?u>h?u:h:d>h?d:h,x=f(p,g,e,n,i),_=f(v,y,e,n,i),w=t.prevZ,O=t.nextZ;w&&w.z>=x&&O&&O.z<=_;){if(w.x>=p&&w.x<=v&&w.y>=g&&w.y<=y&&w!==r&&w!==s&&m(a,u,c,d,l,h,w.x,w.y)&&b(w.prev,w,w.next)>=0)return!1;if(w=w.prevZ,O.x>=p&&O.x<=v&&O.y>=g&&O.y<=y&&O!==r&&O!==s&&m(a,u,c,d,l,h,O.x,O.y)&&b(O.prev,O,O.next)>=0)return!1;O=O.nextZ}for(;w&&w.z>=x;){if(w.x>=p&&w.x<=v&&w.y>=g&&w.y<=y&&w!==r&&w!==s&&m(a,u,c,d,l,h,w.x,w.y)&&b(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;O&&O.z<=_;){if(O.x>=p&&O.x<=v&&O.y>=g&&O.y<=y&&O!==r&&O!==s&&m(a,u,c,d,l,h,O.x,O.y)&&b(O.prev,O,O.next)>=0)return!1;O=O.nextZ}return!0}function l(t,e,n){var i=t;do{var r=i.prev,s=i.next.next;!y(r,s)&&x(r,i,i.next,s)&&O(r,s)&&O(s,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(s.i/n|0),C(i),C(i.next),i=t=s),i=i.next}while(i!==t);return o(i)}function u(t,e,n,i,r,a){var c=t;do{for(var l=c.next.next;l!==c.prev;){if(c.i!==l.i&&v(c,l)){var u=P(c,l);return c=o(c,c.next),u=o(u,u.next),s(c,e,n,i,r,a,0),void s(u,e,n,i,r,a,0)}l=l.next}c=c.next}while(c!==t)}function d(t,e){return t.x-e.x}function h(t,e){var n=function(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>s&&(s=a,n=i.x<i.next.x?i:i.next,a===r))return n}i=i.next}while(i!==e);if(!n)return null;var c,l=n,u=n.x,d=n.y,h=1/0;i=n;do{r>=i.x&&i.x>=u&&r!==i.x&&m(o<d?r:s,o,u,d,o<d?s:r,o,i.x,i.y)&&(c=Math.abs(o-i.y)/(r-i.x),O(i,t)&&(c<h||c===h&&(i.x>n.x||i.x===n.x&&p(n,i)))&&(n=i,h=c)),i=i.next}while(i!==l);return n}(t,e);if(!n)return e;var i=P(n,t);return o(i,i.next),o(n,n.next)}function p(t,e){return b(t.prev,t,e.prev)<0&&b(e.next,t,t.next)<0}function f(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function g(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function m(t,e,n,i,r,o,s,a){return(r-s)*(e-a)>=(t-s)*(o-a)&&(t-s)*(i-a)>=(n-s)*(e-a)&&(n-s)*(o-a)>=(r-s)*(i-a)}function v(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&x(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(O(t,e)&&O(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(b(t.prev,t,e.prev)||b(t,e.prev,e))||y(t,e)&&b(t.prev,t,t.next)>0&&b(e.prev,e,e.next)>0)}function b(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function y(t,e){return t.x===e.x&&t.y===e.y}function x(t,e,n,i){var r=w(b(t,e,n)),o=w(b(t,e,i)),s=w(b(n,i,t)),a=w(b(n,i,e));return r!==o&&s!==a||(!(0!==r||!_(t,n,e))||(!(0!==o||!_(t,i,e))||(!(0!==s||!_(n,t,i))||!(0!==a||!_(n,e,i)))))}function _(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function w(t){return t>0?1:t<0?-1:0}function O(t,e){return b(t.prev,t,t.next)<0?b(t,e,t.next)>=0&&b(t,t.prev,e)>=0:b(t,e,t.prev)<0||b(t,t.next,e)<0}function P(t,e){var n=new j(t.i,t.x,t.y),i=new j(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function S(t,e,n,i){var r=new j(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function C(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function j(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function M(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}t.exports=i,t.exports.default=i,i.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,s=Math.abs(M(t,0,o,n));if(r)for(var a=0,c=e.length;a<c;a++){var l=e[a]*n,u=a<c-1?e[a+1]*n:t.length;s-=Math.abs(M(t,l,u,n))}var d=0;for(a=0;a<i.length;a+=3){var h=i[a]*n,p=i[a+1]*n,f=i[a+2]*n;d+=Math.abs((t[h]-t[f])*(t[p+1]-t[h+1])-(t[h]-t[p])*(t[f+1]-t[h+1]))}return 0===s&&0===d?0:Math.abs((d-s)/s)},i.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}},1412:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(3);class r{constructor(t){Object(i.a)(this,"index",void 0),Object(i.a)(this,"isVisible",void 0),Object(i.a)(this,"isSelected",void 0),Object(i.a)(this,"parent",void 0),Object(i.a)(this,"children",void 0),Object(i.a)(this,"content",void 0),Object(i.a)(this,"state",void 0),Object(i.a)(this,"layers",void 0),Object(i.a)(this,"id",void 0),Object(i.a)(this,"zoom",void 0),Object(i.a)(this,"userData",void 0),Object(i.a)(this,"boundingBox",void 0),Object(i.a)(this,"_abortController",void 0),Object(i.a)(this,"_loader",void 0),Object(i.a)(this,"_loaderId",void 0),Object(i.a)(this,"_isLoaded",void 0),Object(i.a)(this,"_isCancelled",void 0),Object(i.a)(this,"_needsReload",void 0),Object(i.a)(this,"_bbox",void 0),this.index=t,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(t){this._bbox||(this._bbox=t,this.boundingBox="west"in t?[[t.west,t.south],[t.east,t.north]]:[[t.left,t.top],[t.right,t.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return Boolean(this._loader)&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const t=this.content?this.content.byteLength:0;return Number.isFinite(t)||console.error("byteLength not defined in tile data"),t}async _loadData({getData:t,requestScheduler:e,onLoad:n,onError:i}){const{index:r,id:o,bbox:s,userData:a,zoom:c}=this,l=this._loaderId;this._abortController=new AbortController;const{signal:u}=this._abortController,d=await e.scheduleRequest(this,t=>t.isSelected?1:-1);if(!d)return void(this._isCancelled=!0);if(this._isCancelled)return void d.done();let h,p=null;try{p=await t({index:r,id:o,bbox:s,userData:a,zoom:c,signal:u})}catch(t){h=t||!0}finally{d.done()}l===this._loaderId&&(this._loader=void 0,this.content=p,!this._isCancelled||p?(this._isLoaded=!0,this._isCancelled=!1,h?i(h,this):n(this)):this._isLoaded=!1)}loadData(t){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(t),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var t;this.isLoaded||(this._isCancelled=!0,null===(t=this._abortController)||void 0===t||t.abort())}}},1413:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var i=n(3),r=n(532);const o=t=>t.length,s=t=>t.points,a=t=>t.index,c=(t,e)=>t<e?-1:t>e?1:t>=e?0:NaN,l={getValue:o,getPoints:s,getIndex:a,filterData:null};class u{constructor(t=[],e=l){Object(i.a)(this,"maxCount",void 0),Object(i.a)(this,"maxValue",void 0),Object(i.a)(this,"minValue",void 0),Object(i.a)(this,"totalCount",void 0),Object(i.a)(this,"aggregatedBins",void 0),Object(i.a)(this,"sortedBins",void 0),Object(i.a)(this,"binMap",void 0),this.aggregatedBins=this.getAggregatedBins(t,e),this._updateMinMaxValues(),this.binMap=this.getBinMap()}getAggregatedBins(t,e){const{getValue:n=o,getPoints:i=s,getIndex:r=a,filterData:c}=e,l="function"==typeof c,u=t.length,d=[];let h=0;for(let e=0;e<u;e++){const o=t[e],s=i(o),a=r(o),u=l?s.filter(c):s;o.filteredPoints=l?u:null;const p=u.length?n(u):null;null!=p&&(d[h]={i:Number.isFinite(a)?a:e,value:p,counts:u.length},h++)}return d}_percentileToIndex(t){const e=this.sortedBins.length;if(e<2)return[0,0];const[n,i]=t.map(t=>Object(r.a)(t,0,100));return[Math.ceil(n/100*(e-1)),Math.floor(i/100*(e-1))]}getBinMap(){const t={};for(const e of this.aggregatedBins)t[e.i]=e;return t}_updateMinMaxValues(){let t=0,e=0,n=3402823466e29,i=0;for(const r of this.aggregatedBins)t=t>r.counts?t:r.counts,e=e>r.value?e:r.value,n=n<r.value?n:r.value,i+=r.counts;this.maxCount=t,this.maxValue=e,this.minValue=n,this.totalCount=i}getValueRange(t){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((t,e)=>c(t.value,e.value))),!this.sortedBins.length)return[];let e=0,n=this.sortedBins.length-1;if(Array.isArray(t)){const i=this._percentileToIndex(t);e=i[0],n=i[1]}return[this.sortedBins[e].value,this.sortedBins[n].value]}getValueDomainByScale(t,[e=0,n=100]=[]){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((t,e)=>c(t.value,e.value))),!this.sortedBins.length)return[];const i=this._percentileToIndex([e,n]);return this._getScaleDomain(t,i)}_getScaleDomain(t,[e,n]){const i=this.sortedBins;switch(t){case"quantize":case"linear":return[i[e].value,i[n].value];case"quantile":return Object(r.c)(i.slice(e,n+1),t=>t.value);case"ordinal":return Object(r.b)(i,t=>t.value);default:return[i[e].value,i[n].value]}}}},1415:function(t,e,n){"use strict";e.a={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},1449:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n(591);var r=n(772);function o(t){return function(t){if(Array.isArray(t))return Object(i.a)(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Object(r.a)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},1452:function(t,e,n){"use strict";var i=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|inert|itemProp|itemScope|itemType|itemID|itemRef|on|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,r=function(t){var e={};return function(n){return void 0===e[n]&&(e[n]=t(n)),e[n]}}((function(t){return i.test(t)||111===t.charCodeAt(0)&&110===t.charCodeAt(1)&&t.charCodeAt(2)<91}));e.a=r},1463:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return p}));var i=n(3),r=n(1376),o=n(2197),s=n(245),a=n(1412),c=n(542);function l(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}const u="best-available",d={[u]:function(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!f(e)&&g(e);for(const e of t)e.isVisible=Boolean(2&e.state)},"no-overlap":function(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&f(e);const e=Array.from(t).sort((t,e)=>t.zoom-e.zoom);for(const t of e)if(t.isVisible=Boolean(2&t.state),t.children&&(t.isVisible||1&t.state))for(const e of t.children)e.state=1;else t.isSelected&&g(t)},never:()=>{}},h={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};class p{constructor(t){Object(i.a)(this,"opts",void 0),Object(i.a)(this,"_requestScheduler",void 0),Object(i.a)(this,"_cache",void 0),Object(i.a)(this,"_dirty",void 0),Object(i.a)(this,"_tiles",void 0),Object(i.a)(this,"_cacheByteSize",void 0),Object(i.a)(this,"_viewport",void 0),Object(i.a)(this,"_zRange",void 0),Object(i.a)(this,"_selectedTiles",void 0),Object(i.a)(this,"_frameNumber",void 0),Object(i.a)(this,"_modelMatrix",void 0),Object(i.a)(this,"_modelMatrixInverse",void 0),Object(i.a)(this,"_maxZoom",void 0),Object(i.a)(this,"_minZoom",void 0),Object(i.a)(this,"onTileLoad",void 0),Object(i.a)(this,"_getCullBounds",function(t){let e,n={};return i=>{for(const r in i)if(!l(i[r],n[r])){e=t(i),n=i;break}return e}}(c.a)),this.opts={...h,...t},this.onTileLoad=t=>{var e,n;null===(e=(n=this.opts).onTileLoad)||void 0===e||e.call(n,t),this.opts.maxCacheByteSize&&(this._cacheByteSize+=t.byteLength,this._resizeCache())},this._requestScheduler=new r.a({maxRequests:t.maxRequests,throttleRequests:Boolean(t.maxRequests&&t.maxRequests>0)}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new o.a,this._modelMatrixInverse=new o.a,this.setOptions(t)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return null!==this._selectedTiles&&this._selectedTiles.every(t=>t.isLoaded)}get needsReload(){return null!==this._selectedTiles&&this._selectedTiles.some(t=>t.needsReload)}setOptions(t){Object.assign(this.opts,t),Number.isFinite(t.maxZoom)&&(this._maxZoom=Math.floor(t.maxZoom)),Number.isFinite(t.minZoom)&&(this._minZoom=Math.ceil(t.minZoom))}finalize(){for(const t of this._cache.values())t.isLoading&&t.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const t of this._cache.keys()){const e=this._cache.get(t);this._selectedTiles&&this._selectedTiles.includes(e)?e.setNeedsReload():this._cache.delete(t)}}update(t,{zRange:e,modelMatrix:n}={}){const i=new o.a(n),r=!i.equals(this._modelMatrix);if(this._viewport&&t.equals(this._viewport)&&Object(s.b)(this._zRange,e)&&!r)this.needsReload&&(this._selectedTiles=this._selectedTiles.map(t=>this._getTile(t.index,!0)));else{r&&(this._modelMatrixInverse=i.clone().invert(),this._modelMatrix=i),this._viewport=t,this._zRange=e;const n=this.getTileIndices({viewport:t,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:e,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=n.map(t=>this._getTile(t,!0)),this._dirty&&this._rebuildTree()}const a=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),a&&this._frameNumber++,this._frameNumber}isTileVisible(t,e){if(!t.isVisible)return!1;if(e&&this._viewport){const n=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:e}),{bbox:i}=t;for(const[t,e,r,o]of n){let n;if("west"in i)n=i.west<r&&i.east>t&&i.south<o&&i.north>e;else{const s=Math.min(i.top,i.bottom),a=Math.max(i.top,i.bottom);n=i.left<r&&i.right>t&&s<o&&a>e}if(n)return!0}return!1}return!0}getTileIndices({viewport:t,maxZoom:e,minZoom:n,zRange:i,modelMatrix:r,modelMatrixInverse:o}){const{tileSize:s,extent:a,zoomOffset:l}=this.opts;return Object(c.b)({viewport:t,maxZoom:e,minZoom:n,zRange:i,tileSize:s,extent:a,modelMatrix:r,modelMatrixInverse:o,zoomOffset:l})}getTileId(t){return"".concat(t.x,"-").concat(t.y,"-").concat(t.z)}getTileZoom(t){return t.z}getTileMetadata(t){const{tileSize:e}=this.opts;return{bbox:Object(c.g)(this._viewport,t.x,t.y,t.z,e)}}getParentIndex(t){return{x:Math.floor(t.x/2),y:Math.floor(t.y/2),z:t.z-1}}updateTileStates(){const t=this.opts.refinementStrategy||u,e=new Array(this._cache.size);let n=0;for(const t of this._cache.values())e[n++]=t.isVisible,t.isSelected=!1,t.isVisible=!1;for(const t of this._selectedTiles)t.isSelected=!0,t.isVisible=!0;("function"==typeof t?t:d[t])(Array.from(this._cache.values())),n=0;for(const t of this._cache.values())if(e[n++]!==t.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:t=0}=this.opts,e=[];let n=0;for(const t of this._cache.values())t.isLoading&&(n++,t.isSelected||t.isVisible||e.push(t));for(;t>0&&n>t&&e.length>0;){e.shift().abort(),n--}}_rebuildTree(){const{_cache:t}=this;for(const e of t.values())e.parent=null,e.children&&(e.children.length=0);for(const e of t.values()){const t=this._getNearestAncestor(e);e.parent=t,null!=t&&t.children&&t.children.push(e)}}_resizeCache(){const{_cache:t,opts:e}=this,n=e.maxCacheSize||(e.maxCacheByteSize?1/0:5*this.selectedTiles.length),i=e.maxCacheByteSize||1/0;if(t.size>n||this._cacheByteSize>i){for(const[s,a]of t){var r,o;if(!a.isVisible&&!a.isSelected)this._cacheByteSize-=e.maxCacheByteSize?a.byteLength:0,t.delete(s),null===(r=(o=this.opts).onTileUnload)||void 0===r||r.call(o,a);if(t.size<=n&&this._cacheByteSize<=i)break}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((t,e)=>t.zoom-e.zoom),this._dirty=!1)}_getTile(t,e){const n=this.getTileId(t);let i=this._cache.get(n),r=!1;return!i&&e?(i=new a.a(t),Object.assign(i,this.getTileMetadata(i.index)),Object.assign(i,{id:n,zoom:this.getTileZoom(i.index)}),r=!0,this._cache.set(n,i),this._dirty=!0):i&&i.needsReload&&(r=!0),i&&r&&i.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),i}_getNearestAncestor(t){const{_minZoom:e=0}=this;let n=t.index;for(;this.getTileZoom(n)>e;){n=this.getParentIndex(n);const t=this._getTile(n);if(t)return t}return null}}function f(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=2,!0;e=e.parent}return!1}function g(t){for(const e of t.children)e.isLoaded||e.content?e.state|=2:g(e)}},148:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));var i=n(69);function r(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function o(t,e,n=""){if(i.b.debug&&!function(t,e){if(t.length!==e)return!1;for(let e=0;e<t.length;++e)if(!Number.isFinite(t[e]))return!1;return!0}(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}},149:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(772);function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==a.return||a.return()}finally{if(r)throw o}}return n}}(t,e)||Object(i.a)(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},154:function(t,e,n){"use strict";n.r(e),n.d(e,"SortableContext",(function(){return b})),n.d(e,"arrayMove",(function(){return a})),n.d(e,"arraySwap",(function(){return c})),n.d(e,"defaultAnimateLayoutChanges",(function(){return x})),n.d(e,"defaultNewIndexGetter",(function(){return y})),n.d(e,"hasSortableData",(function(){return S})),n.d(e,"horizontalListSortingStrategy",(function(){return h})),n.d(e,"rectSortingStrategy",(function(){return p})),n.d(e,"rectSwappingStrategy",(function(){return f})),n.d(e,"sortableKeyboardCoordinates",(function(){return j})),n.d(e,"useSortable",(function(){return P})),n.d(e,"verticalListSortingStrategy",(function(){return m}));var i=n(0),r=n.n(i),o=n(113),s=n(35);function a(t,e,n){const i=t.slice();return i.splice(n<0?i.length+n:n,0,i.splice(e,1)[0]),i}function c(t,e,n){const i=t.slice();return i[e]=t[n],i[n]=t[e],i}function l(t,e){return t.reduce((t,n,i)=>{const r=e.get(n);return r&&(t[i]=r),t},Array(t.length))}function u(t){return null!==t&&t>=0}const d={scaleX:1,scaleY:1},h=t=>{var e;let{rects:n,activeNodeRect:i,activeIndex:r,overIndex:o,index:s}=t;const a=null!=(e=n[r])?e:i;if(!a)return null;const c=function(t,e,n){const i=t[e],r=t[e-1],o=t[e+1];if(!i||!r&&!o)return 0;if(n<e)return r?i.left-(r.left+r.width):o.left-(i.left+i.width);return o?o.left-(i.left+i.width):i.left-(r.left+r.width)}(n,s,r);if(s===r){const t=n[o];return t?{x:r<o?t.left+t.width-(a.left+a.width):t.left-a.left,y:0,...d}:null}return s>r&&s<=o?{x:-a.width-c,y:0,...d}:s<r&&s>=o?{x:a.width+c,y:0,...d}:{x:0,y:0,...d}};const p=t=>{let{rects:e,activeIndex:n,overIndex:i,index:r}=t;const o=a(e,i,n),s=e[r],c=o[r];return c&&s?{x:c.left-s.left,y:c.top-s.top,scaleX:c.width/s.width,scaleY:c.height/s.height}:null},f=t=>{let e,n,{activeIndex:i,index:r,rects:o,overIndex:s}=t;return r===i&&(e=o[r],n=o[s]),r===s&&(e=o[r],n=o[i]),n&&e?{x:n.left-e.left,y:n.top-e.top,scaleX:n.width/e.width,scaleY:n.height/e.height}:null},g={scaleX:1,scaleY:1},m=t=>{var e;let{activeIndex:n,activeNodeRect:i,index:r,rects:o,overIndex:s}=t;const a=null!=(e=o[n])?e:i;if(!a)return null;if(r===n){const t=o[s];return t?{x:0,y:n<s?t.top+t.height-(a.top+a.height):t.top-a.top,...g}:null}const c=function(t,e,n){const i=t[e],r=t[e-1],o=t[e+1];if(!i)return 0;if(n<e)return r?i.top-(r.top+r.height):o?o.top-(i.top+i.height):0;return o?o.top-(i.top+i.height):r?i.top-(r.top+r.height):0}(o,r,n);return r>n&&r<=s?{x:0,y:-a.height-c,...g}:r<n&&r>=s?{x:0,y:a.height+c,...g}:{x:0,y:0,...g}};const v=r.a.createContext({activeIndex:-1,containerId:"Sortable",disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:p,disabled:{draggable:!1,droppable:!1}});function b(t){let{children:e,id:n,items:a,strategy:c=p,disabled:u=!1}=t;const{active:d,dragOverlay:h,droppableRects:f,over:g,measureDroppableContainers:m}=Object(o.useDndContext)(),b=Object(s.useUniqueId)("Sortable",n),y=Boolean(null!==h.rect),x=Object(i.useMemo)(()=>a.map(t=>"object"==typeof t&&"id"in t?t.id:t),[a]),_=null!=d,w=d?x.indexOf(d.id):-1,O=g?x.indexOf(g.id):-1,P=Object(i.useRef)(x),S=!function(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}(x,P.current),C=-1!==O&&-1===w||S,j=function(t){return"boolean"==typeof t?{draggable:t,droppable:t}:t}(u);Object(s.useIsomorphicLayoutEffect)(()=>{S&&_&&m(x)},[S,x,_,m]),Object(i.useEffect)(()=>{P.current=x},[x]);const M=Object(i.useMemo)(()=>({activeIndex:w,containerId:b,disabled:j,disableTransforms:C,items:x,overIndex:O,useDragOverlay:y,sortedRects:l(x,f),strategy:c}),[w,b,j.draggable,j.droppable,C,x,O,f,y,c]);return r.a.createElement(v.Provider,{value:M},e)}const y=t=>{let{id:e,items:n,activeIndex:i,overIndex:r}=t;return a(n,i,r).indexOf(e)},x=t=>{let{containerId:e,isSorting:n,wasDragging:i,index:r,items:o,newIndex:s,previousItems:a,previousContainerId:c,transition:l}=t;return!(!l||!i)&&((a===o||r!==s)&&(!!n||s!==r&&e===c))},_={duration:200,easing:"ease"},w=s.CSS.Transition.toString({property:"transform",duration:0,easing:"linear"}),O={roleDescription:"sortable"};function P(t){let{animateLayoutChanges:e=x,attributes:n,disabled:r,data:a,getNewIndex:c=y,id:l,strategy:d,resizeObserverConfig:h,transition:p=_}=t;const{items:f,containerId:g,activeIndex:m,disabled:b,disableTransforms:P,sortedRects:S,overIndex:C,useDragOverlay:j,strategy:M}=Object(i.useContext)(v),E=function(t,e){var n,i;if("boolean"==typeof t)return{draggable:t,droppable:!1};return{draggable:null!=(n=null==t?void 0:t.draggable)?n:e.draggable,droppable:null!=(i=null==t?void 0:t.droppable)?i:e.droppable}}(r,b),L=f.indexOf(l),T=Object(i.useMemo)(()=>({sortable:{containerId:g,index:L,items:f},...a}),[g,a,L,f]),R=Object(i.useMemo)(()=>f.slice(f.indexOf(l)),[f,l]),{rect:A,node:I,isOver:k,setNodeRef:z}=Object(o.useDroppable)({id:l,data:T,disabled:E.droppable,resizeObserverConfig:{updateMeasurementsFor:R,...h}}),{active:D,activatorEvent:F,activeNodeRect:N,attributes:V,setNodeRef:U,listeners:B,isDragging:W,over:G,setActivatorNodeRef:H,transform:Z}=Object(o.useDraggable)({id:l,data:T,attributes:{...O,...n},disabled:E.draggable}),q=Object(s.useCombinedRefs)(z,U),K=Boolean(D),X=K&&!P&&u(m)&&u(C),Y=!j&&W,J=Y&&X?Z:null,Q=X?null!=J?J:(null!=d?d:M)({rects:S,activeNodeRect:N,activeIndex:m,overIndex:C,index:L}):null,$=u(m)&&u(C)?c({id:l,items:f,activeIndex:m,overIndex:C}):L,tt=null==D?void 0:D.id,et=Object(i.useRef)({activeId:tt,items:f,newIndex:$,containerId:g}),nt=f!==et.current.items,it=e({active:D,containerId:g,isDragging:W,isSorting:K,id:l,index:L,items:f,newIndex:et.current.newIndex,previousItems:et.current.items,previousContainerId:et.current.containerId,transition:p,wasDragging:null!=et.current.activeId}),rt=function(t){let{disabled:e,index:n,node:r,rect:a}=t;const[c,l]=Object(i.useState)(null),u=Object(i.useRef)(n);return Object(s.useIsomorphicLayoutEffect)(()=>{if(!e&&n!==u.current&&r.current){const t=a.current;if(t){const e=Object(o.getClientRect)(r.current,{ignoreTransform:!0}),n={x:t.left-e.left,y:t.top-e.top,scaleX:t.width/e.width,scaleY:t.height/e.height};(n.x||n.y)&&l(n)}}n!==u.current&&(u.current=n)},[e,n,r,a]),Object(i.useEffect)(()=>{c&&l(null)},[c]),c}({disabled:!it,index:L,node:I,rect:A});return Object(i.useEffect)(()=>{K&&et.current.newIndex!==$&&(et.current.newIndex=$),g!==et.current.containerId&&(et.current.containerId=g),f!==et.current.items&&(et.current.items=f)},[K,$,g,f]),Object(i.useEffect)(()=>{if(tt===et.current.activeId)return;if(tt&&!et.current.activeId)return void(et.current.activeId=tt);const t=setTimeout(()=>{et.current.activeId=tt},50);return()=>clearTimeout(t)},[tt]),{active:D,activeIndex:m,attributes:V,data:T,rect:A,index:L,newIndex:$,items:f,isOver:k,isSorting:K,isDragging:W,listeners:B,node:I,overIndex:C,over:G,setNodeRef:q,setActivatorNodeRef:H,setDroppableNodeRef:z,setDraggableNodeRef:U,transform:null!=rt?rt:Q,transition:function(){if(rt||nt&&et.current.newIndex===L)return w;if(Y&&!Object(s.isKeyboardEvent)(F)||!p)return;if(K||it)return s.CSS.Transition.toString({...p,property:"transform"});return}()}}function S(t){if(!t)return!1;const e=t.data.current;return!!(e&&"sortable"in e&&"object"==typeof e.sortable&&"containerId"in e.sortable&&"items"in e.sortable&&"index"in e.sortable)}const C=[o.KeyboardCode.Down,o.KeyboardCode.Right,o.KeyboardCode.Up,o.KeyboardCode.Left],j=(t,e)=>{let{context:{active:n,collisionRect:i,droppableRects:r,droppableContainers:a,over:c,scrollableAncestors:l}}=e;if(C.includes(t.code)){if(t.preventDefault(),!n||!i)return;const e=[];a.getEnabled().forEach(n=>{if(!n||null!=n&&n.disabled)return;const s=r.get(n.id);if(s)switch(t.code){case o.KeyboardCode.Down:i.top<s.top&&e.push(n);break;case o.KeyboardCode.Up:i.top>s.top&&e.push(n);break;case o.KeyboardCode.Left:i.left>s.left&&e.push(n);break;case o.KeyboardCode.Right:i.left<s.left&&e.push(n)}});const u=Object(o.closestCorners)({active:n,collisionRect:i,droppableRects:r,droppableContainers:e,pointerCoordinates:null});let d=Object(o.getFirstCollision)(u,"id");if(d===(null==c?void 0:c.id)&&u.length>1&&(d=u[1].id),null!=d){const t=a.get(n.id),e=a.get(d),c=e?r.get(e.id):null,u=null==e?void 0:e.node.current;if(u&&c&&t&&e){const n=Object(o.getScrollableAncestors)(u).some((t,e)=>l[e]!==t),r=M(t,e),a=function(t,e){if(!S(t)||!S(e))return!1;if(!M(t,e))return!1;return t.data.current.sortable.index<e.data.current.sortable.index}(t,e),d=n||!r?{x:0,y:0}:{x:a?i.width-c.width:0,y:a?i.height-c.height:0},h={x:c.left,y:c.top};return d.x&&d.y?h:Object(s.subtract)(h,d)}}}};function M(t,e){return!(!S(t)||!S(e))&&t.data.current.sortable.containerId===e.data.current.sortable.containerId}},1561:function(t,e,n){var i=n(998);t.exports=function(t){if(Array.isArray(t))return i(t)},t.exports.default=t.exports,t.exports.__esModule=!0},1562:function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0},1563:function(t,e){t.exports=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==a.return||a.return()}finally{if(r)throw o}}return n}},t.exports.default=t.exports,t.exports.__esModule=!0},1597:function(t,e){function n(e,i){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},t.exports.default=t.exports,t.exports.__esModule=!0,n(e,i)}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},1598:function(t,e,n){var i=n(1149);function r(t){var e,n;function r(e,n){try{var s=t[e](n),a=s.value,c=a instanceof i;Promise.resolve(c?a.wrapped:a).then((function(t){c?r("return"===e?"return":"next",t):o(s.done?"return":"normal",t)}),(function(t){r("throw",t)}))}catch(t){o("throw",t)}}function o(t,i){switch(t){case"return":e.resolve({value:i,done:!0});break;case"throw":e.reject(i);break;default:e.resolve({value:i,done:!1})}(e=e.next)?r(e.key,e.arg):n=null}this._invoke=function(t,i){return new Promise((function(o,s){var a={key:t,arg:i,resolve:o,reject:s,next:null};n?n=n.next=a:(e=n=a,r(t,i))}))},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(r.prototype[Symbol.asyncIterator]=function(){return this}),r.prototype.next=function(t){return this._invoke("next",t)},r.prototype.throw=function(t){return this._invoke("throw",t)},r.prototype.return=function(t){return this._invoke("return",t)},t.exports=r,t.exports.default=t.exports,t.exports.__esModule=!0},1600:function(t,e,n){var i=n(7);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=i(t)););return t},t.exports.default=t.exports,t.exports.__esModule=!0},165:function(t,e){function n(t,e,n,i,r,o,s){try{var a=t[o](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(i,r)}t.exports=function(t){return function(){var e=this,i=arguments;return new Promise((function(r,o){var s=t.apply(e,i);function a(t){n(s,r,o,a,c,"next",t)}function c(t){n(s,r,o,a,c,"throw",t)}a(void 0)}))}},t.exports.default=t.exports,t.exports.__esModule=!0},17:function(t,e){t.exports=function(t){return t&&t.__esModule?t:{default:t}},t.exports.default=t.exports,t.exports.__esModule=!0},178:function(t,e,n){"use strict";function i(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!i(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if("object"==typeof t&&"object"==typeof e){const r=Object.keys(t),o=Object.keys(e);if(r.length!==o.length)return!1;for(const o of r){if(!e.hasOwnProperty(o))return!1;if(!i(t[o],e[o],n-1))return!1}return!0}return!1}n.d(e,"a",(function(){return i}))},18:function(t,e){function n(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(t.exports=n=function(t){return typeof t},t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.default=t.exports,t.exports.__esModule=!0),n(e)}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},185:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var i=n(3),r=n(68),o=n(128),s=n(377),a=n(69),c=n(327),l=n(46),u=n(61),d=n(52);const h=Math.PI/180,p=Object(o.a)(),f=[0,0,0],g={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class m{constructor(t={}){Object(i.a)(this,"id",void 0),Object(i.a)(this,"x",void 0),Object(i.a)(this,"y",void 0),Object(i.a)(this,"width",void 0),Object(i.a)(this,"height",void 0),Object(i.a)(this,"padding",void 0),Object(i.a)(this,"isGeospatial",void 0),Object(i.a)(this,"zoom",void 0),Object(i.a)(this,"focalDistance",void 0),Object(i.a)(this,"position",void 0),Object(i.a)(this,"modelMatrix",void 0),Object(i.a)(this,"distanceScales",void 0),Object(i.a)(this,"scale",void 0),Object(i.a)(this,"center",void 0),Object(i.a)(this,"cameraPosition",void 0),Object(i.a)(this,"projectionMatrix",void 0),Object(i.a)(this,"viewMatrix",void 0),Object(i.a)(this,"viewMatrixUncentered",void 0),Object(i.a)(this,"viewMatrixInverse",void 0),Object(i.a)(this,"viewProjectionMatrix",void 0),Object(i.a)(this,"pixelProjectionMatrix",void 0),Object(i.a)(this,"pixelUnprojectionMatrix",void 0),Object(i.a)(this,"resolution",void 0),Object(i.a)(this,"_frustumPlanes",{}),this.id=t.id||this.constructor.displayName||"viewport",this.x=t.x||0,this.y=t.y||0,this.width=t.width||1,this.height=t.height||1,this.zoom=t.zoom||0,this.padding=t.padding,this.distanceScales=t.distanceScales||g,this.focalDistance=t.focalDistance||1,this.position=t.position||f,this.modelMatrix=t.modelMatrix||null;const{longitude:e,latitude:n}=t;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(e),this._initProps(t),this._initMatrices(t),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?d.d.WEB_MERCATOR:d.d.WEB_MERCATOR_AUTO_OFFSET:d.d.IDENTITY}equals(t){return t instanceof m&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&Object(a.d)(t.projectionMatrix,this.projectionMatrix)&&Object(a.d)(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:e=!0}={}){const n=this.projectPosition(t),i=Object(u.q)(n,this.pixelProjectionMatrix),[r,o]=i,s=e?o:this.height-o;return 2===t.length?[r,s]:[r,s,i[2]]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[i,r,o]=t,s=e?r:this.height-r,a=n&&n*this.distanceScales.unitsPerMeter[2],c=Object(u.n)([i,s,o],this.pixelUnprojectionMatrix,a),[l,d,h]=this.unprojectPosition(c);return Number.isFinite(o)?[l,d,h]:Number.isFinite(n)?[l,d,n]:[l,d]}projectPosition(t){const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){if(this.isGeospatial){const e=Object(u.l)(t);return e[1]=Object(a.a)(e[1],-318,830),e}return t}unprojectFlat(t){return this.isGeospatial?Object(u.p)(t):t}getBounds(t={}){const e={targetZ:t.z||0},n=this.unproject([0,0],e),i=this.unproject([this.width,0],e),r=this.unproject([0,this.height],e),o=this.unproject([this.width,this.height],e);return[Math.min(n[0],i[0],r[0],o[0]),Math.min(n[1],i[1],r[1],o[1]),Math.max(n[0],i[0],r[0],o[0]),Math.max(n[1],i[1],r[1],o[1])]}getDistanceScales(t){return t?Object(u.g)({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:e,width:n=1,height:i=1}){return t<this.x+this.width&&this.x<t+n&&e<this.y+this.height&&this.y<e+i}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,Object(o.d)(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,e){return null}_initProps(t){const e=t.longitude,n=t.latitude;this.isGeospatial&&(Number.isFinite(t.zoom)||(this.zoom=Object(u.i)({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=t.distanceScales||Object(u.g)({latitude:n,longitude:e}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:r,modelMatrix:o}=t;let a=f;if(r&&(a=o?new s.a(o).transformAsVector(r,[]):r),this.isGeospatial){const t=this.projectPosition([e,n,0]);this.center=new c.a(a).scale(this.distanceScales.unitsPerMeter).add(t)}else this.center=this.projectPosition(a)}_initMatrices(t){const{viewMatrix:e=p,projectionMatrix:n=null,orthographic:i=!1,fovyRadians:u,fovy:d=75,near:f=.1,far:g=1e3,padding:m=null,focalDistance:v=1}=t;this.viewMatrixUncentered=e,this.viewMatrix=(new s.a).multiplyRight(e).translate(new c.a(this.center).negate()),this.projectionMatrix=n||function({width:t,height:e,orthographic:n,fovyRadians:i,focalDistance:r,padding:o,near:c,far:l}){const u=t/e,d=n?(new s.a).orthographic({fovy:i,aspect:u,focalDistance:r,near:c,far:l}):(new s.a).perspective({fovy:i,aspect:u,near:c,far:l});if(o){const{left:n=0,right:i=0,top:r=0,bottom:s=0}=o,c=Object(a.a)((n+t-i)/2,0,t)-t/2,l=Object(a.a)((r+e-s)/2,0,e)-e/2;d[8]-=2*c/t,d[9]+=2*l/e}return d}({width:this.width,height:this.height,orthographic:i,fovyRadians:u||d*h,focalDistance:v,padding:m,near:f,far:g});const b=Object(o.a)();l.h(b,b,this.projectionMatrix),l.h(b,b,this.viewMatrix),this.viewProjectionMatrix=b,this.viewMatrixInverse=l.f([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=Object(o.c)(this.viewMatrixInverse);const y=Object(o.a)(),x=Object(o.a)();l.o(y,y,[this.width/2,-this.height/2,1]),l.p(y,y,[1,-1,0]),l.h(x,y,this.viewProjectionMatrix),this.pixelProjectionMatrix=x,this.pixelUnprojectionMatrix=l.f(Object(o.a)(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||r.a.warn("Pixel project matrix not invertible")()}}Object(i.a)(m,"displayName","Viewport")},190:function(t,e,n){"use strict";function i(t){const{source:e,target:n,start:i=0,size:r,getData:o}=t,s=t.end||n.length,a=e.length,c=s-i;if(a>c)return void n.set(e.subarray(0,c),i);if(n.set(e,i),!o)return;let l=a;for(;l<c;){const t=o(l,e);for(let e=0;e<r;e++)n[i+l]=t[e]||0,l++}}n.d(e,"e",(function(){return o})),n.d(e,"d",(function(){return s})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return l})),n.d(e,"f",(function(){return u}));const r={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function o(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...r[n],...e,...t,type:n}}function s(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function a(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function c(t){t.push(t.shift())}function l(t,e){const{doublePrecision:n,settings:i,value:r,size:o}=t,s=n&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*o)*s}function u({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:o,getData:s=(t=>t)}){const a=n.doublePrecision&&n.value instanceof Float64Array?2:1,c=n.size*a,u=n.byteOffset,d=n.startIndices,h=o&&d,p=l(n,e),f=n.isConstant;if(!h&&r>=p)return;const g=f?n.value:n.getBuffer().getData({srcByteOffset:u});if(n.settings.normalized&&!f){const t=s;s=(e,i)=>n.normalizeConstant(t(e,i))}const m=f?(t,e)=>s(g,e):(t,e)=>s(g.subarray(t,t+c),e),v=t.getData({length:r}),b=new Float32Array(p);!function({source:t,target:e,size:n,getData:r,sourceStartIndices:o,targetStartIndices:s}){if(!Array.isArray(s))return i({source:t,target:e,size:n,getData:r}),e;let a=0,c=0;const l=r&&((t,e)=>r(t+c,e)),u=Math.min(o.length,s.length);for(let r=1;r<u;r++){const u=o[r]*n,d=s[r]*n;i({source:t.subarray(a,u),target:e,start:c,end:d,size:n,getData:l}),a=u,c=d}c<e.length&&i({source:[],target:e,start:c,size:n,getData:l})}({source:v,target:b,sourceStartIndices:o,targetStartIndices:d,size:c,getData:m}),t.byteLength<b.byteLength+u&&t.reallocate(b.byteLength+u),t.subData({data:b,offset:u})}},196:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return a}));const i=[],r=[];function o(t,e=0,n=1/0){let o=i;const s={index:-1,data:t,target:[]};return t?"function"==typeof t[Symbol.iterator]?o=t:t.length>0&&(r.length=t.length,o=r):o=i,(e>0||Number.isFinite(n))&&(o=(Array.isArray(o)?o:Array.from(o)).slice(e,n),s.index=e-1),{iterable:o,objectInfo:s}}function s(t){return t&&t[Symbol.asyncIterator]}function a(t,e){const{size:n,stride:i,offset:r,startIndices:o,nested:s}=e,a=t.BYTES_PER_ELEMENT,c=i?i/a:n,l=r?r/a:0,u=Math.floor((t.length-l)/c);return(e,{index:i,target:r})=>{if(!o){const e=i*c+l;for(let i=0;i<n;i++)r[i]=t[e+i];return r}const a=o[i],d=o[i+1]||u;let h;if(s){h=new Array(d-a);for(let e=a;e<d;e++){const i=e*c+l;r=new Array(n);for(let e=0;e<n;e++)r[e]=t[i+e];h[e-a]=r}}else if(c===n)h=t.subarray(a*n+l,d*n+l);else{h=new t.constructor((d-a)*n);let e=0;for(let i=a;i<d;i++){const r=i*c+l;for(let i=0;i<n;i++)h[e++]=t[r+i]}}return h}}},207:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(3),r=n(461),o=n(69);const s=["longitude","latitude","zoom","bearing","pitch"],a=["longitude","latitude","zoom"];class c extends r.a{constructor(t={}){const e=Array.isArray(t)?t:t.transitionProps,n=Array.isArray(t)?{}:t;n.transitionProps=Array.isArray(e)?{compare:e,required:e}:e||{compare:s,required:a},super(n.transitionProps),Object(i.a)(this,"opts",void 0),this.opts=n}initializeProps(t,e){const n=super.initializeProps(t,e),{makeViewport:i,around:r}=this.opts;if(i&&r){const o=i(t),s=i(e),a=o.unproject(r);n.start.around=r,Object.assign(n.end,{around:s.project(a),aroundPosition:a,width:e.width,height:e.height})}return n}interpolateProps(t,e,n){const i={};for(const r of this._propsToExtract)i[r]=Object(o.g)(t[r]||0,e[r]||0,n);if(e.aroundPosition&&this.opts.makeViewport){const r=this.opts.makeViewport({...e,...i});Object.assign(i,r.panByPosition(e.aroundPosition,Object(o.g)(t.around,e.around,n)))}return i}}},21:function(t,e,n){var i=n(1561),r=n(999),o=n(835),s=n(1562);t.exports=function(t){return i(t)||r(t)||o(t)||s()},t.exports.default=t.exports,t.exports.__esModule=!0},213:function(t,e,n){"use strict";n.d(e,"f",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return p})),n.d(e,"d",(function(){return d})),n.d(e,"e",(function(){return b})),n.d(e,"c",(function(){return y}));n(3),n(2218);const i={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function r(t,e,n={}){return function(t,e={}){return Math.sign(o(t,e))}(t,n)!==e&&(function(t,e){const{start:n=0,end:i=t.length,size:r=2}=e,o=(i-n)/r,s=Math.floor(o/2);for(let e=0;e<s;++e){const i=n+e*r,s=n+(o-1-e)*r;for(let e=0;e<r;++e){const n=t[i+e];t[i+e]=t[s+e],t[s+e]=n}}}(t,n),!0)}function o(t,e={}){const{start:n=0,end:i=t.length}=e,r=e.size||2;let o=0;for(let e=n,s=i-r;e<i;e+=r)o+=(t[e]-t[s])*(t[e+1]+t[s+1]),s=e;return o/2}function s(t,e){const n=e.length,i=t.length;if(i>0){let r=!0;for(let o=0;o<n;o++)if(t[i-n+o]!==e[o]){r=!1;break}if(r)return!1}for(let r=0;r<n;r++)t[i+r]=e[r];return!0}function a(t,e){const n=e.length;for(let i=0;i<n;i++)t[i]=e[i]}function c(t,e,n,i,r=[]){const o=i+e*n;for(let e=0;e<n;e++)r[e]=t[o+e];return r}function l(t,e,n,i,r=[]){let o,s;if(8&n)o=(i[3]-t[1])/(e[1]-t[1]),s=3;else if(4&n)o=(i[1]-t[1])/(e[1]-t[1]),s=1;else if(2&n)o=(i[2]-t[0])/(e[0]-t[0]),s=2;else{if(!(1&n))return null;o=(i[0]-t[0])/(e[0]-t[0]),s=0}for(let n=0;n<t.length;n++)r[n]=(1&s)===n?i[s]:o*(e[n]-t[n])+t[n];return r}function u(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function d(t,e){const{size:n=2,broken:i=!1,gridResolution:r=10,gridOffset:o=[0,0],startIndex:d=0,endIndex:h=t.length}=e||{},p=(h-d)/n;let f=[];const v=[f],b=c(t,0,n,d);let y,x;const _=g(b,r,o,[]),w=[];s(f,b);for(let e=1;e<p;e++){for(y=c(t,e,n,d,y),x=u(y,_);x;){l(b,y,x,_,w);const t=u(w,_);t&&(l(b,w,t,_,w),x=t),s(f,w),a(b,w),m(_,r,x),i&&f.length>n&&(f=[],v.push(f),s(f,b)),x=u(y,_)}s(f,y),a(b,y)}return i?v:v[0]}function h(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function p(t,e=null,n){if(!t.length)return[];const{size:i=2,gridResolution:r=10,gridOffset:o=[0,0],edgeTypes:s=!1}=n||{},a=[],c=[{pos:t,types:s?new Array(t.length/i).fill(1):null,holes:e||[]}],l=[[],[]];let d=[];for(;c.length;){const{pos:t,types:e,holes:n}=c.shift();v(t,i,n[0]||t.length,l),d=g(l[0],r,o,d);const p=u(l[1],d);if(p){let r=f(t,e,i,0,n[0]||t.length,d,p);const o={pos:r[0].pos,types:r[0].types,holes:[]},a={pos:r[1].pos,types:r[1].types,holes:[]};c.push(o,a);for(let c=0;c<n.length;c++)r=f(t,e,i,n[c],n[c+1]||t.length,d,p),r[0]&&(o.holes.push(o.pos.length),o.pos=h(o.pos,r[0].pos),s&&(o.types=h(o.types,r[0].types))),r[1]&&(a.holes.push(a.pos.length),a.pos=h(a.pos,r[1].pos),s&&(a.types=h(a.types,r[1].types)))}else{const i={positions:t};s&&(i.edgeTypes=e),n.length&&(i.holeIndices=n),a.push(i)}}return a}function f(t,e,n,i,r,o,u){const d=(r-i)/n,h=[],p=[],f=[],g=[],m=[];let v,b,y;const x=c(t,d-1,n,i);let _=Math.sign(8&u?x[1]-o[3]:x[0]-o[2]),w=e&&e[d-1],O=0,P=0;for(let r=0;r<d;r++)v=c(t,r,n,i,v),b=Math.sign(8&u?v[1]-o[3]:v[0]-o[2]),y=e&&e[i/n+r],b&&_&&_!==b&&(l(x,v,u,o,m),s(h,m)&&f.push(w),s(p,m)&&g.push(w)),b<=0?(s(h,v)&&f.push(y),O-=b):f.length&&(f[f.length-1]=0),b>=0?(s(p,v)&&g.push(y),P+=b):g.length&&(g[g.length-1]=0),a(x,v),_=b,w=y;return[O?{pos:h,types:e&&f}:null,P?{pos:p,types:e&&g}:null]}function g(t,e,n,i){const r=Math.floor((t[0]-n[0])/e)*e+n[0],o=Math.floor((t[1]-n[1])/e)*e+n[1];return i[0]=r,i[1]=o,i[2]=r+e,i[3]=o+e,i}function m(t,e,n){8&n?(t[1]+=e,t[3]+=e):4&n?(t[1]-=e,t[3]-=e):2&n?(t[0]+=e,t[2]+=e):1&n&&(t[0]-=e,t[2]-=e)}function v(t,e,n,i){let r=1/0,o=-1/0,s=1/0,a=-1/0;for(let i=0;i<n;i+=e){const e=t[i],n=t[i+1];r=e<r?e:r,o=e>o?e:o,s=n<s?n:s,a=n>a?n:a}return i[0][0]=r,i[0][1]=s,i[1][0]=o,i[1][1]=a,i}function b(t,e){const{size:n=2,startIndex:i=0,endIndex:r=t.length,normalize:o=!0}=e||{},s=t.slice(i,r);w(s,n,0,r-i);const a=d(s,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const t of a)O(t,n);return a}function y(t,e=null,n){const{size:i=2,normalize:r=!0,edgeTypes:o=!1}=n||{};e=e||[];const s=[],a=[];let c=0,l=0;for(let r=0;r<=e.length;r++){const o=e[r]||t.length,u=l,d=x(t,i,c,o);for(let e=d;e<o;e++)s[l++]=t[e];for(let e=c;e<d;e++)s[l++]=t[e];w(s,i,u,l),_(s,i,u,l,null==n?void 0:n.maxLatitude),c=o,a[r]=l}a.pop();const u=p(s,a,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(r)for(const t of u)O(t.positions,i);return u}function x(t,e,n,i){let r=-1,o=-1;for(let s=n+1;s<i;s+=e){const e=Math.abs(t[s]);e>r&&(r=e,o=s-1)}return o}function _(t,e,n,i,r=85.051129){const o=t[n],a=t[i-e];if(Math.abs(o-a)>180){const i=c(t,0,e,n);i[0]+=360*Math.round((a-o)/360),s(t,i),i[1]=Math.sign(i[1])*r,s(t,i),i[0]=o,s(t,i)}}function w(t,e,n,i){let r,o=t[0];for(let s=n;s<i;s+=e){r=t[s];const e=r-o;(e>180||e<-180)&&(r-=360*Math.round(e/360)),t[s]=o=r}}function O(t,e){let n;const i=t.length/e;for(let r=0;r<i&&(n=t[r*e],(n+180)%360==0);r++);const r=360*-Math.round(n/360);if(0!==r)for(let n=0;n<i;n++)t[n*e]+=r}},2197:function(t,e,n){"use strict";n.d(e,"a",(function(){return x}));var i=n(245);class r extends(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array)){clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}toArray(t=[],e=0){for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:Object(i.d)(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(i.a)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+Object(i.c)(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!Object(i.b)(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){if(void 0===n)return this.lerp(this,t,e);for(let i=0;i<this.ELEMENTS;++i){const r=t[i];this[i]=r+n*(e[i]-r)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=e[t];return this.check()}subtract(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=e[t];return this.check()}scale(t){if("number"==typeof t)for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;else for(let e=0;e<this.ELEMENTS&&e<t.length;++e)this[e]*=t[e];return this.check()}multiplyByScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}check(){if(i.a.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}get elements(){return this}}function o(t,e,n=""){if(i.a.debug&&!function(t,e){if(t.length!==e)return!1;for(let e=0;e<t.length;++e)if(!Number.isFinite(t[e]))return!1;return!0}(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class s extends r{toString(){let t="[";if(i.a.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=function(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}(n),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)e[t]=this[n+t];return e}setColumn(t,e){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)this[n+t]=e[t];return this}}var a=1e-6,c="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function l(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],c=e[5],l=e[6],u=e[7],d=e[8],h=e[9],p=e[10],f=e[11],g=e[12],m=e[13],v=e[14],b=e[15],y=n[0],x=n[1],_=n[2],w=n[3];return t[0]=y*i+x*a+_*d+w*g,t[1]=y*r+x*c+_*h+w*m,t[2]=y*o+x*l+_*p+w*v,t[3]=y*s+x*u+_*f+w*b,y=n[4],x=n[5],_=n[6],w=n[7],t[4]=y*i+x*a+_*d+w*g,t[5]=y*r+x*c+_*h+w*m,t[6]=y*o+x*l+_*p+w*v,t[7]=y*s+x*u+_*f+w*b,y=n[8],x=n[9],_=n[10],w=n[11],t[8]=y*i+x*a+_*d+w*g,t[9]=y*r+x*c+_*h+w*m,t[10]=y*o+x*l+_*p+w*v,t[11]=y*s+x*u+_*f+w*b,y=n[12],x=n[13],_=n[14],w=n[15],t[12]=y*i+x*a+_*d+w*g,t[13]=y*r+x*c+_*h+w*m,t[14]=y*o+x*l+_*p+w*v,t[15]=y*s+x*u+_*f+w*b,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var u=function(t,e,n,i,r){var o,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(o=1/(i-r),t[10]=(r+i)*o,t[14]=2*r*i*o):(t[10]=-1,t[14]=-2*i),t};var d=function(t,e,n,i,r,o,s){var a=1/(e-n),c=1/(i-r),l=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*c,t[14]=(s+o)*l,t[15]=1,t};var h,p;h=new c(2),c!=Float32Array&&(h[0]=0,h[1]=0),p=h;!function(){var t=function(){var t=new c(3);return c!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}()}();var f;!function(){var t=function(){var t=new c(4);return c!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}()}();!function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"}(f||(f={}));const g=45*Math.PI/180,m=1,v=.1,b=500,y=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class x extends s{static get IDENTITY(){return function(){w||(w=new x,Object.freeze(w));return w}()}static get ZERO(){return function(){_||(_=new x([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(_));return _}()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return f}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,i,r,o,s,a,c,l,u,d,h,p,f,g){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this[4]=r,this[5]=o,this[6]=s,this[7]=a,this[8]=c,this[9]=l,this[10]=u,this[11]=d,this[12]=h,this[13]=p,this[14]=f,this[15]=g,this.check()}setRowMajor(t,e,n,i,r,o,s,a,c,l,u,d,h,p,f,g){return this[0]=t,this[1]=r,this[2]=c,this[3]=h,this[4]=e,this[5]=o,this[6]=l,this[7]=p,this[8]=n,this[9]=s,this[10]=u,this[11]=f,this[12]=i,this[13]=a,this[14]=d,this[15]=g,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(y)}fromObject(t){return this.check()}fromQuaternion(t){return function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n+n,a=i+i,c=r+r,l=n*s,u=i*s,d=i*a,h=r*s,p=r*a,f=r*c,g=o*s,m=o*a,v=o*c;t[0]=1-d-f,t[1]=u+v,t[2]=h-m,t[3]=0,t[4]=u-v,t[5]=1-l-f,t[6]=p+g,t[7]=0,t[8]=h+m,t[9]=p-g,t[10]=1-l-d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(this,t),this.check()}frustum(t){const{left:e,right:n,bottom:i,top:r,near:o=v,far:s=b}=t;return s===1/0?function(t,e,n,i,r,o){const s=2*o/(n-e),a=2*o/(r-i),c=(n+e)/(n-e),l=(r+i)/(r-i),u=-2*o;t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=c,t[9]=l,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=u,t[15]=0}(this,e,n,i,r,o):function(t,e,n,i,r,o,s){var a=1/(n-e),c=1/(r-i),l=1/(o-s);t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*c,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(r+i)*c,t[10]=(s+o)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*l,t[15]=0}(this,e,n,i,r,o,s),this.check()}lookAt(t){const{eye:e,center:n=[0,0,0],up:i=[0,1,0]}=t;return function(t,e,n,i){var r,o,s,c,l,u,d,h,p,f,g=e[0],m=e[1],v=e[2],b=i[0],y=i[1],x=i[2],_=n[0],w=n[1],O=n[2];Math.abs(g-_)<a&&Math.abs(m-w)<a&&Math.abs(v-O)<a?function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(t):(d=g-_,h=m-w,p=v-O,r=y*(p*=f=1/Math.hypot(d,h,p))-x*(h*=f),o=x*(d*=f)-b*p,s=b*h-y*d,(f=Math.hypot(r,o,s))?(r*=f=1/f,o*=f,s*=f):(r=0,o=0,s=0),c=h*s-p*o,l=p*r-d*s,u=d*o-h*r,(f=Math.hypot(c,l,u))?(c*=f=1/f,l*=f,u*=f):(c=0,l=0,u=0),t[0]=r,t[1]=c,t[2]=d,t[3]=0,t[4]=o,t[5]=l,t[6]=h,t[7]=0,t[8]=s,t[9]=u,t[10]=p,t[11]=0,t[12]=-(r*g+o*m+s*v),t[13]=-(c*g+l*m+u*v),t[14]=-(d*g+h*m+p*v),t[15]=1)}(this,e,n,i),this.check()}ortho(t){const{left:e,right:n,bottom:i,top:r,near:o=v,far:s=b}=t;return d(this,e,n,i,r,o,s),this.check()}orthographic(t){const{fovy:e=g,aspect:n=m,focalDistance:i=1,near:r=v,far:o=b}=t;O(e);const s=e/2,a=i*Math.tan(s),c=a*n;return this.ortho({left:-c,right:c,bottom:-a,top:a,near:r,far:o})}perspective(t){const{fovy:e=45*Math.PI/180,aspect:n=1,near:i=.1,far:r=500}=t;return O(e),u(this,e,n,i,r),this.check()}determinant(){return e=(t=this)[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],c=t[7],l=t[8],u=t[9],d=t[10],h=t[11],p=t[12],f=t[13],g=t[14],m=t[15],(e*s-n*o)*(d*m-h*g)-(e*a-i*o)*(u*m-h*f)+(e*c-r*o)*(u*g-d*f)+(n*a-i*s)*(l*m-h*p)-(n*c-r*s)*(l*g-d*p)+(i*c-r*a)*(l*f-u*p);var t,e,n,i,r,o,s,a,c,l,u,d,h,p,f,g,m}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],r=1/n[1],o=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*r,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*r,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],r=1/n[1],o=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*o,t[3]=this[4]*i,t[4]=this[5]*r,t[5]=this[6]*o,t[6]=this[8]*i,t[7]=this[9]*r,t[8]=this[10]*o,t}transpose(){return function(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=r,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]}(this,this),this.check()}invert(){return function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],c=e[6],l=e[7],u=e[8],d=e[9],h=e[10],p=e[11],f=e[12],g=e[13],m=e[14],v=e[15],b=n*a-i*s,y=n*c-r*s,x=n*l-o*s,_=i*c-r*a,w=i*l-o*a,O=r*l-o*c,P=u*g-d*f,S=u*m-h*f,C=u*v-p*f,j=d*m-h*g,M=d*v-p*g,E=h*v-p*m,L=b*E-y*M+x*j+_*C-w*S+O*P;L&&(L=1/L,t[0]=(a*E-c*M+l*j)*L,t[1]=(r*M-i*E-o*j)*L,t[2]=(g*O-m*w+v*_)*L,t[3]=(h*w-d*O-p*_)*L,t[4]=(c*C-s*E-l*S)*L,t[5]=(n*E-r*C+o*S)*L,t[6]=(m*x-f*O-v*y)*L,t[7]=(u*O-h*x+p*y)*L,t[8]=(s*M-a*C+l*P)*L,t[9]=(i*C-n*M-o*P)*L,t[10]=(f*w-g*x+v*b)*L,t[11]=(d*x-u*w-p*b)*L,t[12]=(a*S-s*j-c*P)*L,t[13]=(n*j-i*S+r*P)*L,t[14]=(g*y-f*_-m*b)*L,t[15]=(u*_-d*y+h*b)*L)}(this,this),this.check()}multiplyLeft(t){return l(this,t,this),this.check()}multiplyRight(t){return l(this,this,t),this.check()}rotateX(t){return function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],s=e[5],a=e[6],c=e[7],l=e[8],u=e[9],d=e[10],h=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+l*i,t[5]=s*r+u*i,t[6]=a*r+d*i,t[7]=c*r+h*i,t[8]=l*r-o*i,t[9]=u*r-s*i,t[10]=d*r-a*i,t[11]=h*r-c*i}(this,this,t),this.check()}rotateY(t){return function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],c=e[3],l=e[8],u=e[9],d=e[10],h=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-l*i,t[1]=s*r-u*i,t[2]=a*r-d*i,t[3]=c*r-h*i,t[8]=o*i+l*r,t[9]=s*i+u*r,t[10]=a*i+d*r,t[11]=c*i+h*r}(this,this,t),this.check()}rotateZ(t){return function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],c=e[3],l=e[4],u=e[5],d=e[6],h=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+l*i,t[1]=s*r+u*i,t[2]=a*r+d*i,t[3]=c*r+h*i,t[4]=l*r-o*i,t[5]=u*r-s*i,t[6]=d*r-a*i,t[7]=h*r-c*i}(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,e){return function(t,e,n,i){var r,o,s,c,l,u,d,h,p,f,g,m,v,b,y,x,_,w,O,P,S,C,j,M,E=i[0],L=i[1],T=i[2],R=Math.hypot(E,L,T);R<a||(E*=R=1/R,L*=R,T*=R,r=Math.sin(n),s=1-(o=Math.cos(n)),c=e[0],l=e[1],u=e[2],d=e[3],h=e[4],p=e[5],f=e[6],g=e[7],m=e[8],v=e[9],b=e[10],y=e[11],x=E*E*s+o,_=L*E*s+T*r,w=T*E*s-L*r,O=E*L*s-T*r,P=L*L*s+o,S=T*L*s+E*r,C=E*T*s+L*r,j=L*T*s-E*r,M=T*T*s+o,t[0]=c*x+h*_+m*w,t[1]=l*x+p*_+v*w,t[2]=u*x+f*_+b*w,t[3]=d*x+g*_+y*w,t[4]=c*O+h*P+m*S,t[5]=l*O+p*P+v*S,t[6]=u*O+f*P+b*S,t[7]=d*O+g*P+y*S,t[8]=c*C+h*j+m*M,t[9]=l*C+p*j+v*M,t[10]=u*C+f*j+b*M,t[11]=d*C+g*j+y*M,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]))}(this,this,t,e),this.check()}scale(t){return function(t,e,n){var i=n[0],r=n[1],o=n[2];t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return function(t,e,n){var i,r,o,s,a,c,l,u,d,h,p,f,g=n[0],m=n[1],v=n[2];e===t?(t[12]=e[0]*g+e[4]*m+e[8]*v+e[12],t[13]=e[1]*g+e[5]*m+e[9]*v+e[13],t[14]=e[2]*g+e[6]*m+e[10]*v+e[14],t[15]=e[3]*g+e[7]*m+e[11]*v+e[15]):(i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],c=e[5],l=e[6],u=e[7],d=e[8],h=e[9],p=e[10],f=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=c,t[6]=l,t[7]=u,t[8]=d,t[9]=h,t[10]=p,t[11]=f,t[12]=i*g+a*m+d*v+e[12],t[13]=r*g+c*m+h*v+e[13],t[14]=o*g+l*m+p*v+e[14],t[15]=s*g+u*m+f*v+e[15])}(this,this,t),this.check()}transform(t,e){return 4===t.length?(o(e=function(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*s,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*s,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*s,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*s,t}(e||[-0,-0,-0,-0],t,this),4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;let i;switch(n){case 2:i=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}(e||[-0,-0],t,this);break;case 3:i=function(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[3]*i+n[7]*r+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/s,t[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/s,t[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/s,t}(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return o(i,t.length),i}transformAsVector(t,e){let n;switch(t.length){case 2:n=function(t,e,n){const i=e[0],r=e[1],o=n[3]*i+n[7]*r||1;return t[0]=(n[0]*i+n[4]*r)/o,t[1]=(n[1]*i+n[5]*r)/o,t}(e||[-0,-0],t,this);break;case 3:n=function(t,e,n){const i=e[0],r=e[1],o=e[2],s=n[3]*i+n[7]*r+n[11]*o||1;return t[0]=(n[0]*i+n[4]*r+n[8]*o)/s,t[1]=(n[1]*i+n[5]*r+n[9]*o)/s,t[2]=(n[2]*i+n[6]*r+n[10]*o)/s,t}(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return o(n,t.length),n}transformPoint(t,e){return this.transformAsPoint(t,e)}transformVector(t,e){return this.transformAsPoint(t,e)}transformDirection(t,e){return this.transformAsVector(t,e)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}}let _,w;function O(t){if(t>2*Math.PI)throw Error("expected radians")}},2207:function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));var i=n(3),r=n(1156);const o="\nuniform DATAFILTER_TYPE filter_min;\nuniform DATAFILTER_TYPE filter_softMin;\nuniform DATAFILTER_TYPE filter_softMax;\nuniform DATAFILTER_TYPE filter_max;\nuniform bool filter_useSoftMargin;\nuniform bool filter_enabled;\nuniform bool filter_transformSize;\n\n#ifdef NON_INSTANCED_MODEL\n  #define DATAFILTER_ATTRIB filterValues\n  #define DATAFILTER_ATTRIB_64LOW filterValues64Low\n#else\n  #define DATAFILTER_ATTRIB instanceFilterValues\n  #define DATAFILTER_ATTRIB_64LOW instanceFilterValues64Low\n#endif\n\nattribute DATAFILTER_TYPE DATAFILTER_ATTRIB;\n#ifdef DATAFILTER_DOUBLE\n  attribute DATAFILTER_TYPE DATAFILTER_ATTRIB_64LOW;\n\n  uniform DATAFILTER_TYPE filter_min64High;\n  uniform DATAFILTER_TYPE filter_max64High;\n#endif\n\nvarying float dataFilter_value;\n\nfloat dataFilter_reduceValue(float value) {\n  return value;\n}\nfloat dataFilter_reduceValue(vec2 value) {\n  return min(value.x, value.y);\n}\nfloat dataFilter_reduceValue(vec3 value) {\n  return min(min(value.x, value.y), value.z);\n}\nfloat dataFilter_reduceValue(vec4 value) {\n  return min(min(value.x, value.y), min(value.z, value.w));\n}\nvoid dataFilter_setValue(DATAFILTER_TYPE valueFromMin, DATAFILTER_TYPE valueFromMax) {\n  if (filter_enabled) {\n    if (filter_useSoftMargin) {\n      dataFilter_value = dataFilter_reduceValue(\n        smoothstep(filter_min, filter_softMin, valueFromMin) *\n        (1.0 - smoothstep(filter_softMax, filter_max, valueFromMax))\n      );\n    } else {\n      dataFilter_value = dataFilter_reduceValue(\n        step(filter_min, valueFromMin) * step(valueFromMax, filter_max)\n      );\n    }\n  } else {\n    dataFilter_value = 1.0;\n  }\n}\n",s="\nuniform bool filter_transformColor;\nvarying float dataFilter_value;\n";function a(t){if(!t||!("extensions"in t))return{};const{filterRange:e=[-1,1],filterEnabled:n=!0,filterTransformSize:i=!0,filterTransformColor:r=!0}=t,o=t.filterSoftRange||e;return{...Number.isFinite(e[0])?{filter_min:e[0],filter_softMin:o[0],filter_softMax:o[1],filter_max:e[1]}:{filter_min:e.map(t=>t[0]),filter_softMin:o.map(t=>t[0]),filter_softMax:o.map(t=>t[1]),filter_max:e.map(t=>t[1])},filter_enabled:n,filter_useSoftMargin:Boolean(t.filterSoftRange),filter_transformSize:n&&i,filter_transformColor:n&&r}}const c={"vs:#main-start":"\n    #ifdef DATAFILTER_DOUBLE\n      dataFilter_setValue(\n        DATAFILTER_ATTRIB - filter_min64High + DATAFILTER_ATTRIB_64LOW,\n        DATAFILTER_ATTRIB - filter_max64High + DATAFILTER_ATTRIB_64LOW\n      );\n    #else\n      dataFilter_setValue(DATAFILTER_ATTRIB, DATAFILTER_ATTRIB);\n    #endif\n  ","vs:#main-end":"\n    if (dataFilter_value == 0.0) {\n      gl_Position = vec4(0.);\n    }\n  ","vs:DECKGL_FILTER_SIZE":"\n    if (filter_transformSize) {\n      size = size * dataFilter_value;\n    }\n  ","fs:DECKGL_FILTER_COLOR":"\n    if (dataFilter_value == 0.0) discard;\n    if (filter_transformColor) {\n      color.a *= dataFilter_value;\n    }\n  "},l={name:"data-filter",vs:o,fs:s,inject:c,getUniforms:a},u={name:"data-filter-fp64",vs:o,fs:s,inject:c,getUniforms:function(t){if(!t||!("extensions"in t))return{};const e=a(t);if(Number.isFinite(e.filter_min)){const t=Math.fround(e.filter_min);e.filter_min-=t,e.filter_softMin-=t,e.filter_min64High=t;const n=Math.fround(e.filter_max);e.filter_max-=n,e.filter_softMax-=n,e.filter_max64High=n}else{const t=e.filter_min.map(Math.fround);e.filter_min=e.filter_min.map((e,n)=>e-t[n]),e.filter_softMin=e.filter_softMin.map((e,n)=>e-t[n]),e.filter_min64High=t;const n=e.filter_max.map(Math.fround);e.filter_max=e.filter_max.map((t,e)=>t-n[e]),e.filter_softMax=e.filter_softMax.map((t,e)=>t-n[e]),e.filter_max64High=n}return e}};var d=n(275),h=n(425),p=n(29),f=n(798);const g={blend:!0,blendFunc:[1,1,1,1],blendEquation:[32774,32774],depthTest:!1};var m=n(809),v=n(955);const b={1:"float",2:"vec2",3:"vec3",4:"vec4"};class y extends r.a{constructor({filterSize:t=1,fp64:e=!1,countItems:n=!1}={}){if(!b[t])throw new Error("filterSize out of range");super({filterSize:t,fp64:e,countItems:n})}getShaders(t){const{filterSize:e,fp64:n}=t.opts;return{modules:[n?u:l],defines:{DATAFILTER_TYPE:b[e],DATAFILTER_DOUBLE:Boolean(n)}}}initializeState(t,e){const n=this.getAttributeManager();n&&n.add({filterValues:{size:e.opts.filterSize,type:e.opts.fp64?5130:5126,accessor:"getFilterValue",shaderAttributes:{filterValues:{divisor:0},instanceFilterValues:{divisor:1}}}});const{gl:i}=this.context;if(n&&e.opts.countItems){const t=function(t){return Boolean(t.getExtension("EXT_float_blend")&&(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")))}(i);n.add({filterIndices:{size:t?1:2,vertexOffset:1,type:5121,normalized:!0,accessor:(e,{index:n})=>{const i=e&&e.__source?e.__source.index:n;return t?(i+1)%255:[(i+1)%255,Math.floor(i/255)%255]},shaderAttributes:{filterPrevIndices:{vertexOffset:0},filterIndices:{vertexOffset:1}}}});const r=function(t,e){return e?new d.a(t,{width:1,height:1,attachments:{36064:new h.a(t,{format:Object(p.j)(t)?34836:6408,type:5126,mipmaps:!1})}}):new d.a(t,{width:256,height:64,depth:!1})}(i,t),o=function(t,e,n){return e.defines.NON_INSTANCED_MODEL=1,n&&(e.defines.FLOAT_TARGET=1),new f.a(t,{id:"data-filter-aggregation-model",vertexCount:1,isInstanced:!1,drawMode:0,vs:"#define SHADER_NAME data-filter-vertex-shader\n\n#ifdef FLOAT_TARGET\n  attribute float filterIndices;\n  attribute float filterPrevIndices;\n#else\n  attribute vec2 filterIndices;\n  attribute vec2 filterPrevIndices;\n#endif\n\nvarying vec4 vColor;\nconst float component = 1.0 / 255.0;\n\nvoid main() {\n  #ifdef FLOAT_TARGET\n    dataFilter_value *= float(filterIndices != filterPrevIndices);\n    gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\n    vColor = vec4(0.0, 0.0, 0.0, 1.0);\n  #else\n    // Float texture is not supported: pack result into 4 channels x 256 px x 64px\n    dataFilter_value *= float(filterIndices.x != filterPrevIndices.x);\n    float col = filterIndices.x;\n    float row = filterIndices.y * 4.0;\n    float channel = floor(row);\n    row = fract(row);\n    vColor = component * vec4(bvec4(channel == 0.0, channel == 1.0, channel == 2.0, channel == 3.0));\n    gl_Position = vec4(col * 2.0 - 1.0, row * 2.0 - 1.0, 0.0, 1.0);\n  #endif\n  gl_PointSize = 1.0;\n}\n",fs:"#define SHADER_NAME data-filter-fragment-shader\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main() {\n  if (dataFilter_value < 0.5) {\n    discard;\n  }\n  gl_FragColor = vColor;\n}\n",...e})}(i,e.getShaders.call(this,e),t);this.setState({filterFBO:r,filterModel:o})}}updateState({props:t,oldProps:e}){if(this.state.filterModel){const n=this.getAttributeManager().attributes.filterValues.needsUpdate()||t.filterEnabled!==e.filterEnabled||t.filterRange!==e.filterRange||t.filterSoftRange!==e.filterSoftRange;n&&this.setState({filterNeedsUpdate:n})}}draw(t,e){const{filterFBO:n,filterModel:i,filterNeedsUpdate:r}=this.state,{onFilteredItemsChange:o}=this.props;if(r&&o&&i){const{attributes:{filterValues:e,filterIndices:r}}=this.getAttributeManager();i.setVertexCount(this.getNumInstances());const{gl:s}=this.context;Object(m.a)(s,{framebuffer:n,color:[0,0,0,0]}),i.updateModuleSettings(t.moduleParameters).setAttributes({...e.getShaderAttributes(),...r&&r.getShaderAttributes()}).draw({framebuffer:n,parameters:{...g,viewport:[0,0,n.width,n.height]}});const a=Object(v.c)(n);let c=0;for(let t=0;t<a.length;t++)c+=a[t];o({id:this.id,count:c}),this.state.filterNeedsUpdate=!1}}finalizeState(){const{filterFBO:t,filterModel:e}=this.state;t&&(t.color.delete(),t.delete(),e.delete())}}Object(i.a)(y,"defaultProps",{getFilterValue:{type:"accessor",value:0},onFilteredItemsChange:{type:"function",value:null,optional:!0},filterEnabled:!0,filterRange:[-1,1],filterSoftRange:null,filterTransformSize:!0,filterTransformColor:!0}),Object(i.a)(y,"extensionName","DataFilterExtension")},2208:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i=n(3),r=n(1162),o=n(780),s=n(196);n(52),n(68);function a(t,e,n=!0){if(!n)return{xOffset:e,yOffset:e};const{yMin:i,yMax:r}=t;return function(t,e){const n=(s=t,s/6378e3*(180/Math.PI)),i=(r=e,o=t,o/6378e3*(180/Math.PI)/Math.cos(r*Math.PI/180));var r,o;var s;return{yOffset:n,xOffset:i}}(e,(i+r)/2)}var c=n(781),l=n(804);function u(){}const d={colorDomain:null,colorRange:o.a,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",min:0,max:100,value:0},upperPercentile:{type:"number",min:0,max:100,value:100},colorScaleType:"quantize",onSetColorDomain:u,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationLowerPercentile:{type:"number",min:0,max:100,value:0},elevationUpperPercentile:{type:"number",min:0,max:100,value:100},elevationScale:{type:"number",min:0,value:1},elevationScaleType:"linear",onSetElevationDomain:u,gridAggregator:function(t,e){const n=function(t,e){const{data:n=[],cellSize:i}=t,{attributes:r,viewport:o,projectPoints:c,numInstances:l}=e,u=r.positions.value,{size:d}=r.positions.getAccessor(),h=e.boundingBox||function(t,e){const n=t.value,{size:i}=t.getAccessor();let r,o,s=1/0,a=-1/0,c=1/0,l=-1/0;for(let t=0;t<e;t++)o=n[t*i],r=n[t*i+1],Number.isFinite(o)&&Number.isFinite(r)&&(s=r<s?r:s,a=r>a?r:a,c=o<c?o:c,l=o>l?o:l);return{xMin:c,xMax:l,yMin:s,yMax:a}}(r.positions,l),p=e.posOffset||[180,90],f=e.gridOffset||a(h,i);if(f.xOffset<=0||f.yOffset<=0)return{gridHash:{},gridOffset:f};const{width:g,height:m}=o,v=Math.ceil(g/f.xOffset),b=Math.ceil(m/f.yOffset),y={},{iterable:x,objectInfo:_}=Object(s.a)(n),w=new Array(3);for(const t of x){_.index++,w[0]=u[_.index*d],w[1]=u[_.index*d+1],w[2]=d>=3?u[_.index*d+2]:0;const[e,n]=c?o.project(w):w;if(Number.isFinite(e)&&Number.isFinite(n)){const i=Math.floor((n+p[1])/f.yOffset),r=Math.floor((e+p[0])/f.xOffset);if(!c||r>=0&&r<v&&i>=0&&i<b){const e="".concat(i,"-").concat(r);y[e]=y[e]||{count:0,points:[],lonIdx:r,latIdx:i},y[e].count+=1,y[e].points.push({source:t,index:_.index})}}}return{gridHash:y,gridOffset:f,offsets:[-1*p[0],-1*p[1]]}}(t,e),i=function({gridHash:t,gridOffset:e,offsets:n}){const i=new Array(Object.keys(t).length);let r=0;for(const o in t){const s=o.split("-"),a=parseInt(s[0],10),c=parseInt(s[1],10),l=r++;i[l]={index:l,position:[n[0]+e.xOffset*c,n[1]+e.yOffset*a],...t[o]}}return i}(n);return{gridHash:n.gridHash,gridOffset:n.gridOffset,data:i}},cellSize:{type:"number",min:0,max:1e3,value:1e3},coverage:{type:"number",min:0,max:1,value:1},getPosition:{type:"accessor",value:t=>t.position},extruded:!1,material:!0,_filterData:{type:"function",value:null,optional:!0}};class h extends l.a{initializeState(){const t=new c.a({getAggregator:t=>t.gridAggregator,getCellSize:t=>t.cellSize});this.state={cpuAggregator:t,aggregatorState:t.state};this.getAttributeManager().add({positions:{size:3,type:5130,accessor:"getPosition"}})}updateState(t){super.updateState(t),this.setState({aggregatorState:this.state.cpuAggregator.updateState(t,{viewport:this.context.viewport,attributes:this.getAttributes(),numInstances:this.getNumInstances()})})}getPickingInfo({info:t}){return this.state.cpuAggregator.getPickingInfo({info:t})}_onGetSublayerColor(t){return this.state.cpuAggregator.getAccessor("fillColor")(t)}_onGetSublayerElevation(t){return this.state.cpuAggregator.getAccessor("elevation")(t)}_getSublayerUpdateTriggers(){return this.state.cpuAggregator.getUpdateTriggers(this.props)}renderLayers(){const{elevationScale:t,extruded:e,cellSize:n,coverage:i,material:o,transitions:s}=this.props,{cpuAggregator:a}=this.state,c=this.getSubLayerClass("grid-cell",r.a),l=this._getSublayerUpdateTriggers();return new c({cellSize:n,coverage:i,material:o,elevationScale:t,extruded:e,getFillColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:s&&{getFillColor:s.getColorValue||s.getColorWeight,getElevation:s.getElevationValue||s.getElevationWeight}},this.getSubLayerProps({id:"grid-cell",updateTriggers:l}),{data:a.state.layerData.data})}}Object(i.a)(h,"layerName","CPUGridLayer"),Object(i.a)(h,"defaultProps",d)},2213:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(3),r=n(1156),o=n(408);const s={source:0,target:1,custom:2,source_target:3};var a={name:"brushing",dependencies:[o.a],vs:"\n  uniform bool brushing_enabled;\n  uniform int brushing_target;\n  uniform vec2 brushing_mousePos;\n  uniform float brushing_radius;\n\n  #ifdef NON_INSTANCED_MODEL\n  attribute vec2 brushingTargets;\n  #else\n  attribute vec2 instanceBrushingTargets;\n  #endif\n\n  varying float brushing_isVisible;\n\n  bool brushing_isPointInRange(vec2 position) {\n    if (!brushing_enabled) {\n      return true;\n    }\n    vec2 source_commonspace = project_position(position);\n    vec2 target_commonspace = project_position(brushing_mousePos);\n    float distance = length((target_commonspace - source_commonspace) / project_uCommonUnitsPerMeter.xy);\n\n    return distance <= brushing_radius;\n  }\n\n  bool brushing_arePointsInRange(vec2 sourcePos, vec2 targetPos) {\n    return brushing_isPointInRange(sourcePos) || brushing_isPointInRange(targetPos);\n  }\n\n  void brushing_setVisible(bool visible) {\n    brushing_isVisible = float(visible);\n  }\n",fs:"\n  uniform bool brushing_enabled;\n  varying float brushing_isVisible;\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    vec2 brushingTarget;\n    vec2 brushingSource;\n    if (brushing_target == 3) {\n      brushingTarget = geometry.worldPositionAlt.xy;\n      brushingSource = geometry.worldPosition.xy;\n    } else if (brushing_target == 0) {\n      brushingTarget = geometry.worldPosition.xy;\n    } else if (brushing_target == 1) {\n      brushingTarget = geometry.worldPositionAlt.xy;\n    } else {\n      #ifdef NON_INSTANCED_MODEL\n      brushingTarget = brushingTargets;\n      #else\n      brushingTarget = instanceBrushingTargets;\n      #endif\n    }\n    bool visible;\n    if (brushing_target == 3) {\n      visible = brushing_arePointsInRange(brushingSource, brushingTarget);\n    } else {\n      visible = brushing_isPointInRange(brushingTarget);\n    }\n    brushing_setVisible(visible);\n  ","fs:DECKGL_FILTER_COLOR":"\n    if (brushing_enabled && brushing_isVisible < 0.5) {\n      discard;\n    }\n  "},getUniforms:t=>{if(!t||!("viewport"in t))return{};const{brushingEnabled:e=!0,brushingRadius:n=1e4,brushingTarget:i="source",mousePosition:r,viewport:o}=t;return{brushing_enabled:Boolean(e&&r&&o.containsPixel(r)),brushing_radius:n,brushing_target:s[i]||0,brushing_mousePos:r?o.unproject([r.x-o.x,r.y-o.y]):[0,0]}}};class c extends r.a{getShaders(){return{modules:[a]}}initializeState(t,e){const n=this.getAttributeManager();n&&n.add({brushingTargets:{size:2,accessor:"getBrushingTarget",shaderAttributes:{brushingTargets:{divisor:0},instanceBrushingTargets:{divisor:1}}}}),this.state.onMouseMove=()=>{var t;null===(t=this.getCurrentLayer())||void 0===t||t.setNeedsRedraw()},t.deck&&t.deck.eventManager.on({pointermove:this.state.onMouseMove,pointerleave:this.state.onMouseMove})}finalizeState(t,e){t.deck&&t.deck.eventManager.off({pointermove:this.state.onMouseMove,pointerleave:this.state.onMouseMove})}}Object(i.a)(c,"defaultProps",{getBrushingTarget:{type:"accessor",value:[0,0]},brushingTarget:"source",brushingEnabled:!0,brushingRadius:1e4}),Object(i.a)(c,"extensionName","BrushingExtension")},2214:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var i=n(3),r=n(68),o=n(586),s=n(780),a=n(803),c=n(196);var l=n(781),u=n(804);function d(){}const h={colorDomain:null,colorRange:s.a,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",value:0,min:0,max:100},upperPercentile:{type:"number",value:100,min:0,max:100},colorScaleType:"quantize",onSetColorDomain:d,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationLowerPercentile:{type:"number",value:0,min:0,max:100},elevationUpperPercentile:{type:"number",value:100,min:0,max:100},elevationScale:{type:"number",min:0,value:1},elevationScaleType:"linear",onSetElevationDomain:d,radius:{type:"number",value:1e3,min:1},coverage:{type:"number",min:0,max:1,value:1},extruded:!1,hexagonAggregator:function(t,e){const{data:n,radius:i}=t,{viewport:o,attributes:s}=e,l=n.length?function(t,e){const{attributes:n}=e,i=n.positions.value,{size:r}=n.positions.getAccessor();let o,s=1/0,a=1/0,c=-1/0,l=-1/0;for(o=0;o<r*t.length;o+=r){const t=i[o],e=i[o+1];Number.isFinite(t)&&Number.isFinite(e)&&(s=Math.min(t,s),c=Math.max(t,c),a=Math.min(e,a),l=Math.max(e,l))}return[s,a,c,l].every(Number.isFinite)?[(s+c)/2,(a+l)/2]:null}(n,e):null,u=function(t,e,n){const{unitsPerMeter:i}=e.getDistanceScales(n);return t*i[0]}(i,o,l),d=[],{iterable:h,objectInfo:p}=Object(c.a)(n),f=s.positions.value,{size:g}=s.positions.getAccessor();for(const t of h){p.index++;const e=p.index*g,n=[f[e],f[e+1]];Number.isFinite(n[0])&&Number.isFinite(n[1])?d.push({screenCoord:o.projectFlat(n),source:t,index:p.index}):r.a.warn("HexagonLayer: invalid position")()}return{hexagons:Object(a.a)().radius(u).x(t=>t.screenCoord[0]).y(t=>t.screenCoord[1])(d).map((t,e)=>({position:o.unprojectFlat([t.x,t.y]),points:t,index:e})),radiusCommon:u}},getPosition:{type:"accessor",value:t=>t.position},material:!0,_filterData:{type:"function",value:null,optional:!0}};class p extends u.a{constructor(...t){super(...t),Object(i.a)(this,"state",void 0)}initializeState(){const t=new l.a({getAggregator:t=>t.hexagonAggregator,getCellSize:t=>t.radius});this.state={cpuAggregator:t,aggregatorState:t.state,vertices:null};this.getAttributeManager().add({positions:{size:3,type:5130,accessor:"getPosition"}})}updateState(t){if(super.updateState(t),t.changeFlags.propsOrDataChanged){const e=this.state.cpuAggregator.updateState(t,{viewport:this.context.viewport,attributes:this.getAttributes()});if(this.state.aggregatorState.layerData!==e.layerData){const{hexagonVertices:t}=e.layerData||{};this.setState({vertices:t&&this.convertLatLngToMeterOffset(t)})}this.setState({aggregatorState:e})}}convertLatLngToMeterOffset(t){const{viewport:e}=this.context;if(Array.isArray(t)&&6===t.length){const n=t[0],i=t[3],r=[(n[0]+i[0])/2,(n[1]+i[1])/2],o=e.projectFlat(r),{metersPerUnit:s}=e.getDistanceScales(r);return t.map(t=>{const n=e.projectFlat(t);return[(n[0]-o[0])*s[0],(n[1]-o[1])*s[1]]})}return r.a.error("HexagonLayer: hexagonVertices needs to be an array of 6 points")(),null}getPickingInfo({info:t}){return this.state.cpuAggregator.getPickingInfo({info:t})}_onGetSublayerColor(t){return this.state.cpuAggregator.getAccessor("fillColor")(t)}_onGetSublayerElevation(t){return this.state.cpuAggregator.getAccessor("elevation")(t)}_getSublayerUpdateTriggers(){return this.state.cpuAggregator.getUpdateTriggers(this.props)}renderLayers(){const{elevationScale:t,extruded:e,coverage:n,material:i,transitions:r}=this.props,{aggregatorState:s,vertices:a}=this.state,c=this.getSubLayerClass("hexagon-cell",o.a),l=this._getSublayerUpdateTriggers();return new c({...a?{vertices:a,radius:1}:{radius:s.layerData.radiusCommon||1,radiusUnits:"common",angle:90},diskResolution:6,elevationScale:t,extruded:e,coverage:n,material:i,getFillColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:r&&{getFillColor:r.getColorValue||r.getColorWeight,getElevation:r.getElevationValue||r.getElevationWeight}},this.getSubLayerProps({id:"hexagon-cell",updateTriggers:l}),{data:s.layerData.data})}}Object(i.a)(p,"layerName","HexagonLayer"),Object(i.a)(p,"defaultProps",h)},2215:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n(3),r=n(1156),o=n(665);const s={inject:{"vs:#decl":"\nattribute vec2 instanceDashArrays;\nattribute float instanceDashOffsets;\nvarying vec2 vDashArray;\nvarying float vDashOffset;\n","vs:#main-end":"\nvDashArray = instanceDashArrays;\nvDashOffset = instanceDashOffsets / width.x;\n","fs:#decl":"\nuniform float dashAlignMode;\nuniform float capType;\nuniform bool dashGapPickable;\nvarying vec2 vDashArray;\nvarying float vDashOffset;\n\nfloat round(float x) {\n  return floor(x + 0.5);\n}\n","fs:#main-start":"\n  float solidLength = vDashArray.x;\n  float gapLength = vDashArray.y;\n  float unitLength = solidLength + gapLength;\n\n  float offset;\n\n  if (unitLength > 0.0) {\n    if (dashAlignMode == 0.0) {\n      offset = vDashOffset;\n    } else {\n      unitLength = vPathLength / round(vPathLength / unitLength);\n      offset = solidLength / 2.0;\n    }\n\n    float unitOffset = mod(vPathPosition.y + offset, unitLength);\n\n    if (gapLength > 0.0 && unitOffset > solidLength) {\n      if (capType <= 0.5) {\n        if (!(dashGapPickable && picking_uActive)) {\n          discard;\n        }\n      } else {\n        float distToEnd = length(vec2(\n          min(unitOffset - solidLength, unitLength - unitOffset),\n          vPathPosition.x\n        ));\n        if (distToEnd > 1.0) {\n          if (!(dashGapPickable && picking_uActive)) {\n            discard;\n          }\n        }\n      }\n    }\n  }\n"}},a={inject:{"vs:#decl":"\nattribute float instanceOffsets;\n","vs:DECKGL_FILTER_SIZE":"\n  float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;\n  size *= offsetWidth;\n","vs:#main-end":"\n  float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;\n  float offsetDir = sign(instanceOffsets);\n  vPathPosition.x = (vPathPosition.x + offsetDir) * offsetWidth - offsetDir;\n  vPathPosition.y *= offsetWidth;\n  vPathLength *= offsetWidth;\n","fs:#main-start":"\n  float isInside;\n  isInside = step(-1.0, vPathPosition.x) * step(vPathPosition.x, 1.0);\n  if (isInside == 0.0) {\n    discard;\n  }\n"}};var c=n(64);class l extends r.a{constructor({dash:t=!1,offset:e=!1,highPrecisionDash:n=!1}={}){super({dash:t||n,offset:e,highPrecisionDash:n})}isEnabled(t){return"pathTesselator"in t.state}getShaders(t){if(!t.isEnabled(this))return null;let e={};return t.opts.dash&&(e=Object(o.a)(e,s)),t.opts.offset&&(e=Object(o.a)(e,a)),e}initializeState(t,e){const n=this.getAttributeManager();n&&e.isEnabled(this)&&(e.opts.dash&&n.addInstanced({instanceDashArrays:{size:2,accessor:"getDashArray"}}),e.opts.highPrecisionDash&&n.addInstanced({instanceDashOffsets:{size:1,accessor:"getPath",transform:e.getDashOffsets.bind(this)}}),e.opts.offset&&n.addInstanced({instanceOffsets:{size:1,accessor:"getOffset"}}))}updateState(t,e){if(!e.isEnabled(this))return;const n={};e.opts.dash&&(n.dashAlignMode=this.props.dashJustified?1:0,n.dashGapPickable=Boolean(this.props.dashGapPickable)),this.state.model.setUniforms(n)}getDashOffsets(t){const e=[0],n="XY"===this.props.positionFormat?2:3,i=Array.isArray(t[0]),r=i?t.length:t.length/n;let o,s;for(let a=0;a<r-1;a++)o=i?t[a]:t.slice(a*n,a*n+n),o=this.projectPosition(o),a>0&&(e[a]=e[a-1]+Object(c.e)(s,o)),s=o;return e}}Object(i.a)(l,"defaultProps",{getDashArray:{type:"accessor",value:[0,0]},getOffset:{type:"accessor",value:0},dashJustified:!1,dashGapPickable:!1}),Object(i.a)(l,"extensionName","PathStyleExtension")},2218:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return s}));Math.PI,Math.PI;const i={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function r(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function o(t,e,n){return r(t)?t.map((t,i)=>o(t,e[i],n)):n*e+(1-n)*t}function s(t,e,n){const o=i.EPSILON;n&&(i.EPSILON=n);try{if(t===e)return!0;if(r(t)&&r(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!s(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):"number"==typeof t&&"number"==typeof e&&Math.abs(t-e)<=i.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{i.EPSILON=o}}},226:function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"h",(function(){return s})),n.d(e,"g",(function(){return a})),n.d(e,"i",(function(){return c})),n.d(e,"d",(function(){return l})),n.d(e,"e",(function(){return u})),n.d(e,"f",(function(){return d})),n.d(e,"a",(function(){return h}));var i=n(54);function r(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)}function o(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[0],a=n[1],c=n[2];return t[0]=r*c-o*a,t[1]=o*s-i*c,t[2]=i*a-r*s,t}function s(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[3]*i+n[7]*r+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/s,t[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/s,t[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/s,t}function a(t,e,n){var i=e[0],r=e[1],o=e[2];return t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8],t}function c(t,e,n){var i=n[0],r=n[1],o=n[2],s=n[3],a=e[0],c=e[1],l=e[2],u=r*l-o*c,d=o*a-i*l,h=i*c-r*a,p=r*h-o*d,f=o*u-i*h,g=i*d-r*u,m=2*s;return u*=m,d*=m,h*=m,p*=2,f*=2,g*=2,t[0]=a+u+p,t[1]=c+d+f,t[2]=l+h+g,t}function l(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0],o[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),o[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function u(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),o[1]=r[1],o[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function d(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),o[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),o[2]=r[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function h(t,e){var n=t[0],i=t[1],r=t[2],o=e[0],s=e[1],a=e[2],c=Math.sqrt(n*n+i*i+r*r)*Math.sqrt(o*o+s*s+a*a),l=c&&function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}(t,e)/c;return Math.acos(Math.min(Math.max(l,-1),1))}var p,f;p=new i.a(3),i.a!=Float32Array&&(p[0]=0,p[1]=0,p[2]=0),f=p},232:function(t,e,n){"use strict";function i(t,e=(()=>!0)){return Array.isArray(t)?function t(e,n,i){let r=-1;for(;++r<e.length;){const o=e[r];Array.isArray(o)?t(o,n,i):n(o)&&i.push(o)}return i}(t,e,[]):e(t)?[t]:[]}function r({target:t,source:e,start:n=0,count:i=1}){const r=e.length,o=i*r;let s=0;for(let i=n;s<r;s++)t[i++]=e[s];for(;s<o;)s<o-s?(t.copyWithin(n+s,n,n+s),s*=2):(t.copyWithin(n+s,n,n+o-s),s=o);return t}n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return r}))},233:function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var i=n(3),r=n(668),o=n(207);const s={transitionDuration:0},a=t=>1-(1-t)*(1-t),c=["wheel"],l=["panstart","panmove","panend"],u=["pinchstart","pinchmove","pinchend"],d=["tripanstart","tripanmove","tripanend"],h=["doubletap"],p=["keydown"],f={};class g{constructor(t){Object(i.a)(this,"props",void 0),Object(i.a)(this,"state",{}),Object(i.a)(this,"transitionManager",void 0),Object(i.a)(this,"eventManager",void 0),Object(i.a)(this,"onViewStateChange",void 0),Object(i.a)(this,"onStateChange",void 0),Object(i.a)(this,"makeViewport",void 0),Object(i.a)(this,"_controllerState",void 0),Object(i.a)(this,"_events",{}),Object(i.a)(this,"_interactionState",{isDragging:!1}),Object(i.a)(this,"_customEvents",[]),Object(i.a)(this,"_eventStartBlocked",null),Object(i.a)(this,"_panMove",!1),Object(i.a)(this,"invertPan",!1),Object(i.a)(this,"dragMode","rotate"),Object(i.a)(this,"inertia",0),Object(i.a)(this,"scrollZoom",!0),Object(i.a)(this,"dragPan",!0),Object(i.a)(this,"dragRotate",!0),Object(i.a)(this,"doubleClickZoom",!0),Object(i.a)(this,"touchZoom",!0),Object(i.a)(this,"touchRotate",!1),Object(i.a)(this,"keyboard",!0),this.transitionManager=new r.b({...t,getControllerState:t=>new this.ControllerState(t),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=t.eventManager,this.onViewStateChange=t.onViewStateChange||(()=>{}),this.onStateChange=t.onStateChange||(()=>{}),this.makeViewport=t.makeViewport}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events){var t;if(this._events[e])null===(t=this.eventManager)||void 0===t||t.off(e,this.handleEvent)}this.transitionManager.finalize()}handleEvent(t){this._controllerState=void 0;const e=this._eventStartBlocked;switch(t.type){case"panstart":return!e&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!e&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!e&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(t){const{x:e,y:n}=this.props,{offsetCenter:i}=t;return[i.x-e,i.y-n]}isPointInBounds(t,e){const{width:n,height:i}=this.props;if(e&&e.handled)return!1;const r=t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=i;return r&&e&&e.stopPropagation(),r}isFunctionKeyPressed(t){const{srcEvent:e}=t;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(t){const e=setTimeout(()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)},t);this._eventStartBlocked=e}setProps(t){t.dragMode&&(this.dragMode=t.dragMode),this.props=t,"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);const{inertia:e}=t;this.inertia=Number.isFinite(e)?e:!0===e?300:0;const{scrollZoom:n=!0,dragPan:i=!0,dragRotate:r=!0,doubleClickZoom:o=!0,touchZoom:s=!0,touchRotate:a=!1,keyboard:f=!0}=t,g=Boolean(this.onViewStateChange);this.toggleEvents(c,g&&n),this.toggleEvents(l,g),this.toggleEvents(u,g&&(s||a)),this.toggleEvents(d,g&&a),this.toggleEvents(h,g&&o),this.toggleEvents(p,g&&f),this.scrollZoom=n,this.dragPan=i,this.dragRotate=r,this.doubleClickZoom=o,this.touchZoom=s,this.touchRotate=a,this.keyboard=f}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,e){this.eventManager&&t.forEach(t=>{this._events[t]!==e&&(this._events[t]=e,e?this.eventManager.on(t,this.handleEvent):this.eventManager.off(t,this.handleEvent))})}updateViewport(t,e=null,n={}){const i={...t.getViewportProps(),...e},r=this.controllerState!==t;if(this.state=t.getState(),this._setInteractionState(n),r){const t=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:t})}}_onTransition(t){this.onViewStateChange({...t,interactionState:this._interactionState})}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange(this._interactionState)}_onPanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;let n=this.isFunctionKeyPressed(t)||t.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const i=this.controllerState[n?"panStart":"rotateStart"]({pos:e});return this._panMove=n,this.updateViewport(i,s,{isDragging:!0}),!0}_onPan(t){return!!this.isDragging()&&(this._panMove?this._onPanMove(t):this._onPanRotate(t))}_onPanEnd(t){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t))}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,s,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:e}=this;if(this.dragPan&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],r=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:a},{isDragging:!1,isPanning:!0})}else{const t=this.controllerState.panEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),n=this.controllerState.rotate({pos:e});return this.updateViewport(n,s,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:e}=this;if(this.dragRotate&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],r=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:a},{isDragging:!1,isRotating:!0})}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;t.srcEvent.preventDefault();const{speed:n=.01,smooth:i=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:r}=t;let o=2/(1+Math.exp(-Math.abs(r*n)));r<0&&0!==o&&(o=1/o);const s=this.controllerState.zoom({pos:e,scale:o});return this.updateViewport(s,{...this._getTransitionProps({around:e}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.rotateStart({pos:e});return this.updateViewport(n,s,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const n=this.controllerState.rotate({pos:e});return this.updateViewport(n,s,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this;if(this.touchRotate&&e&&t.velocityY){const n=this.getCenter(t),i=[n[0],n[1]+=t.velocityY*e/2],r=this.controllerState.rotate({pos:i});this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:a},{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return f._startPinchRotation=t.rotation,f._lastPinchEvent=t,this.updateViewport(n,s,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let e=this.controllerState;if(this.touchZoom){const{scale:n}=t,i=this.getCenter(t);e=e.zoom({pos:i,scale:n})}if(this.touchRotate){const{rotation:n}=t;e=e.rotate({deltaAngleX:f._startPinchRotation-n})}return this.updateViewport(e,s,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),f._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this,{_lastPinchEvent:n}=f;if(this.touchZoom&&e&&n&&t.scale!==n.scale){const i=this.getCenter(t);let r=this.controllerState.rotateEnd();const o=Math.log2(t.scale),s=(o-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),c=Math.pow(2,o+s*e/2);r=r.zoom({pos:i,scale:c}).zoomEnd(),this.updateViewport(r,{...this._getTransitionProps({around:i}),transitionDuration:e,transitionEasing:a},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{const t=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return f._startPinchRotation=null,f._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.isFunctionKeyPressed(t),i=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:r,rotateSpeedY:o}=!0===this.keyboard?{}:this.keyboard,{controllerState:s}=this;let a;const c={};switch(t.srcEvent.code){case"Minus":a=e?s.zoomOut(n).zoomOut(n):s.zoomOut(n),c.isZooming=!0;break;case"Equal":a=e?s.zoomIn(n).zoomIn(n):s.zoomIn(n),c.isZooming=!0;break;case"ArrowLeft":e?(a=s.rotateLeft(r),c.isRotating=!0):(a=s.moveLeft(i),c.isPanning=!0);break;case"ArrowRight":e?(a=s.rotateRight(r),c.isRotating=!0):(a=s.moveRight(i),c.isPanning=!0);break;case"ArrowUp":e?(a=s.rotateUp(o),c.isRotating=!0):(a=s.moveUp(i),c.isPanning=!0);break;case"ArrowDown":e?(a=s.rotateDown(o),c.isRotating=!0):(a=s.moveDown(i),c.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),c),!0}_getTransitionProps(t){const{transition:e}=this;return e&&e.transitionInterpolator?t?{...e,transitionInterpolator:new o.a({...t,...e.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:e:s}}},236:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var i=n(3),r=n(185);const o=/([0-9]+\.?[0-9]*)(%|px)/;function s(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=o.exec(t);if(e&&e.length>=3){const t="%"===e[2],n=parseFloat(e[1]);return{position:t?n/100:n,relative:t}}default:throw new Error("Could not parse position string ".concat(t))}}function a(t,e){return t.relative?Math.round(t.position*e):t.position}var c=n(178),l=n(116);class u{constructor(t){Object(i.a)(this,"id",void 0),Object(i.a)(this,"viewportInstance",void 0),Object(i.a)(this,"_x",void 0),Object(i.a)(this,"_y",void 0),Object(i.a)(this,"_width",void 0),Object(i.a)(this,"_height",void 0),Object(i.a)(this,"_padding",void 0),Object(i.a)(this,"props",void 0);const{id:e,x:n=0,y:o=0,width:a="100%",height:c="100%",padding:u=null,viewportInstance:d}=t||{};Object(l.a)(!d||d instanceof r.a),this.viewportInstance=d,this.id=e||this.constructor.displayName||"view",this.props={...t,id:this.id},this._x=s(n),this._y=s(o),this._width=s(a),this._height=s(c),this._padding=u&&{left:s(u.left||0),right:s(u.right||0),top:s(u.top||0),bottom:s(u.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(t){return this===t||(this.viewportInstance?!!t.viewportInstance&&this.viewportInstance.equals(t.viewportInstance):this.ViewportType===t.ViewportType&&Object(c.a)(this.props,t.props,2))}makeViewport({width:t,height:e,viewState:n}){if(this.viewportInstance)return this.viewportInstance;n=this.filterViewState(n);const i=this.getDimensions({width:t,height:e});return i.height&&i.width?new this.ViewportType({...n,...this.props,...i}):null}getViewStateId(){const{viewState:t}=this.props;return"string"==typeof t?t:(null==t?void 0:t.id)||this.id}filterViewState(t){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const e={...t};for(const t in this.props.viewState)"id"!==t&&(e[t]=this.props.viewState[t]);return e}return t}getDimensions({width:t,height:e}){const n={x:a(this._x,t),y:a(this._y,e),width:a(this._width,t),height:a(this._height,e)};return this._padding&&(n.padding={left:a(this._padding.left,t),top:a(this._padding.top,e),right:a(this._padding.right,t),bottom:a(this._padding.bottom,e)}),n}get controller(){const t=this.props.controller;return t?!0===t?{type:this.ControllerType}:"function"==typeof t?{type:t}:{type:this.ControllerType,...t}:null}}},24:function(t,e,n){var i=n(1e3),r=n(1563),o=n(835),s=n(1001);t.exports=function(t,e){return i(t)||r(t,e)||o(t,e)||s()},t.exports.default=t.exports,t.exports.__esModule=!0},245:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return s})),n.d(e,"b",(function(){return a}));Math.PI,Math.PI;const i={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function r(t,{precision:e=i.precision}={}){return t=function(t){return Math.round(t/i.EPSILON)*i.EPSILON}(t),"".concat(parseFloat(t.toPrecision(e)))}function o(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function s(t,e,n){return o(t)?t.map((t,i)=>s(t,e[i],n)):n*e+(1-n)*t}function a(t,e,n){const r=i.EPSILON;n&&(i.EPSILON=n);try{if(t===e)return!0;if(o(t)&&o(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!a(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):"number"==typeof t&&"number"==typeof e&&Math.abs(t-e)<=i.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{i.EPSILON=r}}},246:function(t,e,n){"use strict";n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return u})),n.d(e,"d",(function(){return p})),n.d(e,"c",(function(){return m}));var i=n(1411),r=n.n(i),o=n(213);const s=o.a.CLOCKWISE,a=o.a.COUNTER_CLOCKWISE,c={isClosed:!0};function l(t){return"positions"in t?t.positions:t}function u(t){return"holeIndices"in t?t.holeIndices:null}function d(t,e,n,i,r){let s=e;const a=n.length;for(let e=0;e<a;e++)for(let r=0;r<i;r++)t[s++]=n[e][r]||0;if(!function(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}(n))for(let e=0;e<i;e++)t[s++]=n[0][e]||0;return c.start=e,c.end=s,c.size=i,Object(o.f)(t,r,c),s}function h(t,e,n,i,r=0,s,a){const l=(s=s||n.length)-r;if(l<=0)return e;let u=e;for(let e=0;e<l;e++)t[u++]=n[r+e];if(!function(t,e,n,i){for(let r=0;r<e;r++)if(t[n+r]!==t[i-e+r])return!1;return!0}(n,i,r,s))for(let e=0;e<i;e++)t[u++]=n[r+e];return c.start=e,c.end=u,c.size=i,Object(o.f)(t,a,c),u}function p(t,e){!function(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}(t);const n=[],i=[];if("positions"in t){const{positions:r,holeIndices:o}=t;if(o){let t=0;for(let c=0;c<=o.length;c++)t=h(n,t,r,e,o[c-1],o[c],0===c?s:a),i.push(t);return i.pop(),{positions:n,holeIndices:i}}t=r}if(!function(t){return Array.isArray(t[0])}(t))return h(n,0,t,e,0,n.length,s),n;if(!function(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}(t)){let r=0;for(const[o,c]of t.entries())r=d(n,r,c,e,0===o?s:a),i.push(r);return i.pop(),{positions:n,holeIndices:i}}return d(n,0,t,e,s),n}function f(t,e,n){const i=t.length/3;let r=0;for(let o=0;o<i;o++){const s=(o+1)%i;r+=t[3*o+e]*t[3*s+n],r-=t[3*s+e]*t[3*o+n]}return Math.abs(r/2)}function g(t,e,n,i){const r=t.length/3;for(let o=0;o<r;o++){const r=3*o,s=t[r+0],a=t[r+1],c=t[r+2];t[r+e]=s,t[r+n]=a,t[r+i]=c}}function m(t,e,n,i){let o=u(t);o&&(o=o.map(t=>t/e));let s=l(t);const a=i&&3===e;if(n){const t=s.length;s=s.slice();const i=[];for(let r=0;r<t;r+=e){i[0]=s[r],i[1]=s[r+1],a&&(i[2]=s[r+2]);const t=n(i);s[r]=t[0],s[r+1]=t[1],a&&(s[r+2]=t[2])}}if(a){const t=f(s,0,1),e=f(s,0,2),i=f(s,1,2);if(!t&&!e&&!i)return[];t>e&&t>i||(e>i?(n||(s=s.slice()),g(s,0,2,1)):(n||(s=s.slice()),g(s,2,0,1)))}return r()(s,o,e)}},253:function(t,e,n){"use strict";function i(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}function r(t){let e,n={};return r=>{for(const o in r)if(!i(r[o],n[o])){e=t(r),n=r;break}return e}}n.d(e,"a",(function(){return r}))},256:function(t,e,n){"use strict";var i=n(3);e.a=new class{constructor(t={}){Object(i.a)(this,"_pool",[]),Object(i.a)(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(t)}setOptions(t){Object.assign(this.opts,t)}allocate(t,e,{size:n=1,type:i,padding:r=0,copy:o=!1,initialize:s=!1,maxCount:a}){const c=i||t&&t.constructor||Float32Array,l=e*n+r;if(ArrayBuffer.isView(t)){if(l<=t.length)return t;if(l*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new c(t.buffer,0,l)}let u=1/0;a&&(u=a*n+r);const d=this._allocate(c,l,s,u);return t&&o?d.set(t):s||d.fill(0,0,4),this._release(t),d}release(t){this._release(t)}_allocate(t,e,n,i){let r=Math.max(Math.ceil(e*this.opts.overAlloc),1);r>i&&(r=i);const o=this._pool,s=t.BYTES_PER_ELEMENT*r,a=o.findIndex(t=>t.byteLength>=s);if(a>=0){const e=new t(o.splice(a,1)[0],0,r);return n&&e.fill(0),e}return new t(r)}_release(t){if(!ArrayBuffer.isView(t))return;const e=this._pool,{buffer:n}=t,{byteLength:i}=n,r=e.findIndex(t=>t.byteLength>=i);r<0?e.push(n):(r>0||e.length<this.opts.poolSize)&&e.splice(r,0,n),e.length>this.opts.poolSize&&e.shift()}}},273:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(3),r=n(531),o=n(533);const s={...o.a.defaultProps};class a extends r.a{indexToBounds(){return null}renderLayers(){const{elevationScale:t,extruded:e,wireframe:n,filled:i,stroked:r,lineWidthUnits:s,lineWidthScale:a,lineWidthMinPixels:c,lineWidthMaxPixels:l,lineJointRounded:u,lineMiterLimit:d,lineDashJustified:h,getElevation:p,getFillColor:f,getLineColor:g,getLineWidth:m}=this.props,{updateTriggers:v,material:b,transitions:y}=this.props,x=this.getSubLayerClass("cell",o.a),{updateTriggers:_,...w}=this.indexToBounds()||{};return new x({filled:i,wireframe:n,extruded:e,elevationScale:t,stroked:r,lineWidthUnits:s,lineWidthScale:a,lineWidthMinPixels:c,lineWidthMaxPixels:l,lineJointRounded:u,lineMiterLimit:d,lineDashJustified:h,material:b,transitions:y,getElevation:p,getFillColor:f,getLineColor:g,getLineWidth:m},this.getSubLayerProps({id:"cell",updateTriggers:v&&{..._,getElevation:v.getElevation,getFillColor:v.getFillColor,getLineColor:v.getLineColor,getLineWidth:v.getLineWidth}}),w)}}Object(i.a)(a,"layerName","GeoCellLayer"),Object(i.a)(a,"defaultProps",s)},276:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(3);class r{constructor(t){Object(i.a)(this,"_inProgress",void 0),Object(i.a)(this,"_handle",void 0),Object(i.a)(this,"_timeline",void 0),Object(i.a)(this,"time",void 0),Object(i.a)(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=t,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(t){var e,n;this.cancel(),this.settings=t,this._inProgress=!0,null===(e=(n=this.settings).onStart)||void 0===e||e.call(n,this)}end(){var t,e;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,null===(t=(e=this.settings).onEnd)||void 0===t||t.call(e,this))}cancel(){var t,e;this._inProgress&&(null===(t=(e=this.settings).onInterrupt)||void 0===t||t.call(e,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var t,e;if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:t,settings:e}=this;this._handle=t.addChannel({delay:t.getTime(),duration:e.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),null===(t=(e=this.settings).onUpdate)||void 0===t||t.call(e,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}},287:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",(function(){return i}))},288:function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}n.d(e,"a",(function(){return r}))},3:function(t,e,n){"use strict";function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"a",(function(){return i}))},327:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i=n(775),r=n(148),o=n(592);class s extends i.a{get x(){return this[0]}set x(t){this[0]=Object(r.a)(t)}get y(){return this[1]}set y(t){this[1]=Object(r.a)(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const i=this[n]-t[n];e+=i*i}return Object(r.a)(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return Object(r.a)(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e[t];return this.check()}divide(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return Object(o.a)(t>=0&&t<this.ELEMENTS,"index is out of range"),Object(r.a)(this[t])}setComponent(t,e){return Object(o.a)(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}var a=n(69),c=n(226),l=n(530);const u=[0,0,0];let d;class h extends s{static get ZERO(){return d||(d=new h(0,0,0),Object.freeze(d)),d}constructor(t=0,e=0,n=0){super(-0,-0,-0),1===arguments.length&&Object(a.f)(t)?this.copy(t):(a.b.debug&&(Object(r.a)(t),Object(r.a)(e),Object(r.a)(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return a.b.debug&&(Object(r.a)(t.x),Object(r.a)(t.y),Object(r.a)(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=Object(r.a)(t)}angle(t){return c.a(this,t)}cross(t){return c.b(this,this,t),this.check()}rotateX({radians:t,origin:e=u}){return c.d(this,this,e,t),this.check()}rotateY({radians:t,origin:e=u}){return c.e(this,this,e,t),this.check()}rotateZ({radians:t,origin:e=u}){return c.f(this,this,e,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return c.h(this,this,t),this.check()}transformAsVector(t){return Object(l.c)(this,this,t),this.check()}transformByMatrix3(t){return c.g(this,this,t),this.check()}transformByMatrix2(t){return Object(l.b)(this,this,t),this.check()}transformByQuaternion(t){return c.i(this,this,t),this.check()}}},340:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(3),r=n(777),o=n(29),s=n(809);class a extends r.a{constructor(...t){super(...t),Object(i.a)(this,"_lastRenderIndex",-1)}render(t){const e=this.gl;return Object(o.n)(e,{framebuffer:t.target}),this._drawLayers(t)}_drawLayers(t){const{target:e,moduleParameters:n,viewports:i,views:r,onViewportActive:s,clearStack:a=!0,clearCanvas:c=!0}=t;t.pass=t.pass||"unknown";const l=this.gl;c&&function(t,e){const n=e?e.width:t.drawingBufferWidth,i=e?e.height:t.drawingBufferHeight;Object(o.n)(t,{viewport:[0,0,n,i]}),t.clear(16640)}(l,e),a&&(this._lastRenderIndex=-1);const u=[];for(const o of i){const i=r&&r[o.id];null==s||s(o);const a=this._getDrawLayerParams(o,t),c=o.subViewports||[o];for(const r of c){const o=this._drawLayersInViewport(l,{target:e,moduleParameters:n,viewport:r,view:i,pass:t.pass,layers:t.layers},a);u.push(o)}}return u}_getDrawLayerParams(t,{layers:e,pass:n,isPicking:i=!1,layerFilter:r,cullRect:o,effects:s,moduleParameters:a},c=!1){const l=[],u=function t(e=0,n={}){const i={},r=(o,s)=>{const a=o.props._offset,c=o.id,l=o.parent&&o.parent.id;let u;if(l&&!(l in n)&&r(o.parent,!1),l in i){const e=i[l]=i[l]||t(n[l],n);u=e(o,s),i[c]=e}else Number.isFinite(a)?(u=a+(n[l]||0),i[c]=null):u=e;return s&&u>=e&&(e=u+1),n[c]=u,u};return r}(this._lastRenderIndex+1),d={layer:e[0],viewport:t,isPicking:i,renderPass:n,cullRect:o},h={};for(let i=0;i<e.length;i++){const o=e[i],p=this._shouldDrawLayer(o,d,r,h),f={shouldDrawLayer:p};p&&!c&&(f.layerRenderIndex=u(o,p),f.moduleParameters=this._getModuleParameters(o,s,n,a),f.layerParameters=this.getLayerParameters(o,i,t)),l[i]=f}return l}_drawLayersInViewport(t,{layers:e,moduleParameters:n,pass:i,target:r,viewport:a,view:c},l){const u=function(t,{moduleParameters:e,target:n,viewport:i}){const r=n&&"default-framebuffer"!==n.id,s=e&&e.devicePixelRatio||Object(o.e)(t),a=r?n.height:t.drawingBufferHeight,c=i;return[c.x*s,a-(c.y+c.height)*s,c.width*s,c.height*s]}(t,{moduleParameters:n,target:r,viewport:a});if(c&&c.props.clear){const e=!0===c.props.clear?{color:!0,depth:!0}:c.props.clear;Object(o.o)(t,{scissorTest:!0,scissor:u},()=>Object(s.a)(t,e))}const d={totalCount:e.length,visibleCount:0,compositeCount:0,pickableCount:0};Object(o.n)(t,{viewport:u});for(let t=0;t<e.length;t++){const n=e[t],{shouldDrawLayer:r,layerRenderIndex:o,moduleParameters:s,layerParameters:c}=l[t];if(r&&n.props.pickable&&d.pickableCount++,n.isComposite)d.compositeCount++;else if(r){d.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,o),s.viewport=a;try{n._drawLayer({moduleParameters:s,uniforms:{layerIndex:o},parameters:c})}catch(t){n.raiseError(t,"drawing ".concat(n," to ").concat(i))}}}return d}shouldDrawLayer(t){return!0}getModuleParameters(t,e){return null}getLayerParameters(t,e,n){return t.props.parameters}_shouldDrawLayer(t,e,n,i){if(!(t.props.visible&&this.shouldDrawLayer(t)))return!1;e.layer=t;let r=t.parent;for(;r;){if(!r.props.visible||!r.filterSubLayer(e))return!1;e.layer=r,r=r.parent}if(n){const t=e.layer.id;if(t in i||(i[t]=n(e)),!i[t])return!1}return t.activateViewport(e.viewport),!0}_getModuleParameters(t,e,n,i){var r;const s=Object.assign(Object.create((null===(r=t.internalState)||void 0===r?void 0:r.propsInTransition)||t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,pickingActive:0,devicePixelRatio:Object(o.e)(this.gl)});if(e)for(const n of e){var a;Object.assign(s,null===(a=n.getModuleParameters)||void 0===a?void 0:a.call(n,t))}return Object.assign(s,this.getModuleParameters(t,e),i)}}},35:function(t,e,n){"use strict";n.r(e),n.d(e,"CSS",(function(){return E})),n.d(e,"add",(function(){return O})),n.d(e,"canUseDOM",(function(){return o})),n.d(e,"findFirstFocusableNode",(function(){return T})),n.d(e,"getEventCoordinates",(function(){return M})),n.d(e,"getOwnerDocument",(function(){return h})),n.d(e,"getWindow",(function(){return c})),n.d(e,"hasViewportRelativeCoordinates",(function(){return S})),n.d(e,"isDocument",(function(){return l})),n.d(e,"isHTMLElement",(function(){return u})),n.d(e,"isKeyboardEvent",(function(){return C})),n.d(e,"isNode",(function(){return a})),n.d(e,"isSVGElement",(function(){return d})),n.d(e,"isTouchEvent",(function(){return j})),n.d(e,"isWindow",(function(){return s})),n.d(e,"subtract",(function(){return P})),n.d(e,"useCombinedRefs",(function(){return r})),n.d(e,"useEvent",(function(){return f})),n.d(e,"useInterval",(function(){return g})),n.d(e,"useIsomorphicLayoutEffect",(function(){return p})),n.d(e,"useLatestValue",(function(){return m})),n.d(e,"useLazyMemo",(function(){return v})),n.d(e,"useNodeRef",(function(){return b})),n.d(e,"usePrevious",(function(){return y})),n.d(e,"useUniqueId",(function(){return _}));var i=n(0);function r(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Object(i.useMemo)(()=>t=>{e.forEach(e=>e(t))},e)}const o="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function s(t){const e=Object.prototype.toString.call(t);return"[object Window]"===e||"[object global]"===e}function a(t){return"nodeType"in t}function c(t){var e,n;return t?s(t)?t:a(t)&&null!=(e=null==(n=t.ownerDocument)?void 0:n.defaultView)?e:window:window}function l(t){const{Document:e}=c(t);return t instanceof e}function u(t){return!s(t)&&t instanceof c(t).HTMLElement}function d(t){return t instanceof c(t).SVGElement}function h(t){return t?s(t)?t.document:a(t)?l(t)?t:u(t)?t.ownerDocument:document:document:document}const p=o?i.useLayoutEffect:i.useEffect;function f(t){const e=Object(i.useRef)(t);return p(()=>{e.current=t}),Object(i.useCallback)((function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return null==e.current?void 0:e.current(...n)}),[])}function g(){const t=Object(i.useRef)(null);return[Object(i.useCallback)((e,n)=>{t.current=setInterval(e,n)},[]),Object(i.useCallback)(()=>{null!==t.current&&(clearInterval(t.current),t.current=null)},[])]}function m(t,e){void 0===e&&(e=[t]);const n=Object(i.useRef)(t);return p(()=>{n.current!==t&&(n.current=t)},e),n}function v(t,e){const n=Object(i.useRef)();return Object(i.useMemo)(()=>{const e=t(n.current);return n.current=e,e},[...e])}function b(t){const e=f(t),n=Object(i.useRef)(null),r=Object(i.useCallback)(t=>{t!==n.current&&(null==e||e(t,n.current)),n.current=t},[]);return[n,r]}function y(t){const e=Object(i.useRef)();return Object(i.useEffect)(()=>{e.current=t},[t]),e.current}let x={};function _(t,e){return Object(i.useMemo)(()=>{if(e)return e;const n=null==x[t]?0:x[t]+1;return x[t]=n,t+"-"+n},[t,e])}function w(t){return function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i.reduce((e,n)=>{const i=Object.entries(n);for(const[n,r]of i){const i=e[n];null!=i&&(e[n]=i+t*r)}return e},{...e})}}const O=w(1),P=w(-1);function S(t){return"clientX"in t&&"clientY"in t}function C(t){if(!t)return!1;const{KeyboardEvent:e}=c(t.target);return e&&t instanceof e}function j(t){if(!t)return!1;const{TouchEvent:e}=c(t.target);return e&&t instanceof e}function M(t){if(j(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:n}=t.touches[0];return{x:e,y:n}}if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:n}=t.changedTouches[0];return{x:e,y:n}}}return S(t)?{x:t.clientX,y:t.clientY}:null}const E=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:n}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:n}=t;return"scaleX("+e+") scaleY("+n+")"}},Transform:{toString(t){if(t)return[E.Translate.toString(t),E.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:n,easing:i}=t;return e+" "+n+"ms "+i}}}),L="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function T(t){return t.matches(L)?t:t.querySelector(L)}},377:function(t,e,n){"use strict";n.d(e,"a",(function(){return _}));var i=n(775),r=n(148),o=n(69);class s extends i.a{toString(){let t="[";if(o.b.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=Object(r.a)(n),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)e[t]=this[n+t];return e}setColumn(t,e){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)this[n+t]=e[t];return this}}var a=n(530),c=n(54);function l(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],c=e[5],l=e[6],u=e[7],d=e[8],h=e[9],p=e[10],f=e[11],g=e[12],m=e[13],v=e[14],b=e[15],y=n[0],x=n[1],_=n[2],w=n[3];return t[0]=y*i+x*a+_*d+w*g,t[1]=y*r+x*c+_*h+w*m,t[2]=y*o+x*l+_*p+w*v,t[3]=y*s+x*u+_*f+w*b,y=n[4],x=n[5],_=n[6],w=n[7],t[4]=y*i+x*a+_*d+w*g,t[5]=y*r+x*c+_*h+w*m,t[6]=y*o+x*l+_*p+w*v,t[7]=y*s+x*u+_*f+w*b,y=n[8],x=n[9],_=n[10],w=n[11],t[8]=y*i+x*a+_*d+w*g,t[9]=y*r+x*c+_*h+w*m,t[10]=y*o+x*l+_*p+w*v,t[11]=y*s+x*u+_*f+w*b,y=n[12],x=n[13],_=n[14],w=n[15],t[12]=y*i+x*a+_*d+w*g,t[13]=y*r+x*c+_*h+w*m,t[14]=y*o+x*l+_*p+w*v,t[15]=y*s+x*u+_*f+w*b,t}var u=function(t,e,n,i,r){var o,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(o=1/(i-r),t[10]=(r+i)*o,t[14]=2*r*i*o):(t[10]=-1,t[14]=-2*i),t};var d=function(t,e,n,i,r,o,s){var a=1/(e-n),c=1/(i-r),l=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*c,t[14]=(s+o)*l,t[15]=1,t};h=new c.a(2),c.a!=Float32Array&&(h[0]=0,h[1]=0),p=h;var h,p,f=n(226);var g;!function(){var t=function(){var t=new c.a(4);return c.a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}()}();!function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"}(g||(g={}));const m=45*Math.PI/180,v=1,b=.1,y=500,x=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class _ extends s{static get IDENTITY(){return function(){O||(O=new _,Object.freeze(O));return O}()}static get ZERO(){return function(){w||(w=new _([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(w));return w}()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return g}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,i,r,o,s,a,c,l,u,d,h,p,f,g){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this[4]=r,this[5]=o,this[6]=s,this[7]=a,this[8]=c,this[9]=l,this[10]=u,this[11]=d,this[12]=h,this[13]=p,this[14]=f,this[15]=g,this.check()}setRowMajor(t,e,n,i,r,o,s,a,c,l,u,d,h,p,f,g){return this[0]=t,this[1]=r,this[2]=c,this[3]=h,this[4]=e,this[5]=o,this[6]=l,this[7]=p,this[8]=n,this[9]=s,this[10]=u,this[11]=f,this[12]=i,this[13]=a,this[14]=d,this[15]=g,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(x)}fromObject(t){return this.check()}fromQuaternion(t){return function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n+n,a=i+i,c=r+r,l=n*s,u=i*s,d=i*a,h=r*s,p=r*a,f=r*c,g=o*s,m=o*a,v=o*c;t[0]=1-d-f,t[1]=u+v,t[2]=h-m,t[3]=0,t[4]=u-v,t[5]=1-l-f,t[6]=p+g,t[7]=0,t[8]=h+m,t[9]=p-g,t[10]=1-l-d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(this,t),this.check()}frustum(t){const{left:e,right:n,bottom:i,top:r,near:o=b,far:s=y}=t;return s===1/0?function(t,e,n,i,r,o){const s=2*o/(n-e),a=2*o/(r-i),c=(n+e)/(n-e),l=(r+i)/(r-i),u=-2*o;t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=c,t[9]=l,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=u,t[15]=0}(this,e,n,i,r,o):function(t,e,n,i,r,o,s){var a=1/(n-e),c=1/(r-i),l=1/(o-s);t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*c,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(r+i)*c,t[10]=(s+o)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*l,t[15]=0}(this,e,n,i,r,o,s),this.check()}lookAt(t){const{eye:e,center:n=[0,0,0],up:i=[0,1,0]}=t;return function(t,e,n,i){var r,o,s,a,l,u,d,h,p,f,g=e[0],m=e[1],v=e[2],b=i[0],y=i[1],x=i[2],_=n[0],w=n[1],O=n[2];Math.abs(g-_)<c.b&&Math.abs(m-w)<c.b&&Math.abs(v-O)<c.b?function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(t):(d=g-_,h=m-w,p=v-O,r=y*(p*=f=1/Math.hypot(d,h,p))-x*(h*=f),o=x*(d*=f)-b*p,s=b*h-y*d,(f=Math.hypot(r,o,s))?(r*=f=1/f,o*=f,s*=f):(r=0,o=0,s=0),a=h*s-p*o,l=p*r-d*s,u=d*o-h*r,(f=Math.hypot(a,l,u))?(a*=f=1/f,l*=f,u*=f):(a=0,l=0,u=0),t[0]=r,t[1]=a,t[2]=d,t[3]=0,t[4]=o,t[5]=l,t[6]=h,t[7]=0,t[8]=s,t[9]=u,t[10]=p,t[11]=0,t[12]=-(r*g+o*m+s*v),t[13]=-(a*g+l*m+u*v),t[14]=-(d*g+h*m+p*v),t[15]=1)}(this,e,n,i),this.check()}ortho(t){const{left:e,right:n,bottom:i,top:r,near:o=b,far:s=y}=t;return d(this,e,n,i,r,o,s),this.check()}orthographic(t){const{fovy:e=m,aspect:n=v,focalDistance:i=1,near:r=b,far:o=y}=t;P(e);const s=e/2,a=i*Math.tan(s),c=a*n;return this.ortho({left:-c,right:c,bottom:-a,top:a,near:r,far:o})}perspective(t){const{fovy:e=45*Math.PI/180,aspect:n=1,near:i=.1,far:r=500}=t;return P(e),u(this,e,n,i,r),this.check()}determinant(){return e=(t=this)[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],c=t[7],l=t[8],u=t[9],d=t[10],h=t[11],p=t[12],f=t[13],g=t[14],m=t[15],(e*s-n*o)*(d*m-h*g)-(e*a-i*o)*(u*m-h*f)+(e*c-r*o)*(u*g-d*f)+(n*a-i*s)*(l*m-h*p)-(n*c-r*s)*(l*g-d*p)+(i*c-r*a)*(l*f-u*p);var t,e,n,i,r,o,s,a,c,l,u,d,h,p,f,g,m}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],r=1/n[1],o=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*r,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*r,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],r=1/n[1],o=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*o,t[3]=this[4]*i,t[4]=this[5]*r,t[5]=this[6]*o,t[6]=this[8]*i,t[7]=this[9]*r,t[8]=this[10]*o,t}transpose(){return function(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=r,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]}(this,this),this.check()}invert(){return function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],c=e[6],l=e[7],u=e[8],d=e[9],h=e[10],p=e[11],f=e[12],g=e[13],m=e[14],v=e[15],b=n*a-i*s,y=n*c-r*s,x=n*l-o*s,_=i*c-r*a,w=i*l-o*a,O=r*l-o*c,P=u*g-d*f,S=u*m-h*f,C=u*v-p*f,j=d*m-h*g,M=d*v-p*g,E=h*v-p*m,L=b*E-y*M+x*j+_*C-w*S+O*P;L&&(L=1/L,t[0]=(a*E-c*M+l*j)*L,t[1]=(r*M-i*E-o*j)*L,t[2]=(g*O-m*w+v*_)*L,t[3]=(h*w-d*O-p*_)*L,t[4]=(c*C-s*E-l*S)*L,t[5]=(n*E-r*C+o*S)*L,t[6]=(m*x-f*O-v*y)*L,t[7]=(u*O-h*x+p*y)*L,t[8]=(s*M-a*C+l*P)*L,t[9]=(i*C-n*M-o*P)*L,t[10]=(f*w-g*x+v*b)*L,t[11]=(d*x-u*w-p*b)*L,t[12]=(a*S-s*j-c*P)*L,t[13]=(n*j-i*S+r*P)*L,t[14]=(g*y-f*_-m*b)*L,t[15]=(u*_-d*y+h*b)*L)}(this,this),this.check()}multiplyLeft(t){return l(this,t,this),this.check()}multiplyRight(t){return l(this,this,t),this.check()}rotateX(t){return function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],s=e[5],a=e[6],c=e[7],l=e[8],u=e[9],d=e[10],h=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+l*i,t[5]=s*r+u*i,t[6]=a*r+d*i,t[7]=c*r+h*i,t[8]=l*r-o*i,t[9]=u*r-s*i,t[10]=d*r-a*i,t[11]=h*r-c*i}(this,this,t),this.check()}rotateY(t){return function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],c=e[3],l=e[8],u=e[9],d=e[10],h=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-l*i,t[1]=s*r-u*i,t[2]=a*r-d*i,t[3]=c*r-h*i,t[8]=o*i+l*r,t[9]=s*i+u*r,t[10]=a*i+d*r,t[11]=c*i+h*r}(this,this,t),this.check()}rotateZ(t){return function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],c=e[3],l=e[4],u=e[5],d=e[6],h=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+l*i,t[1]=s*r+u*i,t[2]=a*r+d*i,t[3]=c*r+h*i,t[4]=l*r-o*i,t[5]=u*r-s*i,t[6]=d*r-a*i,t[7]=h*r-c*i}(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,e){return function(t,e,n,i){var r,o,s,a,l,u,d,h,p,f,g,m,v,b,y,x,_,w,O,P,S,C,j,M,E=i[0],L=i[1],T=i[2],R=Math.hypot(E,L,T);R<c.b||(E*=R=1/R,L*=R,T*=R,r=Math.sin(n),s=1-(o=Math.cos(n)),a=e[0],l=e[1],u=e[2],d=e[3],h=e[4],p=e[5],f=e[6],g=e[7],m=e[8],v=e[9],b=e[10],y=e[11],x=E*E*s+o,_=L*E*s+T*r,w=T*E*s-L*r,O=E*L*s-T*r,P=L*L*s+o,S=T*L*s+E*r,C=E*T*s+L*r,j=L*T*s-E*r,M=T*T*s+o,t[0]=a*x+h*_+m*w,t[1]=l*x+p*_+v*w,t[2]=u*x+f*_+b*w,t[3]=d*x+g*_+y*w,t[4]=a*O+h*P+m*S,t[5]=l*O+p*P+v*S,t[6]=u*O+f*P+b*S,t[7]=d*O+g*P+y*S,t[8]=a*C+h*j+m*M,t[9]=l*C+p*j+v*M,t[10]=u*C+f*j+b*M,t[11]=d*C+g*j+y*M,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]))}(this,this,t,e),this.check()}scale(t){return function(t,e,n){var i=n[0],r=n[1],o=n[2];t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return function(t,e,n){var i,r,o,s,a,c,l,u,d,h,p,f,g=n[0],m=n[1],v=n[2];e===t?(t[12]=e[0]*g+e[4]*m+e[8]*v+e[12],t[13]=e[1]*g+e[5]*m+e[9]*v+e[13],t[14]=e[2]*g+e[6]*m+e[10]*v+e[14],t[15]=e[3]*g+e[7]*m+e[11]*v+e[15]):(i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],c=e[5],l=e[6],u=e[7],d=e[8],h=e[9],p=e[10],f=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=c,t[6]=l,t[7]=u,t[8]=d,t[9]=h,t[10]=p,t[11]=f,t[12]=i*g+a*m+d*v+e[12],t[13]=r*g+c*m+h*v+e[13],t[14]=o*g+l*m+p*v+e[14],t[15]=s*g+u*m+f*v+e[15])}(this,this,t),this.check()}transform(t,e){return 4===t.length?(e=function(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*s,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*s,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*s,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*s,t}(e||[-0,-0,-0,-0],t,this),Object(r.b)(e,4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;let i;switch(n){case 2:i=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}(e||[-0,-0],t,this);break;case 3:i=f.h(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(r.b)(i,t.length),i}transformAsVector(t,e){let n;switch(t.length){case 2:n=Object(a.a)(e||[-0,-0],t,this);break;case 3:n=Object(a.c)(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(r.b)(n,t.length),n}transformPoint(t,e){return this.transformAsPoint(t,e)}transformVector(t,e){return this.transformAsPoint(t,e)}transformDirection(t,e){return this.transformAsVector(t,e)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}}let w,O;function P(t){if(t>2*Math.PI)throw Error("expected radians")}},402:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n(3),r=n(327);const o=[255,255,255],s=1,a=[0,0,-1];let c=0;class l{constructor(t={}){Object(i.a)(this,"id",void 0),Object(i.a)(this,"color",void 0),Object(i.a)(this,"intensity",void 0),Object(i.a)(this,"type","directional"),Object(i.a)(this,"direction",void 0),Object(i.a)(this,"shadow",void 0);const{color:e=o}=t,{intensity:n=s}=t,{direction:l=a}=t,{_shadow:u=!1}=t;this.id=t.id||"directional-".concat(c++),this.color=e,this.intensity=n,this.type="directional",this.direction=new r.a(l).normalize().toArray(),this.shadow=u}getProjectedLight(t){return this}}},403:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var i=n(3),r=n(531),o=n(232),s=n(936),a=n(1463),c=n(542);const l={TilesetClass:a.b,data:{type:"data",value:[]},dataComparator:c.h.equal,renderSubLayers:{type:"function",value:t=>new s.a(t)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:t=>console.error(t)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:a.a,zRange:null,maxRequests:6,zoomOffset:0};class u extends r.a{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var t,e;null===(t=this.state)||void 0===t||null===(e=t.tileset)||void 0===e||e.finalize()}get isLoaded(){var t,e,n;return null===(t=this.state)||void 0===t||null===(e=t.tileset)||void 0===e||null===(n=e.selectedTiles)||void 0===n?void 0:n.every(t=>t.isLoaded&&t.layers&&t.layers.every(t=>t.isLoaded))}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState({changeFlags:t}){let{tileset:e}=this.state;const n=t.propsOrDataChanged||t.updateTriggersChanged,i=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getTileData);e?n&&(e.setOptions(this._getTilesetOptions()),i?e.reloadAll():this.state.tileset.tiles.forEach(t=>{t.layers=null})):(e=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:e})),this._updateTileset()}_getTilesetOptions(){const{tileSize:t,maxCacheSize:e,maxCacheByteSize:n,refinementStrategy:i,extent:r,maxZoom:o,minZoom:s,maxRequests:a,zoomOffset:c}=this.props;return{maxCacheSize:e,maxCacheByteSize:n,maxZoom:o,minZoom:s,tileSize:t,refinementStrategy:i,extent:r,maxRequests:a,zoomOffset:c,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:t}=this.state,{zRange:e,modelMatrix:n}=this.props,i=t.update(this.context.viewport,{zRange:e,modelMatrix:n}),{isLoaded:r}=t,o=this.state.isLoaded!==r,s=this.state.frameNumber!==i;r&&(o||s)&&this._onViewportLoad(),s&&this.setState({frameNumber:i}),this.state.isLoaded=r}_onViewportLoad(){const{tileset:t}=this.state,{onViewportLoad:e}=this.props;e&&e(t.selectedTiles)}_onTileLoad(t){this.props.onTileLoad(t),t.layers=null,this.setNeedsUpdate()}_onTileError(t,e){this.props.onTileError(t),e.layers=null,this.setNeedsUpdate()}_onTileUnload(t){this.props.onTileUnload(t)}getTileData(t){const{data:e,getTileData:n,fetch:i}=this.props,{signal:r}=t;return t.url="string"==typeof e||Array.isArray(e)?Object(c.c)(e,t):null,n?n(t):i&&t.url?i(t.url,{propName:"data",layer:this,signal:r}):null}renderSubLayers(t){return this.props.renderSubLayers(t)}getSubLayerPropsByTile(t){return null}getPickingInfo({info:t,sourceLayer:e}){const n=e.props.tile;return t.picked&&(t.tile=n),t.sourceTile=n,t}_updateAutoHighlight(t){const e=t.sourceTile;if(e&&e.layers)for(const n of e.layers)n.updateAutoHighlight(t)}renderLayers(){return this.state.tileset.tiles.map(t=>{const e=this.getSubLayerPropsByTile(t);if(t.isLoaded||t.content)if(t.layers)e&&t.layers[0]&&Object.keys(e).some(n=>t.layers[0].props[n]!==e[n])&&(t.layers=t.layers.map(t=>t.clone(e)));else{const n=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:t.id,updateTriggers:this.props.updateTriggers}),data:t.content,_offset:0,tile:t});t.layers=Object(o.b)(n,Boolean).map(n=>n.clone({tile:t,...e}))}else;return t.layers})}filterSubLayer({layer:t,cullRect:e}){const{tile:n}=t.props;return this.state.tileset.isTileVisible(n,e)}}Object(i.a)(u,"defaultProps",l),Object(i.a)(u,"layerName","TileLayer")},407:function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var i=n(3),r=n(747),o=n(1157),s=n(1158),a=n(52),c=n(798),l=n(237),u=n(1161),d=n(213);class h extends u.a{constructor(t){super({...t,attributes:{positions:{size:3,padding:18,initialize:!0,type:t.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(t){return this.attributes[t]}getGeometryFromBuffer(t){return this.normalize?super.getGeometryFromBuffer(t):null}normalizeGeometry(t){return this.normalize?function(t,e,n,i){let r;if(Array.isArray(t[0])){const n=t.length*e;r=new Array(n);for(let n=0;n<t.length;n++)for(let i=0;i<e;i++)r[n*e+i]=t[n][i]||0}else r=t;return n?Object(d.d)(r,{size:e,gridResolution:n}):i?Object(d.e)(r,{size:e}):r}(t,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):t}getGeometrySize(t){if(p(t)){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}const e=this.getPathLength(t);return e<2?0:this.isClosed(t)?e<3?0:e+2:e}updateGeometryAttributes(t,e){if(0!==e.geometrySize)if(t&&p(t))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t}else this._updateSegmentTypes(t,e),this._updatePositions(t,e)}_updateSegmentTypes(t,e){const n=this.attributes.segmentTypes,i=!!t&&this.isClosed(t),{vertexStart:r,geometrySize:o}=e;n.fill(0,r,r+o),i?(n[r]=4,n[r+o-2]=4):(n[r]+=1,n[r+o-2]+=2),n[r+o-1]=4}_updatePositions(t,e){const{positions:n}=this.attributes;if(!n||!t)return;const{vertexStart:i,geometrySize:r}=e,o=new Array(3);for(let e=i,s=0;s<r;e++,s++)this.getPointOnPath(t,s,o),n[3*e]=o[0],n[3*e+1]=o[1],n[3*e+2]=o[2]}getPathLength(t){return t.length/this.positionSize}getPointOnPath(t,e,n=[]){const{positionSize:i}=this;e*i>=t.length&&(e+=1-t.length/i);const r=e*i;return n[0]=t[r],n[1]=t[r+1],n[2]=3===i&&t[r+2]||0,n}isClosed(t){if(!this.normalize)return Boolean(this.opts.loop);const{positionSize:e}=this,n=t.length-e;return t[0]===t[n]&&t[1]===t[n+1]&&(2===e||t[2]===t[n+2])}}function p(t){return Array.isArray(t[0])}const f=[0,0,0,255],g={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:f},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},m={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class v extends r.a{constructor(...t){super(...t),Object(i.a)(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\nuniform int widthUnits;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\nvec3 getLineJoinOffset(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  vec2 dir = isEnd ? dirA : dirB;\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\n    vJointType = capType;\n  } else {\n    vJointType = jointType;\n  }\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.pickingColor = instancePickingColors;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  geometry.worldPosition = currPosition;\n  vec2 widthPixels = vec2(clamp(\n    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  if (billboard) {\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 offset = getLineJoinOffset(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);\n    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);\n    geometry.position = vec4(currPosition + offset, 1.0);\n    gl_Position = project_common_position_to_clipspace(geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[o.a,s.a]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:m,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:m,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:m,defaultValue:f},instancePickingColors:{size:3,type:5121,accessor:(t,{index:e,target:n})=>this.encodePickingColor(t&&t.__source?t.__source.index:e,n)}}),this.setState({pathTesselator:new h({fp64:this.use64bitPositions()})})}updateState(t){super.updateState(t);const{props:e,changeFlags:n}=t,i=this.getAttributeManager();if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPath)){const{pathTesselator:t}=this.state,r=e.data.attributes||{};t.updateGeometry({data:e.data,geometryBuffer:r.getPath,buffers:r,normalize:!e._pathType,loop:"loop"===e._pathType,getGeometry:e.getPath,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:n.dataChanged}),this.setState({numInstances:t.instanceCount,startIndices:t.vertexStarts}),n.dataChanged||i.invalidateAll()}if(n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),i.invalidateAll()}}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:i}=this.props;return i[0]&&i[0].__source&&(e.object=i.find(t=>t.__source.index===n)),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else super.disablePickingIndex(t)}draw({uniforms:t}){const{jointRounded:e,capRounded:n,billboard:i,miterLimit:r,widthUnits:o,widthScale:s,widthMinPixels:c,widthMaxPixels:l}=this.props;this.state.model.setUniforms(t).setUniforms({jointType:Number(e),capType:Number(n),billboard:i,widthUnits:a.e[o],widthScale:s,miterLimit:r,widthMinPixels:c,widthMaxPixels:l}).draw()}_getModel(t){return new c.a(t,{...this.getShaders(),id:this.props.id,geometry:new l.a({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0})}calculatePositions(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateSegmentTypes(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("segmentTypes")}}Object(i.a)(v,"defaultProps",g),Object(i.a)(v,"layerName","PathLayer")},408:function(t,e,n){"use strict";var i=n(2141);const r="#define SMOOTH_EDGE_RADIUS 0.5";var o={name:"geometry",vs:"\n".concat(r,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),fs:"\n".concat(r,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n")},s=n(52);const a=Object.keys(s.a).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(s.a[t],";")).join(""),c=Object.keys(s.d).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(s.d[t],";")).join(""),l=Object.keys(s.e).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(s.e[t],";")).join("");var u="".concat(a,"\n").concat(c,"\n").concat(l,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size_at_latitude(float lat) {\n  float y = clamp(lat, -89.9, 89.9);\n  return 1.0 / cos(radians(y));\n}\n\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n    \n    if (geometry.position.w == 0.0) {\n      return project_size_at_latitude(geometry.worldPosition.y);\n    }\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n\nfloat project_size_at_latitude(float meters, float lat) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n  mat3 rotation;\n  if (project_needs_rotation(geometry.position.xyz, rotation)) {\n    n = rotation * n;\n  }\n  return n;\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size_at_latitude(position_world.z, position_world.y),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\n"),d=n(498);const h={};e.a={name:"project",dependencies:[i.a,o],vs:u,getUniforms:function(t=h){return"viewport"in t?Object(d.b)(t):{}}}},457:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n(3),r=n(185),o=n(61),s=n(58),a=n(69),c=n(377);class l extends r.a{constructor(t={}){const{latitude:e=0,longitude:n=0,zoom:r=0,pitch:s=0,bearing:l=0,nearZMultiplier:u=.1,farZMultiplier:d=1.01,nearZ:h,farZ:p,orthographic:f=!1,projectionMatrix:g,repeat:m=!1,worldOffset:v=0,position:b,padding:y,legacyMeterSizes:x=!1}=t;let{width:_,height:w,altitude:O=1.5}=t;const P=Math.pow(2,r);let S;_=_||1,w=w||1;let C=null;if(g)O=g[5]/2,S=Object(o.b)(O);else{let n;if(t.fovy?(S=t.fovy,O=Object(o.e)(S)):S=Object(o.b)(O),y){const{top:t=0,bottom:e=0}=y;n=[0,Object(a.a)((t+w-e)/2,0,w)-w/2]}C=Object(o.j)({width:_,height:w,scale:P,center:b&&[0,0,b[2]*Object(o.o)(e)],offset:n,pitch:s,fovy:S,nearZMultiplier:u,farZMultiplier:d}),Number.isFinite(h)&&(C.near=h),Number.isFinite(p)&&(C.far=p)}let j=Object(o.k)({height:w,pitch:s,bearing:l,scale:P,altitude:O});if(v){j=(new c.a).translate([512*v,0,0]).multiplyLeft(j)}super({...t,width:_,height:w,viewMatrix:j,longitude:n,latitude:e,zoom:r,...C,fovy:S,focalDistance:O}),Object(i.a)(this,"longitude",void 0),Object(i.a)(this,"latitude",void 0),Object(i.a)(this,"pitch",void 0),Object(i.a)(this,"bearing",void 0),Object(i.a)(this,"altitude",void 0),Object(i.a)(this,"fovy",void 0),Object(i.a)(this,"orthographic",void 0),Object(i.a)(this,"_subViewports",void 0),Object(i.a)(this,"_pseudoMeters",void 0),this.latitude=e,this.longitude=n,this.zoom=r,this.pitch=s,this.bearing=l,this.altitude=O,this.fovy=S,this.orthographic=f,this._subViewports=m?[]:null,this._pseudoMeters=x,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),e=Math.floor((t[0]+180)/360),n=Math.ceil((t[2]-180)/360);for(let t=e;t<=n;t++){const e=t?new l({...this,worldOffset:t}):this;this._subViewports.push(e)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*Object(o.o)(t[1])]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)/Object(o.o)(n)]}addMetersToLngLat(t,e){return Object(o.a)(t,e)}panByPosition(t,e){const n=Object(o.n)(e,this.pixelUnprojectionMatrix),i=this.projectFlat(t),r=s.a([],i,s.d([],n)),a=s.a([],this.center,r),[c,l]=this.unprojectFlat(a);return{longitude:c,latitude:l}}getBounds(t={}){const e=Object(o.f)(this,t.z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(t,e={}){const{width:n,height:i}=this,{longitude:r,latitude:s,zoom:a}=Object(o.c)({width:n,height:i,bounds:t,...e});return new l({width:n,height:i,longitude:r,latitude:s,zoom:a})}}Object(i.a)(l,"displayName","WebMercatorViewport")},459:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(3),r=n(340),o=n(29),s=n(68);const a={blendFunc:[1,0,32771,0],blendEquation:32774};class c extends r.a{constructor(...t){super(...t),Object(i.a)(this,"pickZ",void 0),Object(i.a)(this,"_colorEncoderState",null)}render(t){return"pickingFBO"in t?this._drawPickingBuffer(t):super.render(t)}_drawPickingBuffer({layers:t,layerFilter:e,views:n,viewports:i,onViewportActive:r,pickingFBO:s,deviceRect:{x:c,y:u,width:d,height:h},cullRect:p,effects:f,pass:g="picking",pickZ:m,moduleParameters:v}){const b=this.gl;this.pickZ=m;const y=this._resetColorEncoder(m),x=Object(o.o)(b,{scissorTest:!0,scissor:[c,u,d,h],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...a,blend:!m},()=>super.render({target:s,layers:t,layerFilter:e,views:n,viewports:i,onViewportActive:r,cullRect:p,effects:null==f?void 0:f.filter(t=>t.useInPicking),pass:g,isPicking:!0,moduleParameters:v}));this._colorEncoderState=null;return{decodePickingColor:y&&l.bind(null,y),stats:x}}shouldDrawLayer(t){const{pickable:e,operation:n}=t.props;return e&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(t,e,n){const i={...t.props.parameters},{pickable:r,operation:o}=t.props;return this._colorEncoderState?r&&o.includes("draw")&&(Object.assign(i,a),i.blend=!0,i.blendColor=function(t,e,n){const{byLayer:i,byAlpha:r}=t;let o,a=i.get(e);a?(a.viewports.push(n),o=a.a):(o=i.size+1,o<=255?(a={a:o,layer:e,viewports:[n]},i.set(e,a),r[o]=a):(s.a.warn("Too many pickable layers, only picking the first 255")(),o=0));return[0,0,0,o/255]}(this._colorEncoderState,t,n)):i.blend=!1,o.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(t){return this._colorEncoderState=t?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function l(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}},460:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return d}));var i=n(3),r=n(69),o=n(233),s=n(502),a=n(61),c=n(116),l=n(207);class u extends s.a{constructor(t){const{width:e,height:n,latitude:r,longitude:o,zoom:s,bearing:a=0,pitch:l=0,altitude:u=1.5,position:d=[0,0,0],maxZoom:h=20,minZoom:p=0,maxPitch:f=60,minPitch:g=0,startPanLngLat:m,startZoomLngLat:v,startRotatePos:b,startBearing:y,startPitch:x,startZoom:_,normalize:w=!0}=t;Object(c.a)(Number.isFinite(o)),Object(c.a)(Number.isFinite(r)),Object(c.a)(Number.isFinite(s)),super({width:e,height:n,latitude:r,longitude:o,zoom:s,bearing:a,pitch:l,altitude:u,maxZoom:h,minZoom:p,maxPitch:f,minPitch:g,normalize:w,position:d},{startPanLngLat:m,startZoomLngLat:v,startRotatePos:b,startBearing:y,startPitch:x,startZoom:_}),Object(i.a)(this,"makeViewport",void 0),this.makeViewport=t.makeViewport}panStart({pos:t}){return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan({pos:t,startPos:e}){const n=this.getState().startPanLngLat||this._unproject(e);if(!n)return this;const i=this.makeViewport(this.getViewportProps()).panByPosition(n,t);return this._getUpdatedState(i)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:i,startBearing:r,startPitch:o}=this.getState();if(!i||void 0===r||void 0===o)return this;let s;return s=t?this._getNewRotation(t,i,o,r):{bearing:r+e,pitch:o+n},this._getUpdatedState(s)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:t}){return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom({pos:t,startPos:e,scale:n}){let{startZoom:i,startZoomLngLat:o}=this.getState();if(o||(i=this.getViewportProps().zoom,o=this._unproject(e)||this._unproject(t)),!o)return this;const{maxZoom:s,minZoom:a}=this.getViewportProps();let c=i+Math.log2(n);c=Object(r.a)(c,a,s);const l=this.makeViewport({...this.getViewportProps(),zoom:c});return this._getUpdatedState({zoom:c,...l.panByPosition(o,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(t=2){return this._zoomFromCenter(t)}zoomOut(t=2){return this._zoomFromCenter(1/t)}moveLeft(t=100){return this._panFromCenter([t,0])}moveRight(t=100){return this._panFromCenter([-t,0])}moveUp(t=100){return this._panFromCenter([0,t])}moveDown(t=100){return this._panFromCenter([0,-t])}rotateLeft(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:r}=n;return Math.abs(i-e.bearing)>180&&(n.bearing=i<0?i+360:i-360),Math.abs(r-e.longitude)>180&&(n.longitude=r<0?r+360:r-360),n}applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:i}=t;t.zoom=Object(r.a)(i,n,e);const{maxPitch:o,minPitch:s,pitch:c}=t;t.pitch=Object(r.a)(c,s,o);const{normalize:l=!0}=t;return l&&Object.assign(t,Object(a.m)(t)),t}_zoomFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.zoom({pos:[e/2,n/2],scale:t})}_panFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.pan({startPos:[e/2,n/2],pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}_unproject(t){const e=this.makeViewport(this.getViewportProps());return t&&e.unproject(t)}_getNewRotation(t,e,n,i){const o=t[0]-e[0],s=t[1]-e[1],a=t[1],c=e[1],{width:l,height:u}=this.getViewportProps(),d=o/l;let h=0;s>0?Math.abs(u-c)>5&&(h=s/(c-u)*1.2):s<0&&c>5&&(h=1-a/c),h=Object(r.a)(h,-1,1);const{minPitch:p,maxPitch:f}=this.getViewportProps();let g=n;return h>0?g=n+h*(f-n):h<0&&(g=n-h*(p-n)),{pitch:g,bearing:i+180*d}}}class d extends o.a{constructor(...t){super(...t),Object(i.a)(this,"ControllerState",u),Object(i.a)(this,"transition",{transitionDuration:300,transitionInterpolator:new l.a({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),Object(i.a)(this,"dragMode","pan")}setProps(t){t.position=t.position||[0,0,0];const e=this.props;super.setProps(t);(!e||e.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...t,...this.state}))}}},461:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(3),r=n(69),o=n(116);class s{constructor(t){Object(i.a)(this,"_propsToCompare",void 0),Object(i.a)(this,"_propsToExtract",void 0),Object(i.a)(this,"_requiredProps",void 0);const{compare:e,extract:n,required:r}=t;this._propsToCompare=e,this._propsToExtract=n||e,this._requiredProps=r}arePropsEqual(t,e){for(const n of this._propsToCompare)if(!(n in t)||!(n in e)||!Object(r.d)(t[n],e[n]))return!1;return!0}initializeProps(t,e){const n={},i={};for(const r of this._propsToExtract)(r in t||r in e)&&(n[r]=t[r],i[r]=e[r]);return this._checkRequiredProps(n),this._checkRequiredProps(i),{start:n,end:i}}getDuration(t,e){return e.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach(e=>{const n=t[e];Object(o.a)(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))})}}},489:function(t,e,n){"use strict";n.d(e,"a",(function(){return P}));var i=n(3),r=n(747),o=n(1157),s=n(1386),a=n(1158),c=n(52),l=n(1456),u=n(810),d=n(798),h=n(237),p=n(246),f=n(1161),g=n(213);class m extends f.a{constructor(t){const{fp64:e,IndexType:n=Uint32Array}=t;super({...t,attributes:{positions:{size:3,type:e?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:n,size:1}}})}get(t){const{attributes:e}=this;return"indices"===t?e.indices&&e.indices.subarray(0,this.vertexCount):e[t]}updateGeometry(t){super.updateGeometry(t);const e=this.buffers.indices;if(e)this.vertexCount=(e.value||e).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(t){if(this.normalize){const e=p.d(t,this.positionSize);return this.opts.resolution?Object(g.b)(p.b(e),p.a(e),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?Object(g.c)(p.b(e),p.a(e),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):e}return t}getGeometrySize(t){if(v(t)){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}return p.b(t).length/this.positionSize}getGeometryFromBuffer(t){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(t):null}updateGeometryAttributes(t,e){if(t&&v(t))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t,e.indexStart=this.indexStarts[e.geometryIndex+1]}else this._updateIndices(t,e),this._updatePositions(t,e),this._updateVertexValid(t,e)}_updateIndices(t,{geometryIndex:e,vertexStart:n,indexStart:i}){const{attributes:r,indexStarts:o,typedArrayManager:s}=this;let a=r.indices;if(!a||!t)return;let c=i;const l=p.c(t,this.positionSize,this.opts.preproject,this.opts.full3d);a=s.allocate(a,i+l.length,{copy:!0});for(let t=0;t<l.length;t++)a[c++]=l[t]+n;o[e+1]=i+l.length,r.indices=a}_updatePositions(t,{vertexStart:e,geometrySize:n}){const{attributes:{positions:i},positionSize:r}=this;if(!i||!t)return;const o=p.b(t);for(let t=e,s=0;s<n;t++,s++){const e=o[s*r],n=o[s*r+1],a=r>2?o[s*r+2]:0;i[3*t]=e,i[3*t+1]=n,i[3*t+2]=a}}_updateVertexValid(t,{vertexStart:e,geometrySize:n}){const{positionSize:i}=this,r=this.attributes.vertexValid,o=t&&p.a(t);if(t&&t.edgeTypes?r.set(t.edgeTypes,e):r.fill(1,e,e+n),o)for(let t=0;t<o.length;t++)r[e+o[t]/i-1]=0;r[e+n-1]=0}}function v(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}var b="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n  }\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n  #ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n  #else\n    normal = project_normal(vec3(0.0, 0.0, 1.0));\n  #endif\n    geometry.normal = normal;\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",y="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(b,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),x="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(b,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  #if RING_WINDING_ORDER_CW == 1\n    props.positions = instancePositions;\n    props.positions64Low = instancePositions64Low;\n    props.nextPositions = nextPositions;\n    props.nextPositions64Low = nextPositions64Low;\n  #else\n    props.positions = nextPositions;\n    props.positions64Low = nextPositions64Low;\n    props.nextPositions = instancePositions;\n    props.nextPositions64Low = instancePositions64Low;\n  #endif\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n\n  calculatePosition(props);\n}\n");const _=[0,0,0,255],w={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:_},getLineColor:{type:"accessor",value:_},material:!0},O={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class P extends r.a{constructor(...t){super(...t),Object(i.a)(this,"state",void 0)}getShaders(t){return super.getShaders({vs:"top"===t?y:x,fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[o.a,s.a,a.a]})}get wrapLongitude(){return!1}initializeState(){const{gl:t,viewport:e}=this.context;let{coordinateSystem:n}=this.props;const{_full3d:i}=this.props;let r;e.isGeospatial&&n===c.a.DEFAULT&&(n=c.a.LNGLAT),n===c.a.LNGLAT&&(r=i?e.projectPosition.bind(e):e.projectFlat.bind(e)),this.setState({numInstances:0,polygonTesselator:new m({preproject:r,fp64:this.use64bitPositions(),IndexType:!t||Object(l.c)(t,u.a.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const o=this.getAttributeManager();o.remove(["instancePickingColors"]),o.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:!0},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:O,accessor:"getPolygon",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:!0},elevations:{size:1,transition:O,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:O,accessor:"getFillColor",defaultValue:_,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:O,accessor:"getLineColor",defaultValue:_,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(t,{index:e,target:n})=>this.encodePickingColor(t&&t.__source?t.__source.index:e,n),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:i}=this.props;return i[0]&&i[0].__source&&(e.object=i.find(t=>t.__source.index===n)),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else super.disablePickingIndex(t)}draw({uniforms:t}){const{extruded:e,filled:n,wireframe:i,elevationScale:r}=this.props,{topModel:o,sideModel:s,polygonTesselator:a}=this.state,c={...t,extruded:Boolean(e),elevationScale:r};s&&(s.setInstanceCount(a.instanceCount-1),s.setUniforms(c),i&&(s.setDrawMode(3),s.setUniforms({isWireframe:!0}).draw()),n&&(s.setDrawMode(6),s.setUniforms({isWireframe:!1}).draw())),o&&(o.setVertexCount(a.vertexCount),o.setUniforms(c).draw())}updateState(t){super.updateState(t),this.updateGeometry(t);const{props:e,oldProps:n,changeFlags:i}=t,r=this.getAttributeManager();var o;(i.extensionsChanged||e.filled!==n.filled||e.extruded!==n.extruded)&&(null===(o=this.state.models)||void 0===o||o.forEach(t=>t.delete()),this.setState(this._getModels(this.context.gl)),r.invalidateAll())}updateGeometry({props:t,oldProps:e,changeFlags:n}){if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){const{polygonTesselator:e}=this.state,i=t.data.attributes||{};e.updateGeometry({data:t.data,normalize:t._normalize,geometryBuffer:i.getPolygon,buffers:i,getGeometry:t.getPolygon,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:n.dataChanged,full3d:t._full3d}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),n.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(t){const{id:e,filled:n,extruded:i}=this.props;let r,o;if(n){const n=this.getShaders("top");n.defines.NON_INSTANCED_MODEL=1,r=new d.a(t,{...n,id:"".concat(e,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(o=new d.a(t,{...this.getShaders("side"),id:"".concat(e,"-side"),geometry:new h.a({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),o.userData.excludeAttributes={indices:!0}),{models:[o,r].filter(Boolean),topModel:r,sideModel:o}}calculateIndices(t){const{polygonTesselator:e}=this.state;t.startIndices=e.indexStarts,t.value=e.get("indices")}calculatePositions(t){const{polygonTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateVertexValid(t){t.value=this.state.polygonTesselator.get("vertexValid")}}Object(i.a)(P,"defaultProps",w),Object(i.a)(P,"layerName","SolidPolygonLayer")},49:function(t,e,n){"use strict";n.r(e),n.d(e,"VERSION",(function(){return i.a})),n.d(e,"COORDINATE_SYSTEM",(function(){return r.a})),n.d(e,"OPERATION",(function(){return r.c})),n.d(e,"UNIT",(function(){return r.e})),n.d(e,"LightingEffect",(function(){return o.a})),n.d(e,"AmbientLight",(function(){return s.a})),n.d(e,"DirectionalLight",(function(){return a.a})),n.d(e,"PointLight",(function(){return g})),n.d(e,"_CameraLight",(function(){return v})),n.d(e,"_SunLight",(function(){return b.a})),n.d(e,"PostProcessEffect",(function(){return y.a})),n.d(e,"_LayersPass",(function(){return x.a})),n.d(e,"_PickLayersPass",(function(){return _.a})),n.d(e,"Deck",(function(){return w.a})),n.d(e,"LayerManager",(function(){return O.a})),n.d(e,"AttributeManager",(function(){return P.a})),n.d(e,"Layer",(function(){return S.a})),n.d(e,"CompositeLayer",(function(){return C.a})),n.d(e,"DeckRenderer",(function(){return j.a})),n.d(e,"Viewport",(function(){return M.a})),n.d(e,"WebMercatorViewport",(function(){return E.a})),n.d(e,"_GlobeViewport",(function(){return L.a})),n.d(e,"OrbitViewport",(function(){return k})),n.d(e,"OrthographicViewport",(function(){return V})),n.d(e,"FirstPersonViewport",(function(){return G})),n.d(e,"picking",(function(){return H.a})),n.d(e,"project",(function(){return Z.a})),n.d(e,"project32",(function(){return q.a})),n.d(e,"gouraudLighting",(function(){return K.a})),n.d(e,"phongLighting",(function(){return K.b})),n.d(e,"shadow",(function(){return X.a})),n.d(e,"View",(function(){return Y.a})),n.d(e,"MapView",(function(){return J.a})),n.d(e,"FirstPersonView",(function(){return rt})),n.d(e,"OrbitView",(function(){return at})),n.d(e,"OrthographicView",(function(){return ut})),n.d(e,"_GlobeView",(function(){return ft})),n.d(e,"Controller",(function(){return Q.a})),n.d(e,"MapController",(function(){return dt.b})),n.d(e,"_GlobeController",(function(){return pt})),n.d(e,"FirstPersonController",(function(){return it})),n.d(e,"OrbitController",(function(){return st})),n.d(e,"OrthographicController",(function(){return lt})),n.d(e,"LayerExtension",(function(){return gt.a})),n.d(e,"TRANSITION_EVENTS",(function(){return mt.a})),n.d(e,"TransitionInterpolator",(function(){return vt.a})),n.d(e,"LinearInterpolator",(function(){return et.a})),n.d(e,"FlyToInterpolator",(function(){return bt.a})),n.d(e,"log",(function(){return yt.a})),n.d(e,"assert",(function(){return xt.a})),n.d(e,"createIterable",(function(){return _t.a})),n.d(e,"fp64LowPart",(function(){return tt.b})),n.d(e,"Tesselator",(function(){return wt.a})),n.d(e,"_fillArray",(function(){return Ot.a})),n.d(e,"_flatten",(function(){return Ot.b})),n.d(e,"_count",(function(){return Pt.a})),n.d(e,"_deepEqual",(function(){return St.a})),n.d(e,"_memoize",(function(){return Ct.a})),n.d(e,"_mergeShaders",(function(){return jt.a})),n.d(e,"_compareProps",(function(){return Mt.a}));var i=n(761),r=n(52),o=n(587),s=n(663),a=n(402),c=n(3),l=n(594);const u=[255,255,255],d=1,h=[0,0,1],p=[0,0,1];let f=0;class g{constructor(t={}){Object(c.a)(this,"id",void 0),Object(c.a)(this,"color",void 0),Object(c.a)(this,"intensity",void 0),Object(c.a)(this,"type","point"),Object(c.a)(this,"position",void 0),Object(c.a)(this,"attenuation",void 0),Object(c.a)(this,"projectedLight",void 0);const{color:e=u}=t,{intensity:n=d}=t,{position:i=p}=t;this.id=t.id||"point-".concat(f++),this.color=e,this.intensity=n,this.type="point",this.position=i,this.attenuation=function(t){if(t.attenuation)return t.attenuation;if("intensity"in t)return[0,0,t.intensity||0];return h}(t),this.projectedLight={...this}}getProjectedLight({layer:t}){const{projectedLight:e}=this,n=t.context.viewport,{coordinateSystem:i,coordinateOrigin:o}=t.props,s=Object(l.b)(this.position,{viewport:n,coordinateSystem:i,coordinateOrigin:o,fromCoordinateSystem:n.isGeospatial?r.a.LNGLAT:r.a.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return e.color=this.color,e.intensity=this.intensity,e.position=s,e}}var m=n(498);class v extends g{getProjectedLight({layer:t}){const{projectedLight:e}=this,n=t.context.viewport,{coordinateSystem:i,coordinateOrigin:r,modelMatrix:o}=t.props,{project_uCameraPosition:s}=Object(m.b)({viewport:n,modelMatrix:o,coordinateSystem:i,coordinateOrigin:r});return e.color=this.color,e.intensity=this.intensity,e.position=s,e}}var b=n(1154),y=n(1385),x=n(340),_=n(459),w=n(1375),O=n(753),P=n(748),S=n(747),C=n(531),j=n(762),M=n(185),E=n(457),L=n(666),T=n(377),R=n(61);const A=Math.PI/180;function I({height:t,focalDistance:e,orbitAxis:n,rotationX:i,rotationOrbit:r,zoom:o}){const s="Z"===n?[0,0,1]:[0,1,0],a="Z"===n?[0,-e,0]:[0,0,e],c=(new T.a).lookAt({eye:a,up:s});c.rotateX(i*A),"Z"===n?c.rotateZ(r*A):c.rotateY(r*A);const l=Math.pow(2,o)/t;return c.scale(l),c}class k extends M.a{constructor(t){const{height:e,projectionMatrix:n,fovy:i=50,orbitAxis:r="Z",target:o=[0,0,0],rotationX:s=0,rotationOrbit:a=0,zoom:l=0}=t,u=n?n[5]/2:Object(R.e)(i);super({...t,longitude:void 0,viewMatrix:I({height:e||1,focalDistance:u,orbitAxis:r,rotationX:s,rotationOrbit:a,zoom:l}),fovy:i,focalDistance:u,position:o,zoom:l}),Object(c.a)(this,"projectedCenter",void 0),this.projectedCenter=this.project(this.center)}unproject(t,{topLeft:e=!0}={}){const[n,i,r=this.projectedCenter[2]]=t,o=e?i:this.height-i,[s,a,c]=Object(R.n)([n,o,r],this.pixelUnprojectionMatrix);return[s,a,c]}panByPosition(t,e){const n=this.project(t),i=[this.width/2+n[0]-e[0],this.height/2+n[1]-e[1],this.projectedCenter[2]];return{target:this.unproject(i)}}}var z=n(69),D=n(58);const F=(new T.a).lookAt({eye:[0,0,1]});function N({width:t,height:e,near:n,far:i,padding:r}){let o=-t/2,s=t/2,a=-e/2,c=e/2;if(r){const{left:n=0,right:i=0,top:l=0,bottom:u=0}=r,d=Object(z.a)((n+t-i)/2,0,t)-t/2,h=Object(z.a)((l+e-u)/2,0,e)-e/2;o-=d,s-=d,a+=h,c+=h}return(new T.a).ortho({left:o,right:s,bottom:a,top:c,near:n,far:i})}class V extends M.a{constructor(t){const{width:e,height:n,near:i=.1,far:r=1e3,zoom:o=0,target:s=[0,0,0],padding:a=null,flipY:c=!0}=t,l=Array.isArray(o)?o[0]:o,u=Array.isArray(o)?o[1]:o,d=Math.min(l,u),h=Math.pow(2,d);let p;if(l!==u){const t=Math.pow(2,l),e=Math.pow(2,u);p={unitsPerMeter:[t/h,e/h,1],metersPerUnit:[h/t,h/e,1]}}super({...t,longitude:void 0,position:s,viewMatrix:F.clone().scale([h,h*(c?-1:1),h]),projectionMatrix:N({width:e||1,height:n||1,padding:a,near:i,far:r}),zoom:d,distanceScales:p})}projectFlat([t,e]){const{unitsPerMeter:n}=this.distanceScales;return[t*n[0],e*n[1]]}unprojectFlat([t,e]){const{metersPerUnit:n}=this.distanceScales;return[t*n[0],e*n[1]]}panByPosition(t,e){const n=Object(R.n)(e,this.pixelUnprojectionMatrix),i=this.projectFlat(t),r=D.a([],i,D.d([],n)),o=D.a([],this.center,r);return{target:this.unprojectFlat(o)}}}var U=n(327),B=n(226);class W{constructor({phi:t=0,theta:e=0,radius:n=1,bearing:i,pitch:r,altitude:o,radiusScale:s=6371e3}={}){Object(c.a)(this,"phi",void 0),Object(c.a)(this,"theta",void 0),Object(c.a)(this,"radius",void 0),Object(c.a)(this,"radiusScale",void 0),this.phi=t,this.theta=e,this.radius=n||o||1,this.radiusScale=s||1,void 0!==i&&(this.bearing=i),void 0!==r&&(this.pitch=r),this.check()}toString(){return this.formatString(z.b)}formatString({printTypes:t=!1}){const e=z.e;return"".concat(t?"Spherical":"","[rho:").concat(e(this.radius),",theta:").concat(e(this.theta),",phi:").concat(e(this.phi),"]")}equals(t){return Object(z.d)(this.radius,t.radius)&&Object(z.d)(this.theta,t.theta)&&Object(z.d)(this.phi,t.phi)}exactEquals(t){return this.radius===t.radius&&this.theta===t.theta&&this.phi===t.phi}get bearing(){return 180-Object(z.c)(this.phi)}set bearing(t){this.phi=Math.PI-Object(z.h)(t)}get pitch(){return Object(z.c)(this.theta)}set pitch(t){this.theta=Object(z.h)(t)}get longitude(){return Object(z.c)(this.phi)}get latitude(){return Object(z.c)(this.theta)}get lng(){return Object(z.c)(this.phi)}get lat(){return Object(z.c)(this.theta)}get z(){return(this.radius-1)*this.radiusScale}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this.check()}clone(){return(new W).copy(this)}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this.check()}fromLngLatZ([t,e,n]){return this.radius=1+n/this.radiusScale,this.phi=Object(z.h)(e),this.theta=Object(z.h)(t),this.check()}fromVector3(t){return this.radius=B.c(t),this.radius>0&&(this.theta=Math.atan2(t[0],t[1]),this.phi=Math.acos(Object(z.a)(t[2]/this.radius,-1,1))),this.check()}toVector3(){return new U.a(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}check(){if(!(Number.isFinite(this.phi)&&Number.isFinite(this.theta)&&this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}}class G extends M.a{constructor(t){const{longitude:e,latitude:n,modelMatrix:i,bearing:r=0,pitch:o=0,up:s=[0,0,1]}=t,a=new W({bearing:r,pitch:-90===o?1e-4:90+o}).toVector3().normalize(),l=i?new T.a(i).transformAsVector(a):a,u=Number.isFinite(n)?Object(R.i)({latitude:n}):0,d=Math.pow(2,u),h=(new T.a).lookAt({eye:[0,0,0],center:l,up:s}).scale(d);super({...t,zoom:u,viewMatrix:h}),Object(c.a)(this,"longitude",void 0),Object(c.a)(this,"latitude",void 0),this.latitude=n,this.longitude=e}}var H=n(1158),Z=n(408),q=n(1157),K=n(1386),X=n(497),Y=n(236),J=n(576),Q=n(233),$=n(502),tt=n(128),et=n(207);class nt extends $.a{constructor(t){const{width:e,height:n,position:i=[0,0,0],bearing:r=0,pitch:o=0,longitude:s=null,latitude:a=null,maxPitch:c=90,minPitch:l=-90,startRotatePos:u,startBearing:d,startPitch:h,startZoomPosition:p}=t;super({width:e,height:n,position:i,bearing:r,pitch:o,longitude:s,latitude:a,maxPitch:c,minPitch:l},{startRotatePos:u,startBearing:d,startPitch:h,startZoomPosition:p})}panStart(){return this}pan(){return this}panEnd(){return this}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:i,startBearing:r,startPitch:o}=this.getState(),{width:s,height:a}=this.getViewportProps();if(!i||void 0===r||void 0===o)return this;let c;if(t){c={bearing:r-180*((t[0]-i[0])/s),pitch:o-90*((t[1]-i[1])/a)}}else c={bearing:r-e,pitch:o-n};return this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startRotatePos:null,startBearing:null,startPitch:null})}zoomStart(){return this._getUpdatedState({startZoomPosition:this.getViewportProps().position})}zoom({scale:t}){let{startZoomPosition:e}=this.getState();e||(e=this.getViewportProps().position);const n=this.getDirection();return this._move(n,20*Math.log2(t),e)}zoomEnd(){return this._getUpdatedState({startZoomPosition:null})}moveLeft(t=20){const e=this.getDirection(!0);return this._move(e.rotateZ({radians:Math.PI/2}),t)}moveRight(t=20){const e=this.getDirection(!0);return this._move(e.rotateZ({radians:-Math.PI/2}),t)}moveUp(t=20){const e=this.getDirection(!0);return this._move(e,t)}moveDown(t=20){const e=this.getDirection(!0);return this._move(e.negate(),t)}rotateLeft(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}zoomIn(t=2){return this.zoom({scale:t})}zoomOut(t=2){return this.zoom({scale:1/t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:r}=n;return Math.abs(i-e.bearing)>180&&(n.bearing=i<0?i+360:i-360),null!==r&&null!==e.longitude&&Math.abs(r-e.longitude)>180&&(n.longitude=r<0?r+360:r-360),n}_move(t,e,n=this.getViewportProps().position){const i=t.scale(e);return this._getUpdatedState({position:new U.a(n).add(i)})}getDirection(t=!1){return new W({bearing:this.getViewportProps().bearing,pitch:t?90:90+this.getViewportProps().pitch}).toVector3().normalize()}_getUpdatedState(t){return new nt({...this.getViewportProps(),...this.getState(),...t})}applyConstraints(t){const{pitch:e,maxPitch:n,minPitch:i,longitude:r,bearing:o}=t;return t.pitch=Object(z.a)(e,i,n),null!==r&&(r<-180||r>180)&&(t.longitude=Object(tt.f)(r+180,360)-180),(o<-180||o>180)&&(t.bearing=Object(tt.f)(o+180,360)-180),t}}class it extends Q.a{constructor(...t){super(...t),Object(c.a)(this,"ControllerState",nt),Object(c.a)(this,"transition",{transitionDuration:300,transitionInterpolator:new et.a(["position","pitch","bearing"])})}}class rt extends Y.a{get ViewportType(){return G}get ControllerType(){return it}}Object(c.a)(rt,"displayName","FirstPersonView");class ot extends $.a{constructor(t){const{width:e,height:n,rotationX:i=0,rotationOrbit:r=0,target:o=[0,0,0],zoom:s=0,minRotationX:a=-90,maxRotationX:l=90,minZoom:u=-1/0,maxZoom:d=1/0,startPanPosition:h,startRotatePos:p,startRotationX:f,startRotationOrbit:g,startZoomPosition:m,startZoom:v}=t;super({width:e,height:n,rotationX:i,rotationOrbit:r,target:o,zoom:s,minRotationX:a,maxRotationX:l,minZoom:u,maxZoom:d},{startPanPosition:h,startRotatePos:p,startRotationX:f,startRotationOrbit:g,startZoomPosition:m,startZoom:v}),Object(c.a)(this,"makeViewport",void 0),this.makeViewport=t.makeViewport}panStart({pos:t}){return this._getUpdatedState({startPanPosition:this._unproject(t)})}pan({pos:t,startPosition:e}){const n=this.getState().startPanPosition||e;if(!n)return this;const i=this.makeViewport(this.getViewportProps()).panByPosition(n,t);return this._getUpdatedState(i)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:i,startRotationX:r,startRotationOrbit:o}=this.getState(),{width:s,height:a}=this.getViewportProps();if(!i||void 0===r||void 0===o)return this;let c;if(t){let e=(t[0]-i[0])/s;const n=(t[1]-i[1])/a;(r<-90||r>90)&&(e*=-1),c={rotationX:r+180*n,rotationOrbit:o+180*e}}else c={rotationX:r+n,rotationOrbit:o+e};return this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this.getViewportProps()},{rotationOrbit:i}=n;return Math.abs(i-e.rotationOrbit)>180&&(n.rotationOrbit=i<0?i+360:i-360),n}zoomStart({pos:t}){return this._getUpdatedState({startZoomPosition:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom({pos:t,startPos:e,scale:n}){let{startZoom:i,startZoomPosition:r}=this.getState();if(r||(i=this.getViewportProps().zoom,r=this._unproject(e)||this._unproject(t)),!r)return this;const o=this._calculateNewZoom({scale:n,startZoom:i}),s=this.makeViewport({...this.getViewportProps(),zoom:o});return this._getUpdatedState({zoom:o,...s.panByPosition(r,t)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:t})})}zoomOut(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/t})})}moveLeft(t=50){return this._panFromCenter([-t,0])}moveRight(t=50){return this._panFromCenter([t,0])}moveUp(t=50){return this._panFromCenter([0,-t])}moveDown(t=50){return this._panFromCenter([0,t])}rotateLeft(t=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-t})}rotateRight(t=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+t})}rotateUp(t=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-t})}rotateDown(t=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+t})}_unproject(t){const e=this.makeViewport(this.getViewportProps());return t&&e.unproject(t)}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:n,minZoom:i}=this.getViewportProps();void 0===e&&(e=this.getViewportProps().zoom);const r=e+Math.log2(t);return Object(z.a)(r,i,n)}_panFromCenter(t){const{width:e,height:n,target:i}=this.getViewportProps();return this.pan({startPosition:i,pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:i,maxRotationX:r,minRotationX:o,rotationOrbit:s}=t;return t.zoom=Array.isArray(i)?[Object(z.a)(i[0],n,e),Object(z.a)(i[1],n,e)]:Object(z.a)(i,n,e),t.rotationX=Object(z.a)(t.rotationX,o,r),(s<-180||s>180)&&(t.rotationOrbit=Object(tt.f)(s+180,360)-180),t}}class st extends Q.a{constructor(...t){super(...t),Object(c.a)(this,"ControllerState",ot),Object(c.a)(this,"transition",{transitionDuration:300,transitionInterpolator:new et.a({transitionProps:{compare:["target","zoom","rotationX","rotationOrbit"],required:["target","zoom"]}})})}}class at extends Y.a{constructor(t={}){super(t),this.props.orbitAxis=t.orbitAxis||"Z"}get ViewportType(){return k}get ControllerType(){return st}}Object(c.a)(at,"displayName","OrbitView");class ct extends ot{constructor(t){super(t),Object(c.a)(this,"zoomAxis",void 0),this.zoomAxis=t.zoomAxis||"all"}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:n,minZoom:i}=this.getViewportProps();void 0===e&&(e=this.getViewportProps().zoom);let r=Math.log2(t);if(Array.isArray(e)){let[t,o]=e;switch(this.zoomAxis){case"X":t=Object(z.a)(t+r,i,n);break;case"Y":o=Object(z.a)(o+r,i,n);break;default:let e=Math.min(t+r,o+r);e<i&&(r+=i-e),e=Math.max(t+r,o+r),e>n&&(r+=n-e),t+=r,o+=r}return[t,o]}return Object(z.a)(e+r,i,n)}}class lt extends Q.a{constructor(...t){super(...t),Object(c.a)(this,"ControllerState",ct),Object(c.a)(this,"transition",{transitionDuration:300,transitionInterpolator:new et.a(["target","zoom"])}),Object(c.a)(this,"dragMode","pan")}_onPanRotate(){return!1}}class ut extends Y.a{get ViewportType(){return V}get ControllerType(){return lt}}Object(c.a)(ut,"displayName","OrthographicView");var dt=n(460);class ht extends dt.a{applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:i}=t;t.zoom=Object(z.a)(i,n,e);const{longitude:r,latitude:o}=t;return(r<-180||r>180)&&(t.longitude=Object(tt.f)(r+180,360)-180),t.latitude=Object(z.a)(o,-89,89),t}}class pt extends Q.a{constructor(...t){super(...t),Object(c.a)(this,"ControllerState",ht),Object(c.a)(this,"transition",{transitionDuration:300,transitionInterpolator:new et.a(["longitude","latitude","zoom"])}),Object(c.a)(this,"dragMode","pan")}setProps(t){super.setProps(t),this.dragRotate=!1,this.touchRotate=!1}}class ft extends Y.a{get ViewportType(){return L.a}get ControllerType(){return pt}}Object(c.a)(ft,"displayName","GlobeView");var gt=n(1156),mt=n(668),vt=n(461),bt=n(1176),yt=n(68),xt=n(116),_t=n(196),wt=n(1161),Ot=n(232),Pt=n(664),St=n(178),Ct=n(253),jt=n(665),Mt=n(574)},490:function(t,e,n){"use strict";n.d(e,"a",(function(){return O}));var i=n(3),r=n(747),o=n(1157),s=n(1158),a=n(52),c=n(68),l=n(798),u=n(237),d=n(425),h=n(955),p=n(2160),f=n(196);const g=()=>{},m={10241:9987,10240:9729,10242:33071,10243:33071};function v(t,e,n,i){const r=Math.min(n/e.width,i/e.height),o=Math.floor(e.width*r),s=Math.floor(e.height*r);return 1===r?{data:e,width:o,height:s}:(t.canvas.height=s,t.canvas.width=o,t.clearRect(0,0,o,s),t.drawImage(e,0,0,e.width,e.height,0,0,o,s),{data:t.canvas,width:o,height:s})}function b(t){return t&&(t.id||t.url)}function y(t,e,n){for(let i=0;i<e.length;i++){const{icon:r,xOffset:o}=e[i];t[b(r)]={...r,x:o,y:n}}}class x{constructor(t,{onUpdate:e=g,onError:n=g}){Object(i.a)(this,"gl",void 0),Object(i.a)(this,"onUpdate",void 0),Object(i.a)(this,"onError",void 0),Object(i.a)(this,"_loadOptions",null),Object(i.a)(this,"_texture",null),Object(i.a)(this,"_externalTexture",null),Object(i.a)(this,"_mapping",{}),Object(i.a)(this,"_textureParameters",null),Object(i.a)(this,"_pendingCount",0),Object(i.a)(this,"_autoPacking",!1),Object(i.a)(this,"_xOffset",0),Object(i.a)(this,"_yOffset",0),Object(i.a)(this,"_rowHeight",0),Object(i.a)(this,"_buffer",4),Object(i.a)(this,"_canvasWidth",1024),Object(i.a)(this,"_canvasHeight",0),Object(i.a)(this,"_canvas",null),this.gl=t,this.onUpdate=e,this.onError=n}finalize(){var t;null===(t=this._texture)||void 0===t||t.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(t){const e=this._autoPacking?b(t):t;return this._mapping[e]||{}}setProps({loadOptions:t,autoPacking:e,iconAtlas:n,iconMapping:i,textureParameters:r}){var o;(t&&(this._loadOptions=t),void 0!==e&&(this._autoPacking=e),i&&(this._mapping=i),n)&&(null===(o=this._texture)||void 0===o||o.delete(),this._texture=null,this._externalTexture=n);r&&(this._textureParameters=r)}get isLoaded(){return 0===this._pendingCount}packIcons(t,e){if(!this._autoPacking||"undefined"==typeof document)return;const n=Object.values(function(t,e,n){if(!t||!e)return null;n=n||{};const i={},{iterable:r,objectInfo:o}=Object(f.a)(t);for(const t of r){o.index++;const r=e(t,o),s=b(r);if(!r)throw new Error("Icon is missing.");if(!r.url)throw new Error("Icon url is missing.");i[s]||n[s]&&r.url===n[s].url||(i[s]={...r,source:t,sourceIndex:o.index})}return i}(t,e,this._mapping)||{});if(n.length>0){const{mapping:t,xOffset:e,yOffset:i,rowHeight:r,canvasHeight:o}=function({icons:t,buffer:e,mapping:n={},xOffset:i=0,yOffset:r=0,rowHeight:o=0,canvasWidth:s}){let a=[];for(let c=0;c<t.length;c++){const l=t[c];if(!n[b(l)]){const{height:t,width:c}=l;i+c+e>s&&(y(n,a,r),i=0,r=o+r+e,o=0,a=[]),a.push({icon:l,xOffset:i}),i=i+c+e,o=Math.max(o,t)}}return a.length>0&&y(n,a,r),{mapping:n,rowHeight:o,xOffset:i,yOffset:r,canvasWidth:s,canvasHeight:(c=o+r+e,Math.pow(2,Math.ceil(Math.log2(c))))};var c}({icons:n,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=r,this._mapping=t,this._xOffset=e,this._yOffset=i,this._canvasHeight=o,this._texture||(this._texture=new d.a(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||m})),this._texture.height!==this._canvasHeight&&(this._texture=function(t,e,n,i){const r=t.width,o=t.height,s=new d.a(t.gl,{width:e,height:n,parameters:i});return Object(h.b)(t,s,{targetY:0,width:r,height:o}),t.delete(),s}(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||m)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(n)}}_loadIcons(t){const e=this._canvas.getContext("2d",{willReadFrequently:!0});for(const n of t)this._pendingCount++,Object(p.a)(n.url,this._loadOptions).then(t=>{const i=b(n),r=this._mapping[i],{x:o,y:s,width:a,height:c}=r,{data:l,width:u,height:d}=v(e,t,a,c);this._texture.setSubImageData({data:l,x:o+(a-u)/2,y:s+(c-d)/2,width:u,height:d}),r.width=u,r.height=d,this._texture.generateMipmap(),this.onUpdate()}).catch(t=>{this.onError({url:n.url,source:n.source,sourceIndex:n.sourceIndex,loadOptions:this._loadOptions,error:t})}).finally(()=>{this._pendingCount--})}}const _=[0,0,0,255],w={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:_},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class O extends r.a{constructor(...t){super(...t),Object(i.a)(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[o.a,s.a]})}initializeState(){this.state={iconManager:new x(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})};this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:_},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(t){super.updateState(t);const{props:e,oldProps:n,changeFlags:i}=t,r=this.getAttributeManager(),{iconAtlas:o,iconMapping:s,data:a,getIcon:c,textureParameters:l}=e,{iconManager:u}=this.state,d=o||this.internalState.isAsyncPropLoading("iconAtlas");if(u.setProps({loadOptions:e.loadOptions,autoPacking:!d,iconAtlas:o,iconMapping:d?s:null,textureParameters:l}),d?n.iconMapping!==e.iconMapping&&r.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&u.packIcons(a,c),i.extensionsChanged){var h;const{gl:t}=this.context;null===(h=this.state.model)||void 0===h||h.delete(),this.state.model=this._getModel(t),r.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(t){super.finalizeState(t),this.state.iconManager.finalize()}draw({uniforms:t}){const{sizeScale:e,sizeMinPixels:n,sizeMaxPixels:i,sizeUnits:r,billboard:o,alphaCutoff:s}=this.props,{iconManager:c}=this.state,l=c.getTexture();l&&this.state.model.setUniforms(t).setUniforms({iconsTexture:l,iconsTextureDim:[l.width,l.height],sizeUnits:a.e[r],sizeScale:e,sizeMinPixels:n,sizeMaxPixels:i,billboard:o,alphaCutoff:s}).draw()}_getModel(t){return new l.a(t,{...this.getShaders(),id:this.props.id,geometry:new u.a({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(t){var e;const n=null===(e=this.getCurrentLayer())||void 0===e?void 0:e.props.onIconError;n?n(t):c.a.error(t.error.message)()}getInstanceOffset(t){const{width:e,height:n,anchorX:i=e/2,anchorY:r=n/2}=this.state.iconManager.getIconMapping(t);return[e/2-i,n/2-r]}getInstanceColorMode(t){return this.state.iconManager.getIconMapping(t).mask?1:0}getInstanceIconFrame(t){const{x:e,y:n,width:i,height:r}=this.state.iconManager.getIconMapping(t);return[e,n,i,r]}}Object(i.a)(O,"defaultProps",w),Object(i.a)(O,"layerName","IconLayer")},497:function(t,e,n){"use strict";var i=n(52),r=n(408),o=n(377),s=n(327),a=n(253),c=n(61);const l=Object(a.a)((function({viewport:t,center:e}){return new o.a(t.viewProjectionMatrix).invert().transform(e)})),u=Object(a.a)((function({viewport:t,shadowMatrices:e}){const n=[],i=t.pixelUnprojectionMatrix,r=t.isGeospatial?void 0:1,a=[[0,0,r],[t.width,0,r],[0,t.height,r],[t.width,t.height,r],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(t=>function(t,e){const[n,i,r]=t,o=Object(c.n)([n,i,r],e);if(Number.isFinite(r))return o;return[o[0],o[1],0]}(t,i));for(const i of e){const e=i.clone().translate(new s.a(t.center).negate()),r=a.map(t=>e.transform(t)),c=(new o.a).ortho({left:Math.min(...r.map(t=>t[0])),right:Math.max(...r.map(t=>t[0])),bottom:Math.min(...r.map(t=>t[1])),top:Math.max(...r.map(t=>t[1])),near:Math.min(...r.map(t=>-t[2])),far:Math.max(...r.map(t=>-t[2]))});n.push(c.multiplyRight(i))}return n})),d=[0,0,0,1],h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];e.a={name:"shadow",dependencies:[r.a],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?function(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:!!t.shadowMaps&&t.shadowMaps.length>0,shadow_uColor:t.shadowColor||d,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},o=l({viewport:t.viewport,center:e.project_uCenter}),a=[],c=u({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let n=0;n<t.shadowMatrices.length;n++){const r=c[n],l=r.clone().translate(new s.a(t.viewport.center).negate());e.project_uCoordinateSystem===i.a.LNGLAT&&e.project_uProjectionMode===i.d.WEB_MERCATOR?(c[n]=l,a[n]=o):(c[n]=r.clone().multiplyRight(h),a[n]=l.transform(o))}for(let e=0;e<c.length;e++)r["shadow_uViewProjectionMatrices[".concat(e,"]")]=c[e],r["shadow_uProjectCenters[".concat(e,"]")]=a[e],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(e)]=t.shadowMaps[e]:r["shadow_uShadowMap".concat(e)]=t.dummyShadowMap;return r}(t,e):{}}},498:function(t,e,n){"use strict";n.d(e,"a",(function(){return p})),n.d(e,"b",(function(){return f}));var i=n(46),r=n(93),o=n(52),s=n(253);const a=[0,0,0,0],c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],u=[0,0,0],d=[0,0,0],h=Object(s.a)((function({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:s}){const{projectionCenter:d,viewProjectionMatrix:h,originCommon:f,cameraPosCommon:g,shaderCoordinateOrigin:m,geospatialOrigin:v}=function(t,e,n){const{viewMatrixUncentered:o,projectionMatrix:s}=t;let{viewMatrix:l,viewProjectionMatrix:u}=t,d=a,h=a,f=t.cameraPosition;const{geospatialOrigin:g,shaderCoordinateOrigin:m,offsetMode:v}=p(t,e,n);v&&(h=t.projectPosition(g||m),f=[f[0]-h[0],f[1]-h[1],f[2]-h[2]],h[3]=1,d=r.n([],h,u),l=o||l,u=i.h([],s,l),u=i.h([],u,c));return{viewMatrix:l,viewProjectionMatrix:u,projectionCenter:d,originCommon:h,cameraPosCommon:f,shaderCoordinateOrigin:m,geospatialOrigin:g}}(t,n,s),b=t.getDistanceScales(),y=[t.width*e,t.height*e],x=r.n([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,_={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:m,project_uCommonOrigin:f.slice(0,3),project_uCenter:d,project_uPseudoMeters:Boolean(t._pseudoMeters),project_uViewportSize:y,project_uDevicePixelRatio:e,project_uFocalDistance:x,project_uCommonUnitsPerMeter:b.unitsPerMeter,project_uCommonUnitsPerWorldUnit:b.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:u,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:h,project_uModelMatrix:l,project_uCameraPosition:g};if(v){const e=t.getDistanceScales(v);switch(n){case o.a.METER_OFFSETS:_.project_uCommonUnitsPerWorldUnit=e.unitsPerMeter,_.project_uCommonUnitsPerWorldUnit2=e.unitsPerMeter2;break;case o.a.LNGLAT:case o.a.LNGLAT_OFFSETS:t._pseudoMeters||(_.project_uCommonUnitsPerMeter=e.unitsPerMeter),_.project_uCommonUnitsPerWorldUnit=e.unitsPerDegree,_.project_uCommonUnitsPerWorldUnit2=e.unitsPerDegree2;break;case o.a.CARTESIAN:_.project_uCommonUnitsPerWorldUnit=[1,1,e.unitsPerMeter[2]],_.project_uCommonUnitsPerWorldUnit2=[0,0,e.unitsPerMeter2[2]]}}return _}));function p(t,e,n=d){n.length<3&&(n=[n[0],n[1],0]);let i,r=n,s=!0;switch(i=e===o.a.LNGLAT_OFFSETS||e===o.a.METER_OFFSETS?n:t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case o.d.WEB_MERCATOR:e!==o.a.LNGLAT&&e!==o.a.CARTESIAN||(i=[0,0,0],s=!1);break;case o.d.WEB_MERCATOR_AUTO_OFFSET:e===o.a.LNGLAT?r=i:e===o.a.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case o.d.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case o.d.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function f({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:i=o.a.DEFAULT,coordinateOrigin:r=d,autoWrapLongitude:s=!1}){i===o.a.DEFAULT&&(i=t.isGeospatial?o.a.LNGLAT:o.a.CARTESIAN);const a=h({viewport:t,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return a.project_uWrapLongitude=s,a.project_uModelMatrix=n||l,a}},50:function(t,e,n){var i=n(828);t.exports=function(t,e){if(null==t)return{};var n,r,o=i(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)n=s[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o},t.exports.default=t.exports,t.exports.__esModule=!0},502:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(3);class r{constructor(t,e){Object(i.a)(this,"_viewportProps",void 0),Object(i.a)(this,"_state",void 0),this._viewportProps=this.applyConstraints(t),this._state=e}getViewportProps(){return this._viewportProps}getState(){return this._state}}},52:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return s})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return c}));var i=n(68);const r={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(r,"IDENTITY",{get:()=>(i.a.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const o={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},s={common:0,meters:1,pixels:2},a={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},c={DRAW:"draw",MASK:"mask",TERRAIN:"terrain"}},520:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(18),r=n.n(i),o=n(76);function s(t,e){return!e||"object"!==r()(e)&&"function"!=typeof e?Object(o.a)(t):e}},521:function(t,e,n){"use strict";function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.d(e,"a",(function(){return i}))},530:function(t,e,n){"use strict";function i(t,e,n){const i=e[0],r=e[1],o=n[3]*i+n[7]*r||1;return t[0]=(n[0]*i+n[4]*r)/o,t[1]=(n[1]*i+n[5]*r)/o,t}function r(t,e,n){const i=e[0],r=e[1],o=e[2],s=n[3]*i+n[7]*r+n[11]*o||1;return t[0]=(n[0]*i+n[4]*r+n[8]*o)/s,t[1]=(n[1]*i+n[5]*r+n[9]*o)/s,t[2]=(n[2]*i+n[6]*r+n[10]*o)/s,t}function o(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2],t}n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return o}))},531:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(3),r=n(747),o=n(129),s=n(232),a=n(65);class c extends r.a{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(t){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:e}=t;return e&&e.__source&&e.__source.parent&&e.__source.parent.id===this.id?(t.object=e.__source.object,t.index=e.__source.index,t):t}filterSubLayer(t){return!0}shouldRenderSubLayer(t,e){return e&&e.length}getSubLayerClass(t,e){const{_subLayerProps:n}=this.props;return n&&n[t]&&n[t].type||e}getSubLayerRow(t,e,n){return t.__source={parent:this,object:e,index:n},t}getSubLayerAccessor(t){if("function"==typeof t){const e={index:-1,data:this.props.data,target:[]};return(n,i)=>n&&n.__source?(e.index=n.__source.index,t(n.__source.object,e)):t(n,i)}return t}getSubLayerProps(t={}){var e;const{opacity:n,pickable:i,visible:r,parameters:o,getPolygonOffset:s,highlightedObjectIndex:c,autoHighlight:l,highlightColor:u,coordinateSystem:d,coordinateOrigin:h,wrapLongitude:p,positionFormat:f,modelMatrix:g,extensions:m,fetch:v,operation:b,_subLayerProps:y}=this.props,x={id:"",updateTriggers:{},opacity:n,pickable:i,visible:r,parameters:o,getPolygonOffset:s,highlightedObjectIndex:c,autoHighlight:l,highlightColor:u,coordinateSystem:d,coordinateOrigin:h,wrapLongitude:p,positionFormat:f,modelMatrix:g,extensions:m,fetch:v,operation:b},_=y&&t.id&&y[t.id],w=_&&_.updateTriggers,O=t.id||"sublayer";if(_){const e=this.props[a.g],n=t.type?t.type._propTypes:{};for(const t in _){const i=n[t]||e[t];i&&"accessor"===i.type&&(_[t]=this.getSubLayerAccessor(_[t]))}}Object.assign(x,t,_),x.id="".concat(this.props.id,"-").concat(O),x.updateTriggers={all:null===(e=this.props.updateTriggers)||void 0===e?void 0:e.all,...t.updateTriggers,...w};for(const t of m){const e=t.getSubLayerProps.call(this,t);e&&Object.assign(x,e,{updateTriggers:Object.assign(x.updateTriggers,e.updateTriggers)})}return x}_updateAutoHighlight(t){for(const e of this.getSubLayers())e.updateAutoHighlight(t)}_getAttributeManager(){return null}_postUpdate(t,e){let n=this.internalState.subLayers;const i=!n||this.needsUpdate();if(i){const t=this.renderLayers();n=Object(s.b)(t,Boolean),this.internalState.subLayers=n}Object(o.a)("compositeLayer.renderLayers",this,i,n);for(const t of n)t.parent=this}}Object(i.a)(c,"layerName","CompositeLayer")},532:function(t,e,n){"use strict";n.d(e,"c",(function(){return p})),n.d(e,"b",(function(){return f})),n.d(e,"a",(function(){return g})),n.d(e,"d",(function(){return m}));var i=n(68);function r(t,e,n){const i=n;return i.domain=()=>t,i.range=()=>e,i}function o(t,e){return r(t,e,n=>function(t,e,n){const r=t[1]-t[0];if(r<=0)return i.a.warn("quantizeScale: invalid domain, returning range[0]")(),e[0];const o=r/e.length,s=Math.floor((n-t[0])/o),a=Math.max(Math.min(s,e.length-1),0);return e[a]}(t,e,n))}function s(t,e){return r(t,e,n=>function(t,e,n){return(n-t[0])/(t[1]-t[0])*(e[1]-e[0])+e[0]}(t,e,n))}function a(t,e){const n=t.sort(c);let i=0;const o=Math.max(1,e.length),s=new Array(o-1);for(;++i<o;)s[i-1]=l(n,i/o);const a=t=>function(t,e,n){return e[function(t,e){let n=0,i=t.length;for(;n<i;){const r=n+i>>>1;c(t[r],e)>0?i=r:n=r+1}return n}(t,n)]}(s,e,t);return a.thresholds=()=>s,r(t,e,a)}function c(t,e){return t-e}function l(t,e){const n=t.length;if(e<=0||n<2)return t[0];if(e>=1)return t[n-1];const i=(n-1)*e,r=Math.floor(i),o=t[r];return o+(t[r+1]-o)*(i-r)}function u(t,e){const n=new Map,i=[];for(const e of t){const t="".concat(e);n.has(t)||n.set(t,i.push(e))}return r(t,e,t=>function(t,e,n,i){const r="".concat(i);let o=e.get(r);return void 0===o&&(o=t.push(i),e.set(r,o)),n[(o-1)%n.length]}(i,n,e,t))}function d(t){return null!=t}function h(t,e){return("function"==typeof e?t.map(e):t).filter(d)}function p(t,e){return h(t,e)}function f(t,e){return function(t){const e=[];return t.forEach(t=>{!e.includes(t)&&d(t)&&e.push(t)}),e}(h(t,e))}function g(t,e,n){return Math.max(e,Math.min(n,t))}function m(t){switch(t){case"quantize":return o;case"linear":return s;case"quantile":return a;case"ordinal":return u;default:return o}}},533:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var i=n(3),r=n(531),o=n(68),s=n(196),a=n(489),c=n(407),l=n(246),u=n(779);const d=[0,0,0,255],h={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:d},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class p extends r.a{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&o.a.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:t}){const e=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getPolygon);if(e&&Array.isArray(t.dataChanged)){const e=this.state.paths.slice(),n=t.dataChanged.map(t=>Object(u.a)({data:e,getIndex:t=>t.__source.index,dataRange:t,replace:this._getPaths(t)}));this.setState({paths:e,pathsDiff:n})}else e&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(t={}){const{data:e,getPolygon:n,positionFormat:i,_normalize:r}=this.props,o=[],a="XY"===i?2:3,{startRow:c,endRow:u}=t,{iterable:d,objectInfo:h}=Object(s.a)(e,c,u);for(const t of d){h.index++;let e=n(t,h);r&&(e=l.d(e,a));const{holeIndices:i}=e,s=e.positions||e;if(i)for(let e=0;e<=i.length;e++){const n=s.slice(i[e-1]||0,i[e]||s.length);o.push(this.getSubLayerRow({path:n},t,h.index))}else o.push(this.getSubLayerRow({path:s},t,h.index))}return o}renderLayers(){const{data:t,_dataDiff:e,stroked:n,filled:i,extruded:r,wireframe:o,_normalize:s,_windingOrder:l,elevationScale:u,transitions:h,positionFormat:p}=this.props,{lineWidthUnits:f,lineWidthScale:g,lineWidthMinPixels:m,lineWidthMaxPixels:v,lineJointRounded:b,lineMiterLimit:y,lineDashJustified:x}=this.props,{getFillColor:_,getLineColor:w,getLineWidth:O,getLineDashArray:P,getElevation:S,getPolygon:C,updateTriggers:j,material:M}=this.props,{paths:E,pathsDiff:L}=this.state,T=this.getSubLayerClass("fill",a.a),R=this.getSubLayerClass("stroke",c.a),A=this.shouldRenderSubLayer("fill",E)&&new T({_dataDiff:e,extruded:r,elevationScale:u,filled:i,wireframe:o,_normalize:s,_windingOrder:l,getElevation:S,getFillColor:_,getLineColor:r&&o?w:d,material:M,transitions:h},this.getSubLayerProps({id:"fill",updateTriggers:j&&{getPolygon:j.getPolygon,getElevation:j.getElevation,getFillColor:j.getFillColor,lineColors:r&&o,getLineColor:j.getLineColor}}),{data:t,positionFormat:p,getPolygon:C});return[!r&&A,!r&&n&&this.shouldRenderSubLayer("stroke",E)&&new R({_dataDiff:L&&(()=>L),widthUnits:f,widthScale:g,widthMinPixels:m,widthMaxPixels:v,jointRounded:b,miterLimit:y,dashJustified:x,_pathType:"loop",transitions:h&&{getWidth:h.getLineWidth,getColor:h.getLineColor,getPath:h.getPolygon},getColor:this.getSubLayerAccessor(w),getWidth:this.getSubLayerAccessor(O),getDashArray:this.getSubLayerAccessor(P)},this.getSubLayerProps({id:"stroke",updateTriggers:j&&{getWidth:j.getLineWidth,getColor:j.getLineColor,getDashArray:j.getLineDashArray}}),{data:E,positionFormat:p,getPath:t=>t.path}),r&&A]}}Object(i.a)(p,"layerName","PolygonLayer"),Object(i.a)(p,"defaultProps",h)},535:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return d}));var i=n(196),r=n(52);const o=Math.PI/180,s=new Float32Array(16),a=new Float32Array(12);function c(t,e,n){const i=e[0]*o,r=e[1]*o,s=e[2]*o,a=Math.sin(s),c=Math.sin(i),l=Math.sin(r),u=Math.cos(s),d=Math.cos(i),h=Math.cos(r),p=n[0],f=n[1],g=n[2];t[0]=p*h*d,t[1]=p*l*d,t[2]=p*-c,t[3]=f*(-l*u+h*c*a),t[4]=f*(h*u+l*c*a),t[5]=f*d*a,t[6]=g*(l*a+h*c*u),t[7]=g*(-h*a+l*c*u),t[8]=g*d*u}function l(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const u={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:r,getOrientation:o,getScale:u,getTranslation:d,getTransformMatrix:h}=this.props,p=Array.isArray(h),f=p&&16===h.length,g=Array.isArray(u),m=Array.isArray(o),v=Array.isArray(d),b=f||!p&&Boolean(h(r[0]));t.constant=b?f:m&&g&&v;const y=t.value;if(t.constant){let e;if(b)s.set(h),e=l(s);else{e=a;c(e,o,u),e.set(d,9)}t.value=new Float32Array(e)}else{let p=e*t.size;const{iterable:x,objectInfo:_}=Object(i.a)(r,e,n);for(const t of x){let e;if(_.index++,b)s.set(f?h:h(t,_)),e=l(s);else{e=a;c(e,m?o:o(t,_),g?u:u(t,_)),e.set(v?d:d(t,_),9)}y[p++]=e[0],y[p++]=e[1],y[p++]=e[2],y[p++]=e[3],y[p++]=e[4],y[p++]=e[5],y[p++]=e[6],y[p++]=e[7],y[p++]=e[8],y[p++]=e[9],y[p++]=e[10],y[p++]=e[11]}}}};function d(t,e){return e===r.a.CARTESIAN||e===r.a.METER_OFFSETS||e===r.a.DEFAULT&&!t.isGeospatial}},539:function(t,e,n){"use strict";function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}n.d(e,"a",(function(){return r}))},54:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return o}));var i=1e-6,r="undefined"!=typeof Float32Array?Float32Array:Array,o=Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},542:function(t,e,n){"use strict";n.d(e,"h",(function(){return p})),n.d(e,"c",(function(){return g})),n.d(e,"a",(function(){return m})),n.d(e,"f",(function(){return b})),n.d(e,"g",(function(){return x})),n.d(e,"b",(function(){return w})),n.d(e,"e",(function(){return O})),n.d(e,"d",(function(){return P}));var i=n(3),r=n(666),o=n(457),s=n(429),a=n(61);const c=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],l=c.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),u=l.concat([[.25,.5],[.75,.5]]);class d{constructor(t,e,n){Object(i.a)(this,"x",void 0),Object(i.a)(this,"y",void 0),Object(i.a)(this,"z",void 0),Object(i.a)(this,"childVisible",void 0),Object(i.a)(this,"selected",void 0),Object(i.a)(this,"_children",void 0),this.x=t,this.y=e,this.z=n}get children(){if(!this._children){const t=2*this.x,e=2*this.y,n=this.z+1;this._children=[new d(t,e,n),new d(t,e+1,n),new d(t+1,e,n),new d(t+1,e+1,n)]}return this._children}update(t){const{viewport:e,cullingVolume:n,elevationBounds:i,minZ:r,maxZ:o,bounds:s,offset:a,project:c}=t,l=this.getBoundingVolume(i,a,c);if(s&&!this.insideBounds(s))return!1;if(n.computeVisibility(l)<0)return!1;if(!this.childVisible){let{z:t}=this;if(t<o&&t>=r){const n=l.distanceTo(e.cameraPosition)*e.scale/e.height;t+=Math.floor(Math.log2(n))}if(t>=o)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const e of this.children)e.update(t);return!0}getSelected(t=[]){if(this.selected&&t.push(this),this._children)for(const e of this._children)e.getSelected(t);return t}insideBounds([t,e,n,i]){const r=512/Math.pow(2,this.z);return this.x*r<n&&this.y*r<i&&(this.x+1)*r>t&&(this.y+1)*r>e}getBoundingVolume(t,e,n){if(n){const e=this.z<1?u:this.z<2?l:c,i=[];for(const r of e){const e=b(this.x+r[0],this.y+r[1],this.z);e[2]=t[0],i.push(n(e)),t[0]!==t[1]&&(e[2]=t[1],i.push(n(e)))}return Object(s.d)(i)}const i=512/Math.pow(2,this.z),r=this.x*i+512*e,o=512-(this.y+1)*i;return new s.a([r,o,t[0]],[r+i,o+i,t[1]])}}const h=[-1/0,-1/0,1/0,1/0],p={type:"object",value:null,validate:(t,e)=>e.optional&&null===t||"string"==typeof t||Array.isArray(t)&&t.every(t=>"string"==typeof t),equal:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}};function f(t,e){const n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...n.map(t=>t[0])),Math.min(...n.map(t=>t[1])),Math.max(...n.map(t=>t[0])),Math.max(...n.map(t=>t[1]))]}function g(t,e){if(!t||!t.length)return null;const{index:n,id:i}=e;if(Array.isArray(t)){t=t[(r=i,Math.abs(r.split("").reduce((t,e)=>(t<<5)-t+e.charCodeAt(0)|0,0))%t.length)]}var r;let o=t;for(const t of Object.keys(n)){const e=new RegExp("{".concat(t,"}"),"g");o=o.replace(e,String(n[t]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(o=o.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),o}function m({viewport:t,z:e=0,cullRect:n}){return(t.subViewports||[t]).map(t=>function t(e,n,i){if(!Array.isArray(n)){const t=i.x-e.x,r=i.y-e.y,{width:o,height:s}=i,a={targetZ:n},c=e.unproject([t,r],a),l=e.unproject([t+o,r],a),u=e.unproject([t,r+s],a),d=e.unproject([t+o,r+s],a);return[Math.min(c[0],l[0],u[0],d[0]),Math.min(c[1],l[1],u[1],d[1]),Math.max(c[0],l[0],u[0],d[0]),Math.max(c[1],l[1],u[1],d[1])]}const r=t(e,n[0],i),o=t(e,n[1],i);return[Math.min(r[0],o[0]),Math.min(r[1],o[1]),Math.max(r[2],o[2]),Math.max(r[3],o[3])]}(t,e,n))}function v(t,e){return 512*Math.pow(2,t)/e}function b(t,e,n){const i=v(n,512),r=t/i*360-180,o=Math.PI-2*Math.PI*e/i;return[r,180/Math.PI*Math.atan(.5*(Math.exp(o)-Math.exp(-o)))]}function y(t,e,n,i){const r=v(n,i);return[t/r*512,e/r*512]}function x(t,e,n,i,r=512){if(t.isGeospatial){const[t,r]=b(e,n,i),[o,s]=b(e+1,n+1,i);return{west:t,north:r,east:o,south:s}}const[o,s]=y(e,n,i,r),[a,c]=y(e+1,n+1,i,r);return{left:o,top:s,right:a,bottom:c}}function _(t,e,n,i,r){const o=function(t,e,n){let i;if(e&&2===e.length){const[n,r]=e,o=t.getBounds({z:n}),s=t.getBounds({z:r});i=[Math.min(o[0],s[0]),Math.min(o[1],s[1]),Math.max(o[2],s[2]),Math.max(o[3],s[3])]}else i=t.getBounds();return t.isGeospatial?[Math.max(i[0],n[0]),Math.max(i[1],n[1]),Math.min(i[2],n[2]),Math.min(i[3],n[3])]:[Math.max(Math.min(i[0],n[2]),n[0]),Math.max(Math.min(i[1],n[3]),n[1]),Math.min(Math.max(i[2],n[0]),n[2]),Math.min(Math.max(i[3],n[1]),n[3])]}(t,null,i),s=v(e,n),[a,c,l,u]=function(t,e,n){if(n){return f(t,n).map(t=>t*e/512)}return t.map(t=>t*e/512)}(o,s,r),d=[];for(let t=Math.floor(a);t<l;t++)for(let n=Math.floor(c);n<u;n++)d.push({x:t,y:n,z:e});return d}function w({viewport:t,maxZoom:e,minZoom:n,zRange:i,extent:c,tileSize:l=512,modelMatrix:u,modelMatrixInverse:p,zoomOffset:g=0}){let m=t.isGeospatial?Math.round(t.zoom+Math.log2(512/l))+g:Math.ceil(t.zoom)+g;if("number"==typeof n&&Number.isFinite(n)&&m<n){if(!c)return[];m=n}"number"==typeof e&&Number.isFinite(e)&&m>e&&(m=e);let v=c;return u&&p&&c&&!t.isGeospatial&&(v=f(c,u)),t.isGeospatial?function(t,e,n,i){const c=t instanceof r.a&&t.resolution?t.projectPosition:null,l=Object.values(t.getFrustumPlanes()).map(({normal:t,distance:e})=>new s.c(t.clone().negate(),e)),u=new s.b(l),h=t.distanceScales.unitsPerMeter[2],p=n&&n[0]*h||0,f=n&&n[1]*h||0,g=t instanceof o.a&&t.pitch<=60?e:0;if(i){const[t,e,n,r]=i,o=Object(a.l)([t,r]),s=Object(a.l)([n,e]);i=[o[0],512-o[1],s[0],512-s[1]]}const m=new d(0,0,0),v={viewport:t,project:c,cullingVolume:u,elevationBounds:[p,f],minZ:g,maxZ:e,bounds:i,offset:0};if(m.update(v),t instanceof o.a&&t.subViewports&&t.subViewports.length>1){for(v.offset=-1;m.update(v)&&!(--v.offset<-3););for(v.offset=1;m.update(v)&&!(++v.offset>3););}return m.getSelected()}(t,m,i,c):_(t,m,l,v||h,p)}function O(t){return/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(t)}function P(t){return Number.isFinite(t.west)&&Number.isFinite(t.north)&&Number.isFinite(t.east)&&Number.isFinite(t.south)}},548:function(t,e,n){"use strict";n.r(e);var i=n(1383);n.d(e,"SimpleMeshLayer",(function(){return i.a}));var r=n(1377);n.d(e,"ScenegraphLayer",(function(){return r.a}))},557:function(t,e,n){"use strict";n.r(e),n.d(e,"_WMSLayer",(function(){return f})),n.d(e,"GreatCircleLayer",(function(){return m})),n.d(e,"S2Layer",(function(){return v.a})),n.d(e,"QuadkeyLayer",(function(){return x})),n.d(e,"TileLayer",(function(){return _.a})),n.d(e,"TripsLayer",(function(){return w.a})),n.d(e,"H3ClusterLayer",(function(){return C})),n.d(e,"H3HexagonLayer",(function(){return S.a})),n.d(e,"Tile3DLayer",(function(){return B})),n.d(e,"TerrainLayer",(function(){return X})),n.d(e,"MVTLayer",(function(){return Ot})),n.d(e,"GeohashLayer",(function(){return Lt})),n.d(e,"_GeoCellLayer",(function(){return b.a})),n.d(e,"_getURLFromTemplate",(function(){return H.c})),n.d(e,"_Tileset2D",(function(){return Tt.b})),n.d(e,"_Tile2DHeader",(function(){return Rt.a}));var i=n(3),r=n(531),o=n(178),s=n(52),a=n(1378),c=n(518),l=n(2186),u=n(61);const d=6378137*Math.PI;function h(t){const e=Object(u.l)(t);return e[0]=(e[0]/256-1)*d,e[1]=(e[1]/256-1)*d,e}const p={id:"imagery-layer",data:"",serviceType:"auto",srs:"auto",layers:{type:"array",compare:!0,value:[]},onMetadataLoad:{type:"function",value:()=>{}},onMetadataLoadError:{type:"function",value:console.error},onImageLoadStart:{type:"function",value:()=>{}},onImageLoad:{type:"function",value:()=>{}},onImageLoadError:{type:"function",compare:!1,value:(t,e)=>console.error(e,t)}};class f extends r.a{constructor(...t){super(...t),Object(i.a)(this,"state",void 0)}get isLoaded(){return Boolean(this.state)&&0===this.state.loadCounter&&super.isLoaded}shouldUpdateState(){return!0}initializeState(){this.state._nextRequestId=0,this.state.lastRequestId=-1,this.state.loadCounter=0}updateState({changeFlags:t,props:e,oldProps:n}){const{viewport:i}=this.context;t.dataChanged||e.serviceType!==n.serviceType?(this.state.imageSource=this._createImageSource(e),this._loadMetadata(),this.debounce(()=>this.loadImage(i,"image source changed"),0)):Object(o.a)(e.layers,n.layers,1)?t.viewportChanged&&this.debounce(()=>this.loadImage(i,"viewport changed")):this.debounce(()=>this.loadImage(i,"layers changed"),0)}finalizeState(){}renderLayers(){const{bounds:t,image:e,lastRequestParameters:n}=this.state;return e&&new a.a({...this.getSubLayerProps({id:"bitmap"}),_imageCoordinateSystem:"EPSG:4326"===n.srs?s.a.LNGLAT:s.a.CARTESIAN,bounds:t,image:e})}async getFeatureInfoText(t,e){const{lastRequestParameters:n}=this.state;if(n){var i,r;return await(null===(i=(r=this.state.imageSource).getFeatureInfoText)||void 0===i?void 0:i.call(r,{...n,query_layers:n.layers,x:t,y:e,info_format:"application/vnd.ogc.gml"}))}return""}_createImageSource(t){if(t.data instanceof c.a)return t.data;if("string"==typeof t.data)return Object(l.a)({url:t.data,loadOptions:t.loadOptions,type:t.serviceType});throw new Error("invalid image source in props.data")}async _loadMetadata(){const{imageSource:t}=this.state;try{this.state.loadCounter++;const n=await t.getMetadata();var e;if(this.state.imageSource===t)null===(e=this.getCurrentLayer())||void 0===e||e.props.onMetadataLoad(n)}catch(t){var n;null===(n=this.getCurrentLayer())||void 0===n||n.props.onMetadataLoadError(t)}finally{this.state.loadCounter--}}async loadImage(t,e){const{layers:n,serviceType:i}=this.props;if("wms"===i&&0===n.length)return;const r=t.getBounds(),{width:o,height:s}=t,a=this.getRequestId();let{srs:c}=this.props;"auto"===c&&(c=t.resolution?"EPSG:4326":"EPSG:3857");const l={width:o,height:s,bbox:r,layers:n,srs:c};if("EPSG:3857"===c){const[t,e]=h([r[0],r[1]]),[n,i]=h([r[2],r[3]]);l.bbox=[t,e,n,i]}try{this.state.loadCounter++,this.props.onImageLoadStart(a);const t=await this.state.imageSource.getImage(l);var u;if(this.state.lastRequestId<a)null===(u=this.getCurrentLayer())||void 0===u||u.props.onImageLoad(a),this.setState({image:t,bounds:r,lastRequestParameters:l,lastRequestId:a})}catch(t){var d;this.raiseError(t,"Load image"),null===(d=this.getCurrentLayer())||void 0===d||d.props.onImageLoadError(a,t)}finally{this.state.loadCounter--}}getRequestId(){return this.state._nextRequestId++}debounce(t,e=500){clearTimeout(this.state._timeoutId),this.state._timeoutId=setTimeout(()=>t(),e)}}Object(i.a)(f,"layerName","WMSLayer"),Object(i.a)(f,"defaultProps",p);var g=n(1379);class m extends g.a{}Object(i.a)(m,"layerName","GreatCircleLayer"),Object(i.a)(m,"defaultProps",{getHeight:{type:"accessor",value:0},greatCircle:!0});var v=n(1381),b=n(273);function y(t,e=1){const[n,i]=function(t,e){let n=0,i=0,r=1<<t.length;const o=r/512;for(let e=0;e<t.length;e++){r>>=1;const o=parseInt(t[e]);o%2&&(n|=r),o>1&&(i|=r)}return[[n/o,512-i/o],[(n+e)/o,512-(i+e)/o]]}(t,e),[r,o]=Object(u.p)(n),[s,a]=Object(u.p)(i);return[s,o,s,a,r,a,r,o,s,o]}class x extends b.a{indexToBounds(){const{data:t,extruded:e,getQuadkey:n}=this.props,i=e?.99:1;return{data:t,_normalize:!1,positionFormat:"XY",getPolygon:(t,e)=>y(n(t,e),i),updateTriggers:{getPolygon:i}}}}Object(i.a)(x,"layerName","QuadkeyLayer"),Object(i.a)(x,"defaultProps",{getQuadkey:{type:"accessor",value:t=>t.quadkey}});var _=n(403),w=n(1165),O=n(227),P=n(196),S=n(667);class C extends b.a{initializeState(){S.a._checkH3Lib()}updateState({props:t,changeFlags:e}){if(e.dataChanged||e.updateTriggersChanged&&e.updateTriggersChanged.getHexagons){const{data:e,getHexagons:n}=t,i=[],{iterable:r,objectInfo:o}=Object(P.a)(e);for(const t of r){o.index++;const e=n(t,o),r=Object(O.h3SetToMultiPolygon)(e,!0);for(const e of r)i.push(this.getSubLayerRow({polygon:e},t,o.index))}this.setState({polygons:i})}}indexToBounds(){const{getElevation:t,getFillColor:e,getLineColor:n,getLineWidth:i}=this.props;return{data:this.state.polygons,getPolygon:t=>t.polygon,getElevation:this.getSubLayerAccessor(t),getFillColor:this.getSubLayerAccessor(e),getLineColor:this.getSubLayerAccessor(n),getLineWidth:this.getSubLayerAccessor(i)}}}Object(i.a)(C,"layerName","H3ClusterLayer"),Object(i.a)(C,"defaultProps",{getHexagons:{type:"accessor",value:t=>t.hexagons}});var j=n(237),M=n(68),E=n(1382),L=n(1377),T=n(1417),R=n(2211),A=n(798),I=n(1383);class k extends I.a{getShaders(){const t=super.getShaders();return t.modules.push(R.a),{...t,vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nuniform bool pickFeatureIds;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec4 uvRegions;\nin vec3 featureIdsPickingColors;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvec2 applyUVRegion(vec2 uv) {\n  #ifdef HAS_UV_REGIONS\n    return fract(uv) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;\n  #else\n    return uv;\n  #endif\n}\n\nvoid main(void) {\n  vec2 uv = applyUVRegion(texCoords);\n  geometry.uv = uv;\n\n  if (pickFeatureIds) {\n    geometry.pickingColor = featureIdsPickingColors;\n  } else {\n    geometry.pickingColor = instancePickingColors;\n  }\n\n  vTexCoord = uv;\n  cameraPosition = project_uCameraPosition;\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale;\n  vec3 projectedPosition = project_position(positions);\n  position_commonspace = vec4(projectedPosition, 1.0);\n  gl_Position = project_common_position_to_clipspace(position_commonspace);\n\n  geometry.position = position_commonspace;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  geometry.normal = normals_commonspace;\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n    #ifdef HAS_NORMALS\n      pbr_vNormal = geometry.normal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = uv;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  \n#ifdef MODULE_PBR\n\n  fragColor = vColor * pbr_filterColor(vec4(0));\n  geometry.uv = pbr_vUV;\n  fragColor.a *= opacity;\n\n#else\n\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n#endif\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n"}}initializeState(){const{featureIds:t}=this.props;super.initializeState();const e=this.getAttributeManager();t&&e.add({featureIdsPickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;e.pbrMaterial!==n.pbrMaterial&&this.updatePbrMaterialUniforms(e.pbrMaterial)}draw(t){const{featureIds:e}=this.props;this.state.model&&(this.state.model.setUniforms({u_Camera:this.state.model.getUniforms().project_uCameraPosition,pickFeatureIds:Boolean(e)}),super.draw(t))}getModel(t){const{id:e,pbrMaterial:n}=this.props,i=this.parseMaterial(n,t);this.setState({materialParser:i});const r=this.getShaders();var o;(o=t.attributes).COLOR_0||o.colors||(o.colors={constant:!0,value:new Float32Array([1,1,1])});return new A.a(this.context.gl,{...this.getShaders(),id:e,geometry:t,defines:{...r.defines,...null==i?void 0:i.defines,HAS_UV_REGIONS:t.attributes.uvRegions},parameters:null==i?void 0:i.parameters,isInstanced:!0})}updatePbrMaterialUniforms(t){const{model:e}=this.state;if(e){const{mesh:n}=this.props,i=this.parseMaterial(t,n);this.setState({materialParser:i}),e.setUniforms(i.uniforms)}}parseMaterial(t,e){var n;const i=Boolean(t.pbrMetallicRoughness&&t.pbrMetallicRoughness.baseColorTexture);return null===(n=this.state.materialParser)||void 0===n||n.delete(),new T.a(this.context.gl,{attributes:{NORMAL:e.attributes.normals,TEXCOORD_0:e.attributes.texCoords},material:{unlit:i,...t},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1})}calculateFeatureIdsPickingColors(t){const e=this.props.featureIds,n=new Uint8ClampedArray(e.length*t.size),i=[];for(let t=0;t<e.length;t++)this.encodePickingColor(e[t],i),n[3*t]=i[0],n[3*t+1]=i[1],n[3*t+2]=i[2];t.value=n}finalizeState(t){var e;super.finalizeState(t),null===(e=this.state.materialParser)||void 0===e||e.delete(),this.setState({materialParser:null})}}Object(i.a)(k,"layerName","MeshLayer"),Object(i.a)(k,"defaultProps",{pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}});var z=n(2160),D=n(2184),F=n(90),N=n(2182);const V=[0],U={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:"",loader:N.a,onTilesetLoad:{type:"function",value:t=>{}},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:(t,e,n)=>{}},_getMeshColor:{type:"function",value:t=>[255,255,255]}};class B extends r.a{constructor(...t){super(...t),Object(i.a)(this,"state",void 0)}initializeState(){"onTileLoadFail"in this.props&&M.a.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}get isLoaded(){const{tileset3d:t}=this.state;return null!==t&&t.isLoaded()}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState({props:t,oldProps:e,changeFlags:n}){if(t.data&&t.data!==e.data&&this._loadTileset(t.data),n.viewportChanged){const{activeViewports:t}=this.state;Object.keys(t).length&&(this._updateTileset(t),this.state.lastUpdatedViewports=t,this.state.activeViewports={})}if(n.propsChanged){const{layerMap:t}=this.state;for(const e in t)t[e].needsUpdate=!0}}activateViewport(t){const{activeViewports:e,lastUpdatedViewports:n}=this.state;this.internalState.viewport=t,e[t.id]=t;const i=null==n?void 0:n[t.id];i&&t.equals(i)||(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}getPickingInfo({info:t,sourceLayer:e}){const n=e&&e.props.tile;return t.picked&&(t.object=n),t.sourceTile=n,t}filterSubLayer({layer:t,viewport:e}){const{tile:n}=t.props,{id:i}=e;return n.selected&&n.viewportIds.includes(i)}_updateAutoHighlight(t){const e=t.sourceTile,n=this.state.layerMap[null==e?void 0:e.id];n&&n.layer&&n.layer.updateAutoHighlight(t)}async _loadTileset(t){const{loadOptions:e={}}=this.props;let n=this.props.loader||this.props.loaders;Array.isArray(n)&&(n=n[0]);const i={loadOptions:{...e}};let r=t;if(n.preload){const o=await n.preload(t,e);o.url&&(r=o.url),o.headers&&(i.loadOptions.fetch={...i.loadOptions.fetch,headers:o.headers}),Object.assign(i,o)}const o=await Object(z.a)(r,n,i.loadOptions),s=new D.a(o,{onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileError:this.props.onTileError,...i});this.setState({tileset3d:s,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(s)}_onTileLoad(t){const{lastUpdatedViewports:e}=this.state;this.props.onTileLoad(t),this._updateTileset(e),this.setNeedsUpdate()}_onTileUnload(t){delete this.state.layerMap[t.id],this.props.onTileUnload(t)}_updateTileset(t){if(!t)return;const{tileset3d:e}=this.state,{timeline:n}=this.context,i=Object.keys(t).length;n&&i&&e&&e.selectTiles(Object.values(t)).then(t=>{this.state.frameNumber!==t&&this.setState({frameNumber:t})})}_getSubLayer(t,e){if(!t.content)return null;switch(t.type){case F.f.POINTCLOUD:return this._makePointCloudLayer(t,e);case F.f.SCENEGRAPH:return this._make3DModelLayer(t);case F.f.MESH:return this._makeSimpleMeshLayer(t,e);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(t.content.type))}}_makePointCloudLayer(t,e){const{attributes:n,pointCount:i,constantRGBA:r,cartographicOrigin:o,modelMatrix:a}=t.content,{positions:c,normals:l,colors:u}=n;if(!c)return null;const d=e&&e.props.data||{header:{vertexCount:i},attributes:{POSITION:c,NORMAL:l,COLOR_0:u}},{pointSize:h,getPointColor:p}=this.props;return new(this.getSubLayerClass("pointcloud",E.a))({pointSize:h},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(t.id),tile:t,data:d,coordinateSystem:s.a.METER_OFFSETS,coordinateOrigin:o,modelMatrix:a,getColor:r||p,_offset:0})}_make3DModelLayer(t){const{gltf:e,instances:n,cartographicOrigin:i,modelMatrix:r}=t.content;return new(this.getSubLayerClass("scenegraph",L.a))({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(t.id),tile:t,data:n||V,scenegraph:e,coordinateSystem:s.a.METER_OFFSETS,coordinateOrigin:i,modelMatrix:r,getTransformMatrix:t=>t.modelMatrix,getPosition:[0,0,0],_offset:0})}_makeSimpleMeshLayer(t,e){const n=t.content,{attributes:i,indices:r,modelMatrix:o,cartographicOrigin:a,coordinateSystem:c=s.a.METER_OFFSETS,material:l,featureIds:u}=n,{_getMeshColor:d}=this.props,h=e&&e.props.mesh||new j.a({drawMode:4,attributes:W(i),indices:r});return new(this.getSubLayerClass("mesh",k))(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(t.id),tile:t,mesh:h,data:V,getColor:d(t),pbrMaterial:l,modelMatrix:o,coordinateOrigin:a,coordinateSystem:c,featureIds:u,_offset:0})}renderLayers(){const{tileset3d:t,layerMap:e}=this.state;return t?t.tiles.map(t=>{const n=e[t.id]=e[t.id]||{tile:t};let{layer:i}=n;return t.selected&&(i?n.needsUpdate&&(i=this._getSubLayer(t,i),n.needsUpdate=!1):i=this._getSubLayer(t)),n.layer=i,i}).filter(Boolean):null}}function W(t){const e={};return e.positions={...t.positions,value:new Float32Array(t.positions.value)},t.normals&&(e.normals=t.normals),t.texCoords&&(e.texCoords=t.texCoords),t.colors&&(e.colors=t.colors),t.uvRegions&&(e.uvRegions=t.uvRegions),e}Object(i.a)(B,"defaultProps",U),Object(i.a)(B,"layerName","Tile3DLayer");var G=n(2217),H=n(542);const Z=[1],q={..._.a.defaultProps,elevationData:H.h,texture:{...H.h,optional:!0},meshMaxError:{type:"number",value:4},bounds:{type:"array",value:null,optional:!0,compare:!0},color:{type:"color",value:[255,255,255]},elevationDecoder:{type:"object",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:"",wireframe:!1,material:!0,loaders:[G.a]};function K(t){return Array.isArray(t)?t.join(";"):t||""}class X extends r.a{constructor(...t){super(...t),Object(i.a)(this,"state",void 0)}updateState({props:t,oldProps:e}){const n=t.elevationData!==e.elevationData;if(n){const{elevationData:e}=t,n=e&&(Array.isArray(e)||e.includes("{x}")&&e.includes("{y}"));this.setState({isTiled:n})}const i=n||t.meshMaxError!==e.meshMaxError||t.elevationDecoder!==e.elevationDecoder||t.bounds!==e.bounds;if(!this.state.isTiled&&i){const e=this.loadTerrain(t);this.setState({terrain:e})}t.workerUrl&&M.a.removed("workerUrl","loadOptions.terrain.workerUrl")()}loadTerrain({elevationData:t,bounds:e,elevationDecoder:n,meshMaxError:i,signal:r}){var o;if(!t)return null;let s=this.getLoadOptions();s={...s,terrain:{skirtHeight:this.state.isTiled?2*i:0,...null===(o=s)||void 0===o?void 0:o.terrain,bounds:e,meshMaxError:i,elevationDecoder:n}};const{fetch:a}=this.props;return a(t,{propName:"elevationData",layer:this,loadOptions:s,signal:r})}getTiledTerrainData(t){const{elevationData:e,fetch:n,texture:i,elevationDecoder:r,meshMaxError:o}=this.props,{viewport:s}=this.context,a=Object(H.c)(e,t),c=i&&Object(H.c)(i,t),{signal:l}=t;let u=[0,0],d=[0,0];if(s.isGeospatial){const e=t.bbox;u=s.projectFlat([e.west,e.south]),d=s.projectFlat([e.east,e.north])}else{const e=t.bbox;u=[e.left,e.bottom],d=[e.right,e.top]}const h=[u[0],u[1],d[0],d[1]],p=this.loadTerrain({elevationData:a,bounds:h,elevationDecoder:r,meshMaxError:o,signal:l}),f=c?n(c,{propName:"texture",layer:this,loaders:[],signal:l}).catch(t=>null):Promise.resolve(null);return Promise.all([p,f])}renderSubLayers(t){const e=this.getSubLayerClass("mesh",I.a),{color:n,wireframe:i,material:r}=this.props,{data:o}=t;if(!o)return null;const[a,c]=o;return new e(t,{data:Z,mesh:a,texture:c,_instanced:!1,coordinateSystem:s.a.CARTESIAN,getPosition:t=>[0,0,0],getColor:n,wireframe:i,material:r})}onViewportLoad(t){if(!t)return;const{zRange:e}=this.state,n=t.map(t=>t.content).filter(Boolean).map(t=>t[0].header.boundingBox.map(t=>t[2]));if(0===n.length)return;const i=Math.min(...n.map(t=>t[0])),r=Math.max(...n.map(t=>t[1]));(!e||i<e[0]||r>e[1])&&this.setState({zRange:[i,r]})}renderLayers(){const{color:t,material:e,elevationData:n,texture:i,wireframe:r,meshMaxError:o,elevationDecoder:s,tileSize:a,maxZoom:c,minZoom:l,extent:u,maxRequests:d,onTileLoad:h,onTileUnload:p,onTileError:f,maxCacheSize:g,maxCacheByteSize:m,refinementStrategy:v}=this.props;if(this.state.isTiled)return new _.a(this.getSubLayerProps({id:"tiles"}),{getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:K(n),texture:K(i),meshMaxError:o,elevationDecoder:s}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null,tileSize:a,maxZoom:c,minZoom:l,extent:u,maxRequests:d,onTileLoad:h,onTileUnload:p,onTileError:f,maxCacheSize:g,maxCacheByteSize:m,refinementStrategy:v});return new(this.getSubLayerClass("mesh",I.a))(this.getSubLayerProps({id:"mesh"}),{data:Z,mesh:this.state.terrain,texture:i,_instanced:!1,getPosition:t=>[0,0,0],getColor:t,material:e,wireframe:r})}}Object(i.a)(X,"defaultProps",q),Object(i.a)(X,"layerName","TerrainLayer");var Y=n(936),J=n(1156);const Q={clipBounds:[0,0,1,1],clipByInstance:void 0},$="\nuniform vec4 clip_bounds;\n\nbool clip_isInBounds(vec2 position) {\n  return position.x >= clip_bounds[0] && position.y >= clip_bounds[1] && position.x < clip_bounds[2] && position.y < clip_bounds[3];\n}\n",tt={name:"clip-vs",vs:$},et={"vs:#decl":"\nvarying float clip_isVisible;\n","vs:DECKGL_FILTER_GL_POSITION":"\n  clip_isVisible = float(clip_isInBounds(geometry.worldPosition.xy));\n","fs:#decl":"\nvarying float clip_isVisible;\n","fs:DECKGL_FILTER_COLOR":"\n  if (clip_isVisible < 0.5) discard;\n"},nt={name:"clip-fs",fs:$},it={"vs:#decl":"\nvarying vec2 clip_commonPosition;\n","vs:DECKGL_FILTER_GL_POSITION":"\n  clip_commonPosition = geometry.position.xy;\n","fs:#decl":"\nvarying vec2 clip_commonPosition;\n","fs:DECKGL_FILTER_COLOR":"\n  if (!clip_isInBounds(clip_commonPosition)) discard;\n"};class rt extends J.a{getShaders(){let t="instancePositions"in this.getAttributeManager().attributes;return void 0!==this.props.clipByInstance&&(t=Boolean(this.props.clipByInstance)),this.state.clipByInstance=t,t?{modules:[tt],inject:et}:{modules:[nt],inject:it}}draw({uniforms:t}){const{clipBounds:e}=this.props;if(this.state.clipByInstance)t.clip_bounds=e;else{const n=this.projectPosition([e[0],e[1],0]),i=this.projectPosition([e[2],e[3],0]);t.clip_bounds=[Math.min(n[0],i[0]),Math.min(n[1],i[1]),Math.max(n[0],i[0]),Math.max(n[1],i[1])]}}}Object(i.a)(rt,"defaultProps",Q),Object(i.a)(rt,"extensionName","ClipExtension");var ot=n(2197),st=n(2194);function at(t,e){const n=null==e?void 0:e.globalFeatureId;return void 0!==n?function(t,e){const n=ut(t);for(const t of n){let n=0,i=t.featureIds.value[0];for(let r=0;r<t.featureIds.value.length;r++){const o=t.featureIds.value[r];if(o!==i){if(e===t.globalFeatureIds.value[n])return dt(t,n,r);n=r,i=o}}if(e===t.globalFeatureIds.value[n])return dt(t,n,t.featureIds.value.length)}throw new Error("featureId:".concat(e," not found"))}(t,n):ct(t,null==e?void 0:e.type)}function ct(t,e){return function(t){const e=[];for(const n of t){if(0===n.featureIds.value.length)continue;let t=0,i=n.featureIds.value[0];for(let r=0;r<n.featureIds.value.length;r++){const o=n.featureIds.value[r];o!==i&&(e.push(dt(n,t,r)),t=r,i=o)}e.push(dt(n,t,n.featureIds.value.length))}return e}(ut(t,e))}function lt(t,e,n){switch(t.type){case"Point":return function(t,e,n){const{positions:i}=t,r=ht(i,e,n);if(r.length>1)return{type:"MultiPoint",coordinates:r};return{type:"Point",coordinates:r[0]}}(t,e,n);case"LineString":return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1/0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;const{positions:i}=t,r=t.pathIndices.value.filter(t=>t>=e&&t<=n),o=r.length>2;if(!o){return{type:"LineString",coordinates:ht(i,r[0],r[1])}}const s=[];for(let t=0;t<r.length-1;t++){const e=ht(i,r[t],r[t+1]);s.push(e)}return{type:"MultiLineString",coordinates:s}}(t,e,n);case"Polygon":return function t(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1/0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;const{positions:r}=e,o=e.polygonIndices.value.filter(t=>t>=n&&t<=i),s=e.primitivePolygonIndices.value.filter(t=>t>=n&&t<=i),a=o.length>2;if(!a){const t=[];for(let e=0;e<s.length-1;e++){const n=s[e],i=s[e+1],o=ht(r,n,i);t.push(o)}return{type:"Polygon",coordinates:t}}const c=[];for(let n=0;n<o.length-1;n++){const i=o[n],r=o[n+1],s=t(e,i,r).coordinates;c.push(s)}return{type:"MultiPolygon",coordinates:c}}(t,e,n);default:const i=t;throw new Error("Unsupported geometry type: ".concat(null==i?void 0:i.type))}}function ut(t,e){if(!Boolean(t.points||t.lines||t.polygons))return t.type=e||function(t){if(t.pathIndices)return"LineString";if(t.polygonIndices)return"Polygon";return"Point"}(t),[t];const n=[];return t.points&&(t.points.type="Point",n.push(t.points)),t.lines&&(t.lines.type="LineString",n.push(t.lines)),t.polygons&&(t.polygons.type="Polygon",n.push(t.polygons)),n}function dt(t,e,n){return{type:"Feature",geometry:lt(t,e,n),properties:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Object.assign({},t.properties[t.featureIds.value[e]]);for(const i in t.numericProps)n[i]=t.numericProps[i].value[e];return n}(t,e,n),...function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.fields&&t.fields[t.featureIds.value[e]]}(t,e,n)}}function ht(t,e,n){e=e||0,n=n||t.value.length/t.size;const i=[];for(let r=e;r<n;r++){const e=Array();for(let n=r*t.size;n<(r+1)*t.size;n++)e.push(Number(t.value[n]));i.push(e)}return i}var pt=n(245);const ft={Point:gt,MultiPoint:function(t,e,n){return mt(t,e,n)},LineString:vt,MultiLineString:function(t,e,n){return t.map(t=>vt(t,e,n))},Polygon:bt,MultiPolygon:function(t,e,n){return t.map(t=>bt(t,e,n))}};function gt([t,e],[n,i],r){const o=Object(pt.e)(n[0],i[0],t),s=Object(pt.e)(n[1],i[1],e);return r.unprojectFlat([o,s])}function mt(t,e,n){return t.map(t=>gt(t,e,n))}function vt(t,e,n){return mt(t,e,n)}function bt(t,e,n){return t.map(t=>mt(t,e,n))}const yt=["points","lines","polygons"];function xt(t,e,n,i){const r=t.featureIds.value;if(!r.length)return-1;let o=0,s=r[r.length-1]+1;if(i){const e=function(t,e){if(!t.__layers){const e={},{properties:n}=t;for(let t=0;t<n.length;t++){const{layerName:i}=n[t];i&&(e[i]?e[i][1]=t:e[i]=[t,t])}t.__layers=e}return t.__layers[e]}(t,i);if(!e)return-1;o=e[0],s=e[1]+1}let a=-1;if(e in t.numericProps){const i=t.numericProps[e].value.findIndex((t,e)=>t===n&&r[e]>=o&&r[e]<s);return i>=0?t.globalFeatureIds.value[i]:-1}return e?a=_t(t.properties,t=>t[e]===n,o,s):t.fields&&(a=_t(t.fields,t=>t.id===n,o,s)),a>=0?function(t,e){if(!t.__ids){const e=[],n=t.featureIds.value,i=t.globalFeatureIds.value;for(let t=0;t<n.length;t++)e[n[t]]=i[t];t.__ids=e}return t.__ids[e]}(t,a):-1}function _t(t,e,n,i){for(let r=n;r<i;r++)if(e(t[r],r))return r;return-1}const wt={...Y.a.defaultProps,data:H.h,onDataLoad:{type:"function",value:null,optional:!0,compare:!1},uniqueIdProperty:"",highlightedFeatureId:null,loaders:[st.a],binary:!0};class Ot extends _.a{initializeState(){super.initializeState();const t=void 0===this.context.viewport.resolution&&this.props.binary;this.setState({binary:t,data:null,tileJSON:null})}get isLoaded(){return this.state&&this.state.data&&this.state.tileset&&super.isLoaded}updateState({props:t,oldProps:e,context:n,changeFlags:i}){var r;i.dataChanged&&this._updateTileData(),null!==(r=this.state)&&void 0!==r&&r.data&&(super.updateState({props:t,oldProps:e,context:n,changeFlags:i}),this._setWGS84PropertyForTiles());const{highlightColor:o}=t;o!==e.highlightColor&&Array.isArray(o)&&this.setState({highlightColor:o})}async _updateTileData(){let t=this.props.data,e=null;if("string"!=typeof t||Object(H.e)(t))t.tilejson&&(e=t);else{const{onDataLoad:n,fetch:i}=this.props;this.setState({data:null,tileJSON:null});try{e=await i(t,{propName:"data",layer:this,loaders:[]})}catch(e){this.raiseError(e,"loading TileJSON"),t=null}n&&n(e,{propName:"data",layer:this})}e&&(t=e.tiles),this.setState({data:t,tileJSON:e})}_getTilesetOptions(){const t=super._getTilesetOptions(),e=this.state.tileJSON,{minZoom:n,maxZoom:i}=this.props;return e&&(Number.isFinite(e.minzoom)&&e.minzoom>n&&(t.minZoom=e.minzoom),Number.isFinite(e.maxzoom)&&(!Number.isFinite(i)||e.maxzoom<i)&&(t.maxZoom=e.maxzoom)),t}renderLayers(){var t;return null!==(t=this.state)&&void 0!==t&&t.data?super.renderLayers():null}getTileData(t){var e;const{data:n,binary:i}=this.state,{index:r,signal:o}=t,s=Object(H.c)(n,t);if(!s)return Promise.reject("Invalid URL");let a=this.getLoadOptions();const{fetch:c}=this.props;return a={...a,mimeType:"application/x-protobuf",mvt:{...null===(e=a)||void 0===e?void 0:e.mvt,coordinates:this.context.viewport.resolution?"wgs84":"local",tileIndex:r},gis:i?{format:"binary"}:{}},c(s,{propName:"data",layer:this,loadOptions:a,signal:o})}renderSubLayers(t){const{x:e,y:n,z:i}=t.tile.index,r=Math.pow(2,i),o=512/r,a=-o,c=512*e/r,l=512*(1-n/r),u=(new ot.a).scale([o,a,1]);t.autoHighlight=!1,this.context.viewport.resolution||(t.modelMatrix=u,t.coordinateOrigin=[c,l,0],t.coordinateSystem=s.a.CARTESIAN,t.extensions=[...t.extensions||[],new rt]);const d=super.renderSubLayers(t);return!this.state.binary||d instanceof Y.a||M.a.warn("renderSubLayers() must return GeoJsonLayer when using binary:true")(),d}_updateAutoHighlight(t){const{uniqueIdProperty:e}=this.props,{hoveredFeatureId:n,hoveredFeatureLayerName:i}=this.state,r=t.object;let o,s;r&&(o=Pt(r,e),s=St(r));let{highlightColor:a}=this.props;"function"==typeof a&&(a=a(t)),n===o&&i===s||this.setState({highlightColor:a,hoveredFeatureId:o,hoveredFeatureLayerName:s})}getPickingInfo(t){const e=super.getPickingInfo(t),n=Boolean(this.context.viewport.resolution);if(this.state.binary&&-1!==e.index){const{data:n}=t.sourceLayer.props;e.object=at(n,{globalFeatureId:e.index})}return e.object&&!n&&(e.object=jt(e.object,e.tile.bbox,this.context.viewport)),e}getSubLayerPropsByTile(t){return{highlightedObjectIndex:this.getHighlightedObjectIndex(t),highlightColor:this.state.highlightColor}}getHighlightedObjectIndex(t){const{hoveredFeatureId:e,hoveredFeatureLayerName:n,binary:i}=this.state,{uniqueIdProperty:r,highlightedFeatureId:o}=this.props,s=t.content,a=Ct(o);if(!(Ct(e)||a))return-1;const c=a?o:e;return Array.isArray(s)?s.findIndex(t=>{const e=Pt(t,r)===c,i=a||St(t)===n;return e&&i}):s&&i?function(t,e,n,i){for(const r of yt){const o=t[r]&&xt(t[r],e,n,i);if(o>=0)return o}return-1}(s,r,c,a?"":n):-1}_pickObjects(t){const{deck:e,viewport:n}=this.context,i=n.width,r=n.height,o=n.x,s=n.y,a=[this.id];return e.pickObjects({x:o,y:s,width:i,height:r,layerIds:a,maxObjects:t})}getRenderedFeatures(t=null){const e=this._pickObjects(t),n=new Set,i=[];for(const t of e){const e=Pt(t.object,this.props.uniqueIdProperty);void 0===e?i.push(t.object):n.has(e)||(n.add(e),i.push(t.object))}return i}_setWGS84PropertyForTiles(){this.state.tileset.selectedTiles.forEach(t=>{t.hasOwnProperty("dataInWGS84")||Object.defineProperty(t,"dataInWGS84",{get:()=>{if(!t.content)return null;if(this.state.binary&&Array.isArray(t.content)&&!t.content.length)return[];const{bbox:e}=t;if(void 0===t._contentWGS84&&Object(H.d)(e)){const n=this.state.binary?at(t.content):t.content;t._contentWGS84=n.map(t=>jt(t,e,this.context.viewport))}return t._contentWGS84}})})}}function Pt(t,e){return t.properties&&e?t.properties[e]:"id"in t?t.id:void 0}function St(t){var e;return(null===(e=t.properties)||void 0===e?void 0:e.layerName)||null}function Ct(t){return null!=t&&""!==t}function jt(t,e,n){const i={...t,geometry:{type:t.geometry.type}};return Object.defineProperty(i.geometry,"coordinates",{get:()=>function(t,e,n){const i=[n.projectFlat([e.west,e.north]),n.projectFlat([e.east,e.south])];return{...t,coordinates:ft[t.type](t.coordinates,i,n)}}(t.geometry,e,n).coordinates}),i}Object(i.a)(Ot,"layerName","MVTLayer"),Object(i.a)(Ot,"defaultProps",wt);const Mt={};for(let t=0;t<"0123456789bcdefghjkmnpqrstuvwxyz".length;t++)Mt["0123456789bcdefghjkmnpqrstuvwxyz".charAt(t)]=t;function Et(t){const[e,n,i,r]=function(t){let e,n=!0,i=90,r=-90,o=180,s=-180,a=0;for(let c=0,l=t.length;c<l;c++){const l=t[c].toLowerCase();a=Mt[l];for(let t=4;t>=0;t--){const c=a>>t&1;n?(e=(o+s)/2,1===c?s=e:o=e):(e=(i+r)/2,1===c?r=e:i=e),n=!n}}return[r,s,i,o]}(t);return[r,i,r,e,n,e,n,i,r,i]}class Lt extends b.a{indexToBounds(){const{data:t,getGeohash:e}=this.props;return{data:t,_normalize:!1,positionFormat:"XY",getPolygon:(t,n)=>Et(e(t,n))}}}Object(i.a)(Lt,"layerName","GeohashLayer"),Object(i.a)(Lt,"defaultProps",{getGeohash:{type:"accessor",value:t=>t.geohash}});var Tt=n(1463),Rt=n(1412)},568:function(t,e,n){"use strict";var i=n(0),r=n(1375);var o="undefined"!=typeof window?i.useLayoutEffect:i.useEffect;function s(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}var a=n(236),c=n(747);const l={position:"absolute",zIndex:-1};function u(t,e){if("function"==typeof t)return t(e);if(Array.isArray(t))return t.map(t=>u(t,e));if(d(t)){if(null===(n=t.props)||void 0===n?void 0:n.mapStyle)return e.style=l,Object(i.cloneElement)(t,e);if(function(t){const e=t.type;return e&&e.deckGLViewProps}(t))return Object(i.cloneElement)(t,e)}var n;return t}function d(t){return t&&"object"==typeof t&&"type"in t||!1}function h(t){if("function"==typeof t)return Object(i.createElement)(a.a,{},t);if(Array.isArray(t))return t.map(h);if(d(t)){if(t.type===i.Fragment)return h(t.props.children);if(s(t.type,a.a))return t}return t}const p={mixBlendMode:null};function f(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}const g=Object(i.forwardRef)((t,e)=>{const[n,l]=Object(i.useState)(0),g=Object(i.useRef)({control:null,version:n,forceUpdate:()=>l(t=>t+1)}).current,m=Object(i.useRef)(null),v=Object(i.useRef)(null),b=Object(i.useMemo)(()=>function({children:t,layers:e=[],views:n=null}){const r=[],o=[],l={};return i.Children.forEach(h(t),t=>{if(d(t)){const e=t.type;if(s(e,c.a)){const n=function(t,e){const n={},i=t.defaultProps||{};for(const t in e)i[t]!==e[t]&&(n[t]=e[t]);return new t(n)}(e,t.props);o.push(n)}else r.push(t);if(s(e,a.a)&&e!==a.a&&t.props.id){const n=new e(t.props);l[n.id]=n}}else t&&r.push(t)}),Object.keys(l).length>0&&(Array.isArray(n)?n.forEach(t=>{l[t.id]=t}):n&&(l[n.id]=n),n=Object.values(l)),{layers:e=o.length>0?[...o,...e]:e,children:r,views:n}}(t),[t.layers,t.views,t.children]);let y=!0;const x=e=>{var n;return y&&t.viewState?(g.viewStateUpdateRequested=e,null):(g.viewStateUpdateRequested=null,null===(n=t.onViewStateChange)||void 0===n?void 0:n.call(t,e))},_=e=>{var n;y?g.interactionStateUpdateRequested=e:(g.interactionStateUpdateRequested=null,null===(n=t.onInteractionStateChange)||void 0===n||n.call(t,e))},w=Object(i.useMemo)(()=>{const e={...t,style:null,width:"100%",height:"100%",parent:m.current,canvas:v.current,layers:b.layers,views:b.views,onViewStateChange:x,onInteractionStateChange:_};return delete e._customRender,g.deck&&g.deck.setProps(e),e},[t]);Object(i.useEffect)(()=>{const e=t.Deck||r.a;return g.deck=function(t,e,n){const i=new e({...n,_customRender:e=>{t.redrawReason=e;const n=i.getViewports();t.lastRenderedViewports!==n?t.forceUpdate():f(t)}});return i}(g,e,{...w,parent:m.current,canvas:v.current}),()=>{var t;return null===(t=g.deck)||void 0===t?void 0:t.finalize()}},[]),o(()=>{f(g);const{viewStateUpdateRequested:t,interactionStateUpdateRequested:e}=g;t&&x(t),e&&_(e)}),Object(i.useImperativeHandle)(e,()=>function(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}(g),[]);const O=g.deck&&g.deck.isInitialized?g.deck.getViewports():void 0,{ContextProvider:P,width:S,height:C,id:j,style:M}=t,{containerStyle:E,canvasStyle:L}=Object(i.useMemo)(()=>function({width:t,height:e,style:n}){const i={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},r={left:0,top:0};if(n)for(const t in n)t in p?r[t]=n[t]:i[t]=n[t];return{containerStyle:i,canvasStyle:r}}({width:S,height:C,style:M}),[S,C,M]);if(!g.viewStateUpdateRequested&&g.lastRenderedViewports===O||g.version!==n){g.lastRenderedViewports=O,g.version=n;const t=function({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const o={},c=r.views[0].id;for(const e of t){let t=c,n=e;d(e)&&s(e.type,a.a)&&(t=e.props.id||c,n=e.props.children);const i=r.getViewport(t),l=r.getViewState(t);if(i){l.padding=i.padding;const{x:e,y:r,width:s,height:a}=i;n=u(n,{x:e,y:r,width:s,height:a,viewport:i,viewState:l}),o[t]||(o[t]={viewport:i,children:[]}),o[t].children.push(n)}}return Object.keys(o).map(t=>{const{viewport:r,children:s}=o[t],{x:a,y:c,width:l,height:u}=r,d={position:"absolute",left:a,top:c,width:l,height:u},h="view-".concat(t),p=Object(i.createElement)("div",{key:h,id:h,style:d},...s);if(n){const o={viewport:r,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:n=>{n.viewId=t,e._onViewStateChange(n)}};return Object(i.createElement)(n,{key:h,value:o},p)}return p})}({children:b.children,deck:g.deck,ContextProvider:P}),e=Object(i.createElement)("canvas",{key:"canvas",id:j||"deckgl-overlay",ref:v,style:L});g.control=Object(i.createElement)("div",{id:"".concat(j||"deckgl","-wrapper"),ref:m,style:E},[e,t])}return y=!1,g.control});g.defaultProps=r.a.defaultProps;e.a=g},571:function(t,e,n){"use strict";n.r(e),n.d(e,"createSnapModifier",(function(){return r})),n.d(e,"restrictToFirstScrollableAncestor",(function(){return c})),n.d(e,"restrictToHorizontalAxis",(function(){return o})),n.d(e,"restrictToParentElement",(function(){return a})),n.d(e,"restrictToVerticalAxis",(function(){return l})),n.d(e,"restrictToWindowEdges",(function(){return u})),n.d(e,"snapCenterToCursor",(function(){return d}));var i=n(35);function r(t){return e=>{let{transform:n}=e;return{...n,x:Math.ceil(n.x/t)*t,y:Math.ceil(n.y/t)*t}}}const o=t=>{let{transform:e}=t;return{...e,y:0}};function s(t,e,n){const i={...t};return e.top+t.y<=n.top?i.y=n.top-e.top:e.bottom+t.y>=n.top+n.height&&(i.y=n.top+n.height-e.bottom),e.left+t.x<=n.left?i.x=n.left-e.left:e.right+t.x>=n.left+n.width&&(i.x=n.left+n.width-e.right),i}const a=t=>{let{containerNodeRect:e,draggingNodeRect:n,transform:i}=t;return n&&e?s(i,n,e):i},c=t=>{let{draggingNodeRect:e,transform:n,scrollableAncestorRects:i}=t;const r=i[0];return e&&r?s(n,e,r):n},l=t=>{let{transform:e}=t;return{...e,x:0}},u=t=>{let{transform:e,draggingNodeRect:n,windowRect:i}=t;return n&&i?s(e,n,i):e},d=t=>{let{activatorEvent:e,draggingNodeRect:n,transform:r}=t;if(n&&e){const t=Object(i.getEventCoordinates)(e);if(!t)return r;const o=t.x-n.left,s=t.y-n.top;return{...r,x:r.x+o-n.width/2,y:r.y+s-n.height/2}}return r}},574:function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return a}));var i=n(65);function r(t){const e=t[i.g];for(const n in e){const i=e[n],{validate:r}=i;if(r&&!r(t[n],i))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function o(t,e){const n=a({newProps:t,oldProps:e,propTypes:t[i.g],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=function(t,e){if(null===e)return"oldProps is null, initial diff";let n=!1;const{dataComparator:i,_dataDiff:r}=t;i?i(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied");n&&r&&(n=r(t.data,e.data)||n);return n}(t,e);let o=!1;return r||(o=function(t,e){if(null===e)return{all:!0};if("all"in t.updateTriggers){if(u(t,e,"all"))return{all:!0}}const n={};let i=!1;for(const r in t.updateTriggers)if("all"!==r){u(t,e,r)&&(n[r]=!0,i=!0)}return!!i&&n}(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:o,extensionsChanged:l(t,e),transitionsChanged:s(t,e)}}function s(t,e){if(!t.transitions)return!1;const n={},r=t[i.g];let o=!1;for(const i in t.transitions){const s=r[i],a=s&&s.type;("number"===a||"color"===a||"array"===a)&&c(t[i],e[i],s)&&(n[i]=!0,o=!0)}return!!o&&n}function a({newProps:t,oldProps:e,ignoreProps:n={},propTypes:i={},triggerName:r="props"}){if(e===t)return!1;if("object"!=typeof t||null===t)return"".concat(r," changed shallowly");if("object"!=typeof e||null===e)return"".concat(r," changed shallowly");for(const o of Object.keys(t))if(!(o in n)){if(!(o in e))return"".concat(r,".").concat(o," added");const n=c(t[o],e[o],i[o]);if(n)return"".concat(r,".").concat(o," ").concat(n)}for(const o of Object.keys(e))if(!(o in n)){if(!(o in t))return"".concat(r,".").concat(o," dropped");if(!Object.hasOwnProperty.call(t,o)){const n=c(t[o],e[o],i[o]);if(n)return"".concat(r,".").concat(o," ").concat(n)}}return!1}function c(t,e,n){let i=n&&n.equal;return i&&!i(t,e,n)?"changed deeply":i||(i=t&&e&&t.equals,!i||i.call(t,e))?i||e===t?null:"changed shallowly":"changed deeply"}function l(t,e){if(null===e)return!0;const n=e.extensions,{extensions:i}=t;if(i===n)return!1;if(!n||!i)return!0;if(i.length!==n.length)return!0;for(let t=0;t<i.length;t++)if(!i[t].equals(n[t]))return!0;return!1}function u(t,e,n){let i=t.updateTriggers[n];i=null==i?{}:i;let r=e.updateTriggers[n];r=null==r?{}:r;return a({oldProps:r,newProps:i,triggerName:n})}},576:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(3),r=n(236),o=n(457),s=n(460);class a extends r.a{get ViewportType(){return o.a}get ControllerType(){return s.b}}Object(i.a)(a,"displayName","MapView")},586:function(t,e,n){"use strict";n.d(e,"a",(function(){return x}));var i=n(3),r=n(747),o=n(1157),s=n(1386),a=n(1158),c=n(52),l=n(29),u=n(1456),d=n(810),h=n(798),p=n(68),f=n(237),g=n(188),m=n(213);class v extends f.a{constructor(t){const{id:e=Object(g.c)("column-geometry")}=t,{indices:n,attributes:i}=function(t){const{radius:e,height:n=1,nradial:i=10}=t;let{vertices:r}=t;r&&(p.a.assert(r.length>=i),r=r.flatMap(t=>[t[0],t[1]]),Object(m.f)(r,m.a.COUNTER_CLOCKWISE));const o=n>0,s=i+1,a=o?3*s+1:i,c=2*Math.PI/i,l=new Uint16Array(o?3*i*2:0),u=new Float32Array(3*a),d=new Float32Array(3*a);let h=0;if(o){for(let t=0;t<s;t++){const o=t*c,s=t%i,a=Math.sin(o),l=Math.cos(o);for(let t=0;t<2;t++)u[h+0]=r?r[2*s]:l*e,u[h+1]=r?r[2*s+1]:a*e,u[h+2]=(.5-t)*n,d[h+0]=r?r[2*s]:l,d[h+1]=r?r[2*s+1]:a,h+=3}u[h+0]=u[h-3],u[h+1]=u[h-2],u[h+2]=u[h-1],h+=3}for(let t=o?0:1;t<s;t++){const o=Math.floor(t/2)*Math.sign(.5-t%2),s=o*c,a=(o+i)%i,l=Math.sin(s),p=Math.cos(s);u[h+0]=r?r[2*a]:p*e,u[h+1]=r?r[2*a+1]:l*e,u[h+2]=n/2,d[h+2]=1,h+=3}if(o){let t=0;for(let e=0;e<i;e++)l[t++]=2*e+0,l[t++]=2*e+2,l[t++]=2*e+0,l[t++]=2*e+1,l[t++]=2*e+1,l[t++]=2*e+3}return{indices:l,attributes:{POSITION:{size:3,value:u},NORMAL:{size:3,value:d}}}}(t);super({...t,id:e,indices:n,attributes:i})}}const b=[0,0,0,255],y={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:b},getLineColor:{type:"accessor",value:b},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class x extends r.a{getShaders(){const{gl:t}=this.context,e=!Object(l.j)(t),n={},i=this.props.flatShading&&Object(u.b)(t,d.a.GLSL_DERIVATIVES);return i&&(n.FLAT_SHADING=1),super.getShaders({vs:"#version 300 es\n\n#define SHADER_NAME column-layer-vertex-shader\n\nin vec3 positions;\nin vec3 normals;\n\nin vec3 instancePositions;\nin float instanceElevations;\nin vec3 instancePositions64Low;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin float instanceStrokeWidths;\n\nin vec3 instancePickingColors;\nuniform float opacity;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform bool extruded;\nuniform bool stroked;\nuniform bool isStroke;\nuniform float coverage;\nuniform float elevationScale;\nuniform float edgeDistance;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform int radiusUnits;\nuniform int widthUnits;\nout vec4 vColor;\n#ifdef FLAT_SHADING\nout vec4 position_commonspace;\n#endif\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n\n  vec4 color = isStroke ? instanceLineColors : instanceFillColors;\n  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  float elevation = 0.0;\n  float strokeOffsetRatio = 1.0;\n\n  if (extruded) {\n    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;\n  } else if (stroked) {\n    float widthPixels = clamp(\n      project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n      widthMinPixels, widthMaxPixels) / 2.0;\n    float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);\n    if (isStroke) {\n      strokeOffsetRatio -= sign(positions.z) * halfOffset;\n    } else {\n      strokeOffsetRatio -= halfOffset;\n    }\n  }\n  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);\n  float dotRadius = radius * coverage * shouldRender;\n\n  geometry.pickingColor = instancePickingColors;\n  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);\n  vec3 centroidPosition64Low = instancePositions64Low;\n  vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;\n  if (radiusUnits == UNIT_METERS) {\n    offset = project_size(offset);\n  }\n  vec3 pos = vec3(offset, 0.);\n  DECKGL_FILTER_SIZE(pos, geometry);\n\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);\n  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  if (extruded && !isStroke) {\n#ifdef FLAT_SHADING\n    position_commonspace = geometry.position;\n    vColor = vec4(color.rgb, color.a * opacity);\n#else\n    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n    vColor = vec4(lightColor, color.a * opacity);\n#endif\n  } else {\n    vColor = vec4(color.rgb, color.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME column-layer-fragment-shader\n\nprecision highp float;\n\nuniform vec3 project_uCameraPosition;\nuniform bool extruded;\nuniform bool isStroke;\n\nout vec4 fragColor;\n\nin vec4 vColor;\n#ifdef FLAT_SHADING\nin vec4 position_commonspace;\n#endif\n\nvoid main(void) {\n  fragColor = vColor;\n#ifdef FLAT_SHADING\n  if (extruded && !isStroke && !picking_uActive) {\n    vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n    fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);\n  }\n#endif\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",defines:n,transpileToGLSL100:e,modules:[o.a,i?s.b:s.a,a.a]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:b},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:b},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(t){super.updateState(t);const{props:e,oldProps:n,changeFlags:i}=t,r=i.extensionsChanged||e.flatShading!==n.flatShading;if(r){var o;const{gl:t}=this.context;null===(o=this.state.model)||void 0===o||o.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}(r||e.diskResolution!==n.diskResolution||e.vertices!==n.vertices||(e.extruded||e.stroked)!==(n.extruded||n.stroked))&&this._updateGeometry(e)}getGeometry(t,e,n){const i=new v({radius:1,height:n?2:0,vertices:e,nradial:t});let r=0;if(e)for(let n=0;n<t;n++){const i=e[n];r+=Math.sqrt(i[0]*i[0]+i[1]*i[1])/t}else r=1;return this.setState({edgeDistance:Math.cos(Math.PI/t)*r}),i}_getModel(t){return new h.a(t,{...this.getShaders(),id:this.props.id,isInstanced:!0})}_updateGeometry({diskResolution:t,vertices:e,extruded:n,stroked:i}){const r=this.getGeometry(t,e,n||i);this.setState({fillVertexCount:r.attributes.POSITION.value.length/3,wireframeVertexCount:r.indices.value.length}),this.state.model.setProps({geometry:r})}draw({uniforms:t}){const{lineWidthUnits:e,lineWidthScale:n,lineWidthMinPixels:i,lineWidthMaxPixels:r,radiusUnits:o,elevationScale:s,extruded:a,filled:l,stroked:u,wireframe:d,offset:h,coverage:p,radius:f,angle:g}=this.props,{model:m,fillVertexCount:v,wireframeVertexCount:b,edgeDistance:y}=this.state;m.setUniforms(t).setUniforms({radius:f,angle:g/180*Math.PI,offset:h,extruded:a,stroked:u,coverage:p,elevationScale:s,edgeDistance:y,radiusUnits:c.e[o],widthUnits:c.e[e],widthScale:n,widthMinPixels:i,widthMaxPixels:r}),a&&d&&(m.setProps({isIndexed:!0}),m.setVertexCount(b).setDrawMode(1).setUniforms({isStroke:!0}).draw()),l&&(m.setProps({isIndexed:!1}),m.setVertexCount(v).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!a&&u&&(m.setProps({isIndexed:!1}),m.setVertexCount(2*v/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}Object(i.a)(x,"layerName","ColumnLayer"),Object(i.a)(x,"defaultProps",y)},587:function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));var i=n(3),r=n(951),o=n(425),s=n(663),a=n(402),c=n(377),l=n(327),u=n(340),d=n(431),h=n(275),p=n(29);class f extends u.a{constructor(t,e){super(t,e),Object(i.a)(this,"shadowMap",void 0),Object(i.a)(this,"depthBuffer",void 0),Object(i.a)(this,"fbo",void 0),this.shadowMap=new o.a(t,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new d.a(t,{format:33189,width:1,height:1}),this.fbo=new h.a(t,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(t){const e=this.fbo;Object(p.o)(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const n=t.viewports[0],i=Object(p.e)(this.gl),r=n.width*i,o=n.height*i;r===e.width&&o===e.height||e.resize({width:r,height:o}),super.render({...t,target:e,pass:"shadow"})})}shouldDrawLayer(t){return!1!==t.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}var g=n(497);const m={color:[255,255,255],intensity:1},v=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],b=[0,0,0,200/255];class y{constructor(t={}){Object(i.a)(this,"id","lighting-effect"),Object(i.a)(this,"props",void 0),Object(i.a)(this,"shadowColor",b),Object(i.a)(this,"shadow",void 0),Object(i.a)(this,"ambientLight",void 0),Object(i.a)(this,"directionalLights",void 0),Object(i.a)(this,"pointLights",void 0),Object(i.a)(this,"shadowPasses",[]),Object(i.a)(this,"shadowMaps",[]),Object(i.a)(this,"dummyShadowMap",null),Object(i.a)(this,"programManager",void 0),Object(i.a)(this,"shadowMatrices",void 0),this.setProps(t)}setProps(t){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const e in t){const n=t[e];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow),this.props=t}preRender(t,{layers:e,layerFilter:n,viewports:i,onViewportActive:s,views:a}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),0===this.shadowPasses.length&&this._createShadowPasses(t),this.programManager||(this.programManager=r.a.getDefaultProgramManager(t),g.a&&this.programManager.addDefaultModule(g.a)),this.dummyShadowMap||(this.dummyShadowMap=new o.a(t,{width:1,height:1}));for(let t=0;t<this.shadowPasses.length;t++){this.shadowPasses[t].render({layers:e,layerFilter:n,viewports:i,onViewportActive:s,views:a,moduleParameters:{shadowLightId:t,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}}getModuleParameters(t){const e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(e=>e.getProjectedLight({layer:t})),pointLights:this.pointLights.map(e=>e.getProjectedLight({layer:t}))},e}cleanup(){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(g.a),this.programManager=null)}_calculateMatrices(){const t=[];for(const e of this.directionalLights){const n=(new c.a).lookAt({eye:new l.a(e.direction).negate()});t.push(n)}return t}_createShadowPasses(t){for(let e=0;e<this.directionalLights.length;e++){const n=new f(t);this.shadowPasses[e]=n,this.shadowMaps[e]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:e,directionalLights:n}=this;t||0!==e.length||0!==n.length||(this.ambientLight=new s.a(m),this.directionalLights.push(new a.a(v[0]),new a.a(v[1])))}}},591:function(t,e,n){"use strict";function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}n.d(e,"a",(function(){return i}))},592:function(t,e,n){"use strict";function i(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}n.d(e,"a",(function(){return i}))},594:function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return h}));var i=n(52),r=n(498),o=n(457),s=n(93),a=n(64),c=n(61);const l=[0,0,0];function u(t,e,n=!1){const i=e.projectPosition(t);if(n&&e instanceof o.a){const[n,r,o=0]=t,s=e.getDistanceScales([n,r]);i[2]=o*s.unitsPerMeter[2]}return i}function d(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:o,offsetMode:a}){let[l,d,h=0]=t;switch(n&&([l,d,h]=s.n([],[l,d,h,1],n)),r){case i.a.LNGLAT:return u([l,d,h],e,a);case i.a.LNGLAT_OFFSETS:return u([l+o[0],d+o[1],h+(o[2]||0)],e,a);case i.a.METER_OFFSETS:return u(Object(c.a)(o,[l,d,h]),e,a);case i.a.CARTESIAN:default:return e.isGeospatial?[l+o[0],d+o[1],h+o[2]]:e.projectPosition([l,d,h])}}function h(t,e){const{viewport:n,coordinateSystem:o,coordinateOrigin:s,modelMatrix:c,fromCoordinateSystem:u,fromCoordinateOrigin:h}=function(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:o,fromCoordinateSystem:s,fromCoordinateOrigin:a}=t;return o===i.a.DEFAULT&&(o=e.isGeospatial?i.a.LNGLAT:i.a.CARTESIAN),void 0===s&&(s=o),void 0===a&&(a=r),{viewport:e,coordinateSystem:o,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:a}}(e),{autoOffset:p=!0}=e,{geospatialOrigin:f=l,shaderCoordinateOrigin:g=l,offsetMode:m=!1}=p?Object(r.a)(n,o,s):{},v=d(t,{viewport:n,modelMatrix:c,coordinateSystem:u,coordinateOrigin:h,offsetMode:m});if(m){const t=n.projectPosition(f||g);a.r(v,v,t)}return v}},6:function(t,e){t.exports=function(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))},t.exports.default=t.exports,t.exports.__esModule=!0},603:function(t,e,n){"use strict";n.r(e),n.d(e,"arrow",(function(){return yt})),n.d(e,"autoPlacement",(function(){return E})),n.d(e,"autoUpdate",(function(){return gt})),n.d(e,"computePosition",(function(){return mt})),n.d(e,"detectOverflow",(function(){return j})),n.d(e,"flip",(function(){return L})),n.d(e,"getOverflowAncestors",(function(){return et})),n.d(e,"hide",(function(){return A})),n.d(e,"inline",(function(){return k})),n.d(e,"limitShift",(function(){return F})),n.d(e,"offset",(function(){return z})),n.d(e,"platform",(function(){return ft})),n.d(e,"shift",(function(){return D})),n.d(e,"size",(function(){return N})),n.d(e,"FloatingArrow",(function(){return Ht})),n.d(e,"FloatingDelayGroup",(function(){return ae})),n.d(e,"FloatingFocusManager",(function(){return Ie})),n.d(e,"FloatingList",(function(){return De})),n.d(e,"FloatingNode",(function(){return Qt})),n.d(e,"FloatingOverlay",(function(){return Ve})),n.d(e,"FloatingPortal",(function(){return Te})),n.d(e,"FloatingTree",(function(){return $t})),n.d(e,"inner",(function(){return xn})),n.d(e,"safePolygon",(function(){return On})),n.d(e,"useClick",(function(){return We})),n.d(e,"useClientPoint",(function(){return qe})),n.d(e,"useDelayGroup",(function(){return ce})),n.d(e,"useDelayGroupContext",(function(){return se})),n.d(e,"useDismiss",(function(){return Ye})),n.d(e,"useFloating",(function(){return Je})),n.d(e,"useFloatingNodeId",(function(){return Jt})),n.d(e,"useFloatingParentNodeId",(function(){return Xt})),n.d(e,"useFloatingPortalNode",(function(){return Le})),n.d(e,"useFloatingTree",(function(){return Yt})),n.d(e,"useFocus",(function(){return Qe})),n.d(e,"useHover",(function(){return re})),n.d(e,"useId",(function(){return Gt})),n.d(e,"useInnerOffset",(function(){return _n})),n.d(e,"useInteractions",(function(){return tn})),n.d(e,"useListItem",(function(){return Fe})),n.d(e,"useListNavigation",(function(){return dn})),n.d(e,"useMergeRefs",(function(){return hn})),n.d(e,"useRole",(function(){return pn})),n.d(e,"useTransitionStatus",(function(){return mn})),n.d(e,"useTransitionStyles",(function(){return vn})),n.d(e,"useTypeahead",(function(){return bn}));const i=["top","right","bottom","left"],r=["start","end"],o=i.reduce((t,e)=>t.concat(e,e+"-"+r[0],e+"-"+r[1]),[]),s=Math.min,a=Math.max,c=Math.round,l=Math.floor,u=t=>({x:t,y:t}),d={left:"right",right:"left",bottom:"top",top:"bottom"},h={start:"end",end:"start"};function p(t,e,n){return a(t,s(e,n))}function f(t,e){return"function"==typeof t?t(e):t}function g(t){return t.split("-")[0]}function m(t){return t.split("-")[1]}function v(t){return"x"===t?"y":"x"}function b(t){return"y"===t?"height":"width"}function y(t){return["top","bottom"].includes(g(t))?"y":"x"}function x(t){return v(y(t))}function _(t,e,n){void 0===n&&(n=!1);const i=m(t),r=x(t),o=b(r);let s="x"===r?i===(n?"end":"start")?"right":"left":"start"===i?"bottom":"top";return e.reference[o]>e.floating[o]&&(s=O(s)),[s,O(s)]}function w(t){return t.replace(/start|end/g,t=>h[t])}function O(t){return t.replace(/left|right|bottom|top/g,t=>d[t])}function P(t){return"number"!=typeof t?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}function S(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}function C(t,e,n){let{reference:i,floating:r}=t;const o=y(e),s=x(e),a=b(s),c=g(e),l="y"===o,u=i.x+i.width/2-r.width/2,d=i.y+i.height/2-r.height/2,h=i[a]/2-r[a]/2;let p;switch(c){case"top":p={x:u,y:i.y-r.height};break;case"bottom":p={x:u,y:i.y+i.height};break;case"right":p={x:i.x+i.width,y:d};break;case"left":p={x:i.x-r.width,y:d};break;default:p={x:i.x,y:i.y}}switch(m(e)){case"start":p[s]-=h*(n&&l?-1:1);break;case"end":p[s]+=h*(n&&l?-1:1)}return p}async function j(t,e){var n;void 0===e&&(e={});const{x:i,y:r,platform:o,rects:s,elements:a,strategy:c}=t,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:p=0}=f(e,t),g=P(p),m=a[h?"floating"===d?"reference":"floating":d],v=S(await o.getClippingRect({element:null==(n=await(null==o.isElement?void 0:o.isElement(m)))||n?m:m.contextElement||await(null==o.getDocumentElement?void 0:o.getDocumentElement(a.floating)),boundary:l,rootBoundary:u,strategy:c})),b="floating"===d?{...s.floating,x:i,y:r}:s.reference,y=await(null==o.getOffsetParent?void 0:o.getOffsetParent(a.floating)),x=await(null==o.isElement?void 0:o.isElement(y))&&await(null==o.getScale?void 0:o.getScale(y))||{x:1,y:1},_=S(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({rect:b,offsetParent:y,strategy:c}):b);return{top:(v.top-_.top+g.top)/x.y,bottom:(_.bottom-v.bottom+g.bottom)/x.y,left:(v.left-_.left+g.left)/x.x,right:(_.right-v.right+g.right)/x.x}}const M=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:i,placement:r,rects:o,platform:a,elements:c,middlewareData:l}=e,{element:u,padding:d=0}=f(t,e)||{};if(null==u)return{};const h=P(d),g={x:n,y:i},v=x(r),y=b(v),_=await a.getDimensions(u),w="y"===v,O=w?"top":"left",S=w?"bottom":"right",C=w?"clientHeight":"clientWidth",j=o.reference[y]+o.reference[v]-g[v]-o.floating[y],M=g[v]-o.reference[v],E=await(null==a.getOffsetParent?void 0:a.getOffsetParent(u));let L=E?E[C]:0;L&&await(null==a.isElement?void 0:a.isElement(E))||(L=c.floating[C]||o.floating[y]);const T=j/2-M/2,R=L/2-_[y]/2-1,A=s(h[O],R),I=s(h[S],R),k=A,z=L-_[y]-I,D=L/2-_[y]/2+T,F=p(k,D,z),N=!l.arrow&&null!=m(r)&&D!=F&&o.reference[y]/2-(D<k?A:I)-_[y]/2<0,V=N?D<k?D-k:D-z:0;return{[v]:g[v]+V,data:{[v]:F,centerOffset:D-F-V,...N&&{alignmentOffset:V}},reset:N}}});const E=function(t){return void 0===t&&(t={}),{name:"autoPlacement",options:t,async fn(e){var n,i,r;const{rects:s,middlewareData:a,placement:c,platform:l,elements:u}=e,{crossAxis:d=!1,alignment:h,allowedPlacements:p=o,autoAlignment:v=!0,...b}=f(t,e),y=void 0!==h||p===o?function(t,e,n){return(t?[...n.filter(e=>m(e)===t),...n.filter(e=>m(e)!==t)]:n.filter(t=>g(t)===t)).filter(n=>!t||(m(n)===t||!!e&&w(n)!==n))}(h||null,v,p):p,x=await j(e,b),O=(null==(n=a.autoPlacement)?void 0:n.index)||0,P=y[O];if(null==P)return{};const S=_(P,s,await(null==l.isRTL?void 0:l.isRTL(u.floating)));if(c!==P)return{reset:{placement:y[0]}};const C=[x[g(P)],x[S[0]],x[S[1]]],M=[...(null==(i=a.autoPlacement)?void 0:i.overflows)||[],{placement:P,overflows:C}],E=y[O+1];if(E)return{data:{index:O+1,overflows:M},reset:{placement:E}};const L=M.map(t=>{const e=m(t.placement);return[t.placement,e&&d?t.overflows.slice(0,2).reduce((t,e)=>t+e,0):t.overflows[0],t.overflows]}).sort((t,e)=>t[1]-e[1]),T=(null==(r=L.filter(t=>t[2].slice(0,m(t[0])?2:3).every(t=>t<=0))[0])?void 0:r[0])||L[0][0];return T!==c?{data:{index:O+1,overflows:M},reset:{placement:T}}:{}}}},L=function(t){return void 0===t&&(t={}),{name:"flip",options:t,async fn(e){var n,i;const{placement:r,middlewareData:o,rects:s,initialPlacement:a,platform:c,elements:l}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:b=!0,...y}=f(t,e);if(null!=(n=o.arrow)&&n.alignmentOffset)return{};const x=g(r),P=g(a)===a,S=await(null==c.isRTL?void 0:c.isRTL(l.floating)),C=h||(P||!b?[O(a)]:function(t){const e=O(t);return[w(t),e,w(e)]}(a));h||"none"===v||C.push(...function(t,e,n,i){const r=m(t);let o=function(t,e,n){const i=["left","right"],r=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(t){case"top":case"bottom":return n?e?r:i:e?i:r;case"left":case"right":return e?o:s;default:return[]}}(g(t),"start"===n,i);return r&&(o=o.map(t=>t+"-"+r),e&&(o=o.concat(o.map(w)))),o}(a,b,v,S));const M=[a,...C],E=await j(e,y),L=[];let T=(null==(i=o.flip)?void 0:i.overflows)||[];if(u&&L.push(E[x]),d){const t=_(r,s,S);L.push(E[t[0]],E[t[1]])}if(T=[...T,{placement:r,overflows:L}],!L.every(t=>t<=0)){var R,A;const t=((null==(R=o.flip)?void 0:R.index)||0)+1,e=M[t];if(e)return{data:{index:t,overflows:T},reset:{placement:e}};let n=null==(A=T.filter(t=>t.overflows[0]<=0).sort((t,e)=>t.overflows[1]-e.overflows[1])[0])?void 0:A.placement;if(!n)switch(p){case"bestFit":{var I;const t=null==(I=T.map(t=>[t.placement,t.overflows.filter(t=>t>0).reduce((t,e)=>t+e,0)]).sort((t,e)=>t[1]-e[1])[0])?void 0:I[0];t&&(n=t);break}case"initialPlacement":n=a}if(r!==n)return{reset:{placement:n}}}return{}}}};function T(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function R(t){return i.some(e=>t[e]>=0)}const A=function(t){return void 0===t&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:i="referenceHidden",...r}=f(t,e);switch(i){case"referenceHidden":{const t=T(await j(e,{...r,elementContext:"reference"}),n.reference);return{data:{referenceHiddenOffsets:t,referenceHidden:R(t)}}}case"escaped":{const t=T(await j(e,{...r,altBoundary:!0}),n.floating);return{data:{escapedOffsets:t,escaped:R(t)}}}default:return{}}}}};function I(t){const e=s(...t.map(t=>t.left)),n=s(...t.map(t=>t.top));return{x:e,y:n,width:a(...t.map(t=>t.right))-e,height:a(...t.map(t=>t.bottom))-n}}const k=function(t){return void 0===t&&(t={}),{name:"inline",options:t,async fn(e){const{placement:n,elements:i,rects:r,platform:o,strategy:c}=e,{padding:l=2,x:u,y:d}=f(t,e),h=Array.from(await(null==o.getClientRects?void 0:o.getClientRects(i.reference))||[]),p=function(t){const e=t.slice().sort((t,e)=>t.y-e.y),n=[];let i=null;for(let t=0;t<e.length;t++){const r=e[t];!i||r.y-i.y>i.height/2?n.push([r]):n[n.length-1].push(r),i=r}return n.map(t=>S(I(t)))}(h),m=S(I(h)),v=P(l);const b=await o.getElementRects({reference:{getBoundingClientRect:function(){if(2===p.length&&p[0].left>p[1].right&&null!=u&&null!=d)return p.find(t=>u>t.left-v.left&&u<t.right+v.right&&d>t.top-v.top&&d<t.bottom+v.bottom)||m;if(p.length>=2){if("y"===y(n)){const t=p[0],e=p[p.length-1],i="top"===g(n),r=t.top,o=e.bottom,s=i?t.left:e.left,a=i?t.right:e.right;return{top:r,bottom:o,left:s,right:a,width:a-s,height:o-r,x:s,y:r}}const t="left"===g(n),e=a(...p.map(t=>t.right)),i=s(...p.map(t=>t.left)),r=p.filter(n=>t?n.left===i:n.right===e),o=r[0].top,c=r[r.length-1].bottom;return{top:o,bottom:c,left:i,right:e,width:e-i,height:c-o,x:i,y:o}}return m}},floating:i.floating,strategy:c});return r.reference.x!==b.reference.x||r.reference.y!==b.reference.y||r.reference.width!==b.reference.width||r.reference.height!==b.reference.height?{reset:{rects:b}}:{}}}};const z=function(t){return void 0===t&&(t=0),{name:"offset",options:t,async fn(e){const{x:n,y:i}=e,r=await async function(t,e){const{placement:n,platform:i,elements:r}=t,o=await(null==i.isRTL?void 0:i.isRTL(r.floating)),s=g(n),a=m(n),c="y"===y(n),l=["left","top"].includes(s)?-1:1,u=o&&c?-1:1,d=f(e,t);let{mainAxis:h,crossAxis:p,alignmentAxis:v}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&"number"==typeof v&&(p="end"===a?-1*v:v),c?{x:p*u,y:h*l}:{x:h*l,y:p*u}}(e,t);return{x:n+r.x,y:i+r.y,data:r}}}},D=function(t){return void 0===t&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:i,placement:r}=e,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:t=>{let{x:e,y:n}=t;return{x:e,y:n}}},...c}=f(t,e),l={x:n,y:i},u=await j(e,c),d=y(g(r)),h=v(d);let m=l[h],b=l[d];if(o){const t="y"===h?"bottom":"right";m=p(m+u["y"===h?"top":"left"],m,m-u[t])}if(s){const t="y"===d?"bottom":"right";b=p(b+u["y"===d?"top":"left"],b,b-u[t])}const x=a.fn({...e,[h]:m,[d]:b});return{...x,data:{x:x.x-n,y:x.y-i}}}}},F=function(t){return void 0===t&&(t={}),{options:t,fn(e){const{x:n,y:i,placement:r,rects:o,middlewareData:s}=e,{offset:a=0,mainAxis:c=!0,crossAxis:l=!0}=f(t,e),u={x:n,y:i},d=y(r),h=v(d);let p=u[h],m=u[d];const b=f(a,e),x="number"==typeof b?{mainAxis:b,crossAxis:0}:{mainAxis:0,crossAxis:0,...b};if(c){const t="y"===h?"height":"width",e=o.reference[h]-o.floating[t]+x.mainAxis,n=o.reference[h]+o.reference[t]-x.mainAxis;p<e?p=e:p>n&&(p=n)}if(l){var _,w;const t="y"===h?"width":"height",e=["top","left"].includes(g(r)),n=o.reference[d]-o.floating[t]+(e&&(null==(_=s.offset)?void 0:_[d])||0)+(e?0:x.crossAxis),i=o.reference[d]+o.reference[t]+(e?0:(null==(w=s.offset)?void 0:w[d])||0)-(e?x.crossAxis:0);m<n?m=n:m>i&&(m=i)}return{[h]:p,[d]:m}}}},N=function(t){return void 0===t&&(t={}),{name:"size",options:t,async fn(e){const{placement:n,rects:i,platform:r,elements:o}=e,{apply:c=(()=>{}),...l}=f(t,e),u=await j(e,l),d=g(n),h=m(n),p="y"===y(n),{width:v,height:b}=i.floating;let x,_;"top"===d||"bottom"===d?(x=d,_=h===(await(null==r.isRTL?void 0:r.isRTL(o.floating))?"start":"end")?"left":"right"):(_=d,x="end"===h?"top":"bottom");const w=b-u[x],O=v-u[_],P=!e.middlewareData.shift;let S=w,C=O;if(p){const t=v-u.left-u.right;C=h||P?s(O,t):t}else{const t=b-u.top-u.bottom;S=h||P?s(w,t):t}if(P&&!h){const t=a(u.left,0),e=a(u.right,0),n=a(u.top,0),i=a(u.bottom,0);p?C=v-2*(0!==t||0!==e?t+e:a(u.left,u.right)):S=b-2*(0!==n||0!==i?n+i:a(u.top,u.bottom))}await c({...e,availableWidth:C,availableHeight:S});const M=await r.getDimensions(o.floating);return v!==M.width||b!==M.height?{reset:{rects:!0}}:{}}}};function V(t){return W(t)?(t.nodeName||"").toLowerCase():"#document"}function U(t){var e;return(null==t||null==(e=t.ownerDocument)?void 0:e.defaultView)||window}function B(t){var e;return null==(e=(W(t)?t.ownerDocument:t.document)||window.document)?void 0:e.documentElement}function W(t){return t instanceof Node||t instanceof U(t).Node}function G(t){return t instanceof Element||t instanceof U(t).Element}function H(t){return t instanceof HTMLElement||t instanceof U(t).HTMLElement}function Z(t){return"undefined"!=typeof ShadowRoot&&(t instanceof ShadowRoot||t instanceof U(t).ShadowRoot)}function q(t){const{overflow:e,overflowX:n,overflowY:i,display:r}=Q(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!["inline","contents"].includes(r)}function K(t){return["table","td","th"].includes(V(t))}function X(t){const e=Y(),n=Q(t);return"none"!==n.transform||"none"!==n.perspective||!!n.containerType&&"normal"!==n.containerType||!e&&!!n.backdropFilter&&"none"!==n.backdropFilter||!e&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some(t=>(n.willChange||"").includes(t))||["paint","layout","strict","content"].some(t=>(n.contain||"").includes(t))}function Y(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function J(t){return["html","body","#document"].includes(V(t))}function Q(t){return U(t).getComputedStyle(t)}function $(t){return G(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function tt(t){if("html"===V(t))return t;const e=t.assignedSlot||t.parentNode||Z(t)&&t.host||B(t);return Z(e)?e.host:e}function et(t,e,n){var i;void 0===e&&(e=[]),void 0===n&&(n=!0);const r=function t(e){const n=tt(e);return J(n)?e.ownerDocument?e.ownerDocument.body:e.body:H(n)&&q(n)?n:t(n)}(t),o=r===(null==(i=t.ownerDocument)?void 0:i.body),s=U(r);return o?e.concat(s,s.visualViewport||[],q(r)?r:[],s.frameElement&&n?et(s.frameElement):[]):e.concat(r,et(r,[],n))}function nt(t){const e=Q(t);let n=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const r=H(t),o=r?t.offsetWidth:n,s=r?t.offsetHeight:i,a=c(n)!==o||c(i)!==s;return a&&(n=o,i=s),{width:n,height:i,$:a}}function it(t){return G(t)?t:t.contextElement}function rt(t){const e=it(t);if(!H(e))return u(1);const n=e.getBoundingClientRect(),{width:i,height:r,$:o}=nt(e);let s=(o?c(n.width):n.width)/i,a=(o?c(n.height):n.height)/r;return s&&Number.isFinite(s)||(s=1),a&&Number.isFinite(a)||(a=1),{x:s,y:a}}const ot=u(0);function st(t){const e=U(t);return Y()&&e.visualViewport?{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}:ot}function at(t,e,n,i){void 0===e&&(e=!1),void 0===n&&(n=!1);const r=t.getBoundingClientRect(),o=it(t);let s=u(1);e&&(i?G(i)&&(s=rt(i)):s=rt(t));const a=function(t,e,n){return void 0===e&&(e=!1),!(!n||e&&n!==U(t))&&e}(o,n,i)?st(o):u(0);let c=(r.left+a.x)/s.x,l=(r.top+a.y)/s.y,d=r.width/s.x,h=r.height/s.y;if(o){const t=U(o),e=i&&G(i)?U(i):i;let n=t.frameElement;for(;n&&i&&e!==t;){const t=rt(n),e=n.getBoundingClientRect(),i=Q(n),r=e.left+(n.clientLeft+parseFloat(i.paddingLeft))*t.x,o=e.top+(n.clientTop+parseFloat(i.paddingTop))*t.y;c*=t.x,l*=t.y,d*=t.x,h*=t.y,c+=r,l+=o,n=U(n).frameElement}}return S({width:d,height:h,x:c,y:l})}function ct(t){return at(B(t)).left+$(t).scrollLeft}function lt(t,e,n){let i;if("viewport"===e)i=function(t,e){const n=U(t),i=B(t),r=n.visualViewport;let o=i.clientWidth,s=i.clientHeight,a=0,c=0;if(r){o=r.width,s=r.height;const t=Y();(!t||t&&"fixed"===e)&&(a=r.offsetLeft,c=r.offsetTop)}return{width:o,height:s,x:a,y:c}}(t,n);else if("document"===e)i=function(t){const e=B(t),n=$(t),i=t.ownerDocument.body,r=a(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),o=a(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let s=-n.scrollLeft+ct(t);const c=-n.scrollTop;return"rtl"===Q(i).direction&&(s+=a(e.clientWidth,i.clientWidth)-r),{width:r,height:o,x:s,y:c}}(B(t));else if(G(e))i=function(t,e){const n=at(t,!0,"fixed"===e),i=n.top+t.clientTop,r=n.left+t.clientLeft,o=H(t)?rt(t):u(1);return{width:t.clientWidth*o.x,height:t.clientHeight*o.y,x:r*o.x,y:i*o.y}}(e,n);else{const n=st(t);i={...e,x:e.x-n.x,y:e.y-n.y}}return S(i)}function ut(t,e){const n=tt(t);return!(n===e||!G(n)||J(n))&&("fixed"===Q(n).position||ut(n,e))}function dt(t,e,n){const i=H(e),r=B(e),o="fixed"===n,s=at(t,!0,o,e);let a={scrollLeft:0,scrollTop:0};const c=u(0);if(i||!i&&!o)if(("body"!==V(e)||q(r))&&(a=$(e)),i){const t=at(e,!0,o,e);c.x=t.x+e.clientLeft,c.y=t.y+e.clientTop}else r&&(c.x=ct(r));return{x:s.left+a.scrollLeft-c.x,y:s.top+a.scrollTop-c.y,width:s.width,height:s.height}}function ht(t,e){return H(t)&&"fixed"!==Q(t).position?e?e(t):t.offsetParent:null}function pt(t,e){const n=U(t);if(!H(t))return n;let i=ht(t,e);for(;i&&K(i)&&"static"===Q(i).position;)i=ht(i,e);return i&&("html"===V(i)||"body"===V(i)&&"static"===Q(i).position&&!X(i))?n:i||function(t){let e=tt(t);for(;H(e)&&!J(e);){if(X(e))return e;e=tt(e)}return null}(t)||n}const ft={convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{rect:e,offsetParent:n,strategy:i}=t;const r=H(n),o=B(n);if(n===o)return e;let s={scrollLeft:0,scrollTop:0},a=u(1);const c=u(0);if((r||!r&&"fixed"!==i)&&(("body"!==V(n)||q(o))&&(s=$(n)),H(n))){const t=at(n);a=rt(n),c.x=t.x+n.clientLeft,c.y=t.y+n.clientTop}return{width:e.width*a.x,height:e.height*a.y,x:e.x*a.x-s.scrollLeft*a.x+c.x,y:e.y*a.y-s.scrollTop*a.y+c.y}},getDocumentElement:B,getClippingRect:function(t){let{element:e,boundary:n,rootBoundary:i,strategy:r}=t;const o=[..."clippingAncestors"===n?function(t,e){const n=e.get(t);if(n)return n;let i=et(t,[],!1).filter(t=>G(t)&&"body"!==V(t)),r=null;const o="fixed"===Q(t).position;let s=o?tt(t):t;for(;G(s)&&!J(s);){const e=Q(s),n=X(s);n||"fixed"!==e.position||(r=null);(o?!n&&!r:!n&&"static"===e.position&&!!r&&["absolute","fixed"].includes(r.position)||q(s)&&!n&&ut(t,s))?i=i.filter(t=>t!==s):r=e,s=tt(s)}return e.set(t,i),i}(e,this._c):[].concat(n),i],c=o[0],l=o.reduce((t,n)=>{const i=lt(e,n,r);return t.top=a(i.top,t.top),t.right=s(i.right,t.right),t.bottom=s(i.bottom,t.bottom),t.left=a(i.left,t.left),t},lt(e,c,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},getOffsetParent:pt,getElementRects:async function(t){let{reference:e,floating:n,strategy:i}=t;const r=this.getOffsetParent||pt,o=this.getDimensions;return{reference:dt(e,await r(n),i),floating:{x:0,y:0,...await o(n)}}},getClientRects:function(t){return Array.from(t.getClientRects())},getDimensions:function(t){return nt(t)},getScale:rt,isElement:G,isRTL:function(t){return"rtl"===Q(t).direction}};function gt(t,e,n,i){void 0===i&&(i={});const{ancestorScroll:r=!0,ancestorResize:o=!0,elementResize:c="function"==typeof ResizeObserver,layoutShift:u="function"==typeof IntersectionObserver,animationFrame:d=!1}=i,h=it(t),p=r||o?[...h?et(h):[],...et(e)]:[];p.forEach(t=>{r&&t.addEventListener("scroll",n,{passive:!0}),o&&t.addEventListener("resize",n)});const f=h&&u?function(t,e){let n,i=null;const r=B(t);function o(){clearTimeout(n),i&&i.disconnect(),i=null}return function c(u,d){void 0===u&&(u=!1),void 0===d&&(d=1),o();const{left:h,top:p,width:f,height:g}=t.getBoundingClientRect();if(u||e(),!f||!g)return;const m={rootMargin:-l(p)+"px "+-l(r.clientWidth-(h+f))+"px "+-l(r.clientHeight-(p+g))+"px "+-l(h)+"px",threshold:a(0,s(1,d))||1};let v=!0;function b(t){const e=t[0].intersectionRatio;if(e!==d){if(!v)return c();e?c(!1,e):n=setTimeout(()=>{c(!1,1e-7)},100)}v=!1}try{i=new IntersectionObserver(b,{...m,root:r.ownerDocument})}catch(t){i=new IntersectionObserver(b,m)}i.observe(t)}(!0),o}(h,n):null;let g,m=-1,v=null;c&&(v=new ResizeObserver(t=>{let[i]=t;i&&i.target===h&&v&&(v.unobserve(e),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{v&&v.observe(e)})),n()}),h&&!d&&v.observe(h),v.observe(e));let b=d?at(t):null;return d&&function e(){const i=at(t);!b||i.x===b.x&&i.y===b.y&&i.width===b.width&&i.height===b.height||n();b=i,g=requestAnimationFrame(e)}(),n(),()=>{p.forEach(t=>{r&&t.removeEventListener("scroll",n),o&&t.removeEventListener("resize",n)}),f&&f(),v&&v.disconnect(),v=null,d&&cancelAnimationFrame(g)}}const mt=(t,e,n)=>{const i=new Map,r={platform:ft,...n},o={...r.platform,_c:i};return(async(t,e,n)=>{const{placement:i="bottom",strategy:r="absolute",middleware:o=[],platform:s}=n,a=o.filter(Boolean),c=await(null==s.isRTL?void 0:s.isRTL(e));let l=await s.getElementRects({reference:t,floating:e,strategy:r}),{x:u,y:d}=C(l,i,c),h=i,p={},f=0;for(let n=0;n<a.length;n++){const{name:o,fn:g}=a[n],{x:m,y:v,data:b,reset:y}=await g({x:u,y:d,initialPlacement:i,placement:h,strategy:r,middlewareData:p,rects:l,platform:s,elements:{reference:t,floating:e}});u=null!=m?m:u,d=null!=v?v:d,p={...p,[o]:{...p[o],...b}},y&&f<=50&&(f++,"object"==typeof y&&(y.placement&&(h=y.placement),y.rects&&(l=!0===y.rects?await s.getElementRects({reference:t,floating:e,strategy:r}):y.rects),({x:u,y:d}=C(l,h,c))),n=-1)}return{x:u,y:d,placement:h,strategy:r,middlewareData:p}})(t,e,{...r,platform:o})};var vt=n(0),bt=n(60);const yt=t=>({name:"arrow",options:t,fn(e){const{element:n,padding:i}="function"==typeof t?t(e):t;return n&&(r=n,{}.hasOwnProperty.call(r,"current"))?null!=n.current?M({element:n.current,padding:i}).fn(e):{}:n?M({element:n,padding:i}).fn(e):{};var r}});var xt="undefined"!=typeof document?vt.useLayoutEffect:vt.useEffect;function _t(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if("function"==typeof t&&t.toString()===e.toString())return!0;let n,i,r;if(t&&e&&"object"==typeof t){if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(i=n;0!=i--;)if(!_t(t[i],e[i]))return!1;return!0}if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(i=n;0!=i--;)if(!{}.hasOwnProperty.call(e,r[i]))return!1;for(i=n;0!=i--;){const n=r[i];if(("_owner"!==n||!t.$$typeof)&&!_t(t[n],e[n]))return!1}return!0}return t!=t&&e!=e}function wt(t){if("undefined"==typeof window)return 1;return(t.ownerDocument.defaultView||window).devicePixelRatio||1}function Ot(t,e){const n=wt(t);return Math.round(e*n)/n}function Pt(t){const e=vt.useRef(t);return xt(()=>{e.current=t}),e}function St(t){let e=t.activeElement;for(;null!=(null==(n=e)||null==(i=n.shadowRoot)?void 0:i.activeElement);){var n,i;e=e.shadowRoot.activeElement}return e}function Ct(t,e){if(!t||!e)return!1;const n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&Z(n)){let n=e;for(;n;){if(t===n)return!0;n=n.parentNode||n.host}}return!1}function jt(){const t=navigator.userAgentData;return null!=t&&t.platform?t.platform:navigator.platform}function Mt(){const t=navigator.userAgentData;return t&&Array.isArray(t.brands)?t.brands.map(t=>{let{brand:e,version:n}=t;return e+"/"+n}).join(" "):navigator.userAgent}function Et(t){if(0===t.mozInputSource&&t.isTrusted)return!0;const e=/Android/i;return(e.test(jt())||e.test(Mt()))&&t.pointerType?"click"===t.type&&1===t.buttons:0===t.detail&&!t.pointerType}function Lt(t){return 0===t.width&&0===t.height||1===t.width&&1===t.height&&0===t.pressure&&0===t.detail&&"mouse"!==t.pointerType||t.width<1&&t.height<1&&0===t.pressure&&0===t.detail}function Tt(){return/apple/i.test(navigator.vendor)}function Rt(t,e){const n=["mouse","pen"];return e||n.push("",void 0),n.includes(t)}function At(t){return(null==t?void 0:t.ownerDocument)||document}function It(t,e){if(null==e)return!1;if("composedPath"in t)return t.composedPath().includes(e);const n=t;return null!=n.target&&e.contains(n.target)}function kt(t){return"composedPath"in t?t.composedPath()[0]:t.target}function zt(t){return H(t)&&t.matches("input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])")}function Dt(t){t.preventDefault(),t.stopPropagation()}var Ft=n(817);function Nt(){return(Nt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}var Vt="undefined"!=typeof document?vt.useLayoutEffect:vt.useEffect;let Ut=!1,Bt=0;const Wt=()=>"floating-ui-"+Bt++;const Gt=vt["useId".toString()]||function(){const[t,e]=vt.useState(()=>Ut?Wt():void 0);return Vt(()=>{null==t&&e(Wt())},[]),vt.useEffect(()=>{Ut||(Ut=!0)},[]),t},Ht=vt.forwardRef((function(t,e){let{context:{placement:n,elements:{floating:i},middlewareData:{arrow:r}},width:o=14,height:s=7,tipRadius:a=0,strokeWidth:c=0,staticOffset:l,stroke:u,d:d,style:{transform:h,...p}={},...f}=t;const g=Gt();if(!i)return null;c*=2;const m=c/2,v=o/2*(a/-8+1),b=s/2*a/4,[y,x]=n.split("-"),_=ft.isRTL(i),w=!!d,O="top"===y||"bottom"===y,P=l&&"end"===x?"bottom":"top";let S=l&&"end"===x?"right":"left";l&&_&&(S="end"===x?"left":"right");const C=null!=(null==r?void 0:r.x)?l||r.x:"",j=null!=(null==r?void 0:r.y)?l||r.y:"",M=d||"M0,0 H"+o+" L"+(o-v)+","+(s-b)+" Q"+o/2+","+s+" "+v+","+(s-b)+" Z",E={top:w?"rotate(180deg)":"",left:w?"rotate(90deg)":"rotate(-90deg)",bottom:w?"":"rotate(180deg)",right:w?"rotate(-90deg)":"rotate(90deg)"}[y];return vt.createElement("svg",Nt({},f,{"aria-hidden":!0,ref:e,width:w?o:o+c,height:o,viewBox:"0 0 "+o+" "+(s>o?s:o),style:{position:"absolute",pointerEvents:"none",[S]:C,[P]:j,[y]:O||w?"100%":"calc(100% - "+c/2+"px)",transform:""+E+(null!=h?h:""),...p}}),c>0&&vt.createElement("path",{clipPath:"url(#"+g+")",fill:"none",stroke:u,strokeWidth:c+(d?0:1),d:M}),vt.createElement("path",{stroke:c&&!d?f.fill:"none",d:M}),vt.createElement("clipPath",{id:g},vt.createElement("rect",{x:-m,y:m*(w?-1:1),width:o+c,height:o})))}));function Zt(){const t=new Map;return{emit(e,n){var i;null==(i=t.get(e))||i.forEach(t=>t(n))},on(e,n){t.set(e,[...t.get(e)||[],n])},off(e,n){var i;t.set(e,(null==(i=t.get(e))?void 0:i.filter(t=>t!==n))||[])}}}const qt=vt.createContext(null),Kt=vt.createContext(null),Xt=()=>{var t;return(null==(t=vt.useContext(qt))?void 0:t.id)||null},Yt=()=>vt.useContext(Kt);function Jt(t){const e=Gt(),n=Yt(),i=Xt(),r=t||i;return Vt(()=>{const t={id:e,parentId:r};return null==n||n.addNode(t),()=>{null==n||n.removeNode(t)}},[n,e,r]),e}function Qt(t){let{children:e,id:n}=t;const i=Xt();return vt.createElement(qt.Provider,{value:vt.useMemo(()=>({id:n,parentId:i}),[n,i])},e)}function $t(t){let{children:e}=t;const n=vt.useRef([]),i=vt.useCallback(t=>{n.current=[...n.current,t]},[]),r=vt.useCallback(t=>{n.current=n.current.filter(e=>e!==t)},[]),o=vt.useState(()=>Zt())[0];return vt.createElement(Kt.Provider,{value:vt.useMemo(()=>({nodesRef:n,addNode:i,removeNode:r,events:o}),[n,i,r,o])},e)}function te(t){return"data-floating-ui-"+t}function ee(t){const e=Object(vt.useRef)(t);return Vt(()=>{e.current=t}),e}const ne=te("safe-polygon");function ie(t,e,n){return n&&!Rt(n)?0:"number"==typeof t?t:null==t?void 0:t[e]}function re(t,e){void 0===e&&(e={});const{open:n,onOpenChange:i,dataRef:r,events:o,elements:{domReference:s,floating:a},refs:c}=t,{enabled:l=!0,delay:u=0,handleClose:d=null,mouseOnly:h=!1,restMs:p=0,move:f=!0}=e,g=Yt(),m=Xt(),v=ee(d),b=ee(u),y=vt.useRef(),x=vt.useRef(),_=vt.useRef(),w=vt.useRef(),O=vt.useRef(!0),P=vt.useRef(!1),S=vt.useRef(()=>{}),C=vt.useCallback(()=>{var t;const e=null==(t=r.current.openEvent)?void 0:t.type;return(null==e?void 0:e.includes("mouse"))&&"mousedown"!==e},[r]);vt.useEffect(()=>{if(l)return o.on("dismiss",t),()=>{o.off("dismiss",t)};function t(){clearTimeout(x.current),clearTimeout(w.current),O.current=!0}},[l,o]),vt.useEffect(()=>{if(!l||!v.current||!n)return;function t(t){C()&&i(!1,t)}const e=At(a).documentElement;return e.addEventListener("mouseleave",t),()=>{e.removeEventListener("mouseleave",t)}},[a,n,i,l,v,r,C]);const j=vt.useCallback((function(t,e){void 0===e&&(e=!0);const n=ie(b.current,"close",y.current);n&&!_.current?(clearTimeout(x.current),x.current=setTimeout(()=>i(!1,t),n)):e&&(clearTimeout(x.current),i(!1,t))}),[b,i]),M=vt.useCallback(()=>{S.current(),_.current=void 0},[]),E=vt.useCallback(()=>{if(P.current){const t=At(c.floating.current).body;t.style.pointerEvents="",t.removeAttribute(ne),P.current=!1}},[c]);return vt.useEffect(()=>{if(l&&G(s)){const t=s;return n&&t.addEventListener("mouseleave",u),null==a||a.addEventListener("mouseleave",u),f&&t.addEventListener("mousemove",o,{once:!0}),t.addEventListener("mouseenter",o),t.addEventListener("mouseleave",c),()=>{n&&t.removeEventListener("mouseleave",u),null==a||a.removeEventListener("mouseleave",u),f&&t.removeEventListener("mousemove",o),t.removeEventListener("mouseenter",o),t.removeEventListener("mouseleave",c)}}function e(){return!!r.current.openEvent&&["click","mousedown"].includes(r.current.openEvent.type)}function o(t){if(clearTimeout(x.current),O.current=!1,h&&!Rt(y.current)||p>0&&0===ie(b.current,"open"))return;const e=ie(b.current,"open",y.current);e?x.current=setTimeout(()=>{i(!0,t)},e):i(!0,t)}function c(i){if(e())return;S.current();const r=At(a);if(clearTimeout(w.current),v.current){n||clearTimeout(x.current),_.current=v.current({...t,tree:g,x:i.clientX,y:i.clientY,onClose(){E(),M(),j(i)}});const e=_.current;return r.addEventListener("mousemove",e),void(S.current=()=>{r.removeEventListener("mousemove",e)})}("touch"!==y.current||!Ct(a,i.relatedTarget))&&j(i)}function u(n){e()||null==v.current||v.current({...t,tree:g,x:n.clientX,y:n.clientY,onClose(){E(),M(),j(n)}})(n)}},[s,a,l,t,h,p,f,j,M,E,i,n,g,b,v,r]),Vt(()=>{var t;if(l&&n&&null!=(t=v.current)&&t.__options.blockPointerEvents&&C()){const t=At(a).body;if(t.setAttribute(ne,""),t.style.pointerEvents="none",P.current=!0,G(s)&&a){var e,i;const t=s,n=null==g||null==(e=g.nodesRef.current.find(t=>t.id===m))||null==(i=e.context)?void 0:i.elements.floating;return n&&(n.style.pointerEvents=""),t.style.pointerEvents="auto",a.style.pointerEvents="auto",()=>{t.style.pointerEvents="",a.style.pointerEvents=""}}}},[l,n,m,a,s,g,v,r,C]),Vt(()=>{n||(y.current=void 0,M(),E())},[n,M,E]),vt.useEffect(()=>()=>{M(),clearTimeout(x.current),clearTimeout(w.current),E()},[l,s,M,E]),vt.useMemo(()=>{if(!l)return{};function t(t){y.current=t.pointerType}return{reference:{onPointerDown:t,onPointerEnter:t,onMouseMove(t){n||0===p||(clearTimeout(w.current),w.current=setTimeout(()=>{O.current||i(!0,t.nativeEvent)},p))}},floating:{onMouseEnter(){clearTimeout(x.current)},onMouseLeave(t){o.emit("dismiss",{type:"mouseLeave",data:{returnFocus:!1}}),j(t.nativeEvent,!1)}}}},[o,l,p,n,i,j])}const oe=vt.createContext({delay:0,initialDelay:0,timeoutMs:0,currentId:null,setCurrentId:()=>{},setState:()=>{},isInstantPhase:!1}),se=()=>vt.useContext(oe),ae=t=>{let{children:e,delay:n,timeoutMs:i=0}=t;const[r,o]=vt.useReducer((t,e)=>({...t,...e}),{delay:n,timeoutMs:i,initialDelay:n,currentId:null,isInstantPhase:!1}),s=vt.useRef(null),a=vt.useCallback(t=>{o({currentId:t})},[]);return Vt(()=>{r.currentId?null===s.current?s.current=r.currentId:o({isInstantPhase:!0}):(o({isInstantPhase:!1}),s.current=null)},[r.currentId]),vt.createElement(oe.Provider,{value:vt.useMemo(()=>({...r,setState:o,setCurrentId:a}),[r,o,a])},e)},ce=(t,e)=>{let{open:n,onOpenChange:i}=t,{id:r}=e;const{currentId:o,setCurrentId:s,initialDelay:a,setState:c,timeoutMs:l}=se();Vt(()=>{o&&(c({delay:{open:1,close:ie(a,"close")}}),o!==r&&i(!1))},[r,i,c,o,a]),Vt(()=>{function t(){i(!1),c({delay:a,currentId:null})}if(!n&&o===r){if(l){const e=window.setTimeout(t,l);return()=>{clearTimeout(e)}}t()}},[n,c,o,r,i,a,l]),Vt(()=>{n&&s(r)},[n,s,r])};let le=0;function ue(t,e){void 0===e&&(e={});const{preventScroll:n=!1,cancelPrevious:i=!0,sync:r=!1}=e;i&&cancelAnimationFrame(le);const o=()=>null==t?void 0:t.focus({preventScroll:n});r?o():le=requestAnimationFrame(o)}function de(t,e){let n=t.filter(t=>{var n;return t.parentId===e&&(null==(n=t.context)?void 0:n.open)}),i=n;for(;i.length;)i=t.filter(t=>{var e;return null==(e=i)?void 0:e.some(e=>{var n;return t.parentId===e.id&&(null==(n=t.context)?void 0:n.open)})}),n=n.concat(i);return n}let he=new WeakMap,pe=new WeakSet,fe={},ge=0;const me=t=>t&&(t.host||me(t.parentNode));function ve(t,e,n,i){const r="data-floating-ui-inert",o=i?"inert":n?"aria-hidden":null,s=(a=e,t.map(t=>{if(a.contains(t))return t;const e=me(t);return a.contains(e)?e:null}).filter(t=>null!=t));var a;const c=new Set,l=new Set(s),u=[];fe[r]||(fe[r]=new WeakMap);const d=fe[r];return s.forEach((function t(e){if(!e||c.has(e))return;c.add(e),e.parentNode&&t(e.parentNode)})),function t(e){if(!e||l.has(e))return;Array.prototype.forEach.call(e.children,e=>{if(c.has(e))t(e);else{const t=o?e.getAttribute(o):null,n=null!==t&&"false"!==t,i=(he.get(e)||0)+1,s=(d.get(e)||0)+1;he.set(e,i),d.set(e,s),u.push(e),1===i&&n&&pe.add(e),1===s&&e.setAttribute(r,""),!n&&o&&e.setAttribute(o,"true")}})}(e),c.clear(),ge++,()=>{u.forEach(t=>{const e=(he.get(t)||0)-1,n=(d.get(t)||0)-1;he.set(t,e),d.set(t,n),e||(!pe.has(t)&&o&&t.removeAttribute(o),pe.delete(t)),n||t.removeAttribute(r)}),ge--,ge||(he=new WeakMap,he=new WeakMap,pe=new WeakSet,fe={})}}function be(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);const i=At(t[0]).body;return ve(t.concat(Array.from(i.querySelectorAll("[aria-live]"))),i,e,n)}const ye=()=>({getShadowRoot:!0,displayCheck:"function"==typeof ResizeObserver&&ResizeObserver.toString().includes("[native code]")?"full":"none"});function xe(t,e){const n=Object(Ft.a)(t,ye());"prev"===e&&n.reverse();const i=n.indexOf(St(At(t)));return n.slice(i+1)[0]}function _e(){return xe(document.body,"next")}function we(){return xe(document.body,"prev")}function Oe(t,e){const n=e||t.currentTarget,i=t.relatedTarget;return!i||!Ct(n,i)}function Pe(t){Object(Ft.a)(t,ye()).forEach(t=>{t.dataset.tabindex=t.getAttribute("tabindex")||"",t.setAttribute("tabindex","-1")})}function Se(t){t.querySelectorAll("[data-tabindex]").forEach(t=>{const e=t.dataset.tabindex;delete t.dataset.tabindex,e?t.setAttribute("tabindex",e):t.removeAttribute("tabindex")})}const Ce={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"fixed",whiteSpace:"nowrap",width:"1px",top:0,left:0};function je(t){"Tab"===t.key&&(t.target,clearTimeout(void 0))}const Me=vt.forwardRef((function(t,e){const[n,i]=vt.useState();Vt(()=>(Tt()&&i("button"),document.addEventListener("keydown",je),()=>{document.removeEventListener("keydown",je)}),[]);const r={ref:e,tabIndex:0,role:n,"aria-hidden":!n||void 0,[te("focus-guard")]:"",style:Ce};return vt.createElement("span",Nt({},t,r))})),Ee=vt.createContext(null);function Le(t){let{id:e,root:n}=void 0===t?{}:t;const[i,r]=vt.useState(null),o=Gt(),s=Re(),a=vt.useMemo(()=>({id:e,root:n,portalContext:s,uniqueId:o}),[e,n,s,o]),c=vt.useRef();return Vt(()=>()=>{null==i||i.remove()},[i,a]),Vt(()=>{if(c.current===a)return;c.current=a;const{id:t,root:e,portalContext:n,uniqueId:i}=a,o=t?document.getElementById(t):null,s=te("portal");if(o){const t=document.createElement("div");t.id=i,t.setAttribute(s,""),o.appendChild(t),r(t)}else{let o=e||(null==n?void 0:n.portalNode);o&&!G(o)&&(o=o.current),o=o||document.body;let a=null;t&&(a=document.createElement("div"),a.id=t,o.appendChild(a));const c=document.createElement("div");c.id=i,c.setAttribute(s,""),o=a||o,o.appendChild(c),r(c)}},[a]),i}function Te(t){let{children:e,id:n,root:i=null,preserveTabOrder:r=!0}=t;const o=Le({id:n,root:i}),[s,a]=vt.useState(null),c=vt.useRef(null),l=vt.useRef(null),u=vt.useRef(null),d=vt.useRef(null),h=!!s&&!s.modal&&s.open&&r&&!(!i&&!o);return vt.useEffect(()=>{if(o&&r&&(null==s||!s.modal))return o.addEventListener("focusin",t,!0),o.addEventListener("focusout",t,!0),()=>{o.removeEventListener("focusin",t,!0),o.removeEventListener("focusout",t,!0)};function t(t){if(o&&Oe(t)){("focusin"===t.type?Se:Pe)(o)}}},[o,r,null==s?void 0:s.modal]),vt.createElement(Ee.Provider,{value:vt.useMemo(()=>({preserveTabOrder:r,beforeOutsideRef:c,afterOutsideRef:l,beforeInsideRef:u,afterInsideRef:d,portalNode:o,setFocusManagerState:a}),[r,o])},h&&o&&vt.createElement(Me,{"data-type":"outside",ref:c,onFocus:t=>{if(Oe(t,o)){var e;null==(e=u.current)||e.focus()}else{const t=we()||(null==s?void 0:s.refs.domReference.current);null==t||t.focus()}}}),h&&o&&vt.createElement("span",{"aria-owns":o.id,style:Ce}),o&&Object(bt.createPortal)(e,o),h&&o&&vt.createElement(Me,{"data-type":"outside",ref:l,onFocus:t=>{if(Oe(t,o)){var e;null==(e=d.current)||e.focus()}else{const e=_e()||(null==s?void 0:s.refs.domReference.current);null==e||e.focus(),(null==s?void 0:s.closeOnFocusOut)&&(null==s||s.onOpenChange(!1,t.nativeEvent))}}}))}const Re=()=>vt.useContext(Ee),Ae=vt.forwardRef((function(t,e){return vt.createElement("button",Nt({},t,{type:"button",ref:e,tabIndex:-1,style:Ce}))}));function Ie(t){const{context:e,children:n,disabled:i=!1,order:r=["content"],guards:o=!0,initialFocus:s=0,returnFocus:a=!0,modal:c=!0,visuallyHiddenDismiss:l=!1,closeOnFocusOut:u=!0}=t,{open:d,refs:h,nodeId:p,onOpenChange:f,events:g,dataRef:m,elements:{domReference:v,floating:b}}=e,y="undefined"==typeof HTMLElement||!("inert"in HTMLElement.prototype)||o,x=ee(r),_=ee(s),w=ee(a),O=Yt(),P=Re(),S="number"==typeof s&&s<0,C=vt.useRef(null),j=vt.useRef(null),M=vt.useRef(!1),E=vt.useRef(null),L=vt.useRef(!1),T=null!=P,R=v&&"combobox"===v.getAttribute("role")&&zt(v),A=vt.useCallback((function(t){return void 0===t&&(t=b),t?Object(Ft.a)(t,ye()):[]}),[b]),I=vt.useCallback(t=>{const e=A(t);return x.current.map(t=>v&&"reference"===t?v:b&&"floating"===t?b:e).filter(Boolean).flat()},[v,b,x,A]);function k(t){return!i&&l&&c?vt.createElement(Ae,{ref:"start"===t?C:j,onClick:t=>f(!1,t.nativeEvent)},"string"==typeof l?l:"Dismiss"):null}vt.useEffect(()=>{if(i||!c)return;function t(t){if("Tab"===t.key){Ct(b,St(At(b)))&&0===A().length&&!R&&Dt(t);const e=I(),n=kt(t);"reference"===x.current[0]&&n===v&&(Dt(t),t.shiftKey?ue(e[e.length-1]):ue(e[1])),"floating"===x.current[1]&&n===b&&t.shiftKey&&(Dt(t),ue(e[0]))}}const e=At(b);return e.addEventListener("keydown",t),()=>{e.removeEventListener("keydown",t)}},[i,v,b,c,x,h,R,A,I]),vt.useEffect(()=>{if(!i&&u)return b&&H(v)?(v.addEventListener("focusout",e),v.addEventListener("pointerdown",t),!c&&b.addEventListener("focusout",e),()=>{v.removeEventListener("focusout",e),v.removeEventListener("pointerdown",t),!c&&b.removeEventListener("focusout",e)}):void 0;function t(){L.current=!0,setTimeout(()=>{L.current=!1})}function e(t){const e=t.relatedTarget;queueMicrotask(()=>{const n=!(Ct(v,e)||Ct(b,e)||Ct(e,b)||Ct(null==P?void 0:P.portalNode,e)||null!=e&&e.hasAttribute(te("focus-guard"))||O&&(de(O.nodesRef.current,p).find(t=>{var n,i;return Ct(null==(n=t.context)?void 0:n.elements.floating,e)||Ct(null==(i=t.context)?void 0:i.elements.domReference,e)})||function(t,e){var n;let i=[],r=null==(n=t.find(t=>t.id===e))?void 0:n.parentId;for(;r;){const e=t.find(t=>t.id===r);r=null==e?void 0:e.parentId,e&&(i=i.concat(e))}return i}(O.nodesRef.current,p).find(t=>{var n,i;return(null==(n=t.context)?void 0:n.elements.floating)===e||(null==(i=t.context)?void 0:i.elements.domReference)===e})));e&&n&&!L.current&&e!==E.current&&(M.current=!0,f(!1,t))})}},[i,v,b,c,p,O,P,f,u]),vt.useEffect(()=>{var t;if(i)return;const e=Array.from((null==P||null==(t=P.portalNode)?void 0:t.querySelectorAll("["+te("portal")+"]"))||[]);if(b){const t=[b,...e,C.current,j.current,x.current.includes("reference")||R?v:null].filter(t=>null!=t),n=c?be(t,y,!y):be(t);return()=>{n()}}},[i,v,b,c,x,P,R,y]),Vt(()=>{if(i||!b)return;const t=St(At(b));queueMicrotask(()=>{const e=I(b),n=_.current,i=("number"==typeof n?e[n]:n.current)||b,r=Ct(b,t);S||r||!d||ue(i,{preventScroll:i===b})})},[i,d,b,S,I,_]),Vt(()=>{if(i||!b)return;let t=!1;const e=At(b),n=St(e),r=m.current;function o(e){if("escapeKey"===e.type&&h.domReference.current&&(E.current=h.domReference.current),["referencePress","escapeKey"].includes(e.type))return;const n=e.data.returnFocus;"object"==typeof n?(M.current=!1,t=n.preventScroll):M.current=!n}return E.current=n,g.on("dismiss",o),()=>{g.off("dismiss",o);const n=St(e);(Ct(b,n)||O&&de(O.nodesRef.current,p).some(t=>{var e;return Ct(null==(e=t.context)?void 0:e.elements.floating,n)})||r.openEvent&&["click","mousedown"].includes(r.openEvent.type))&&h.domReference.current&&(E.current=h.domReference.current),w.current&&H(E.current)&&!M.current&&ue(E.current,{cancelPrevious:!1,preventScroll:t})}},[i,b,w,m,h,g,O,p]),Vt(()=>{if(!i&&P)return P.setFocusManagerState({modal:c,closeOnFocusOut:u,open:d,onOpenChange:f,refs:h}),()=>{P.setFocusManagerState(null)}},[i,P,c,d,f,h,u]),Vt(()=>{if(!i&&b&&"function"==typeof MutationObserver){const t=()=>{const t=b.getAttribute("tabindex");x.current.includes("floating")||St(At(b))!==h.domReference.current&&0===A().length?"0"!==t&&b.setAttribute("tabindex","0"):"-1"!==t&&b.setAttribute("tabindex","-1")};t();const e=new MutationObserver(t);return e.observe(b,{childList:!0,subtree:!0,attributes:!0}),()=>{e.disconnect()}}},[i,b,h,x,A]);const z=!i&&y&&!R&&(T||c);return vt.createElement(vt.Fragment,null,z&&vt.createElement(Me,{"data-type":"inside",ref:null==P?void 0:P.beforeInsideRef,onFocus:t=>{if(c){const t=I();ue("reference"===r[0]?t[0]:t[t.length-1])}else if(null!=P&&P.preserveTabOrder&&P.portalNode)if(M.current=!1,Oe(t,P.portalNode)){const t=_e()||v;null==t||t.focus()}else{var e;null==(e=P.beforeOutsideRef.current)||e.focus()}}}),!R&&k("start"),n,k("end"),z&&vt.createElement(Me,{"data-type":"inside",ref:null==P?void 0:P.afterInsideRef,onFocus:t=>{if(c)ue(I()[0]);else if(null!=P&&P.preserveTabOrder&&P.portalNode)if(u&&(M.current=!0),Oe(t,P.portalNode)){const t=we()||v;null==t||t.focus()}else{var e;null==(e=P.afterOutsideRef.current)||e.focus()}}}))}function ke(t,e){const n=t.compareDocumentPosition(e);return n&Node.DOCUMENT_POSITION_FOLLOWING||n&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:n&Node.DOCUMENT_POSITION_PRECEDING||n&Node.DOCUMENT_POSITION_CONTAINS?1:0}const ze=vt.createContext({register:()=>{},unregister:()=>{},map:new Map,elementsRef:{current:[]}});function De(t){let{children:e,elementsRef:n,labelsRef:i}=t;const[r,o]=vt.useState(()=>new Map),s=vt.useCallback(t=>{o(e=>new Map(e).set(t,null))},[]),a=vt.useCallback(t=>{o(e=>{const n=new Map(e);return n.delete(t),n})},[]);return Vt(()=>{const t=new Map(r);Array.from(t.keys()).sort(ke).forEach((e,n)=>{t.set(e,n)}),function(t,e){if(t.size!==e.size)return!1;for(const[n,i]of t.entries())if(i!==e.get(n))return!1;return!0}(r,t)||o(t)},[r]),vt.createElement(ze.Provider,{value:vt.useMemo(()=>({register:s,unregister:a,map:r,elementsRef:n,labelsRef:i}),[s,a,r,n,i])},e)}function Fe(t){let{label:e}=void 0===t?{}:t;const[n,i]=vt.useState(null),r=vt.useRef(null),{register:o,unregister:s,map:a,elementsRef:c,labelsRef:l}=vt.useContext(ze),u=vt.useCallback(t=>{if(r.current=t,null!==n&&(c.current[n]=t,l)){var i;const r=void 0!==e;l.current[n]=r?e:null!=(i=null==t?void 0:t.textContent)?i:null}},[n,c,l,e]);return Vt(()=>{const t=r.current;if(t)return o(t),()=>{s(t)}},[o,s]),Vt(()=>{const t=r.current?a.get(r.current):null;null!=t&&i(t)},[a]),vt.useMemo(()=>({ref:u,index:null==n?-1:n}),[n,u])}const Ne=te("scroll-lock"),Ve=vt.forwardRef((function(t,e){let{lockScroll:n=!1,...i}=t;return Vt(()=>{var t,e;if(!n)return;if(document.body.hasAttribute(Ne))return;document.body.setAttribute(Ne,"");const i=Math.round(document.documentElement.getBoundingClientRect().left)+document.documentElement.scrollLeft?"paddingLeft":"paddingRight",r=window.innerWidth-document.documentElement.clientWidth;if(!/iP(hone|ad|od)|iOS/.test(jt()))return Object.assign(document.body.style,{overflow:"hidden",[i]:r+"px"}),()=>{document.body.removeAttribute(Ne),Object.assign(document.body.style,{overflow:"",[i]:""})};const o=(null==(t=window.visualViewport)?void 0:t.offsetLeft)||0,s=(null==(e=window.visualViewport)?void 0:e.offsetTop)||0,a=window.pageXOffset,c=window.pageYOffset;return Object.assign(document.body.style,{position:"fixed",overflow:"hidden",top:-(c-Math.floor(s))+"px",left:-(a-Math.floor(o))+"px",right:"0",[i]:r+"px"}),()=>{Object.assign(document.body.style,{position:"",overflow:"",top:"",left:"",right:"",[i]:""}),document.body.removeAttribute(Ne),window.scrollTo(a,c)}},[n]),vt.createElement("div",Nt({ref:e},i,{style:{position:"fixed",overflow:"auto",top:0,right:0,bottom:0,left:0,...i.style}}))}));function Ue(t){return H(t.target)&&"BUTTON"===t.target.tagName}function Be(t){return zt(t)}function We(t,e){void 0===e&&(e={});const{open:n,onOpenChange:i,dataRef:r,elements:{domReference:o}}=t,{enabled:s=!0,event:a="click",toggle:c=!0,ignoreMouse:l=!1,keyboardHandlers:u=!0}=e,d=vt.useRef(),h=vt.useRef(!1);return vt.useMemo(()=>s?{reference:{onPointerDown(t){d.current=t.pointerType},onMouseDown(t){0===t.button&&(Rt(d.current,!0)&&l||"click"!==a&&(!n||!c||r.current.openEvent&&"mousedown"!==r.current.openEvent.type?(t.preventDefault(),i(!0,t.nativeEvent)):i(!1,t.nativeEvent)))},onClick(t){"mousedown"===a&&d.current?d.current=void 0:Rt(d.current,!0)&&l||(!n||!c||r.current.openEvent&&"click"!==r.current.openEvent.type?i(!0,t.nativeEvent):i(!1,t.nativeEvent))},onKeyDown(t){d.current=void 0,t.defaultPrevented||!u||Ue(t)||(" "!==t.key||Be(o)||(t.preventDefault(),h.current=!0),"Enter"===t.key&&i(!n||!c,t.nativeEvent))},onKeyUp(t){t.defaultPrevented||!u||Ue(t)||Be(o)||" "===t.key&&h.current&&(h.current=!1,i(!n||!c,t.nativeEvent))}}}:{},[s,r,a,l,u,o,c,n,i])}const Ge=vt["useInsertionEffect".toString()]||(t=>t());function He(t){const e=vt.useRef(()=>{0});return Ge(()=>{e.current=t}),vt.useCallback((function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return null==e.current?void 0:e.current(...n)}),[])}function Ze(t){return null!=t&&null!=t.clientX}function qe(t,e){void 0===e&&(e={});const{open:n,refs:i,dataRef:r,elements:{floating:o}}=t,{enabled:s=!0,axis:a="both",x:c=null,y:l=null}=e,u=vt.useRef(!1),d=vt.useRef(null),[h,p]=vt.useState(),[f,g]=vt.useState([]),m=He((t,e)=>{u.current||r.current.openEvent&&!Ze(r.current.openEvent)||i.setPositionReference(function(t,e){let n=null,i=null,r=!1;return{contextElement:t.current||void 0,getBoundingClientRect(){var o,s;const a=(null==(o=t.current)?void 0:o.getBoundingClientRect())||{width:0,height:0,x:0,y:0},c="x"===e.axis||"both"===e.axis,l="y"===e.axis||"both"===e.axis,u=["mouseenter","mousemove"].includes((null==(s=e.dataRef.current.openEvent)?void 0:s.type)||"")&&"touch"!==e.pointerType;let d=a.width,h=a.height,p=a.x,f=a.y;return null==n&&e.x&&c&&(n=a.x-e.x),null==i&&e.y&&l&&(i=a.y-e.y),p-=n||0,f-=i||0,d=0,h=0,!r||u?(d="y"===e.axis?a.width:0,h="x"===e.axis?a.height:0,p=c&&null!=e.x?e.x:p,f=l&&null!=e.y?e.y:f):r&&!u&&(h="x"===e.axis?a.height:h,d="y"===e.axis?a.width:d),r=!0,{width:d,height:h,x:p,y:f,top:f,right:p+d,bottom:f+h,left:p}}}}(i.domReference,{x:t,y:e,axis:a,dataRef:r,pointerType:h}))}),v=He(t=>{null==c&&null==l&&(n?d.current||g([]):m(t.clientX,t.clientY))}),b=Rt(h)?o:n,y=vt.useCallback(()=>{if(!b||!s||null!=c||null!=l)return;const t=U(i.floating.current);function e(n){const r=kt(n);Ct(i.floating.current,r)?(t.removeEventListener("mousemove",e),d.current=null):m(n.clientX,n.clientY)}if(!r.current.openEvent||Ze(r.current.openEvent)){t.addEventListener("mousemove",e);const n=()=>{t.removeEventListener("mousemove",e),d.current=null};return d.current=n,n}i.setPositionReference(i.domReference.current)},[r,s,b,i,m,c,l]);return vt.useEffect(()=>y(),[y,f]),vt.useEffect(()=>{s&&!o&&(u.current=!1)},[s,o]),vt.useEffect(()=>{!s&&n&&(u.current=!0)},[s,n]),Vt(()=>{!s||null==c&&null==l||(u.current=!1,m(c,l))},[s,c,l,m]),vt.useMemo(()=>{if(!s)return{};function t(t){let{pointerType:e}=t;p(e)}return{reference:{onPointerDown:t,onPointerEnter:t,onMouseMove:v,onMouseEnter:v}}},[s,v])}const Ke={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},Xe={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"};function Ye(t,e){void 0===e&&(e={});const{open:n,onOpenChange:i,events:r,nodeId:o,elements:{reference:s,domReference:a,floating:c},dataRef:l}=t,{enabled:u=!0,escapeKey:d=!0,outsidePress:h=!0,outsidePressEvent:p="pointerdown",referencePress:f=!1,referencePressEvent:g="pointerdown",ancestorScroll:m=!1,bubbles:v}=e,b=Yt(),y=null!=Xt(),x=He("function"==typeof h?h:()=>!1),_="function"==typeof h?x:h,w=vt.useRef(!1),{escapeKeyBubbles:O,outsidePressBubbles:P}=(t=>{var e,n;return{escapeKeyBubbles:"boolean"==typeof t?t:null!=(e=null==t?void 0:t.escapeKey)&&e,outsidePressBubbles:"boolean"==typeof t?t:null==(n=null==t?void 0:t.outsidePress)||n}})(v),S=He(t=>{if(!n||!u||!d||"Escape"!==t.key)return;const e=b?de(b.nodesRef.current,o):[];if(!O&&(t.stopPropagation(),e.length>0)){let t=!0;if(e.forEach(e=>{var n;null==(n=e.context)||!n.open||e.context.dataRef.current.__escapeKeyBubbles||(t=!1)}),!t)return}r.emit("dismiss",{type:"escapeKey",data:{returnFocus:{preventScroll:!1}}}),i(!1,function(t){return"nativeEvent"in t}(t)?t.nativeEvent:t)}),C=He(t=>{const e=w.current;if(w.current=!1,e)return;if("function"==typeof _&&!_(t))return;const n=kt(t),s="["+te("inert")+"]",l=At(c).querySelectorAll(s);let u=G(n)?n:null;for(;u&&!J(u);){const t=tt(u);if(t===At(c).body||!G(t))break;u=t}if(l.length&&G(n)&&!n.matches("html,body")&&!Ct(n,c)&&Array.from(l).every(t=>!Ct(u,t)))return;if(H(n)&&c){const e=n.clientWidth>0&&n.scrollWidth>n.clientWidth,i=n.clientHeight>0&&n.scrollHeight>n.clientHeight;let r=i&&t.offsetX>n.clientWidth;if(i){"rtl"===Q(n).direction&&(r=t.offsetX<=n.offsetWidth-n.clientWidth)}if(r||e&&t.offsetY>n.clientHeight)return}const d=b&&de(b.nodesRef.current,o).some(e=>{var n;return It(t,null==(n=e.context)?void 0:n.elements.floating)});if(It(t,c)||It(t,a)||d)return;const h=b?de(b.nodesRef.current,o):[];if(h.length>0){let t=!0;if(h.forEach(e=>{var n;null==(n=e.context)||!n.open||e.context.dataRef.current.__outsidePressBubbles||(t=!1)}),!t)return}r.emit("dismiss",{type:"outsidePress",data:{returnFocus:y?{preventScroll:!0}:Et(t)||Lt(t)}}),i(!1,t)});return vt.useEffect(()=>{if(!n||!u)return;function t(t){i(!1,t)}l.current.__escapeKeyBubbles=O,l.current.__outsidePressBubbles=P;const e=At(c);d&&e.addEventListener("keydown",S),_&&e.addEventListener(p,C);let r=[];return m&&(G(a)&&(r=et(a)),G(c)&&(r=r.concat(et(c))),!G(s)&&s&&s.contextElement&&(r=r.concat(et(s.contextElement)))),r=r.filter(t=>{var n;return t!==(null==(n=e.defaultView)?void 0:n.visualViewport)}),r.forEach(e=>{e.addEventListener("scroll",t,{passive:!0})}),()=>{d&&e.removeEventListener("keydown",S),_&&e.removeEventListener(p,C),r.forEach(e=>{e.removeEventListener("scroll",t)})}},[l,c,a,s,d,_,p,n,i,m,u,O,P,S,C]),vt.useEffect(()=>{w.current=!1},[_,p]),vt.useMemo(()=>u?{reference:{onKeyDown:S,[Ke[g]]:t=>{f&&(r.emit("dismiss",{type:"referencePress",data:{returnFocus:!1}}),i(!1,t.nativeEvent))}},floating:{onKeyDown:S,[Xe[p]]:()=>{w.current=!0}}}:{},[u,r,f,p,g,i,S])}function Je(t){var e;void 0===t&&(t={});const{open:n=!1,onOpenChange:i,nodeId:r}=t;const[o,s]=vt.useState(null),a=(null==(e=t.elements)?void 0:e.reference)||o,c=function(t){void 0===t&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:i=[],platform:r,elements:{reference:o,floating:s}={},transform:a=!0,whileElementsMounted:c,open:l}=t,[u,d]=vt.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[h,p]=vt.useState(i);_t(h,i)||p(i);const[f,g]=vt.useState(null),[m,v]=vt.useState(null),b=vt.useCallback(t=>{t!=w.current&&(w.current=t,g(t))},[g]),y=vt.useCallback(t=>{t!==O.current&&(O.current=t,v(t))},[v]),x=o||f,_=s||m,w=vt.useRef(null),O=vt.useRef(null),P=vt.useRef(u),S=Pt(c),C=Pt(r),j=vt.useCallback(()=>{if(!w.current||!O.current)return;const t={placement:e,strategy:n,middleware:h};C.current&&(t.platform=C.current),mt(w.current,O.current,t).then(t=>{const e={...t,isPositioned:!0};M.current&&!_t(P.current,e)&&(P.current=e,bt.flushSync(()=>{d(e)}))})},[h,e,n,C]);xt(()=>{!1===l&&P.current.isPositioned&&(P.current.isPositioned=!1,d(t=>({...t,isPositioned:!1})))},[l]);const M=vt.useRef(!1);xt(()=>(M.current=!0,()=>{M.current=!1}),[]),xt(()=>{if(x&&(w.current=x),_&&(O.current=_),x&&_){if(S.current)return S.current(x,_,j);j()}},[x,_,j,S]);const E=vt.useMemo(()=>({reference:w,floating:O,setReference:b,setFloating:y}),[b,y]),L=vt.useMemo(()=>({reference:x,floating:_}),[x,_]),T=vt.useMemo(()=>{const t={position:n,left:0,top:0};if(!L.floating)return t;const e=Ot(L.floating,u.x),i=Ot(L.floating,u.y);return a?{...t,transform:"translate("+e+"px, "+i+"px)",...wt(L.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:e,top:i}},[n,a,L.floating,u.x,u.y]);return vt.useMemo(()=>({...u,update:j,refs:E,elements:L,floatingStyles:T}),[u,j,E,L,T])}(t),l=Yt(),u=He((t,e)=>{t&&(h.current.openEvent=e),null==i||i(t,e)}),d=vt.useRef(null),h=vt.useRef({}),p=vt.useState(()=>Zt())[0],f=Gt(),g=vt.useCallback(t=>{const e=G(t)?{getBoundingClientRect:()=>t.getBoundingClientRect(),contextElement:t}:t;c.refs.setReference(e)},[c.refs]),m=vt.useCallback(t=>{(G(t)||null===t)&&(d.current=t,s(t)),(G(c.refs.reference.current)||null===c.refs.reference.current||null!==t&&!G(t))&&c.refs.setReference(t)},[c.refs]),v=vt.useMemo(()=>({...c.refs,setReference:m,setPositionReference:g,domReference:d}),[c.refs,m,g]),b=vt.useMemo(()=>({...c.elements,domReference:a}),[c.elements,a]),y=vt.useMemo(()=>({...c,refs:v,elements:b,dataRef:h,nodeId:r,floatingId:f,events:p,open:n,onOpenChange:u}),[c,r,f,p,n,u,v,b]);return Vt(()=>{const t=null==l?void 0:l.nodesRef.current.find(t=>t.id===r);t&&(t.context=y)}),vt.useMemo(()=>({...c,context:y,refs:v,elements:b}),[c,v,b,y])}function Qe(t,e){void 0===e&&(e={});const{open:n,onOpenChange:i,dataRef:r,events:o,refs:s,elements:{floating:a,domReference:c}}=t,{enabled:l=!0,keyboardOnly:u=!0}=e,d=vt.useRef(""),h=vt.useRef(!1),p=vt.useRef();return vt.useEffect(()=>{if(!l)return;const t=At(a).defaultView||window;function e(){!n&&H(c)&&c===St(At(c))&&(h.current=!0)}return t.addEventListener("blur",e),()=>{t.removeEventListener("blur",e)}},[a,c,n,l]),vt.useEffect(()=>{if(l)return o.on("dismiss",t),()=>{o.off("dismiss",t)};function t(t){"referencePress"!==t.type&&"escapeKey"!==t.type||(h.current=!0)}},[o,l]),vt.useEffect(()=>()=>{clearTimeout(p.current)},[]),vt.useMemo(()=>l?{reference:{onPointerDown(t){let{pointerType:e}=t;d.current=e,h.current=!(!e||!u)},onMouseLeave(){h.current=!1},onFocus(t){var e;h.current||"focus"===t.type&&"mousedown"===(null==(e=r.current.openEvent)?void 0:e.type)&&It(r.current.openEvent,c)||i(!0,t.nativeEvent)},onBlur(t){h.current=!1;const e=t.relatedTarget,n=G(e)&&e.hasAttribute(te("focus-guard"))&&"outside"===e.getAttribute("data-type");p.current=setTimeout(()=>{Ct(s.floating.current,e)||Ct(c,e)||n||i(!1,t.nativeEvent)})}}}:{},[l,u,c,s,r,i])}function $e(t,e,n){const i=new Map;return{..."floating"===n&&{tabIndex:-1},...t,...e.map(t=>t?t[n]:null).concat(t).reduce((t,e)=>e?(Object.entries(e).forEach(e=>{let[n,r]=e;var o;0===n.indexOf("on")?(i.has(n)||i.set(n,[]),"function"==typeof r&&(null==(o=i.get(n))||o.push(r),t[n]=function(){for(var t,e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return null==(t=i.get(n))?void 0:t.map(t=>t(...r)).find(t=>void 0!==t)})):t[n]=r}),t):t,{})}}function tn(t){void 0===t&&(t=[]);const e=t,n=vt.useCallback(e=>$e(e,t,"reference"),e),i=vt.useCallback(e=>$e(e,t,"floating"),e),r=vt.useCallback(e=>$e(e,t,"item"),t.map(t=>null==t?void 0:t.item));return vt.useMemo(()=>({getReferenceProps:n,getFloatingProps:i,getItemProps:r}),[n,i,r])}let en=!1;function nn(t,e,n){return Math.floor(t/e)!==n}function rn(t,e){return e<0||e>=t.current.length}function on(t,e){let{startingIndex:n=-1,decrement:i=!1,disabledIndices:r,amount:o=1}=void 0===e?{}:e;const s=t.current;let a=n;do{var c,l;a+=i?-o:o}while(a>=0&&a<=s.length-1&&(r?r.includes(a):null==s[a]||(null==(c=s[a])?void 0:c.hasAttribute("disabled"))||"true"===(null==(l=s[a])?void 0:l.getAttribute("aria-disabled"))));return a}function sn(t,e,n){switch(t){case"vertical":return e;case"horizontal":return n;default:return e||n}}function an(t,e){return sn(e,"ArrowUp"===t||"ArrowDown"===t,"ArrowLeft"===t||"ArrowRight"===t)}function cn(t,e,n){return sn(e,"ArrowDown"===t,n?"ArrowLeft"===t:"ArrowRight"===t)||"Enter"===t||" "==t||""===t}function ln(t,e){return on(t,{disabledIndices:e})}function un(t,e){return on(t,{decrement:!0,startingIndex:t.current.length,disabledIndices:e})}function dn(t,e){const{open:n,onOpenChange:i,refs:r,elements:{domReference:o,floating:s}}=t,{listRef:a,activeIndex:c,onNavigate:l=(()=>{}),enabled:u=!0,selectedIndex:d=null,allowEscape:h=!1,loop:p=!1,nested:f=!1,rtl:g=!1,virtual:m=!1,focusItemOnOpen:v="auto",focusItemOnHover:b=!0,openOnArrowKeyDown:y=!0,disabledIndices:x,orientation:_="vertical",cols:w=1,scrollItemIntoView:O=!0}=e;const P=Xt(),S=Yt(),C=He(l),j=vt.useRef(v),M=vt.useRef(null!=d?d:-1),E=vt.useRef(null),L=vt.useRef(!0),T=vt.useRef(C),R=vt.useRef(!!s),A=vt.useRef(!1),I=vt.useRef(!1),k=ee(x),z=ee(n),D=ee(O),[F,N]=vt.useState(),V=He((function(t,e,n){void 0===n&&(n=!1);const i=t.current[e.current];i&&(m?N(i.id):ue(i,{preventScroll:!0,sync:!(!jt().toLowerCase().startsWith("mac")||navigator.maxTouchPoints||!Tt())&&(en||A.current)}),requestAnimationFrame(()=>{const t=D.current;t&&i&&(n||!L.current)&&(null==i.scrollIntoView||i.scrollIntoView("boolean"==typeof t?{block:"nearest",inline:"nearest"}:t))}))}));Vt(()=>{document.createElement("div").focus({get preventScroll(){return en=!0,!1}})},[]),Vt(()=>{u&&(n&&s?j.current&&null!=d&&(I.current=!0,C(d)):R.current&&(M.current=-1,T.current(null)))},[u,n,s,d,C]),Vt(()=>{if(u&&n&&s)if(null==c){if(A.current=!1,null!=d)return;if(R.current&&(M.current=-1,V(a,M)),!R.current&&j.current&&(null!=E.current||!0===j.current&&null==E.current)){let t=0;const e=()=>{if(null==a.current[0]){if(t<2){(t?requestAnimationFrame:queueMicrotask)(e)}t++}else M.current=null==E.current||cn(E.current,_,g)||f?ln(a,k.current):un(a,k.current),E.current=null,C(M.current)};e()}}else rn(a,c)||(M.current=c,V(a,M,I.current),I.current=!1)},[u,n,s,c,d,f,a,_,g,C,V,k]),Vt(()=>{if(u&&R.current&&!s&&S){var t,e;const n=S.nodesRef.current,i=null==(t=n.find(t=>t.id===P))||null==(e=t.context)?void 0:e.elements.floating,r=St(At(s)),o=n.some(t=>t.context&&Ct(t.context.elements.floating,r));i&&!o&&i.focus({preventScroll:!0})}},[u,s,S,P]),Vt(()=>{T.current=C,R.current=!!s}),Vt(()=>{n||(E.current=null)},[n]);const U=null!=c,B=vt.useMemo(()=>{function t(t){if(!n)return;const e=a.current.indexOf(t);-1!==e&&C(e)}return{onFocus(e){let{currentTarget:n}=e;t(n)},onClick:t=>{let{currentTarget:e}=t;return e.focus({preventScroll:!0})},...b&&{onMouseMove(e){let{currentTarget:n}=e;t(n)},onPointerLeave(t){let{pointerType:e}=t;L.current&&"touch"!==e&&(M.current=-1,V(a,M),C(null),m||ue(r.floating.current,{preventScroll:!0}))}}}},[n,r,V,b,a,C,m]);return vt.useMemo(()=>{if(!u)return{};const t=k.current;function e(e){if(L.current=!1,A.current=!0,!z.current&&e.currentTarget===r.floating.current)return;if(f&&function(t,e,n){return sn(e,n?"ArrowRight"===t:"ArrowLeft"===t,"ArrowUp"===t)}(e.key,_,g))return Dt(e),i(!1,e.nativeEvent),void(H(o)&&o.focus());const s=M.current,c=ln(a,t),l=un(a,t);if("Home"===e.key&&(Dt(e),M.current=c,C(M.current)),"End"===e.key&&(Dt(e),M.current=l,C(M.current)),w>1){const n=M.current;if("ArrowUp"===e.key){if(Dt(e),-1===n)M.current=l;else if(M.current=on(a,{startingIndex:n,amount:w,decrement:!0,disabledIndices:t}),p&&(n-w<c||M.current<0)){const t=n%w,e=l%w,i=l-(e-t);M.current=e===t?l:e>t?i:i-w}rn(a,M.current)&&(M.current=n),C(M.current)}if("ArrowDown"===e.key&&(Dt(e),-1===n?M.current=c:(M.current=on(a,{startingIndex:n,amount:w,disabledIndices:t}),p&&n+w>l&&(M.current=on(a,{startingIndex:n%w-w,amount:w,disabledIndices:t}))),rn(a,M.current)&&(M.current=n),C(M.current)),"both"===_){const i=Math.floor(n/w);"ArrowRight"===e.key&&(Dt(e),n%w!=w-1?(M.current=on(a,{startingIndex:n,disabledIndices:t}),p&&nn(M.current,w,i)&&(M.current=on(a,{startingIndex:n-n%w-1,disabledIndices:t}))):p&&(M.current=on(a,{startingIndex:n-n%w-1,disabledIndices:t})),nn(M.current,w,i)&&(M.current=n)),"ArrowLeft"===e.key&&(Dt(e),n%w!=0?(M.current=on(a,{startingIndex:n,disabledIndices:t,decrement:!0}),p&&nn(M.current,w,i)&&(M.current=on(a,{startingIndex:n+(w-n%w),decrement:!0,disabledIndices:t}))):p&&(M.current=on(a,{startingIndex:n+(w-n%w),decrement:!0,disabledIndices:t})),nn(M.current,w,i)&&(M.current=n));const r=Math.floor(l/w)===i;return rn(a,M.current)&&(M.current=p&&r?"ArrowLeft"===e.key?l:on(a,{startingIndex:n-n%w-1,disabledIndices:t}):n),void C(M.current)}}if(an(e.key,_)){if(Dt(e),n&&!m&&St(e.currentTarget.ownerDocument)===e.currentTarget)return M.current=cn(e.key,_,g)?c:l,void C(M.current);cn(e.key,_,g)?M.current=p?s>=l?h&&s!==a.current.length?-1:c:on(a,{startingIndex:s,disabledIndices:t}):Math.min(l,on(a,{startingIndex:s,disabledIndices:t})):M.current=p?s<=c?h&&-1!==s?a.current.length:l:on(a,{startingIndex:s,decrement:!0,disabledIndices:t}):Math.max(c,on(a,{startingIndex:s,decrement:!0,disabledIndices:t})),rn(a,M.current)?C(null):C(M.current)}}function s(t){"auto"===v&&Et(t.nativeEvent)&&(j.current=!0)}const c=m&&n&&U&&{"aria-activedescendant":F};return{reference:{...c,onKeyDown(r){L.current=!1;const o=0===r.key.indexOf("Arrow");if(m&&n)return e(r);if(!n&&!y&&o)return;const s=o||"Enter"===r.key||""===r.key.trim(),c=an(r.key,_),l=function(t,e,n){return sn(e,n?"ArrowLeft"===t:"ArrowRight"===t,"ArrowDown"===t)}(r.key,_,g);s&&(E.current=f&&c?null:r.key),f?l&&(Dt(r),n?(M.current=ln(a,t),C(M.current)):i(!0,r.nativeEvent)):c&&(null!=d&&(M.current=d),Dt(r),!n&&y?i(!0,r.nativeEvent):e(r),n&&C(M.current))},onFocus(){n&&C(null)},onPointerDown:function(t){j.current=v,"auto"===v&&Lt(t.nativeEvent)&&(j.current=!0)},onMouseDown:s,onClick:s},floating:{"aria-orientation":"both"===_?void 0:_,...c,onKeyDown:e,onPointerMove(){L.current=!0}},item:B}},[o,r,F,k,z,a,u,_,g,m,n,U,f,d,y,h,w,p,v,C,i,B])}function hn(t){return vt.useMemo(()=>t.every(t=>null==t)?null:e=>{t.forEach(t=>{"function"==typeof t?t(e):null!=t&&(t.current=e)})},t)}function pn(t,e){void 0===e&&(e={});const{open:n,floatingId:i}=t,{enabled:r=!0,role:o="dialog"}=e,s=Gt();return vt.useMemo(()=>{const t={id:i,role:o};return r?"tooltip"===o?{reference:{"aria-describedby":n?i:void 0},floating:t}:{reference:{"aria-expanded":n?"true":"false","aria-haspopup":"alertdialog"===o?"dialog":o,"aria-controls":n?i:void 0,..."listbox"===o&&{role:"combobox"},..."menu"===o&&{id:s}},floating:{...t,..."menu"===o&&{"aria-labelledby":s}}}:{}},[r,o,n,i,s])}const fn=t=>t.replace(/[A-Z]+(?![a-z])|[A-Z]/g,(t,e)=>(e?"-":"")+t.toLowerCase());function gn(t,e){return"function"==typeof t?t(e):t}function mn(t,e){void 0===e&&(e={});const{open:n,elements:{floating:i}}=t,{duration:r=250}=e,o=("number"==typeof r?r:r.close)||0,[s,a]=vt.useState(!1),[c,l]=vt.useState("unmounted"),u=function(t,e){const[n,i]=vt.useState(t);return t&&!n&&i(!0),vt.useEffect(()=>{if(!t){const t=setTimeout(()=>i(!1),e);return()=>clearTimeout(t)}},[t,e]),n}(n,o);return Vt(()=>{s&&!u&&l("unmounted")},[s,u]),Vt(()=>{if(i){if(n){l("initial");const t=requestAnimationFrame(()=>{l("open")});return()=>{cancelAnimationFrame(t)}}a(!0),l("close")}},[n,i]),{isMounted:u,status:c}}function vn(t,e){void 0===e&&(e={});const{initial:n={opacity:0},open:i,close:r,common:o,duration:s=250}=e,a=t.placement,c=a.split("-")[0],l=vt.useMemo(()=>({side:c,placement:a}),[c,a]),u="number"==typeof s,d=(u?s:s.open)||0,h=(u?s:s.close)||0,[p,f]=vt.useState(()=>({...gn(o,l),...gn(n,l)})),{isMounted:g,status:m}=mn(t,{duration:s}),v=ee(n),b=ee(i),y=ee(r),x=ee(o);return Vt(()=>{const t=gn(v.current,l),e=gn(y.current,l),n=gn(x.current,l),i=gn(b.current,l)||Object.keys(t).reduce((t,e)=>(t[e]="",t),{});if("initial"===m&&f(e=>({transitionProperty:e.transitionProperty,...n,...t})),"open"===m&&f({transitionProperty:Object.keys(i).map(fn).join(","),transitionDuration:d+"ms",...n,...i}),"close"===m){const i=e||t;f({transitionProperty:Object.keys(i).map(fn).join(","),transitionDuration:h+"ms",...n,...i})}},[h,y,v,b,x,d,m,l]),{isMounted:g,styles:p}}function bn(t,e){var n;const{open:i,dataRef:r}=t,{listRef:o,activeIndex:s,onMatch:a,onTypingChange:c,enabled:l=!0,findMatch:u=null,resetMs:d=750,ignoreKeys:h=[],selectedIndex:p=null}=e,f=vt.useRef(),g=vt.useRef(""),m=vt.useRef(null!=(n=null!=p?p:s)?n:-1),v=vt.useRef(null),b=He(a),y=He(c),x=ee(u),_=ee(h);return Vt(()=>{i&&(clearTimeout(f.current),v.current=null,g.current="")},[i]),Vt(()=>{var t;i&&""===g.current&&(m.current=null!=(t=null!=p?p:s)?t:-1)},[i,p,s]),vt.useMemo(()=>{if(!l)return{};function t(t){t?r.current.typing||(r.current.typing=t,y(t)):r.current.typing&&(r.current.typing=t,y(t))}function e(t,e,n){const i=x.current?x.current(e,n):e.find(t=>0===(null==t?void 0:t.toLocaleLowerCase().indexOf(n.toLocaleLowerCase())));return i?t.indexOf(i):-1}function n(n){const r=o.current;if(g.current.length>0&&" "!==g.current[0]&&(-1===e(r,r,g.current)?t(!1):" "===n.key&&Dt(n)),null==r||_.current.includes(n.key)||1!==n.key.length||n.ctrlKey||n.metaKey||n.altKey)return;i&&" "!==n.key&&(Dt(n),t(!0));r.every(t=>{var e,n;return!t||(null==(e=t[0])?void 0:e.toLocaleLowerCase())!==(null==(n=t[1])?void 0:n.toLocaleLowerCase())})&&g.current===n.key&&(g.current="",m.current=v.current),g.current+=n.key,clearTimeout(f.current),f.current=setTimeout(()=>{g.current="",m.current=v.current,t(!1)},d);const s=m.current,a=e(r,[...r.slice((s||0)+1),...r.slice(0,(s||0)+1)],g.current);-1!==a?(b(a),v.current=a):" "!==n.key&&(g.current="",t(!1))}return{reference:{onKeyDown:n},floating:{onKeyDown:n,onKeyUp(e){" "===e.key&&t(!1)}}}},[l,i,r,o,d,_,x,b,y])}function yn(t,e){return{...t,rects:{...t.rects,floating:{...t.rects.floating,height:e}}}}const xn=t=>({name:"inner",options:t,async fn(e){const{listRef:n,overflowRef:i,onFallbackChange:r,offset:o=0,index:s=0,minItemsVisible:a=4,referenceOverflowThreshold:c=0,scrollRef:l,...u}=t,{rects:d,elements:{floating:h}}=e,p=n.current[s];if(!p)return{};const f={...e,...await z(-p.offsetTop-h.clientTop-d.reference.height/2-p.offsetHeight/2-o).fn(e)},g=(null==l?void 0:l.current)||h,m=await j(yn(f,g.scrollHeight),u),v=await j(f,{...u,elementContext:"reference"}),b=Math.max(0,m.top),y=f.y+b,x=Math.max(0,g.scrollHeight-b-Math.max(0,m.bottom));return g.style.maxHeight=x+"px",g.scrollTop=b,r&&(g.offsetHeight<p.offsetHeight*Math.min(a,n.current.length-1)-1||v.top>=-c||v.bottom>=-c?Object(bt.flushSync)(()=>r(!0)):Object(bt.flushSync)(()=>r(!1))),i&&(i.current=await j(yn({...f,y:y},g.offsetHeight),u)),{y:y}}});function _n(t,e){const{open:n,elements:i}=t,{enabled:r=!0,overflowRef:o,scrollRef:s,onChange:a}=e,c=He(a),l=vt.useRef(!1),u=vt.useRef(null),d=vt.useRef(null);return vt.useEffect(()=>{if(!r)return;function t(t){if(t.ctrlKey||!e||null==o.current)return;const n=t.deltaY,i=o.current.top>=-.5,r=o.current.bottom>=-.5,s=e.scrollHeight-e.clientHeight,a=n<0?-1:1,l=n<0?"max":"min";e.scrollHeight<=e.clientHeight||(!i&&n>0||!r&&n<0?(t.preventDefault(),Object(bt.flushSync)(()=>{c(t=>t+Math[l](n,s*a))})):/firefox/i.test(Mt())&&(e.scrollTop+=n))}const e=(null==s?void 0:s.current)||i.floating;return n&&e?(e.addEventListener("wheel",t),requestAnimationFrame(()=>{u.current=e.scrollTop,null!=o.current&&(d.current={...o.current})}),()=>{u.current=null,d.current=null,e.removeEventListener("wheel",t)}):void 0},[r,n,i.floating,o,s,c]),vt.useMemo(()=>r?{floating:{onKeyDown(){l.current=!0},onWheel(){l.current=!1},onPointerMove(){l.current=!1},onScroll(){const t=(null==s?void 0:s.current)||i.floating;if(o.current&&t&&l.current){if(null!==u.current){const e=t.scrollTop-u.current;(o.current.bottom<-.5&&e<-1||o.current.top<-.5&&e>1)&&Object(bt.flushSync)(()=>c(t=>t+e))}requestAnimationFrame(()=>{u.current=t.scrollTop})}}}}:{},[r,o,i.floating,s,c])}function wn(t,e){const[n,i]=t;let r=!1;const o=e.length;for(let t=0,s=o-1;t<o;s=t++){const[o,a]=e[t]||[0,0],[c,l]=e[s]||[0,0];a>=i!=l>=i&&n<=(c-o)*(i-a)/(l-a)+o&&(r=!r)}return r}function On(t){void 0===t&&(t={});const{buffer:e=.5,blockPointerEvents:n=!1,requireIntent:i=!0}=t;let r,o=!1,s=null,a=null,c=performance.now();const l=t=>{let{x:n,y:l,placement:u,elements:d,onClose:h,nodeId:p,tree:f}=t;return function(t){function g(){clearTimeout(r),h()}if(clearTimeout(r),!d.domReference||!d.floating||null==u||null==n||null==l)return;const{clientX:m,clientY:v}=t,b=[m,v],y=kt(t),x="mouseleave"===t.type,_=Ct(d.floating,y),w=Ct(d.domReference,y),O=d.domReference.getBoundingClientRect(),P=d.floating.getBoundingClientRect(),S=u.split("-")[0],C=n>P.right-P.width/2,j=l>P.bottom-P.height/2,M=function(t,e){return t[0]>=e.x&&t[0]<=e.x+e.width&&t[1]>=e.y&&t[1]<=e.y+e.height}(b,O),E=P.width>O.width,L=P.height>O.height,T=(E?O:P).left,R=(E?O:P).right,A=(L?O:P).top,I=(L?O:P).bottom;if(_&&(o=!0,!x))return;if(w&&(o=!1),w&&!x)return void(o=!0);if(x&&G(t.relatedTarget)&&Ct(d.floating,t.relatedTarget))return;if(f&&de(f.nodesRef.current,p).some(t=>{let{context:e}=t;return null==e?void 0:e.open}))return;if("top"===S&&l>=O.bottom-1||"bottom"===S&&l<=O.top+1||"left"===S&&n>=O.right-1||"right"===S&&n<=O.left+1)return g();let k=[];switch(S){case"top":k=[[T,O.top+1],[T,P.bottom-1],[R,P.bottom-1],[R,O.top+1]];break;case"bottom":k=[[T,P.top+1],[T,O.bottom-1],[R,O.bottom-1],[R,P.top+1]];break;case"left":k=[[P.right-1,I],[P.right-1,A],[O.left+1,A],[O.left+1,I]];break;case"right":k=[[O.right-1,I],[O.right-1,A],[P.left+1,A],[P.left+1,I]]}if(!wn([m,v],k)){if(o&&!M)return g();if(!x&&i){const e=function(t,e){const n=performance.now(),i=n-c;if(null===s||null===a||0===i)return s=t,a=e,c=n,null;const r=t-s,o=e-a,l=Math.sqrt(r*r+o*o);return s=t,a=e,c=n,l/i}(t.clientX,t.clientY),n=.1;if(null!==e&&e<n)return g()}wn([m,v],function(t){let[n,i]=t;switch(S){case"top":return[[E?n+e/2:C?n+4*e:n-4*e,i+e+1],[E?n-e/2:C?n+4*e:n-4*e,i+e+1],...[[P.left,C||E?P.bottom-e:P.top],[P.right,C?E?P.bottom-e:P.top:P.bottom-e]]];case"bottom":return[[E?n+e/2:C?n+4*e:n-4*e,i-e],[E?n-e/2:C?n+4*e:n-4*e,i-e],...[[P.left,C||E?P.top+e:P.bottom],[P.right,C?E?P.top+e:P.bottom:P.top+e]]];case"left":{const t=[n+e+1,L?i+e/2:j?i+4*e:i-4*e],r=[n+e+1,L?i-e/2:j?i+4*e:i-4*e];return[...[[j||L?P.right-e:P.left,P.top],[j?L?P.right-e:P.left:P.right-e,P.bottom]],t,r]}case"right":return[[n-e,L?i+e/2:j?i+4*e:i-4*e],[n-e,L?i-e/2:j?i+4*e:i-4*e],...[[j||L?P.left+e:P.right,P.top],[j?L?P.left+e:P.right:P.left+e,P.bottom]]]}}([n,l]))?!o&&i&&(r=window.setTimeout(g,40)):g()}}};return l.__options={blockPointerEvents:n},l}},606:function(t,e,n){var i=n(1149);t.exports=function(t){return new i(t)},t.exports.default=t.exports,t.exports.__esModule=!0},63:function(t,e,n){var i=n(1600);function r(e,n,o){return"undefined"!=typeof Reflect&&Reflect.get?(t.exports=r=Reflect.get,t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=r=function(t,e,n){var r=i(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}},t.exports.default=t.exports,t.exports.__esModule=!0),r(e,n,o||e)}t.exports=r,t.exports.default=t.exports,t.exports.__esModule=!0},65:function(t,e,n){"use strict";n.d(e,"f",(function(){return i})),n.d(e,"d",(function(){return r})),n.d(e,"g",(function(){return o})),n.d(e,"e",(function(){return s})),n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return l}));const i={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},r=Symbol.for("component"),o=Symbol.for("propTypes"),s=Symbol.for("deprecatedProps"),a=Symbol.for("asyncPropDefaults"),c=Symbol.for("asyncPropOriginal"),l=Symbol.for("asyncPropResolved")},663:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(3);const r=[255,255,255],o=1;let s=0;class a{constructor(t={}){Object(i.a)(this,"id",void 0),Object(i.a)(this,"color",void 0),Object(i.a)(this,"intensity",void 0),Object(i.a)(this,"type","ambient");const{color:e=r}=t,{intensity:n=o}=t;this.id=t.id||"ambient-".concat(s++),this.color=e,this.intensity=n}}},664:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));function i(t){if(null===(e=t)||"object"!=typeof e)throw new Error("count(): argument not an object");var e;if("function"==typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(function(t){return null!==t&&"object"==typeof t&&t.constructor===Object}(t))return Object.keys(t).length;throw new Error("count(): argument not a container")}},665:function(t,e,n){"use strict";function i(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(t=>"project64"===t.name))){const t=n.modules.findIndex(t=>"project32"===t.name);t>=0&&n.modules.splice(t,1)}if("inject"in e)if(t.inject){const i={...t.inject};for(const t in e.inject)i[t]=(i[t]||"")+e.inject[t];n.inject=i}else n.inject=e.inject;return n}n.d(e,"a",(function(){return i}))},666:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i=n(3),r=n(377),o=n(185),s=n(52),a=n(64),c=n(93);const l=Math.PI/180,u=180/Math.PI;function d(){const t=Math.PI/180*256;return{unitsPerMeter:[256/6370972,256/6370972,256/6370972],unitsPerMeter2:[0,0,0],metersPerUnit:[24886.609375,24886.609375,24886.609375],unitsPerDegree:[t,t,256/6370972],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/t,1/t,24886.609375]}}class h extends o.a{constructor(t={}){const{latitude:e=0,longitude:n=0,zoom:o=0,nearZMultiplier:s=.1,farZMultiplier:a=2,resolution:c=10}=t;let{height:u,altitude:h=1.5}=t;u=u||1,h=Math.max(.75,h);const p=(new r.a).lookAt({eye:[0,-h,0],up:[0,0,1]}),f=Math.pow(2,o);p.rotateX(e*l),p.rotateZ(-n*l),p.scale(f/u);const g=Math.atan(.5/h),m=512*f/u;super({...t,height:u,viewMatrix:p,longitude:n,latitude:e,zoom:o,distanceScales:d(),fovyRadians:2*g,focalDistance:h,near:s,far:Math.min(2,1/m+1)*h*a}),Object(i.a)(this,"longitude",void 0),Object(i.a)(this,"latitude",void 0),Object(i.a)(this,"resolution",void 0),this.latitude=e,this.longitude=n,this.resolution=c}get projectionMode(){return s.d.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(t={}){const e={targetZ:t.z||0},n=this.unproject([0,this.height/2],e),i=this.unproject([this.width/2,0],e),r=this.unproject([this.width,this.height/2],e),o=this.unproject([this.width/2,this.height],e);return r[0]<this.longitude&&(r[0]+=360),n[0]>this.longitude&&(n[0]-=360),[Math.min(n[0],r[0],i[0],o[0]),Math.min(n[1],r[1],i[1],o[1]),Math.max(n[0],r[0],i[0],o[0]),Math.max(n[1],r[1],i[1],o[1])]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[i,r,o]=t,s=e?r:this.height-r,{pixelUnprojectionMatrix:c}=this;let l;if(Number.isFinite(o))l=p(c,[i,s,o,1]);else{const t=p(c,[i,s,-1,1]),e=p(c,[i,s,1,1]),r=256*((n||0)/6370972+1),o=a.q(a.r([],t,e)),u=a.q(t),d=a.q(e),h=4*((4*u*d-(o-u-d)**2)/16)/o,f=(Math.sqrt(u-h)-Math.sqrt(Math.max(0,r*r-h)))/Math.sqrt(o);l=a.j([],t,e,f)}const[u,d,h]=this.unprojectPosition(l);return Number.isFinite(o)?[u,d,h]:Number.isFinite(n)?[u,d,n]:[u,d]}projectPosition(t){const[e,n,i=0]=t,r=e*l,o=n*l,s=Math.cos(o),a=256*(i/6370972+1);return[Math.sin(r)*s*a,-Math.cos(r)*s*a,Math.sin(o)*a]}unprojectPosition(t){const[e,n,i]=t,r=a.h(t),o=Math.asin(i/r);return[Math.atan2(e,-n)*u,o*u,6370972*(r/256-1)]}projectFlat(t){return t}unprojectFlat(t){return t}panByPosition(t,e){const n=this.unproject(e);return{longitude:t[0]-n[0]+this.longitude,latitude:t[1]-n[1]+this.latitude}}}function p(t,e){const n=c.n([],e,t);return c.k(n,n,1/n[3]),n}},667:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var i=n(3),r=n(227),o=n(245),s=n(531),a=n(196),c=n(533),l=n(586);function u(t,e){e=void 0===e?t[0][0]:e;for(const n of t){const t=n[0]-e;t>180?n[0]-=360:t<-180&&(n[0]+=360)}}function d(t,e,n){const i=t(e,n),[o,s]=Object(r.h3ToGeo)(i);return[s,o]}function h(t,e=1){const n=Object(r.h3ToGeoBoundary)(t,!0);return 1!==e?function(t,e,n){const[i,s]=Object(r.h3ToGeo)(t),a=e.length;u(e,s);const c=e[0]===e[a-1]?a-1:a;for(let t=0;t<c;t++)e[t][0]=Object(o.e)(s,e[t][0],n),e[t][1]=Object(o.e)(i,e[t][1],n)}(t,n,e):u(n),n}const p={...c.a.defaultProps,highPrecision:"auto",coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:t=>t.hexagon},extruded:!0};class f extends s.a{constructor(...t){super(...t),Object(i.a)(this,"state",void 0)}initializeState(){f._checkH3Lib(),this.state={edgeLengthKM:0,resolution:-1}}shouldUpdateState({changeFlags:t}){return this._shouldUseHighPrecision()?t.propsOrDataChanged:t.somethingChanged}updateState({props:t,changeFlags:e}){if(!0!==t.highPrecision&&(e.dataChanged||e.updateTriggersChanged&&e.updateTriggersChanged.getHexagon)){const t=this._calculateH3DataProps();this.setState(t)}this._updateVertices(this.context.viewport)}_calculateH3DataProps(){let t=-1,e=!1,n=!1;const{iterable:i,objectInfo:o}=Object(a.a)(this.props.data);for(const s of i){o.index++;const i=this.props.getHexagon(s,o),a=Object(r.h3GetResolution)(i);if(t<0){if(t=a,!this.props.highPrecision)break}else if(t!==a){n=!0;break}if(Object(r.h3IsPentagon)(i)){e=!0;break}}return{resolution:t,edgeLengthKM:t>=0?Object(r.edgeLength)(t,"km"):0,hasMultipleRes:n,hasPentagon:e}}_shouldUseHighPrecision(){if("auto"===this.props.highPrecision){const{resolution:t,hasPentagon:e,hasMultipleRes:n}=this.state,{viewport:i}=this.context;return Boolean(null==i?void 0:i.resolution)||n||e||t>=0&&t<=5}return this.props.highPrecision}_updateVertices(t){if(this._shouldUseHighPrecision())return;const{resolution:e,edgeLengthKM:n,centerHex:i}=this.state;if(e<0)return;const o=this.props.centerHexagon||Object(r.geoToH3)(t.latitude,t.longitude,e);if(i===o)return;if(i){const t=Object(r.h3Distance)(i,o);if(t>=0&&t*n<10)return}const{unitsPerMeter:s}=t.distanceScales;let a=h(o);const[c,l]=Object(r.h3ToGeo)(o),[u,d]=t.projectFlat([l,c]);a=a.map(e=>{const n=t.projectFlat(e);return[(n[0]-u)/s[0],(n[1]-d)/s[1]]}),this.setState({centerHex:o,vertices:a})}renderLayers(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}_getForwardProps(){const{elevationScale:t,material:e,coverage:n,extruded:i,wireframe:r,stroked:o,filled:s,lineWidthUnits:a,lineWidthScale:c,lineWidthMinPixels:l,lineWidthMaxPixels:u,getFillColor:d,getElevation:h,getLineColor:p,getLineWidth:f,transitions:g,updateTriggers:m}=this.props;return{elevationScale:t,extruded:i,coverage:n,wireframe:r,stroked:o,filled:s,lineWidthUnits:a,lineWidthScale:c,lineWidthMinPixels:l,lineWidthMaxPixels:u,material:e,getElevation:h,getFillColor:d,getLineColor:p,getLineWidth:f,transitions:g,updateTriggers:{getFillColor:m.getFillColor,getElevation:m.getElevation,getLineColor:m.getLineColor,getLineWidth:m.getLineWidth}}}_renderPolygonLayer(){const{data:t,getHexagon:e,updateTriggers:n,coverage:i}=this.props,r=this.getSubLayerClass("hexagon-cell-hifi",c.a),o=this._getForwardProps();return o.updateTriggers.getPolygon=function(t,e){let n;return n=null==t?e:"object"==typeof t?{...t,coverage:e}:{getHexagon:t,coverage:e},n}(n.getHexagon,i),new r(o,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:o.updateTriggers}),{data:t,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:(t,n)=>function(t){const e=new Float64Array(2*t.length);let n=0;for(const i of t)e[n++]=i[0],e[n++]=i[1];return e}(h(e(t,n),i))})}_renderColumnLayer(){const{data:t,getHexagon:e,updateTriggers:n}=this.props,i=this.getSubLayerClass("hexagon-cell",l.a),r=this._getForwardProps();return r.updateTriggers.getPosition=n.getHexagon,new i(r,this.getSubLayerProps({id:"hexagon-cell",flatShading:!0,updateTriggers:r.updateTriggers}),{data:t,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:d.bind(null,e)})}}Object(i.a)(f,"defaultProps",p),Object(i.a)(f,"layerName","H3HexagonLayer"),Object(i.a)(f,"_checkH3Lib",()=>{})},668:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return l}));var i=n(3),r=n(276);const o=()=>{},s={BREAK:1,SNAP_TO_END:2,IGNORE:3},a=t=>t,c=s.BREAK;class l{constructor(t){Object(i.a)(this,"getControllerState",void 0),Object(i.a)(this,"props",void 0),Object(i.a)(this,"propsInTransition",void 0),Object(i.a)(this,"transition",void 0),Object(i.a)(this,"onViewStateChange",void 0),Object(i.a)(this,"onStateChange",void 0),Object(i.a)(this,"_onTransitionUpdate",t=>{const{time:e,settings:{interpolator:n,startProps:i,endProps:r,duration:o,easing:s}}=t,a=s(e/o),c=n.interpolateProps(i,r,a);this.propsInTransition=this.getControllerState({...this.props,...c}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=t.getControllerState,this.propsInTransition=null,this.transition=new r.a(t.timeline),this.onViewStateChange=t.onViewStateChange||o,this.onStateChange=t.onStateChange||o}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let e=!1;const n=this.props;if(this.props=t,!n||this._shouldIgnoreViewportChange(n,t))return!1;if(this._isTransitionEnabled(t)){let i=n;if(this.transition.inProgress){const{interruption:t,endProps:e}=this.transition.settings;i={...n,...t===s.SNAP_TO_END?e:this.propsInTransition||n}}this._triggerTransition(i,t),e=!0}else this.transition.cancel();return e}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:e,transitionInterpolator:n}=t;return(e>0||"auto"===e)&&Boolean(n)}_isUpdateDueToCurrentTransition(t){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition)}_shouldIgnoreViewportChange(t,e){return this.transition.inProgress?this.transition.settings.interruption===s.IGNORE||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e)}_triggerTransition(t,e){const n=this.getControllerState(t),i=this.getControllerState(e).shortestPathFrom(n),r=e.transitionInterpolator,o=r.getDuration?r.getDuration(t,e):e.transitionDuration;if(0===o)return;const s=r.initializeProps(t,i);this.propsInTransition={};const l={duration:o,easing:e.transitionEasing||a,interpolator:r,interruption:e.transitionInterruption||c,startProps:s.start,endProps:s.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)};this.transition.start(l),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return e=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),null==t||t(e)}}}},68:function(t,e,n){"use strict";var i=n(2104);e.a=new i.a({id:"deck"})},69:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"e",(function(){return s})),n.d(e,"f",(function(){return a})),n.d(e,"h",(function(){return c})),n.d(e,"c",(function(){return l})),n.d(e,"a",(function(){return u})),n.d(e,"g",(function(){return d})),n.d(e,"d",(function(){return h}));n(592);const i=1/Math.PI*180,r=1/180*Math.PI,o={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function s(t,{precision:e=o.precision}={}){return t=function(t){return Math.round(t/o.EPSILON)*o.EPSILON}(t),"".concat(parseFloat(t.toPrecision(e)))}function a(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function c(t,e){return p(t,t=>t*r,e)}function l(t,e){return p(t,t=>t*i,e)}function u(t,e,n){return p(t,t=>Math.max(e,Math.min(n,t)))}function d(t,e,n){return a(t)?t.map((t,i)=>d(t,e[i],n)):n*e+(1-n)*t}function h(t,e,n){const i=o.EPSILON;n&&(o.EPSILON=n);try{if(t===e)return!0;if(a(t)&&a(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!h(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):"number"==typeof t&&"number"==typeof e&&Math.abs(t-e)<=o.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{o.EPSILON=i}}function p(t,e,n){if(a(t)){const i=t;n=n||function(t){return t.clone?t.clone():new Array(t.length)}(i);for(let r=0;r<n.length&&r<i.length;++r)n[r]=e(t[r],r,n);return n}return e(t)}},7:function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.default=t.exports,t.exports.__esModule=!0,n(e)}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},747:function(t,e,n){"use strict";n.d(e,"a",(function(){return Y}));var i=n(3),r=n(52),o=n(748),s=n(190),a=n(69),c=n(276);class l extends c.a{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:e,toValue:n,duration:i,easing:r}}=this,o=r(t/i);this._value=Object(a.g)(e,n,o)}}function u(t,e,n,i,r){const o=e-t;return(n-e)*r+-o*i+o+e}function d(t,e){if(Array.isArray(t)){let n=0;for(let i=0;i<t.length;i++){const r=t[i]-e[i];n+=r*r}return Math.sqrt(n)}return Math.abs(t-e)}class h extends c.a{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:n,stiffness:i}=this.settings,{_prevValue:r=t,_currValue:o=t}=this;let s=function(t,e,n,i,r){if(Array.isArray(n)){const o=[];for(let s=0;s<n.length;s++)o[s]=u(t[s],e[s],n[s],i,r);return o}return u(t,e,n,i,r)}(r,o,e,n,i);const a=d(s,e),c=d(s,o);a<1e-5&&c<1e-5&&(s=e,this.end()),this._prevValue=o,this._currValue=s}}var p=n(68);const f={interpolation:l,spring:h};class g{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,e,n,i){const{transitions:r}=this;if(r.has(t)){const n=r.get(t),{value:i=n.settings.fromValue}=n;e=i,this.remove(t)}if(!(i=Object(s.e)(i)))return;const o=f[i.type];if(!o)return void p.a.error("unsupported transition type '".concat(i.type,"'"))();const a=new o(this.timeline);a.start({...i,fromValue:e,toValue:n}),r.set(t,a)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,n]of this.transitions)n.update(),t[e]=n.value,n.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}var m=n(574),v=n(65),b=n(664),y=n(129),x=n(29),_=n(116),w=n(253),O=n(665),P=n(594),S=n(256),C=n(196),j=n(425);const M={10241:9987,10240:9729,10242:33071,10243:33071},E={};var L=n(178);const T={boolean:{validate:(t,e)=>!0,equal:(t,e,n)=>Boolean(t)===Boolean(e)},number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},color:{validate:(t,e)=>e.optional&&!t||I(t)&&(3===t.length||4===t.length),equal:(t,e,n)=>Object(L.a)(t,e,1)},accessor:{validate(t,e){const n=k(t);return"function"===n||n===k(e.value)},equal:(t,e,n)=>"function"==typeof e||Object(L.a)(t,e,1)},array:{validate:(t,e)=>e.optional&&!t||I(t),equal(t,e,n){const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?Object(L.a)(t,e,r):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?Object(L.a)(t,e,r):t===e}},function:{validate:(t,e)=>e.optional&&!t||"function"==typeof t,equal:(t,e,n)=>!n.compare&&!1!==n.ignore||t===e},data:{transform:(t,e,n)=>{const{dataTransform:i}=n.props;return i&&t?i(t):t}},image:{transform:(t,e,n)=>{const i=n.context;return i&&i.gl?function(t,e,n,i){if(n instanceof j.a)return n;n.constructor&&"Object"!==n.constructor.name&&(n={data:n});let r=null;n.compressed&&(r={10241:n.data.length>1?9985:9729});const o=new j.a(e,{...n,parameters:{...M,...r,...i}});return E[o.id]=t,o}(n.id,i.gl,t,{...e.parameters,...n.props.textureParameters}):null},release:(t,e,n)=>{var i,r;i=n.id,(r=t)&&r instanceof j.a&&E[r.id]===i&&(r.delete(),delete E[r.id])}}};function R(t,e){switch(k(e)){case"object":return A(t,e);case"array":return A(t,{type:"array",value:e,compare:!1});case"boolean":return A(t,{type:"boolean",value:e});case"number":return A(t,{type:"number",value:e});case"function":return A(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function A(t,e){return"type"in e?{name:t,...T[e.type],...e}:"value"in e?{name:t,type:k(e.value),...e}:{name:t,type:"object",value:e}}function I(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function k(t){return I(t)?"array":null===t?"null":typeof t}function z(t,e){let n="_mergedDefaultProps";if(e)for(const t of e){const e=t.constructor;e&&(n+=":".concat(e.extensionName||e.name))}const i=N(t,n);return i||(t[n]=function(t,e){if(!t.prototype)return null;const n=z(Object.getPrototypeOf(t)),i=function(t){const e={},n={},i={};for(const[r,o]of Object.entries(t)){const t=null==o?void 0:o.deprecatedFor;if(t)i[r]=Array.isArray(t)?t:[t];else{const t=R(r,o);e[r]=t,n[r]=t.value}}return{propTypes:e,defaultProps:n,deprecatedProps:i}}(N(t,"defaultProps")||{}),r=Object.assign(Object.create(null),n,i.defaultProps),o=Object.assign(Object.create(null),null==n?void 0:n[v.g],i.propTypes),s=Object.assign(Object.create(null),null==n?void 0:n[v.e],i.deprecatedProps);for(const t of e){const e=z(t.constructor);e&&(Object.assign(r,e),Object.assign(o,e[v.g]),Object.assign(s,e[v.e]))}(function(t,e){const n=function(t){const e=t.componentName;e||p.a.warn("".concat(t.name,".componentName not specified"))();return e||t.name}(e);Object.defineProperties(t,{id:{writable:!0,value:n}})})(r,t),function(t,e){const n={},i={};for(const t in e){const r=e[t],{name:o,value:s}=r;r.async&&(n[o]=s,i[o]=D(o))}t[v.a]=n,t[v.b]={},Object.defineProperties(t,i)}(r,o),function(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(t){const i="".concat(this.id,": ").concat(n);for(const i of e[n])F(this,i)||(this[i]=t);p.a.deprecated(i,e[n].join("/"))()}})}(r,s),r[v.g]=o,r[v.e]=s,0!==e.length||F(t,"_propTypes")||(t._propTypes=o);return r}(t,e||[]))}function D(t){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||Object(C.c)(e)?this[v.b][t]=e:this[v.c][t]=e},get(){if(this[v.c]){if(t in this[v.c]){return this[v.c][t]||this[v.a][t]}if(t in this[v.b]){const e=this[v.d]&&this[v.d].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[v.a][t]}}return this[v.a][t]}}}function F(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function N(t,e){return F(t,e)&&t[e]}let V=0;class U{constructor(...t){Object(i.a)(this,"id",void 0),Object(i.a)(this,"props",void 0),Object(i.a)(this,"count",void 0),this.props=function(t,e){let n;for(let t=e.length-1;t>=0;t--){const i=e[t];"extensions"in i&&(n=i.extensions)}const i=z(t.constructor,n),r=Object.create(i);r[v.d]=t,r[v.b]={},r[v.c]={};for(let t=0;t<e.length;++t){const n=e[t];for(const t in n)r[t]=n[t]}return Object.freeze(r),r}(this,t),this.id=this.props.id,this.count=V++}clone(t){const{props:e}=this,n={};for(const t in e[v.a])t in e[v.c]?n[t]=e[v.c][t]:t in e[v.b]&&(n[t]=e[v.b][t]);return new this.constructor({...e,...n,...t})}}Object(i.a)(U,"componentName","Component"),Object(i.a)(U,"defaultProps",{});const B=Object.freeze({});class W extends class{constructor(t){Object(i.a)(this,"component",void 0),Object(i.a)(this,"onAsyncPropUpdated",void 0),Object(i.a)(this,"asyncProps",void 0),Object(i.a)(this,"oldProps",void 0),Object(i.a)(this,"oldAsyncProps",void 0),this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const e=this.asyncProps[t];e&&e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||B}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const e=this.asyncProps[t];return e&&e.resolvedValue}isAsyncPropLoading(t){if(t){const e=this.asyncProps[t];return Boolean(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(t,e){this._watchPromise(t,Promise.resolve(e))}setAsyncProps(t){this.component=t[v.d]||this.component;const e=t[v.c]||{},n=t[v.b]||t,i=t[v.a]||{};for(const t in e){const n=e[t];this._createAsyncPropData(t,i[t]),this._updateAsyncProp(t,n),e[t]=this.getAsyncProp(t)}for(const t in n){const e=n[t];this._createAsyncPropData(t,i[t]),this._updateAsyncProp(t,e)}}_fetch(t,e){return null}_onResolve(t,e){}_onError(t,e){}_updateAsyncProp(t,e){this._didAsyncInputValueChange(t,e)&&("string"==typeof e&&(e=this._fetch(t,e)),e instanceof Promise?this._watchPromise(t,e):Object(C.c)(e)?this._resolveAsyncIterable(t,e):this._setPropValue(t,e))}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}_didAsyncInputValueChange(t,e){const n=this.asyncProps[t];return e!==n.resolvedValue&&e!==n.lastValue&&(n.lastValue=e,!0)}_setPropValue(t,e){this._freezeAsyncOldProps();const n=this.asyncProps[t];n&&(e=this._postProcessValue(n,e),n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(t,e,n){const i=this.asyncProps[t];i&&n>=i.resolvedLoadCount&&void 0!==e&&(this._freezeAsyncOldProps(),i.resolvedValue=e,i.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}_watchPromise(t,e){const n=this.asyncProps[t];if(n){n.pendingLoadCount++;const i=n.pendingLoadCount;e.then(e=>{this.component&&(e=this._postProcessValue(n,e),this._setAsyncPropValue(t,e,i),this._onResolve(t,e))}).catch(e=>{this._onError(t,e)})}}async _resolveAsyncIterable(t,e){if("data"!==t)return void this._setPropValue(t,e);const n=this.asyncProps[t];if(!n)return;n.pendingLoadCount++;const i=n.pendingLoadCount;let r=[],o=0;for await(const n of e){if(!this.component)return;const{dataTransform:e}=this.component.props;r=e?e(n,r):r.concat(n),Object.defineProperty(r,"__diff",{enumerable:!1,value:[{startRow:o,endRow:r.length}]}),o=r.length,this._setAsyncPropValue(t,r,i)}this._onResolve(t,r)}_postProcessValue(t,e){const n=t.type;return n&&this.component&&(n.release&&n.release(t.resolvedValue,n,this.component),n.transform)?n.transform(e,n,this.component):e}_createAsyncPropData(t,e){if(!this.asyncProps[t]){const n=this.component&&this.component.props[v.g];this.asyncProps[t]={type:n&&n[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}{constructor({attributeManager:t,layer:e}){super(e),Object(i.a)(this,"attributeManager",void 0),Object(i.a)(this,"needsRedraw",void 0),Object(i.a)(this,"needsUpdate",void 0),Object(i.a)(this,"subLayers",void 0),Object(i.a)(this,"usesPickingColorCache",void 0),Object(i.a)(this,"hasPickingBuffer",void 0),Object(i.a)(this,"changeFlags",void 0),Object(i.a)(this,"viewport",void 0),Object(i.a)(this,"uniformTransitions",void 0),Object(i.a)(this,"propsInTransition",void 0),this.attributeManager=t,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(t,e){const n=this.layer,i=null==n?void 0:n.props.fetch;return i?i(e,{propName:t,layer:n}):super._fetch(t,e)}_onResolve(t,e){const n=this.layer;if(n){const i=n.props.onDataLoad;"data"===t&&i&&i(e,{propName:t,layer:n})}}_onError(t,e){const n=this.layer;n&&n.raiseError(e,"loading ".concat(t," of ").concat(this.layer))}}var G=n(61),H=n(2160);const Z=Object.freeze([]),q=Object(w.a)(({oldViewport:t,viewport:e})=>t.equals(e));let K=new Uint8ClampedArray(0);const X={data:{type:"data",value:Z,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:i,loadOptions:r,signal:o})=>{const{resourceManager:s}=n.context;var a;(r=r||n.getLoadOptions(),i=i||n.props.loaders,o)&&(r={...r,fetch:{...null===(a=r)||void 0===a?void 0:a.fetch,signal:o}});let c=s.contains(t);return c||r||(s.add({resourceId:t,data:Object(H.a)(t,i),persistent:!1}),c=!0),c?s.subscribe({resourceId:t,onChange:t=>{var i;return null===(i=n.internalState)||void 0===i?void 0:i.reloadAsyncProp(e,t)},consumerId:n.id,requestId:e}):Object(H.a)(t,i,r)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:r.a.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,100*-t]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Y extends U{constructor(...t){super(...t),Object(i.a)(this,"internalState",null),Object(i.a)(this,"lifecycle",v.f.NO_STATE),Object(i.a)(this,"context",void 0),Object(i.a)(this,"state",void 0),Object(i.a)(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let t=this;for(;t.parent;)t=t.parent;return t}toString(){const t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}project(t){Object(_.a)(this.internalState);const e=this.internalState.viewport||this.context.viewport,n=Object(P.a)(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,r,o]=Object(G.q)(n,e.pixelProjectionMatrix);return 2===t.length?[i,r]:[i,r,o]}unproject(t){Object(_.a)(this.internalState);return(this.internalState.viewport||this.context.viewport).unproject(t)}projectPosition(t,e){Object(_.a)(this.internalState);const n=this.internalState.viewport||this.context.viewport;return Object(P.b)(t,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...e})}get isComposite(){return!1}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===r.a.DEFAULT||t===r.a.LNGLAT||t===r.a.CARTESIAN}onHover(t,e){return this.props.onHover&&this.props.onHover(t,e)||!1}onClick(t,e){return this.props.onClick&&this.props.onClick(t,e)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(t,e=[]){return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){Object(_.a)(t instanceof Uint8Array);const[e,n,i]=t;return e+256*n+65536*i-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:Object(b.a)(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var t;return null===(t=this.getAttributeManager())||void 0===t?void 0:t.getBounds(["positions","instancePositions"])}getShaders(t){for(const e of this.props.extensions)t=Object(O.a)(t,e.getShaders.call(this,e));return t}shouldUpdateState(t){return t.changeFlags.propsOrDataChanged}updateState(t){const e=this.getAttributeManager(),{dataChanged:n}=t.changeFlags;if(n&&e)if(Array.isArray(n))for(const t of n)e.invalidateAll(t);else e.invalidateAll();if(e){const{props:n}=t,i=this.internalState.hasPickingBuffer,r=Number.isInteger(n.highlightedObjectIndex)||n.pickable||n.extensions.some(t=>t.getNeedsPickingBuffer.call(this,t));if(i!==r){this.internalState.hasPickingBuffer=r;const{pickingColors:t,instancePickingColors:n}=e.attributes,i=t||n;i&&(r&&i.constant&&(i.constant=!1,e.invalidate(i.id)),i.value||r||(i.constant=!0,i.value=[0,0,0]))}}}finalizeState(t){for(const t of this.getModels())t.delete();const e=this.getAttributeManager();e&&e.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo({info:t,mode:e,sourceLayer:n}){const{index:i}=t;return i>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[i]),t}raiseError(t,e){var n,i,r,o;(e&&(t=new Error("".concat(e,": ").concat(t.message),{cause:t})),null!==(n=(i=this.props).onError)&&void 0!==n&&n.call(i,t))||(null===(r=this.context)||void 0===r||null===(o=r.onError)||void 0===o||o.call(r,t,this))}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){var t;return(null===(t=this.internalState)||void 0===t?void 0:t.uniformTransitions.active)||!1}activateViewport(t){if(!this.internalState)return;const e=this.internalState.viewport;this.internalState.viewport=t,e&&q({oldViewport:e,viewport:t})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all"){const e=this.getAttributeManager();e&&("all"===t?e.invalidateAll():e.invalidate(t))}updateAttributes(t){for(const e of this.getModels())this._setModelAttributes(e,t)}_updateAttributes(){const t=this.getAttributeManager();if(!t)return;const e=this.props,n=this.getNumInstances(),i=this.getStartIndices();t.update({data:e.data,numInstances:n,startIndices:i,props:e,transitions:e.transitions,buffers:e.data.attributes,context:this});const r=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(r)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),n=Object.create(this.props);for(const t in e)Object.defineProperty(n,t,{value:e[t]});return n}return this.props}calculateInstancePickingColors(t,{numInstances:e}){if(t.constant)return;const n=Math.floor(K.length/3);if(this.internalState.usesPickingColorCache=!0,n<e){e>2**24-1&&p.a.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),K=S.a.allocate(K,e,{size:3,copy:!0,maxCount:Math.max(e,2**24-1)});const t=Math.floor(K.length/3),i=[];for(let e=n;e<t;e++)this.encodePickingColor(e,i),K[3*e+0]=i[0],K[3*e+1]=i[1],K[3*e+2]=i[2]}t.value=K.subarray(0,3*e)}_setModelAttributes(t,e){const n=this.getAttributeManager(),i=t.userData.excludeAttributes||{},r=n.getShaderAttributes(e,i);t.setAttributes(r)}disablePickingIndex(t){const e=this.props.data;if(!("attributes"in e))return void this._disablePickingIndex(t);const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,r=n||i,o=r&&e.attributes&&e.attributes[r.id];if(o&&o.value){const n=o.value,i=this.encodePickingColor(t);for(let t=0;t<e.length;t++){const e=r.getVertexOffset(t);n[e]===i[0]&&n[e+1]===i[1]&&n[e+2]===i[2]&&this._disablePickingIndex(t)}}else this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,i=e||n;if(!i)return;const r=i.getVertexOffset(t),o=i.getVertexOffset(t+1);i.buffer.subData({data:new Uint8Array(o-r),offset:r})}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,n=t||e;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==K.buffer&&(n.value=K.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){Object(_.a)(!this.internalState),Object(_.a)(Number.isFinite(this.props.coordinateSystem)),Object(y.a)("layer.initialize",this);const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new W({attributeManager:t,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(p.a.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),t)}),this.internalState.uniformTransitions=new g(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(t){Object(y.a)("layer.matched",this,this===t);const{state:e,internalState:n}=t;this!==t&&(this.internalState=n,this.state=e,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const t=this.needsUpdate();if(Object(y.a)("layer.update",this,t),!t)return;const e=this.props,n=this.context,i=this.internalState,r=n.viewport,o=this._updateUniformTransition();i.propsInTransition=o,n.viewport=i.viewport||r,this.props=o;try{const t=this._getUpdateParams(),o=this.getModels();if(n.gl)this.updateState(t);else try{this.updateState(t)}catch(t){}for(const e of this.props.extensions)e.updateState.call(this,t,e);const s=this.getModels()[0]!==o[0];this._postUpdate(t,s)}finally{n.viewport=r,this.props=e,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){Object(y.a)("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,this.context,t)}_drawLayer({moduleParameters:t=null,uniforms:e={},parameters:n={}}){this._updateAttributeTransition();const i=this.props,r=this.context;this.props=this.internalState.propsInTransition||i;const o=this.props.opacity;e.opacity=Math.pow(o,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:o}=this.props,s=o&&o(e)||[0,0];Object(x.n)(r.gl,{polygonOffset:s}),Object(x.o)(r.gl,n,()=>{const i={moduleParameters:t,uniforms:e,parameters:n,context:r};for(const t of this.props.extensions)t.draw.call(this,i,t);this.draw(i)})}finally{this.props=i}}getChangeFlags(){var t;return null===(t=this.internalState)||void 0===t?void 0:t.changeFlags}setChangeFlags(t){if(!this.internalState)return;const{changeFlags:e}=this.internalState;for(const n in t)if(t[n]){let i=!1;switch(n){case"dataChanged":const r=t[n],o=e[n];r&&Array.isArray(o)&&(e.dataChanged=Array.isArray(r)?o.concat(r):r,i=!0);default:e[n]||(e[n]=t[n],i=!0)}i&&Object(y.a)("layer.changeFlag",this,n,t)}const n=Boolean(e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged);e.propsOrDataChanged=n,e.somethingChanged=n||e.viewportChanged||e.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(t,e){const n=Object(m.b)(t,e);if(n.updateTriggersChanged)for(const t in n.updateTriggersChanged)n.updateTriggersChanged[t]&&this.invalidateAttribute(t);if(n.transitionsChanged)for(const r in n.transitionsChanged){var i;this.internalState.uniformTransitions.add(r,e[r],t[r],null===(i=t.transitions)||void 0===i?void 0:i[r])}return this.setChangeFlags(n)}validateProps(){Object(m.c)(this.props)}updateAutoHighlight(t){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={pickingSelectedColor:t.picked?t.color:null},{highlightColor:n}=this.props;t.picked&&"function"==typeof n&&(e.pickingHighlightColor=n(t)),this.setModuleParameters(e),this.setNeedsRedraw()}_getAttributeManager(){const t=this.context;return new o.a(t.gl,{id:this.props.id,stats:t.stats,timeline:t.timeline})}_postUpdate(t,e){const{props:n,oldProps:i}=t;this.setNeedsRedraw(),this._updateAttributes();const{model:r}=this.state;null==r||r.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:s,highlightColor:a}=n;if(e||i.autoHighlight!==o||i.highlightedObjectIndex!==s||i.highlightColor!==a){const t={};o||(t.pickingSelectedColor=null),Array.isArray(a)&&(t.pickingHighlightColor=a),(e||s!==i.highlightedObjectIndex)&&(t.pickingSelectedColor=Number.isFinite(s)&&s>=0?this.encodePickingColor(s):null),this.setModuleParameters(t)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),i=!!n&&n.getNeedsRedraw(t);if(e=e||i,e)for(const t of this.props.extensions)t.onNeedsRedraw.call(this,t);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags,e}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}Object(i.a)(Y,"defaultProps",X),Object(i.a)(Y,"layerName","Layer")},748:function(t,e,n){"use strict";n.d(e,"a",(function(){return E}));var i=n(3),r=n(1456),o=n(810),s=n(134);class a{constructor(t,e){Object(i.a)(this,"opts",void 0),Object(i.a)(this,"source",void 0),this.opts=e,this.source=t}get value(){return this.source.value}getValue(){const t=this.source.getBuffer(),e=this.getAccessor();if(t)return[t,e];const{value:n}=this.source,{size:i}=e;let r=n;if(n&&n.length!==i){r=new Float32Array(i);const t=e.elementOffset||0;for(let e=0;e<i;++e)r[e]=n[t+e]}return r}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}var c=n(256),l=n(128),u=n(68);function d(t){return t.stride||t.size*t.bytesPerElement}function h(t,e){e.offset&&u.a.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=d(t),i=(void 0!==e.vertexOffset?e.vertexOffset:t.vertexOffset||0)*n+(e.elementOffset||0)*t.bytesPerElement+(t.offset||0);return{...e,offset:i,stride:n}}var p=n(116),f=n(196),g=n(232);const m=[],v=[[0,1/0]];var b=n(190);class y extends class{constructor(t,e,n){Object(i.a)(this,"gl",void 0),Object(i.a)(this,"id",void 0),Object(i.a)(this,"size",void 0),Object(i.a)(this,"settings",void 0),Object(i.a)(this,"value",void 0),Object(i.a)(this,"doublePrecision",void 0),Object(i.a)(this,"_buffer",void 0),Object(i.a)(this,"state",void 0),this.gl=t,this.id=e.id||"",this.size=e.size||1;const s=e.logicalType||e.type,a=5130===s;let c,{defaultValue:l}=e;l=Number.isFinite(l)?[l]:l||new Array(this.size).fill(0),c=a?5126:!s&&e.isIndexed?t&&Object(r.b)(t,o.a.ELEMENT_INDEX_UINT32)?5125:5123:s||5126;let u=function(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(s||c||5126);this.doublePrecision=a,a&&!1===e.fp64&&(u=Float32Array),this.value=null,this.settings={...e,defaultType:u,defaultValue:l,logicalType:s,type:c,size:this.size,bytesPerElement:u.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:t,type:e}=this.settings;this._buffer=new s.a(this.gl,{id:this.id,target:t?34963:34962,accessor:{type:e}})}return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*d(t):0}get numInstances(){return this.state.numInstances}set numInstances(t){this.state.numInstances=t}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),c.a.release(this.state.allocatedValue)}getShaderAttributes(t,e){if(this.doublePrecision){const n={},i=this.value instanceof Float64Array,r=function(t,e){const n=h(t,e);return{high:n,low:{...n,offset:n.offset+4*t.size}}}(this.getAccessor(),e||{});return n[t]=new a(this,r.high),n["".concat(t,"64Low")]=i?new a(this,r.low):new Float32Array(this.size),n}if(e){const n=h(this.getAccessor(),e);return{[t]:new a(this,n)}}return{[t]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let t=null;if(this.state.constant&&this.value){const e=Array.from(this.value);t=[e,e]}else{const{value:e,numInstances:n,size:i}=this,r=n*i;if(e&&r&&e.length>=r){const n=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let t=0;t<r;)for(let r=0;r<i;r++){const i=e[t++];i<n[r]&&(n[r]=i),i>o[r]&&(o[r]=i)}t=[n,o]}}return this.state.bounds=t,t}setData(t){const{state:e}=this;let n;n=ArrayBuffer.isView(t)?{value:t}:t instanceof s.a?{buffer:t}:t;const i={...this.settings,...n};if(e.bufferAccessor=i,e.bounds=null,n.constant){let t=n.value;t=this._normalizeValue(t,[],0),this.settings.normalized&&(t=this.normalizeConstant(t));if(!(!e.constant||!this._areValuesEqual(t,this.value)))return!1;e.externalBuffer=null,e.constant=!0,this.value=t}else if(n.buffer){const t=n.buffer;e.externalBuffer=t,e.constant=!1,this.value=n.value||null;const r=n.value instanceof Float64Array;i.type=n.type||t.accessor.type,i.bytesPerElement=t.accessor.BYTES_PER_ELEMENT*(r?2:1),i.stride=d(i)}else if(n.value){this._checkExternalBuffer(n);let t=n.value;e.externalBuffer=null,e.constant=!1,this.value=t,i.bytesPerElement=t.BYTES_PER_ELEMENT,i.stride=d(i);const{buffer:r,byteOffset:o}=this;this.doublePrecision&&t instanceof Float64Array&&(t=Object(l.g)(t,i));const s=t.byteLength+o+2*i.stride;r.byteLength<s&&r.reallocate(s),r.setAccessor(null),r.subData({data:t,offset:o}),i.type=n.type||r.accessor.type}return!0}updateSubBuffer(t={}){this.state.bounds=null;const e=this.value,{startOffset:n=0,endOffset:i}=t;this.buffer.subData({data:this.doublePrecision&&e instanceof Float64Array?Object(l.g)(e,{size:this.size,startIndex:n,endIndex:i}):e.subarray(n,i),offset:n*e.BYTES_PER_ELEMENT+this.byteOffset})}allocate(t,e=!1){const{state:n}=this,i=n.allocatedValue,r=c.a.allocate(i,t+1,{size:this.size,type:this.settings.defaultType,copy:e});this.value=r;const{buffer:o,byteOffset:s}=this;return o.byteLength<r.byteLength+s&&(o.reallocate(r.byteLength+s),e&&i&&o.subData({data:i instanceof Float64Array?Object(l.g)(i,this):i,offset:s})),n.allocatedValue=r,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}_checkExternalBuffer(t){const{value:e}=t;if(!ArrayBuffer.isView(e))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const n=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=e.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(e.constructor.name));e instanceof n||!this.settings.normalized||"normalized"in t||u.a.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(t){switch(this.settings.type){case 5120:return new Float32Array(t).map(t=>(t+128)/255*2-1);case 5122:return new Float32Array(t).map(t=>(t+32768)/65535*2-1);case 5121:return new Float32Array(t).map(t=>t/255);case 5123:return new Float32Array(t).map(t=>t/65535);default:return t}}_normalizeValue(t,e,n){const{defaultValue:i,size:r}=this.settings;if(Number.isFinite(t))return e[n]=t,e;if(!t){let t=r;for(;--t>=0;)e[n+t]=i[t];return e}switch(r){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:i[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:i[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:i[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:i[0];break;default:let o=r;for(;--o>=0;)e[n+o]=Number.isFinite(t[o])?t[o]:i[o]}return e}_areValuesEqual(t,e){if(!t||!e)return!1;const{size:n}=this;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}}{constructor(t,e){super(t,e,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:v}),Object(i.a)(this,"constant",!1),this.settings.update=e.update||(e.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:t=!1}={}){const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat("function"!=typeof t&&t||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,n=this.settings.transition,i=Array.isArray(e)?t[e.find(e=>t[e])]:t[e];return Object(b.e)(i,n)}setNeedsUpdate(t=this.id,e){if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:t=0,endRow:n=1/0}=e;this.state.updateRanges=function(t,e){if(t===v)return t;if(e[0]<0&&(e[0]=0),e[0]>=e[1])return t;const n=[],i=t.length;let r=0;for(let o=0;o<i;o++){const i=t[o];i[1]<e[0]?(n.push(i),r=o+1):i[0]>e[1]?n.push(i):e=[Math.min(i[0],e[0]),Math.max(i[1],e[1])]}return n.splice(r,0,e),n}(this.state.updateRanges,[t,n])}else this.state.updateRanges=v}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=m}setNeedsRedraw(t=this.id){this.state.needsRedraw=this.state.needsRedraw||t}allocate(t){const{state:e,settings:n}=this;return!n.noAlloc&&(!!n.update&&(super.allocate(t,e.updateRanges!==v),!0))}updateBuffer({numInstances:t,data:e,props:n,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:r},settings:{update:o,noAlloc:s}}=this;let a=!0;if(o){for(const[s,a]of r)o.call(i,this,{data:e,startRow:s,endRow:a,props:n,numInstances:t});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[e,n]of r){const i=Number.isFinite(e)?this.getVertexOffset(e):0,r=Number.isFinite(n)?this.getVertexOffset(n):s||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:i,endOffset:r})}else;this._checkAttributeArray()}else a=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),a}setConstantValue(t){if(void 0===t||"function"==typeof t)return!1;return this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(e.lastExternalBuffer=null,!1)}setBinaryValue(t,e=null){const{state:n,settings:i}=this;if(!t)return n.binaryValue=null,n.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(n.binaryValue===t)return this.clearNeedsUpdate(),!0;n.binaryValue=t,this.setNeedsRedraw();if(i.transform||e!==this.startIndices){ArrayBuffer.isView(t)&&(t={value:t});const r=t;Object(p.a)(ArrayBuffer.isView(r.value),"invalid ".concat(i.accessor));const o=Boolean(r.size)&&r.size!==this.size;return n.binaryAccessor=Object(f.b)(r.value,{size:r.size||this.size,stride:r.stride,offset:r.offset,startIndices:e,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:e}=this;return(e?t<e.length?e[t]:this.numInstances:t)*this.size}getShaderAttributes(){const t=this.settings.shaderAttributes||{[this.id]:null},e={};for(const n in t)Object.assign(e,super.getShaderAttributes(n,t[n]));return e}_autoUpdater(t,{data:e,startRow:n,endRow:i,props:r,numInstances:o}){if(t.constant)return;const{settings:s,state:a,value:c,size:l,startIndices:u}=t,{accessor:d,transform:h}=s,m=a.binaryAccessor||("function"==typeof d?d:r[d]);Object(p.a)("function"==typeof m,'accessor "'.concat(d,'" is not a function'));let v=t.getVertexOffset(n);const{iterable:b,objectInfo:y}=Object(f.a)(e,n,i);for(const e of b){y.index++;let n=m(e,y);if(h&&(n=h.call(this,n)),u){const e=(y.index<u.length-1?u[y.index+1]:o)-u[y.index];if(n&&Array.isArray(n[0])){let e=v;for(const i of n)t._normalizeValue(i,c,e),e+=l}else n&&n.length>l?c.set(n,v):(t._normalizeValue(n,y.target,0),Object(g.a)({target:c,source:y.target,start:v,count:e}));v+=e*l}else t._normalizeValue(n,c,v),v+=l}}_validateAttributeUpdaters(){const{settings:t}=this;if(!(t.noAlloc||"function"==typeof t.update))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let n=!0;switch(e){case 4:n=n&&Number.isFinite(t[3]);case 3:n=n&&Number.isFinite(t[2]);case 2:n=n&&Number.isFinite(t[1]);case 1:n=n&&Number.isFinite(t[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}var x=n(253),_=n(129),w=n(2200),O=n(276);var P=n(955),S=n(425),C=n(275);const j={interpolation:class{constructor({gl:t,attribute:e,timeline:n}){Object(i.a)(this,"gl",void 0),Object(i.a)(this,"type","interpolation"),Object(i.a)(this,"attributeInTransition",void 0),Object(i.a)(this,"settings",void 0),Object(i.a)(this,"attribute",void 0),Object(i.a)(this,"transition",void 0),Object(i.a)(this,"currentStartIndices",void 0),Object(i.a)(this,"currentLength",void 0),Object(i.a)(this,"transform",void 0),Object(i.a)(this,"buffers",void 0),this.gl=t,this.transition=new O.a(n),this.attribute=e,this.attributeInTransition=new y(t,e.settings),this.currentStartIndices=e.startIndices,this.currentLength=0,this.transform=function(t,e){const n=Object(b.c)(e.size);return new w.a(t,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}(t,e);const r={byteLength:0,usage:35050};this.buffers=[new s.a(t,r),new s.a(t,r)]}get inProgress(){return this.transition.inProgress}start(t,e){if(t.duration<=0)return void this.transition.cancel();this.settings=t;const{gl:n,buffers:i,attribute:r}=this;Object(b.a)(i);const o={numInstances:e,attribute:r,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const t of i)Object(b.f)({buffer:t,...o});this.currentStartIndices=r.startIndices,this.currentLength=Object(b.b)(r,e),this.attributeInTransition.setData({buffer:i[1],value:r.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/r.size),sourceBuffers:{aFrom:i[0],aTo:Object(b.d)(n,r)},feedbackBuffers:{vCurrent:i[1]}})}update(){const t=this.transition.update();if(t){const{duration:t,easing:e}=this.settings,{time:n}=this.transition;let i=n/t;e&&(i=e(i)),this.transform.run({uniforms:{time:i}})}return t}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0}},spring:class{constructor({gl:t,attribute:e,timeline:n}){Object(i.a)(this,"gl",void 0),Object(i.a)(this,"type","spring"),Object(i.a)(this,"attributeInTransition",void 0),Object(i.a)(this,"settings",void 0),Object(i.a)(this,"attribute",void 0),Object(i.a)(this,"transition",void 0),Object(i.a)(this,"currentStartIndices",void 0),Object(i.a)(this,"currentLength",void 0),Object(i.a)(this,"texture",void 0),Object(i.a)(this,"framebuffer",void 0),Object(i.a)(this,"transform",void 0),Object(i.a)(this,"buffers",void 0),this.gl=t,this.type="spring",this.transition=new O.a(n),this.attribute=e,this.attributeInTransition=new y(t,{...e.settings,normalized:!1}),this.currentStartIndices=e.startIndices,this.currentLength=0,this.texture=function(t){return new S.a(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(t),this.framebuffer=function(t,e){return new C.a(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(t,this.texture),this.transform=function(t,e,n){const i=Object(b.c)(e.size);return new w.a(t,{framebuffer:n,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}(t,e,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new s.a(t,r),new s.a(t,r),new s.a(t,r)]}get inProgress(){return this.transition.inProgress}start(t,e){const{gl:n,buffers:i,attribute:r}=this,o={numInstances:e,attribute:r,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const t of i)Object(b.f)({buffer:t,...o});this.settings=t,this.currentStartIndices=r.startIndices,this.currentLength=Object(b.b)(r,e),this.attributeInTransition.setData({buffer:i[1],value:r.value}),this.transition.start({...t,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/r.size),sourceBuffers:{aTo:Object(b.d)(n,r)}})}update(){const{buffers:t,transform:e,framebuffer:n,transition:i}=this;if(!i.update())return!1;const r=this.settings;e.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),e.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.stiffness,damping:r.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),Object(b.a)(t),this.attributeInTransition.setData({buffer:t[1],value:this.attribute.value});return Object(P.c)(n)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}};class M{constructor(t,{id:e,timeline:n}){Object(i.a)(this,"id",void 0),Object(i.a)(this,"isSupported",void 0),Object(i.a)(this,"gl",void 0),Object(i.a)(this,"timeline",void 0),Object(i.a)(this,"transitions",void 0),Object(i.a)(this,"needsRedraw",void 0),Object(i.a)(this,"numInstances",void 0),this.id=e,this.gl=t,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=w.a.isSupported(t)}finalize(){for(const t in this.transitions)this._removeTransition(t)}update({attributes:t,transitions:e,numInstances:n}){this.numInstances=n||1;for(const n in t){const i=t[n],r=i.getTransitionSetting(e);r&&this._updateAttribute(n,i,r)}for(const n in this.transitions){const i=t[n];i&&i.getTransitionSetting(e)||this._removeTransition(n)}}hasAttribute(t){const e=this.transitions[t];return e&&e.inProgress}getAttributes(){const t={};for(const e in this.transitions){const n=this.transitions[e];n.inProgress&&(t[e]=n.attributeInTransition)}return t}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions){this.transitions[t].update()&&(this.needsRedraw=!0)}const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].cancel(),delete this.transitions[t]}_updateAttribute(t,e,n){const i=this.transitions[t];let r=!i||i.type!==n.type;if(r){if(!this.isSupported)return void u.a.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();i&&this._removeTransition(t);const o=j[n.type];o?this.transitions[t]=new o({attribute:e,timeline:this.timeline,gl:this.gl}):(u.a.error("unsupported transition type '".concat(n.type,"'"))(),r=!1)}(r||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(n,this.numInstances))}}class E{constructor(t,{id:e="attribute-manager",stats:n,timeline:r}={}){Object(i.a)(this,"id",void 0),Object(i.a)(this,"gl",void 0),Object(i.a)(this,"attributes",void 0),Object(i.a)(this,"updateTriggers",void 0),Object(i.a)(this,"needsRedraw",void 0),Object(i.a)(this,"userData",void 0),Object(i.a)(this,"stats",void 0),Object(i.a)(this,"attributeTransitionManager",void 0),Object(i.a)(this,"mergeBoundsMemoized",Object(x.a)(l.e)),this.id=e,this.gl=t,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new M(t,{id:"".concat(e,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(t={clearRedrawFlags:!1}){const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(t){this._add(t)}addInstanced(t){this._add(t,{instanced:1})}remove(t){for(const e of t)void 0!==this.attributes[e]&&(this.attributes[e].delete(),delete this.attributes[e])}invalidate(t,e){const n=this._invalidateTrigger(t,e);Object(_.a)("attributeManager.invalidate",this,t,n)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);Object(_.a)("attributeManager.invalidate",this,"all")}update({data:t,numInstances:e,startIndices:n=null,transitions:i,props:r={},buffers:o={},context:s={}}){let a=!1;Object(_.a)("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const i in this.attributes){const c=this.attributes[i],l=c.settings.accessor;c.startIndices=n,c.numInstances=e,r[i]&&u.a.removed("props.".concat(i),"data.attributes.".concat(i))(),c.setExternalBuffer(o[i])||c.setBinaryValue("string"==typeof l?o[l]:void 0,t.startIndices)||"string"==typeof l&&!o[l]&&c.setConstantValue(r[l])||c.needsUpdate()&&(a=!0,this._updateAttribute({attribute:c,numInstances:e,data:t,props:r,context:s})),this.needsRedraw=this.needsRedraw||c.needsRedraw()}a&&Object(_.a)("attributeManager.updateEnd",this,e),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:e,transitions:i})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return this.attributes}getBounds(t){const e=t.map(t=>{var e;return null===(e=this.attributes[t])||void 0===e?void 0:e.getBounds()});return this.mergeBoundsMemoized(e)}getChangedAttributes(t={clearChangedFlags:!1}){const{attributes:e,attributeTransitionManager:n}=this,i={...n.getAttributes()};for(const r in e){const o=e[r];o.needsRedraw(t)&&!n.hasAttribute(r)&&(i[r]=o)}return i}getShaderAttributes(t,e={}){t||(t=this.getAttributes());const n={};for(const i in t)e[i]||Object.assign(n,t[i].getShaderAttributes());return n}_add(t,e={}){for(const n in t){const i=t[n];this.attributes[n]=this._createAttribute(n,i,e)}this._mapUpdateTriggersToAttributes()}_createAttribute(t,e,n){const i={...e,id:t,size:(e.isIndexed?1:e.size)||1,divisor:n.instanced?1:e.divisor||0};return new y(this.gl,i)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes){this.attributes[e].getUpdateTriggers().forEach(n=>{t[n]||(t[n]=[]),t[n].push(e)})}this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:n,updateTriggers:i}=this,r=i[t];return r&&r.forEach(t=>{const i=n[t];i&&i.setNeedsUpdate(i.id,e)}),r}_updateAttribute(t){const{attribute:e,numInstances:n}=t;if(Object(_.a)("attribute.updateStart",e),e.constant)return void e.setConstantValue(e.value);e.allocate(n)&&Object(_.a)("attribute.allocate",e,n);e.updateBuffer(t)&&(this.needsRedraw=!0,Object(_.a)("attribute.updateEnd",e,n))}}},752:function(t,e,n){"use strict";n.d(e,"a",(function(){return S}));var i=n(3),r=n(531),o=n(68),s=n(196),a=n(763),c=n(1409);const l=[];function u(t,e,n,i){let r=0;for(let s=e;s<n;s++){var o;r+=(null===(o=i[t[s]])||void 0===o?void 0:o.layoutWidth)||0}return r}function d(t,e,n,i,r,o){let s=e,a=0;for(let c=e;c<n;c++){const e=u(t,c,c+1,r);a+e>i&&(s<c&&o.push(c),s=c,a=0),a+=e}return a}function h(t,e,n,i,r=0,o){void 0===o&&(o=t.length);const s=[];return"break-all"===e?d(t,r,o,n,i,s):function(t,e,n,i,r,o){let s=e,a=e,c=e,l=0;for(let h=e;h<n;h++)if(" "===t[h]?c=h+1:" "!==t[h+1]&&h+1!==n||(c=h+1),c>a){let e=u(t,a,c,r);l+e>i&&(s<a&&(o.push(a),s=a,l=0),e>i&&(e=d(t,a,c,i,r,o),s=o[o.length-1])),a=c,l+=e}}(t,r,o,n,i,s),s}function p(t,e,n,i,r,s){let a=0,c=0;for(let s=e;s<n;s++){const e=t[s],n=i[e];n?(c||(c=n.layoutHeight),r[s]=a+n.layoutWidth/2,a+=n.layoutWidth):(o.a.warn("Missing character: ".concat(e," (").concat(e.codePointAt(0),")"))(),r[s]=a,a+=32)}s[0]=a,s[1]=c}class f{constructor(t=5){Object(i.a)(this,"limit",void 0),Object(i.a)(this,"_cache",{}),Object(i.a)(this,"_order",[]),this.limit=t}get(t){const e=this._cache[t];return e&&(this._deleteOrder(t),this._appendOrder(t)),e}set(t,e){this._cache[t]?(this.delete(t),this._cache[t]=e,this._appendOrder(t)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[t]=e,this._appendOrder(t))}delete(t){this._cache[t]&&(delete this._cache[t],this._deleteOrder(t))}_deleteOrder(t){const e=this._order.indexOf(t);e>=0&&this._order.splice(e,1)}_appendOrder(t){this._order.push(t)}}const g={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:function(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1};let m=new f(3);function v(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function b(t,e,n,i){t.font="".concat(i," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}class y{constructor(){Object(i.a)(this,"props",{...g}),Object(i.a)(this,"_key",void 0),Object(i.a)(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:t,buffer:e}=this.props;return(1.2*t+2*e)/t}setProps(t={}){Object.assign(this.props,t),this._key=this._getKey();const e=function(t,e){let n;n="string"==typeof e?new Set(Array.from(e)):new Set(e);const i=m.get(t);if(!i)return n;for(const t in i.mapping)n.has(t)&&n.delete(t);return n}(this._key,this.props.characterSet),n=m.get(this._key);if(n&&0===e.size)return void(this._atlas!==n&&(this._atlas=n));const i=this._generateFontAtlas(e,n);this._atlas=i,m.set(this._key,i)}_generateFontAtlas(t,e){const{fontFamily:n,fontWeight:i,fontSize:r,buffer:o,sdf:s,radius:a,cutoff:l}=this.props;let u=e&&e.data;u||(u=document.createElement("canvas"),u.width=1024);const d=u.getContext("2d",{willReadFrequently:!0});b(d,n,r,i);const{mapping:h,canvasHeight:p,xOffset:f,yOffset:g}=function({characterSet:t,getFontWidth:e,fontHeight:n,buffer:i,maxCanvasWidth:r,mapping:o={},xOffset:s=0,yOffset:a=0}){let c=0,l=s;const u=n+2*i;for(const s of t)if(!o[s]){const t=e(s);l+t+2*i>r&&(l=0,c++),o[s]={x:l+i,y:a+c*u+i,width:t,height:u,layoutWidth:t,layoutHeight:n},l+=t+2*i}return{mapping:o,xOffset:l,yOffset:a+c*u,canvasHeight:(d=a+(c+1)*u,Math.pow(2,Math.ceil(Math.log2(d))))};var d}({getFontWidth:t=>d.measureText(t).width,fontHeight:1.2*r,buffer:o,characterSet:t,maxCanvasWidth:1024,...e&&{mapping:e.mapping,xOffset:e.xOffset,yOffset:e.yOffset}});if(u.height!==p){const t=d.getImageData(0,0,u.width,u.height);u.height=p,d.putImageData(t,0,0)}if(b(d,n,r,i),s){const e=new c.a({fontSize:r,buffer:o,radius:a,cutoff:l,fontFamily:n,fontWeight:"".concat(i)});for(const n of t){const{data:t,width:i,height:o,glyphTop:s}=e.draw(n);h[n].width=i,h[n].layoutOffsetY=.9*r-s;const a=d.createImageData(i,o);v(t,a),d.putImageData(a,h[n].x,h[n].y)}}else for(const e of t)d.fillText(e,h[e].x,h[e].y+o+.9*r);return{xOffset:f,yOffset:g,mapping:h,data:u,width:u.width,height:u.height}}_getKey(){const{fontFamily:t,fontWeight:e,fontSize:n,buffer:i,sdf:r,radius:o,cutoff:s}=this.props;return r?"".concat(t," ").concat(e," ").concat(n," ").concat(i," ").concat(o," ").concat(s):"".concat(t," ").concat(e," ").concat(n," ").concat(i)}}var x=n(754);const _={start:1,middle:0,end:-1},w={top:1,center:0,bottom:-1},O=[0,0,0,255],P={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:O},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:g.characterSet},fontFamily:g.fontFamily,fontWeight:g.fontWeight,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:O},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:O},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class S extends r.a{constructor(...t){super(...t),Object(i.a)(this,"state",void 0),Object(i.a)(this,"getBoundingRect",(t,e)=>{let{size:[n,i]}=this.transformParagraph(t,e);const{fontSize:r}=this.state.fontAtlasManager.props;n/=r,i/=r;const{getTextAnchor:o,getAlignmentBaseline:s}=this.props;return[(_["function"==typeof o?o(t,e):o]-1)*n/2,(w["function"==typeof s?s(t,e):s]-1)*i/2,n,i]}),Object(i.a)(this,"getIconOffsets",(t,e)=>{const{getTextAnchor:n,getAlignmentBaseline:i}=this.props,{x:r,y:o,rowWidth:s,size:[a,c]}=this.transformParagraph(t,e),l=_["function"==typeof n?n(t,e):n],u=w["function"==typeof i?i(t,e):i],d=r.length,h=new Array(2*d);let p=0;for(let t=0;t<d;t++){const e=(1-l)*(a-s[t])/2;h[p++]=(l-1)*a/2+e+r[t],h[p++]=(u-1)*c/2+o[t]}return h})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new y},this.props.maxWidth>0&&o.a.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(t){const{props:e,oldProps:n,changeFlags:i}=t;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText();(this._updateFontAtlas()||e.lineHeight!==n.lineHeight||e.wordBreak!==n.wordBreak||e.maxWidth!==n.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:t}){return t.object=t.index>=0?this.props.data[t.index]:null,t}_updateFontAtlas(){const{fontSettings:t,fontFamily:e,fontWeight:n}=this.props,{fontAtlasManager:i,characterSet:r}=this.state,o={...t,characterSet:r,fontFamily:e,fontWeight:n};if(!i.mapping)return i.setProps(o),!0;for(const t in o)if(o[t]!==i.props[t])return i.setProps(o),!0;return!1}_updateText(){var t;const{data:e,characterSet:n}=this.props,i=null===(t=e.attributes)||void 0===t?void 0:t.getText;let r,{getText:o}=this.props,a=e.startIndices;const c="auto"===n&&new Set;if(i&&a){const{texts:t,characterCount:n}=function({value:t,length:e,stride:n,offset:i,startIndices:r,characterSet:o}){const s=t.BYTES_PER_ELEMENT,a=n?n/s:1,c=i?i/s:0,l=r[e]||Math.ceil((t.length-c)/a),u=o&&new Set,d=new Array(e);let h=t;if(a>1||c>0){h=new(0,t.constructor)(l);for(let e=0;e<l;e++)h[e]=t[e*a+c]}for(let t=0;t<e;t++){const e=r[t],n=r[t+1]||l,i=h.subarray(e,n);d[t]=String.fromCodePoint.apply(null,i),u&&i.forEach(u.add,u)}if(u)for(const t of u)o.add(String.fromCodePoint(t));return{texts:d,characterCount:l}}({...ArrayBuffer.isView(i)?{value:i}:i,length:e.length,startIndices:a,characterSet:c});r=n,o=(e,{index:n})=>t[n]}else{const{iterable:t,objectInfo:n}=Object(s.a)(e);a=[0],r=0;for(const e of t){n.index++;const t=Array.from(o(e,n)||"");c&&t.forEach(c.add,c),r+=t.length,a.push(r)}}this.setState({getText:o,startIndices:a,numInstances:r,characterSet:c||n})}transformParagraph(t,e){const{fontAtlasManager:n}=this.state,i=n.mapping,r=this.state.getText,{wordBreak:o,lineHeight:s,maxWidth:a}=this.props;return function(t,e,n,i,r){const o=Array.from(t),s=o.length,a=new Array(s),c=new Array(s),u=new Array(s),d=("break-word"===n||"break-all"===n)&&isFinite(i)&&i>0,f=[0,0],g=[0,0];let m=0,v=0,b=0;for(let t=0;t<=s;t++){const x=o[t];if("\n"!==x&&t!==s||(b=t),b>v){const t=d?h(o,n,i,r,v,b):l;for(let n=0;n<=t.length;n++){const i=0===n?v:t[n-1],s=n<t.length?t[n]:b;p(o,i,s,r,a,g);for(let t=i;t<s;t++){var y;const e=(null===(y=r[o[t]])||void 0===y?void 0:y.layoutOffsetY)||0;c[t]=m+g[1]/2+e,u[t]=g[0]}m+=g[1]*e,f[0]=Math.max(f[0],g[0])}v=b}"\n"===x&&(a[v]=0,c[v]=0,u[v]=0,v++)}return f[1]=m,{x:a,y:c,rowWidth:u,size:f}}(r(t,e)||"",s,o,a*n.props.fontSize,i)}renderLayers(){const{startIndices:t,numInstances:e,getText:n,fontAtlasManager:{scale:i,texture:r,mapping:o},styleVersion:s}=this.state,{data:c,_dataDiff:l,getPosition:u,getColor:d,getSize:h,getAngle:p,getPixelOffset:f,getBackgroundColor:m,getBorderColor:v,getBorderWidth:b,backgroundPadding:y,background:_,billboard:w,fontSettings:O,outlineWidth:P,outlineColor:S,sizeScale:C,sizeUnits:j,sizeMinPixels:M,sizeMaxPixels:E,transitions:L,updateTriggers:T}=this.props,R=this.getSubLayerClass("characters",a.a),A=this.getSubLayerClass("background",x.a);return[_&&new A({getFillColor:m,getLineColor:v,getLineWidth:b,padding:y,getPosition:u,getSize:h,getAngle:p,getPixelOffset:f,billboard:w,sizeScale:C,sizeUnits:j,sizeMinPixels:M,sizeMaxPixels:E,transitions:L&&{getPosition:L.getPosition,getAngle:L.getAngle,getSize:L.getSize,getFillColor:L.getBackgroundColor,getLineColor:L.getBorderColor,getLineWidth:L.getBorderWidth,getPixelOffset:L.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:T.getPosition,getAngle:T.getAngle,getSize:T.getSize,getFillColor:T.getBackgroundColor,getLineColor:T.getBorderColor,getLineWidth:T.getBorderWidth,getPixelOffset:T.getPixelOffset,getBoundingRect:{getText:T.getText,getTextAnchor:T.getTextAnchor,getAlignmentBaseline:T.getAlignmentBaseline,styleVersion:s}}}),{data:c.attributes&&c.attributes.background?{length:c.length,attributes:c.attributes.background}:c,_dataDiff:l,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new R({sdf:O.sdf,smoothing:Number.isFinite(O.smoothing)?O.smoothing:g.smoothing,outlineWidth:P/(O.radius||g.radius),outlineColor:S,iconAtlas:r,iconMapping:o,getPosition:u,getColor:d,getSize:h,getAngle:p,getPixelOffset:f,billboard:w,sizeScale:C*i,sizeUnits:j,sizeMinPixels:M*i,sizeMaxPixels:E*i,transitions:L&&{getPosition:L.getPosition,getAngle:L.getAngle,getColor:L.getColor,getSize:L.getSize,getPixelOffset:L.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:T.getText,getPosition:T.getPosition,getAngle:T.getAngle,getColor:T.getColor,getSize:T.getSize,getPixelOffset:T.getPixelOffset,getIconOffsets:{getTextAnchor:T.getTextAnchor,getAlignmentBaseline:T.getAlignmentBaseline,styleVersion:s}}}),{data:c,_dataDiff:l,startIndices:t,numInstances:e,getIconOffsets:this.getIconOffsets,getIcon:n})]}static set fontAtlasCacheLimit(t){!function(t){o.a.assert(Number.isFinite(t)&&t>=3,"Invalid cache limit"),m=new f(t)}(t)}}Object(i.a)(S,"defaultProps",P),Object(i.a)(S,"layerName","TextLayer")},753:function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var i=n(3),r=n(2163),o=n(65),s=n(68),a=n(129),c=n(232),l=n(514),u=n(2160);class d{constructor(t,e,n){Object(i.a)(this,"id",void 0),Object(i.a)(this,"context",void 0),Object(i.a)(this,"isLoaded",void 0),Object(i.a)(this,"persistent",void 0),Object(i.a)(this,"_loadCount",0),Object(i.a)(this,"_subscribers",new Set),Object(i.a)(this,"_data",void 0),Object(i.a)(this,"_loader",void 0),Object(i.a)(this,"_error",void 0),Object(i.a)(this,"_content",void 0),this.id=t,this.context=n,this.setData(e)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(t,e){if(t===this._data&&!e)return;this._data=t;const n=++this._loadCount;let i=t;"string"==typeof t&&(i=Object(u.a)(t)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=t)}).catch(t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=t||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=t);for(const t of this._subscribers)t.onChange(this.getData())}}class h{constructor({gl:t,protocol:e}){Object(i.a)(this,"protocol",void 0),Object(i.a)(this,"_context",void 0),Object(i.a)(this,"_resources",void 0),Object(i.a)(this,"_consumers",void 0),Object(i.a)(this,"_pruneRequest",void 0),this.protocol=e||"resource://",this._context={gl:t,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return!!t.startsWith(this.protocol)||t in this._resources}add({resourceId:t,data:e,forceUpdate:n=!1,persistent:i=!0}){let r=this._resources[t];r?r.setData(e,n):(r=new d(t,e,this._context),this._resources[t]=r),r.persistent=i}remove(t){const e=this._resources[t];e&&(e.delete(),delete this._resources[t])}unsubscribe({consumerId:t}){const e=this._consumers[t];if(e){for(const t in e){const n=e[t],i=this._resources[n.resourceId];i&&i.unsubscribe(n)}delete this._consumers[t],this.prune()}}subscribe({resourceId:t,onChange:e,consumerId:n,requestId:i="default"}){const{_resources:r,protocol:o}=this;t.startsWith(o)&&(r[t=t.replace(o,"")]||this.add({resourceId:t,data:null,persistent:!1}));const s=r[t];if(this._track(n,i,s,e),s)return s.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const t in this._resources)this._resources[t].delete()}_track(t,e,n,i){const r=this._consumers,o=r[t]=r[t]||{},s=o[e]||{},a=s.resourceId&&this._resources[s.resourceId];a&&(a.unsubscribe(s),this.prune()),n&&(o[e]=s,s.onChange=i,s.resourceId=n.id,n.subscribe(s))}_prune(){this._pruneRequest=null;for(const t of Object.keys(this._resources)){const e=this._resources[t];e.persistent||e.inUse()||(e.delete(),delete this._resources[t])}}}var p=n(185),f=n(927);class g{constructor(t,{deck:e,stats:n,viewport:o,timeline:s}={}){Object(i.a)(this,"layers",void 0),Object(i.a)(this,"context",void 0),Object(i.a)(this,"resourceManager",void 0),Object(i.a)(this,"_lastRenderedLayers",[]),Object(i.a)(this,"_needsRedraw",!1),Object(i.a)(this,"_needsUpdate",!1),Object(i.a)(this,"_nextLayers",null),Object(i.a)(this,"_debug",!1),Object(i.a)(this,"activateViewport",t=>{Object(a.a)("layerManager.activateViewport",this,t),t&&(this.context.viewport=t)}),this.layers=[],this.resourceManager=new h({gl:t,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:t,deck:e,programManager:t&&Object(f.a)(t),stats:n||new l.a({id:"deck.gl"}),viewport:o||new p.a({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new r.a,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const t of this.layers)this._finalizeLayer(t)}needsRedraw(t={clearRedrawFlags:!1}){let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const i=n.getNeedsRedraw(t);e=e||i}return e}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers({layerIds:t}={}){return t?this.layers.filter(e=>t.find(t=>0===e.id.indexOf(t))):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,e){Object(a.a)("layerManager.setLayers",this,e,t),this._lastRenderedLayers=t;const n=Object(c.b)(t,Boolean);for(const t of n)t.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(this._nextLayers||this._lastRenderedLayers,t)),this._nextLayers=null}_handleError(t,e,n){n.raiseError(e,"".concat(t," of ").concat(n))}_updateLayers(t,e){const n={};for(const e of t)n[e.id]?s.a.warn("Multiple old layers with same id ".concat(e.id))():n[e.id]=e;const i=[];this._updateSublayersRecursively(e,n,i),this._finalizeOldLayers(n);let r=!1;for(const t of i)if(t.hasUniformTransition()){r="Uniform transition in ".concat(t);break}this._needsUpdate=r,this.layers=i}_updateSublayersRecursively(t,e,n){for(const i of t){i.context=this.context;const t=e[i.id];null===t&&s.a.warn("Multiple new layers with same id ".concat(i.id))(),e[i.id]=null;let r=null;try{this._debug&&t!==i&&i.validateProps(),t?(this._transferLayerState(t,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),r=i.isComposite?i.getSubLayers():null}catch(t){this._handleError("matching",t,i)}r&&this._updateSublayersRecursively(r,e,n)}}_finalizeOldLayers(t){for(const e in t){const n=t[e];n&&this._finalizeLayer(n)}}_initializeLayer(t){try{t._initialize(),t.lifecycle=o.f.INITIALIZED}catch(e){this._handleError("initialization",e,t)}}_transferLayerState(t,e){e._transferState(t),e.lifecycle=o.f.MATCHED,e!==t&&(t.lifecycle=o.f.AWAITING_GC)}_updateLayer(t){try{t._update()}catch(e){this._handleError("update",e,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||"finalized ".concat(t),t.lifecycle=o.f.AWAITING_FINALIZATION;try{t._finalize(),t.lifecycle=o.f.FINALIZED}catch(e){this._handleError("finalization",e,t)}}}},754:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var i=n(3),r=n(747),o=n(1157),s=n(1158),a=n(52),c=n(798),l=n(237);const u={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class d extends r.a{constructor(...t){super(...t),Object(i.a)(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[o.a,s.a]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(t){super.updateState(t);const{changeFlags:e}=t;if(e.extensionsChanged){var n;const{gl:t}=this.context;null===(n=this.state.model)||void 0===n||n.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{billboard:e,sizeScale:n,sizeUnits:i,sizeMinPixels:r,sizeMaxPixels:o,getLineWidth:s}=this.props;let{padding:c}=this.props;c.length<4&&(c=[c[0],c[1],c[0],c[1]]),this.state.model.setUniforms(t).setUniforms({billboard:e,stroked:Boolean(s),padding:c,sizeUnits:a.e[i],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:o}).draw()}_getModel(t){return new c.a(t,{...this.getShaders(),id:this.props.id,geometry:new l.a({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0})}}Object(i.a)(d,"defaultProps",u),Object(i.a)(d,"layerName","TextBackgroundLayer")},755:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i=n(3),r=n(747),o=n(1157),s=n(1158),a=n(52),c=n(798),l=n(237);const u=[0,0,0,255],d={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:u},getLineColor:{type:"accessor",value:u},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class h extends r.a{getShaders(){return super.getShaders({vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool antialiasing;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\n    radiusMinPixels, radiusMaxPixels\n  );\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\n  unitPosition = edgePadding * positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = edgePadding * positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (!filled) {\n    discard;\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[o.a,s.a]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(t){if(super.updateState(t),t.changeFlags.extensionsChanged){var e;const{gl:t}=this.context;null===(e=this.state.model)||void 0===e||e.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{radiusUnits:e,radiusScale:n,radiusMinPixels:i,radiusMaxPixels:r,stroked:o,filled:s,billboard:c,antialiasing:l,lineWidthUnits:u,lineWidthScale:d,lineWidthMinPixels:h,lineWidthMaxPixels:p}=this.props;this.state.model.setUniforms(t).setUniforms({stroked:o?1:0,filled:s,billboard:c,antialiasing:l,radiusUnits:a.e[e],radiusScale:n,radiusMinPixels:i,radiusMaxPixels:r,lineWidthUnits:a.e[u],lineWidthScale:d,lineWidthMinPixels:h,lineWidthMaxPixels:p}).draw()}_getModel(t){return new c.a(t,{...this.getShaders(),id:this.props.id,geometry:new l.a({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0})}}Object(i.a)(h,"defaultProps",d),Object(i.a)(h,"layerName","ScatterplotLayer")},76:function(t,e,n){"use strict";function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.d(e,"a",(function(){return i}))},761:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(1401),r=n(2193),o=n(68),s=n(129);var a={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(t){const e=t[0],n=t[t.length-1];return"{"===e&&"}"===n||"["===e&&"]"===n},parseTextSync:JSON.parse};const c=function(){const t=globalThis.deck&&globalThis.deck.VERSION;if(t&&"8.9.32"!==t)throw new Error("deck.gl - multiple versions detected: ".concat(t," vs ").concat("8.9.32"));return t||(o.a.log(1,"deck.gl ".concat("8.9.32"))(),globalThis.deck={...globalThis.deck,VERSION:"8.9.32",version:"8.9.32",log:o.a,_registerLoggers:s.b},Object(i.b)([a,[r.a,{imagebitmap:{premultiplyAlpha:"none"}}]])),"8.9.32"}()},762:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n(3),r=n(129),o=n(340);class s extends o.a{shouldDrawLayer(t){const{operation:e}=t.props;return e.includes("draw")||e.includes("terrain")}}var a=n(459),c=n(275);class l{constructor(t){Object(i.a)(this,"gl",void 0),Object(i.a)(this,"layerFilter",void 0),Object(i.a)(this,"drawPickingColors",void 0),Object(i.a)(this,"drawLayersPass",void 0),Object(i.a)(this,"pickLayersPass",void 0),Object(i.a)(this,"renderCount",void 0),Object(i.a)(this,"_needsRedraw",void 0),Object(i.a)(this,"renderBuffers",void 0),Object(i.a)(this,"lastPostProcessEffect",void 0),this.gl=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new s(t),this.pickLayersPass=new a.a(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){if(!t.viewports.length)return;const e=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...t,target:t.target||c.a.getDefaultFramebuffer(this.gl)};n.effects&&this._preRender(n.effects,n);const i=this.lastPostProcessEffect?this.renderBuffers[0]:n.target,o=e.render({...n,target:i});n.effects&&this._postRender(n.effects,n),this.renderCount++,Object(r.a)("deckRenderer.renderLayers",this,o,t)}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}finalize(){const{renderBuffers:t}=this;for(const e of t)e.delete();t.length=0}_preRender(t,e){this.lastPostProcessEffect=null,e.preRenderStats=e.preRenderStats||{};for(const n of t)e.preRenderStats[n.id]=n.preRender(this.gl,e),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:t}=this;0===t.length&&t.push(new c.a(this.gl),new c.a(this.gl));for(const e of t)e.resize()}_postRender(t,e){const{renderBuffers:n}=this,i={...e,inputBuffer:n[0],swapBuffer:n[1],target:null};for(const r of t)if(r.postRender){if(r.id===this.lastPostProcessEffect){i.target=e.target,r.postRender(this.gl,i);break}const t=r.postRender(this.gl,i);i.inputBuffer=t,i.swapBuffer=t===n[0]?n[1]:n[0]}}}},763:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(3),r=n(68),o=n(490);const s=[];class a extends o.a{constructor(...t){super(...t),Object(i.a)(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float sdfBuffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"}}initializeState(){super.initializeState();this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(t,{index:e,target:n})=>this.encodePickingColor(e,n)}})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;let{outlineColor:i}=e;i!==n.outlineColor&&(i=i.map(t=>t/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!e.sdf&&e.outlineWidth&&r.a.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(t){const{sdf:e,smoothing:n,outlineWidth:i}=this.props,{outlineColor:r}=this.state,o=i?Math.max(n,.75*(1-i)):-1;if(t.uniforms={...t.uniforms,sdfBuffer:.75,outlineBuffer:o,gamma:n,sdf:Boolean(e),outlineColor:r},super.draw(t),e&&i){const{iconManager:t}=this.state;t.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:.75}})}}getInstanceOffset(t){return t?Array.from(t).flatMap(t=>super.getInstanceOffset(t)):s}getInstanceColorMode(t){return 1}getInstanceIconFrame(t){return t?Array.from(t).flatMap(t=>super.getInstanceIconFrame(t)):s}}Object(i.a)(a,"defaultProps",{getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}}),Object(i.a)(a,"layerName","MultiIconLayer")},768:function(t,e,n){var i=n(1e3),r=n(999),o=n(835),s=n(1001);t.exports=function(t){return i(t)||r(t)||o(t)||s()},t.exports.default=t.exports,t.exports.__esModule=!0},772:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(591);function r(t,e){if(t){if("string"==typeof t)return Object(i.a)(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(i.a)(t,e):void 0}}},775:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(69);class r extends(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array)){clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}toArray(t=[],e=0){for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:Object(i.f)(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(i.b)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+Object(i.e)(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!Object(i.d)(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){if(void 0===n)return this.lerp(this,t,e);for(let i=0;i<this.ELEMENTS;++i){const r=t[i];this[i]=r+n*(e[i]-r)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=e[t];return this.check()}subtract(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=e[t];return this.check()}scale(t){if("number"==typeof t)for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;else for(let e=0;e<this.ELEMENTS&&e<t.length;++e)this[e]*=t[e];return this.check()}multiplyByScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}check(){if(i.b.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}get elements(){return this}}},777:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(3);class r{constructor(t,e={id:"pass"}){Object(i.a)(this,"id",void 0),Object(i.a)(this,"gl",void 0),Object(i.a)(this,"props",void 0);const{id:n}=e;this.id=n,this.gl=t,this.props={...e}}setProps(t){Object.assign(this.props,t)}render(t){}cleanup(){}}},779:function(t,e,n){"use strict";function i({data:t,getIndex:e,dataRange:n,replace:i}){const{startRow:r=0,endRow:o=1/0}=n,s=t.length;let a=s,c=s;for(let n=0;n<s;n++){const i=e(t[n]);if(a>n&&i>=r&&(a=n),i>=o){c=n;break}}let l=a;const u=c-a!==i.length?t.slice(c):void 0;for(let e=0;e<i.length;e++)t[l++]=i[e];if(u){for(let e=0;e<u.length;e++)t[l++]=u[e];t.length=l}return{startRow:a,endRow:a+i.length}}n.d(e,"a",(function(){return i}))},780:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));const i=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]]},781:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var i=n(1413),r=n(532),o=n(942);function s(){}const a=["getBins","getDomain","getScaleFunc"],c=[{key:"fillColor",accessor:"getFillColor",pickingInfo:"colorValue",getBins:{triggers:{value:{prop:"getColorValue",updateTrigger:"getColorValue"},weight:{prop:"getColorWeight",updateTrigger:"getColorWeight"},aggregation:{prop:"colorAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"lowerPercentile"},upperPercentile:{prop:"upperPercentile"},scaleType:{prop:"colorScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"colorDomain"},range:{prop:"colorRange"}},onSet:{props:"onSetColorDomain"}},nullValue:[0,0,0,0]},{key:"elevation",accessor:"getElevation",pickingInfo:"elevationValue",getBins:{triggers:{value:{prop:"getElevationValue",updateTrigger:"getElevationValue"},weight:{prop:"getElevationWeight",updateTrigger:"getElevationWeight"},aggregation:{prop:"elevationAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"elevationLowerPercentile"},upperPercentile:{prop:"elevationUpperPercentile"},scaleType:{prop:"elevationScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"elevationDomain"},range:{prop:"elevationRange"}},onSet:{props:"onSetElevationDomain"}},nullValue:-1}],l=t=>t.cellSize;class u{constructor(t){this.state={layerData:{},dimensions:{}},this.changeFlags={},this.dimensionUpdaters={},this._getCellSize=t.getCellSize||l,this._getAggregator=t.getAggregator,this._addDimension(t.dimensions||c)}static defaultDimensions(){return c}updateState(t,e){const{oldProps:n,props:i,changeFlags:r}=t;this.updateGetValueFuncs(n,i,r);const o=this.needsReProjectPoints(n,i,r);let s=!1;if(r.dataChanged||o)this.getAggregatedData(i,e),s=!0;else{(this.getDimensionChanges(n,i,r)||[]).forEach(t=>"function"==typeof t&&t()),s=!0}return this.setState({aggregationDirty:s}),this.state}setState(t){this.state={...this.state,...t}}setDimensionState(t,e){this.setState({dimensions:{...this.state.dimensions,[t]:{...this.state.dimensions[t],...e}}})}normalizeResult(t={}){return t.hexagons?{data:t.hexagons,...t}:t.layerData?{data:t.layerData,...t}:t}getAggregatedData(t,e){const n=this._getAggregator(t)(t,e);this.setState({layerData:this.normalizeResult(n)}),this.changeFlags={layerData:!0},this.getSortedBins(t)}updateGetValueFuncs(t,e,n){for(const i in this.dimensionUpdaters){const{value:r,weight:s,aggregation:a}=this.dimensionUpdaters[i].getBins.triggers;let c=e[r.prop];this.needUpdateDimensionStep(this.dimensionUpdaters[i].getBins,t,e,n)&&(c=c?Object(o.c)(c,{data:e.data}):Object(o.b)(e[a.prop],e[s.prop],{data:e.data})),c&&this.setDimensionState(i,{getValue:c})}}needsReProjectPoints(t,e,n){return this._getCellSize(t)!==this._getCellSize(e)||this._getAggregator(t)!==this._getAggregator(e)||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPosition)}addDimension(t){this._addDimension(t)}_addDimension(t=[]){t.forEach(t=>{const{key:e}=t;this.dimensionUpdaters[e]=this.getDimensionUpdaters(t),this.state.dimensions[e]={getValue:null,domain:null,sortedBins:null,scaleFunc:s}})}getDimensionUpdaters({key:t,accessor:e,pickingInfo:n,getBins:i,getDomain:r,getScaleFunc:o,nullValue:s}){return{key:t,accessor:e,pickingInfo:n,getBins:{updater:this.getDimensionSortedBins,...i},getDomain:{updater:this.getDimensionValueDomain,...r},getScaleFunc:{updater:this.getDimensionScale,...o},attributeAccessor:this.getSubLayerDimensionAttribute(t,s)}}needUpdateDimensionStep(t,e,n,i){return Object.values(t.triggers).some(t=>t.updateTrigger?i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged[t.updateTrigger]):e[t.prop]!==n[t.prop])}getDimensionChanges(t,e,n){const i=[];for(const r in this.dimensionUpdaters){const o=a.find(i=>this.needUpdateDimensionStep(this.dimensionUpdaters[r][i],t,e,n));o&&i.push(this.dimensionUpdaters[r][o].updater.bind(this,e,this.dimensionUpdaters[r]))}return i.length?i:null}getUpdateTriggers(t){const e=t.updateTriggers||{},n={};for(const i in this.dimensionUpdaters){const{accessor:r}=this.dimensionUpdaters[i];n[r]={},a.forEach(o=>{Object.values(this.dimensionUpdaters[i][o].triggers).forEach(({prop:i,updateTrigger:o})=>{if(o){const t=e[o];"object"!=typeof t||Array.isArray(t)?void 0!==t&&(n[r][i]=t):Object.assign(n[r],t)}else n[r][i]=t[i]})})}return n}getSortedBins(t){for(const e in this.dimensionUpdaters)this.getDimensionSortedBins(t,this.dimensionUpdaters[e])}getDimensionSortedBins(t,e){const{key:n}=e,{getValue:r}=this.state.dimensions[n],o=new i.a(this.state.layerData.data||[],{getValue:r,filterData:t._filterData});this.setDimensionState(n,{sortedBins:o}),this.getDimensionValueDomain(t,e)}getDimensionValueDomain(t,e){const{getDomain:n,key:i}=e,{triggers:{lowerPercentile:r,upperPercentile:o,scaleType:s}}=n,a=this.state.dimensions[i].sortedBins.getValueDomainByScale(t[s.prop],[t[r.prop],t[o.prop]]);this.setDimensionState(i,{valueDomain:a}),this.getDimensionScale(t,e)}getDimensionScale(t,e){const{key:n,getScaleFunc:i,getDomain:o}=e,{domain:s,range:a}=i.triggers,{scaleType:c}=o.triggers,{onSet:l}=i,u=t[a.prop],d=t[s.prop]||this.state.dimensions[n].valueDomain,h=Object(r.d)(c&&t[c.prop])(d,u);"object"==typeof l&&"function"==typeof t[l.props]&&t[l.props](h.domain()),this.setDimensionState(n,{scaleFunc:h})}getSubLayerDimensionAttribute(t,e){return n=>{const{sortedBins:i,scaleFunc:r}=this.state.dimensions[t],o=i.binMap[n.index];if(o&&0===o.counts)return e;const s=o&&o.value,a=r.domain();return s>=a[0]&&s<=a[a.length-1]?r(s):e}}getSubLayerAccessors(t){const e={};for(const n in this.dimensionUpdaters){const{accessor:i}=this.dimensionUpdaters[n];e[i]=this.getSubLayerDimensionAttribute(t,n)}return e}getPickingInfo({info:t}){let e=null;if(t.picked&&t.index>-1){const n=this.state.layerData.data[t.index],i={};for(const t in this.dimensionUpdaters){const{pickingInfo:e}=this.dimensionUpdaters[t],{sortedBins:r}=this.state.dimensions[t],o=r.binMap[n.index]&&r.binMap[n.index].value;i[e]=o}e=Object.assign(i,n,{points:n.filteredPoints||n.points})}return t.picked=Boolean(e),t.object=e,t}getAccessor(t){return this.dimensionUpdaters.hasOwnProperty(t)?this.dimensionUpdaters[t].attributeAccessor:s}}},8:function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.default=t.exports,t.exports.__esModule=!0},804:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n(3),r=n(531),o=n(574),s=n(748),a=n(29);function c(t,e){const n={};for(const i in t)e.includes(i)||(n[i]=t[i]);return n}class l extends r.a{constructor(...t){super(...t),Object(i.a)(this,"state",void 0)}initializeAggregationLayer(t){super.initializeState(this.context),this.setState({ignoreProps:c(this.constructor._propTypes,t.data.props),dimensions:t})}updateState(t){super.updateState(t);const{changeFlags:e}=t;if(e.extensionsChanged){const t=this.getShaders({});t&&t.defines&&(t.defines.NON_INSTANCED_MODEL=1),this.updateShaders(t)}this._updateAttributes()}updateAttributes(t){this.setState({changedAttributes:t})}getAttributes(){return this.getAttributeManager().getShaderAttributes()}getModuleSettings(){const{viewport:t,mousePosition:e,gl:n}=this.context;return Object.assign(Object.create(this.props),{viewport:t,mousePosition:e,pickingActive:0,devicePixelRatio:Object(a.e)(n)})}updateShaders(t){}isAggregationDirty(t,e={}){const{props:n,oldProps:i,changeFlags:r}=t,{compareAll:s=!1,dimension:a}=e,{ignoreProps:c}=this.state,{props:l,accessors:u=[]}=a,{updateTriggersChanged:d}=r;if(r.dataChanged)return!0;if(d){if(d.all)return!0;for(const t of u)if(d[t])return!0}if(s)return!!r.extensionsChanged||Object(o.a)({oldProps:i,newProps:n,ignoreProps:c,propTypes:this.constructor._propTypes});for(const t of l)if(n[t]!==i[t])return!0;return!1}isAttributeChanged(t){const{changedAttributes:e}=this.state;return t?e&&void 0!==e[t]:!function(t){let e=!0;for(const n in t){e=!1;break}return e}(e)}_getAttributeManager(){return new s.a(this.context.gl,{id:this.props.id,stats:this.context.stats})}}Object(i.a)(l,"layerName","AggregationLayer")},814:function(t,e,n){"use strict";function i(){return(i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}n.d(e,"a",(function(){return i}))},815:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(3);function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?Object(arguments[e]):{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){Object(i.a)(t,e,n[e])}))}return t}},828:function(t,e){t.exports=function(t,e){if(null==t)return{};var n,i,r={},o=Object.keys(t);for(i=0;i<o.length;i++)n=o[i],e.indexOf(n)>=0||(r[n]=t[n]);return r},t.exports.default=t.exports,t.exports.__esModule=!0},835:function(t,e,n){var i=n(998);t.exports=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}},t.exports.default=t.exports,t.exports.__esModule=!0},9:function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t},t.exports.default=t.exports,t.exports.__esModule=!0},927:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(951);const r=[n(408).a],o=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function s(t){const e=i.a.getDefaultProgramManager(t);for(const t of r)e.addDefaultModule(t);for(const t of o)e.addShaderHook(t);return e}},936:function(t,e,n){"use strict";n.d(e,"a",(function(){return P}));var i=n(3),r=n(531),o=n(779);var s=n(490),a=n(755),c=n(752),l=n(407),u=n(489);const d={circle:{type:a.a,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:s.a,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:c.a,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},h={type:l.a,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},p={type:u.a,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function f({type:t,props:e}){const n={};for(const i in e)n[i]=t.defaultProps[e[i]];return n}function g(t,e){const{transitions:n,updateTriggers:i}=t.props,r={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const o in e){const s=e[o];let a=t.props[o];o.startsWith("get")&&(a=t.getSubLayerAccessor(a),r.updateTriggers[s]=i[o],n&&(r.transitions[s]=n[o])),r[s]=a}return r}var m=n(68);function v(t,e,n={}){const i={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:r=0,endRow:o=t.length}=n;for(let n=r;n<o;n++){const r=t[n],{geometry:o}=r;if(o)if("GeometryCollection"===o.type){m.a.assert(Array.isArray(o.geometries),"GeoJSON does not have geometries array");const{geometries:t}=o;for(let o=0;o<t.length;o++){b(t[o],i,e,r,n)}}else b(o,i,e,r,n)}return i}function b(t,e,n,i,r){const{type:o,coordinates:s}=t,{pointFeatures:a,lineFeatures:c,polygonFeatures:l,polygonOutlineFeatures:u}=e;if(function(t,e){let n=y[t];m.a.assert(n,"Unknown GeoJSON type ".concat(t));for(;e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}(o,s))switch(o){case"Point":a.push(n({geometry:t},i,r));break;case"MultiPoint":s.forEach(t=>{a.push(n({geometry:{type:"Point",coordinates:t}},i,r))});break;case"LineString":c.push(n({geometry:t},i,r));break;case"MultiLineString":s.forEach(t=>{c.push(n({geometry:{type:"LineString",coordinates:t}},i,r))});break;case"Polygon":l.push(n({geometry:t},i,r)),s.forEach(t=>{u.push(n({geometry:{type:"LineString",coordinates:t}},i,r))});break;case"MultiPolygon":s.forEach(t=>{l.push(n({geometry:{type:"Polygon",coordinates:t}},i,r)),t.forEach(t=>{u.push(n({geometry:{type:"LineString",coordinates:t}},i,r))})})}else m.a.warn("".concat(o," coordinates are malformed"))()}const y={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function x(t){return t.geometry.coordinates}function _(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{points:i,lines:r,polygons:o}=t,s=function(t,e){const n={points:null,lines:null,polygons:null};for(const i in n){const r=t[i].globalFeatureIds.value;n[i]=new Uint8ClampedArray(3*r.length);const o=[];for(let t=0;t<r.length;t++)e(r[t],o),n[i][3*t+0]=o[0],n[i][3*t+1]=o[1],n[i][3*t+2]=o[2]}return n}(t,e);return n.points.data={length:i.positions.value.length/i.positions.size,attributes:{...i.attributes,getPosition:i.positions,instancePickingColors:{size:3,value:s.points}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines.data={length:r.pathIndices.value.length-1,startIndices:r.pathIndices.value,attributes:{...r.attributes,getPath:r.positions,instancePickingColors:{size:3,value:s.lines}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines._pathType="open",n.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:{...o.attributes,getPolygon:o.positions,pickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygons._normalize=!1,o.triangles&&(n.polygons.data.attributes.indices=o.triangles.value),n.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:{...o.attributes,getPath:o.positions,instancePickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygonsOutline._pathType="open",n}const w=["points","linestrings","polygons"],O={...f(d.circle),...f(d.icon),...f(d.text),...f(h),...f(p),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class P extends r.a{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:t,changeFlags:e}){if(!e.dataChanged)return;const{data:n}=this.props,i=n&&"points"in n&&"polygons"in n&&"lines"in n;this.setState({binary:i}),i?this._updateStateBinary({props:t,changeFlags:e}):this._updateStateJSON({props:t,changeFlags:e})}_updateStateBinary({props:t,changeFlags:e}){const n=_(t.data,this.encodePickingColor);this.setState({layerProps:n})}_updateStateJSON({props:t,changeFlags:e}){const n=function(t){if(Array.isArray(t))return t;switch(m.a.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return m.a.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}(t.data),i=this.getSubLayerRow.bind(this);let r={};const s={};if(Array.isArray(e.dataChanged)){const t=this.state.features;for(const e in t)r[e]=t[e].slice(),s[e]=[];for(const a of e.dataChanged){const e=v(n,i,a);for(const n in t)s[n].push(Object(o.a)({data:r[n],getIndex:t=>t.__source.index,dataRange:a,replace:e[n]}))}}else r=v(n,i);const a=function(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{pointFeatures:i,lineFeatures:r,polygonFeatures:o,polygonOutlineFeatures:s}=t;return n.points.data=i,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=x,n.lines.data=r,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=x,n.polygons.data=o,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=x,n.polygonsOutline.data=s,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=x,n}(r,s);this.setState({features:r,featuresDiff:s,layerProps:a})}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n,sourceLayer:i}=e;return e.featureType=w.find(t=>i.id.startsWith("".concat(this.id,"-").concat(t,"-"))),n>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(e.index=this.props.data.points.globalFeatureIds.value[n]),e}_updateAutoHighlight(t){const e="".concat(this.id,"-points-"),n="points"===t.featureType;for(const i of this.getSubLayers())i.id.startsWith(e)===n&&i.updateAutoHighlight(t)}_renderPolygonLayer(){const{extruded:t,wireframe:e}=this.props,{layerProps:n}=this.state,i="polygons-fill",r=this.shouldRenderSubLayer(i,n.polygons.data)&&this.getSubLayerClass(i,p.type);if(r){const o=g(this,p.props),s=t&&e;return s||delete o.getLineColor,o.updateTriggers.lineColors=s,new r(o,this.getSubLayerProps({id:i,updateTriggers:o.updateTriggers}),n.polygons)}return null}_renderLineLayers(){const{extruded:t,stroked:e}=this.props,{layerProps:n}=this.state,i=!t&&e&&this.shouldRenderSubLayer("polygons-stroke",n.polygonsOutline.data)&&this.getSubLayerClass("polygons-stroke",h.type),r=this.shouldRenderSubLayer("linestrings",n.lines.data)&&this.getSubLayerClass("linestrings",h.type);if(i||r){const t=g(this,h.props);return[i&&new i(t,this.getSubLayerProps({id:"polygons-stroke",updateTriggers:t.updateTriggers}),n.polygonsOutline),r&&new r(t,this.getSubLayerProps({id:"linestrings",updateTriggers:t.updateTriggers}),n.lines)]}return null}_renderPointLayers(){const{pointType:t}=this.props,{layerProps:e,binary:n}=this.state;let{highlightedObjectIndex:i}=this.props;!n&&Number.isFinite(i)&&(i=e.points.data.findIndex(t=>t.__source.index===i));const r=new Set(t.split("+")),o=[];for(const t of r){const r="points-".concat(t),s=d[t],a=s&&this.shouldRenderSubLayer(r,e.points.data)&&this.getSubLayerClass(r,s.type);if(a){const c=g(this,s.props);let l=e.points;if("text"===t&&n){const{instancePickingColors:t,...e}=l.data.attributes;l={...l,data:{...l.data,attributes:e}}}o.push(new a(c,this.getSubLayerProps({id:r,updateTriggers:c.updateTriggers,highlightedObjectIndex:i}),l))}}return o}renderLayers(){const{extruded:t}=this.props,e=this._renderPolygonLayer();return[!t&&e,this._renderLineLayers(),this._renderPointLayers(),t&&e]}getSubLayerAccessor(t){const{binary:e}=this.state;return e&&"function"==typeof t?(e,n)=>{const{data:i,index:r}=n,o=function(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,i=t.featureIds.value[n];return-1!==n?function(t,e,n){const i={properties:{...t.properties[e]}};for(const e in t.numericProps)i.properties[e]=t.numericProps[e].value[n];return i}(t,i,n):null}(i,r);return t(o,n)}:super.getSubLayerAccessor(t)}}Object(i.a)(P,"layerName","GeoJsonLayer"),Object(i.a)(P,"defaultProps",O)},941:function(t,e,n){var i=n(1598);t.exports=function(t){return function(){return new i(t.apply(this,arguments))}},t.exports.default=t.exports,t.exports.__esModule=!0},942:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return c}));const i={SUM:1,MEAN:2,MIN:3,MAX:4};function r(t,e){return t+e}function o(t,e){return e>t?e:t}function s(t,e){return e<t?e:t}function a(t,e,n){const a=i[t]||i.SUM;switch(e=function(t,e={}){if(Number.isFinite(t))return t;return n=>(e.index=n.index,t(n.source,e))}(e,n),a){case i.MIN:return t=>function(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(s,1/0):null}(t,e);case i.SUM:return t=>function(t,e){if(Number.isFinite(e))return t.length?t.length*e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(r,0):null}(t,e);case i.MEAN:return t=>function(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(r,0)/n.length:null}(t,e);case i.MAX:return t=>function(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(o,-1/0):null}(t,e);default:return null}}function c(t,e={}){return n=>(e.indices=n.map(t=>t.index),t(n.map(t=>t.source),e))}},99:function(t,e,n){"use strict";n.r(e);var i=n(1379);n.d(e,"ArcLayer",(function(){return i.a}));var r=n(1378);n.d(e,"BitmapLayer",(function(){return r.a}));var o=n(490);n.d(e,"IconLayer",(function(){return o.a}));var s=n(1380);n.d(e,"LineLayer",(function(){return s.a}));var a=n(1382);n.d(e,"PointCloudLayer",(function(){return a.a}));var c=n(755);n.d(e,"ScatterplotLayer",(function(){return c.a}));var l=n(586);n.d(e,"ColumnLayer",(function(){return l.a}));var u=n(1162);n.d(e,"GridCellLayer",(function(){return u.a}));var d=n(407);n.d(e,"PathLayer",(function(){return d.a}));var h=n(533);n.d(e,"PolygonLayer",(function(){return h.a}));var p=n(936);n.d(e,"GeoJsonLayer",(function(){return p.a}));var f=n(752);n.d(e,"TextLayer",(function(){return f.a}));var g=n(489);n.d(e,"SolidPolygonLayer",(function(){return g.a}));var m=n(763);n.d(e,"_MultiIconLayer",(function(){return m.a}));var v=n(754);n.d(e,"_TextBackgroundLayer",(function(){return v.a}))},998:function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i},t.exports.default=t.exports,t.exports.__esModule=!0},999:function(t,e){t.exports=function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)},t.exports.default=t.exports,t.exports.__esModule=!0}}]);
//# sourceMappingURL=13.bundle.js.map